
Guide to Installing NWChem  
====================================================
$Id: INSTALL,v 1.18 1999-08-02 21:44:16 d3e129 Exp $
----------------------------------------------------

SOURCE CODE PROTECTION:
----------------------
Your User agreement states that you will protect the source code from
the general public.  You are not allowed to redistribute the software
in any form.  Please make sure the source code is protected by issuing
the following commands in the root NWChem directory (where this file
lives):

find . -exec chmod go-rwx "{}" ";"

See the instructions below after you have built the code for
installing the binaries and data files in a public place.


BUILDING NWCHEM:
---------------
  DO THESE STEPS IN ORDER OR THE BUILD WILL FAIL
                                       ----


1) You must use GNU make with a version of at least 3.71. You can
   check this by seeing if make understands the "-v" flag.  It does
   not matter what make is called (.i.e., gmake, gnumake, etc., are
   all OK).

2) Set the environment variable, NWCHEM_TOP, to the top directory 
   of the NWChem tree (where *this* file lives), e.g.

       % setenv NWCHEM_TOP /home/adrian/nwchem

   All the following directions assume that the current working
   directory is $NWCHEM_TOP/src.
   so issue the command "cd $NWCHEM_TOP/src"

3)  The currently supported platforms are:

    Symb.Name  Platform       Checked    OS/Version    Precision 
    -------------------------------------------------------------
    SUN         Sun                      SunOS         double
    SOLARIS     Sun             ***      Solaris 2.X   double
    IBM         IBM RS/6000     ***      AIX 3.X 4.X   double
    DECOSF      DEC AXP         ***      Dig.Unix 4.0  double
    SGI_N32     SGI 64 bit os   ***      IRIX          double 
                using 32 ints
    SGI         SGI 32 bit os    *       IRIX 5.X 6.X  double
    SGITFP      SGI 64 bit os    *       IRIX          double
    CRAY-T3D    Cray T3D                 UNICOS        single
    CRAY-T3E    Cray T3E        ***      UNICOS        single
    PARAGON     Intel Paragon            OSF/1         double
    DELTA       Intel Delta              NX            double
    SP          IBM SP1,SP2     ***      AIX/LAPI      double
    -------------------------------------------------------------

   Set the environment variable, NWCHEM_TARGET, to the symbolic name
   that matches your target platform, e.g.

       % setenv NWCHEM_TARGET SP1

   Some systems also require that you set NWCHEM_TARGET_CPU
    Symb.Name      CPU type     NWCHEM_TARGET_CPU 
    ----------------------------------------------------------
    SGITFP         R8000           R8000
                   R10000          R10000
    SGI_N32        R8000           R8000
                   R10000          R10000
    SP or LAPI     Power 2         DO __NOT__ set NWCHEM_TARGET_CPU
                   Power 2 super   P2SC
                   604e chip       604
    LINUX          Intel Pentium   DO __NOT__ set NWCHEM_TARGET_CPU
                   Power Mac       POWERPC
                   Alpha           ALPHA  (Build is currently broke)

   Note: LAPI is now the primary way to use NWChem on an IBM SP system.
         If you don't have it get it from IBM.

4) Configure to build the modules you need.  As a first shot build
   everything, and if you start running out of memory you can exclude
   modules.  Choose one or more from

        Name        Description
        ---------------------------------------------------------
        pnnl        Everything useful including NBO and python
        all         Everything useful
        qm          All quantum mechanics modules
	argos       MD only build 
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
          If you are familiar with building NWChem you 
          can be more selective with the modules you 
          really nead.  If you are a novice at this then
          use only one of the three above!
        - - - - - - - - - - - - - - - - - - - - - - - - -
	ddscf       RHF and UHF SCF energies
        nwdft       DFT energies
        gradients   SCF gradients
	dftgrad     DFT gradients
        stepper     Geometry optimization with stepper
        driver      Geometry optimization with driver
        moints      4-index
        rimp2       RI-MP2
        ccsd        CCSD & CCSD(T)
        property    Properties analysis
        pspw        Build the plane wave pseudo-potential code
        python      Build python interface to NWChem
        ---------------------------------------------------------

    To configure to build everything use the command

       % cd $NWCHEM_TOP/src
       % make nwchem_config NWCHEM_MODULES=all
    OR 
       % cd $NWCHEM_TOP/src
       % setenv NWCHEM_MODULES all
       % make nwchem_config

    Combinations of these tags are allowed.  For example,
       % setenv NWCHEM_MODULES "all pspw python" 
    will build the union of these three modules identifiers.  

5) Run the precision conversion according to the Precision column
   above for your target. This is necessary only on machines where 64
   bit is single precision in order to match BLAS routine names to
   vendor-supplied libraries (or if converting back from such source
   into the standard of 64 bit is double precision).

   For 64 bit single precision source

       % cd $NWCHEM_TOP/src
       % make dbl_to_sngl

6) Finally, compile and link:

       % make >& make.log

   This should install the executables and libraries into
   platform-specific subdirectories in the directory tree. For
   example, if the target platform equals SP1 then the following
   subdirectories are created:

	$NWCHEM_TOP/bin/SP          (executables)
        $NWCHEM_TOP/lib/SP          (libraries)

7) If you will be installing NWChem for general site use please also
   build the version info to help us determine exactly which version
   and patched version of NWChem you are using.  To do this you do the
   following: 
   cd $NWCHEM_TOP/src/util
   make version
   make
   cd $NWCHEM_TOP/src
   make link

   Note: Some compilers cannot build the full version file due to a
   lack of memory available to the compiler.  If the make in
   $NWCHEM_TOP/src/util fails try instead: 
   cd $NWCHEM_TOP/src/util
   make smallversion
   make
   cd $NWCHEM_TOP/src
   make link


ALTERNATIVE BUILD MODE:
----------------
   An alternative to steps 2 thru 6 is to specify all variables
   on the make command line.  This is recommended only for one
   time builds.  For instance, to build just the quantum mechanical
   codes on an IBM workstation

     make NWCHEM_TOP=/home/nwchem NWCHEM_TARGET=IBM NWCHEM_MODULES=qm

   Sometimes but infrequently the GNU make program fails with a singlye
   line specification.  If this happens try
     make NWCHEM_TOP=/home/nwchem NWCHEM_MODULES=qm nwchem_config
     make NWCHEM_TOP=/home/nwchem NWCHEM_TARGET=IBM 

POINT OF CONTACT USERS:
----------------------
   If you are the NWChem point-of-contact for a given site please
build and use the java tool in $NWCHEM_TOP/contrib/javasupport.  The
java class files and images are already built and available at the
binary download site.  If you have access to the source code you also
have access to the binary download site.  You need java 1.1.1 or
higher to use the tool.  This form formats information and allows the
attachment of input and output files via a simple browsing mechanism.
Use of this tool will greatly facilitate any support you may need for
using NWChem.


INSTALLING NWCHEM FOR GENERAL SITE USE: 
--------------------------------------
   The build procedures outlined above will allow use of NWChem within
the NWChem directory structure.  The code will look for the basis set
library file in a default place within that directory structure.  To
install the code in a general, public place (e.g., /usr/local/NWChem)
you need to do the following:

A) determine the local storage path for the install files. (e.g.,
   /usr/local/NWChem).

B) make directories
   mkdir /usr/local/NWChem
   mkdir /usr/local/NWChem/bin
   mkdir /usr/local/NWChem/data

C) cp $NWCHEM_TOP/bin/$NWCHEM_TARGET/nwchem /usr/local/NWChem/bin
   cp $NWCHEM_TOP/bin/$NWCHEM_TARGET/parallel /usr/local/NWChem/bin 
   cd /usr/local/NWChem/bin
   chmod 755 nwchem 
   chmod 755 parallel
   Note: parallel does not exist for all builds.  To learn how to use
         parallel consult the on-line documentation at:
         http://www.emsl.pnl.gov/pub/docs/nwchem/doc/user/index.html
	 or read the README files in $NWCHEM_TOP/src/tcgmsg    

D) cp $NWCHEM_TOP/src/basis/library /usr/local/NWChem/data
   cd $NWCHEM_TOP/src/nwadata
   cp -r * /usr/local/NWChem/data

E) Each user will need a .nwchemrc file to point to these default data
   files.  A global one could be put in /usr/local/NWChem/data and a
   symbolic link made in each users $HOME directory which is probably
   the best plan for new installs.  Users would have to issue the
   following command prior to using NWChem:
   ln -s /usr/local/NWChem/data/default.nwchemrc $HOME/.nwchemrc

F) Contents of the default.nwchemrc file based on the above
   information should be:

   nwchem_basis_library /usr/local/NWChem/data/library
   ffield amber
   amber_s /usr/local/NWChem/data/amber/amber_s/
   spce /usr/local/NWChem/data/solvents/spce.rst
   charmm_s /usr/local/NWChem/data/charmm/charmm_s/

   Of course users can copy this file instead of making the symbolic
   link described above and change these defaults at their discretion.


NOTE TO MPI USERS:
-----------------

   NWChem can be compiled to use MPI instead of TCGMSG for message
   passing on many systems. Although this is still somewhat
   experimental and not particulary tested it can be done.  Please
   contact nwchem-support@emsl.pnl.gov to get assistance with this
   procedure.  


