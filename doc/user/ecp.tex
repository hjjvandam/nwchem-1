\label{sec:ecp}

This optional directive allows the user to describe an effective core
potential (ECP) in terms of contracted gaussian functions.  The ECPs
are fit to Gaussians with the form
\[
 r^2V_l(r) = \sum_{k} A_{lk} r^{n_{lk}} e^{B_{lk}r^{2}}
\]
where $A_{lk}$ is the contraction coefficient, $n_{lk}$ is the
exponent of the ``r'' term (r-exponent), and $B_{lk}$ is the gaussian
exponent.  The $n_{lk}$ is shifted by 2 as per most of the ECP
literature and implementations, e.g., an $n_{lk} = 0$ implies
$r^{-2}$.  The current implementation only allows for $n_{lk}$ values
of only 0, 1, or 2. 

The EMSL library does not currently support a standard set of ECPs.
Basis sets using these functions must be specified explicitly by user
input in the \verb+ECP+ directive.  This directive has essentially the
same form as the standard \verb+BASIS+ directive, except for
differences in the type of information to be supplied for each atom or
center using the ECP basis set.  The form of the input for the
\verb+ECP+ directive is as follows;

\begin{verbatim}
  ecp [<string name default "ecp basis">] \
        [spherical || cartesian default cartesian] \
        [segment || nosegment default segment] \
        [print || noprint default print]

     <string tag> [nelec] <integer number_of_electrons_replaced>
 
        ...

     <string tag> <string shell_type>
     <real r-exponent> <real gaussian-exponent> <real list_of_coefficients>
        ...
     
  END
\end{verbatim}    

By default ECPs are automatically segmented and cartesian even if
general contractions are input.  ECPs are associated with centers in
geometries through tags or names of centers.  These tags must match
exactly (including case) in the \verb+GEOMETRY+ and \verb+ECP+
directives, and are limited to sixteen (16) characters.  Each center
with the same tag will have the same ECP.  By default the input module
prints each ECP encountered.  The \verb+NOPRINT+ option can be used to
disable printing.  There can be only one active ECP, even though
several may exist in the input deck.  The ECP modules load ``ecp
basis'' with any ``ao basis'' present.  The ECP functionality works
for energy and gradients.  Second derivative code exists and will be
incorporated once this functionality is stable within the rest of
NWChem.  There are limits associated with angular momentum of both the
ECP and ``ao basis'' but these issues will be addressed. The standard
Hay-Wadt, Stevens et al., or Christiansen-Ermler ECPs are acceptable.
The Stuuttgart ECPs should be avoided.

ECPs are named in the same fashion as for geometries or regular basis
sets, with the default name being \verb+"ecp basis"+.  It should be
clear from the above discussion on geometries and database entries how
indirection is supported.

Basis functions currently may not be drawn from a standard set in the
EMSL basis set library; they must be specified explicitly.  All
directives that are in common with the standard gaussian basis set
input have the same function and syntax.

The following keyword pairs are included as input options for the 
\verb+ECP+ directive,

\begin{verbatim}
  spherical || cartesian
  segment || nosegment
  print || noprint
\end{verbatim}

These keyword pairs are interpreted in the \verb+ECP+ directive in the
same manner as for the \verb+BASIS+ directive, but only the defaults
are currently available for the coordinate system and segmentation in
the \verb+ECP+ directive.  NWChem assumes that all ECPs are segmented
and cartesian.  The keywords are included in the directive, however,
because it is expected that eventually the code will include the
options for the user to specify basis functions in either spherical or
cartesian coordinates, segmented or unsegmented.  The print keyword is
currently active, and can be used to specify that the descriptions of
the functions will be printed or not printed by the input module, at
the user's discretion.
% , whether specified by the 
% user or defined in the standard library sets.

As with the input for the standard basis sets using the \verb+BASIS+
directive, the input specified for the \verb+ECP+ directive in lines
beginning with the string \verb+tag+ allow particular centers or atoms
in a calculation to be associated with particular basis functions.
The values specified for \verb+tag+ must correspond exactly with the
names supplied for the \verb+tag+ entries on the \verb+GEOMETRY+
directive for a particular calculation.  Each atom or center with the
same \verb+tag+ will have the same basis set, which must also be
specified with the same name \verb+tag+.

The keyword \verb+NELEC+ allows the user to specify the number of core
electrons replaced by the ECP for the atom represented by the tag.
Additional input lines can then be used to define the specific
coefficients and exponents.  The string \verb+shell_type+ is used to
specify the components of the ECP.  The label \verb+ul+ entered for
\verb+shell_type+ for a given atom or center (identified by the string
\verb+tag+) denotes the local part of the ECP.  This is equivalent to
the highest angular momentum functions specified in the literature for
most ECPs.  The standard entries (\verb+s, p, d+, etc.) for
\verb+shell_type+ delineate the angular momentum projector onto the
local function.  The shell type label of \verb+s+ indicates the
\verb+ul-s+ projector input, \verb+p+ indicates the \verb+ul-p+, etc.

An application of the \verb+ECP+ directive is illustrated in the
following example for the molecule H$_2$CO.  This input defines an ECP
for the carbon and oxygen atoms in the molecule.

% \centerline{{\bf H$_2$CO }}

\begin{verbatim}
  ecp print  
    C nelec 2     # ecp replaces 2 electrons on C
    C ul    # d
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        0.5498205       -0.03990210
   C s     # s - d 
            0        0.7374760        0.63810832
            0      135.2354832       11.00916230
            2        8.5605569       20.13797020
    C p     # p - d
            2       10.6863587       -3.24684280
            2       23.4979897        0.78505765
    O nelec 2     # ecp replaces 2 electrons on O
    O ul    # d 
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        1.0953760       -0.06623814
    O s     # s - d
            0        0.9212952        0.39552179
            0       28.6481971        2.51654843
            2        9.3033500       17.04478500
    O p     # p - s 
            2       52.3427019       27.97790770
            2       30.7220233      -16.49630500
  end
\end{verbatim}

%Generally contracted ECP basis sets are not in wide use, but the
%functionality has been included in NWChem for applications where they
%might be useful. 

