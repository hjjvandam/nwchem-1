\label{sec:ecp}

This optional directive allows the user to describe an effective core
potential (ECP) in terms of contracted Gaussian functions.  The ECPs
are fit to Gaussians with the form
\[
 r^2V_l(r) = \sum_{k} A_{lk} r^{n_{lk}} e^{-B_{lk}r^{2}}
\]
where $A_{lk}$ is the contraction coefficient, $n_{lk}$ is the
exponent of the ``r'' term (r-exponent), and $B_{lk}$ is the Gaussian
exponent.  The $n_{lk}$ is shifted by 2, in accordance with most of the ECP
literature and implementations, i.e., an $n_{lk} = 0$ implies
$r^{-2}$.  The current implementation allows $n_{lk}$ values
of only 0, 1, or 2. 

Potentials using these functions must be specified explicitly by user input
in the \verb+ECP+ directive.  This directive has essentially the same form
and properties as the standard \verb+BASIS+ directive, except for essential
differences required for ECPs.  Because of this, the ECP is treated
internally as a basis set. The form of the input for the
\verb+ECP+ directive is as follows:

%        [spherical || cartesian default cartesian]
%        [segment || nosegment default segment] 

\begin{verbatim}
  ECP [<string name default "ecp basis">] \
        [print || noprint default print]

     <string tag> library [<string tag_in_lib>] \
                  <string standard_set> [file <filename>]

     <string tag> [nelec] <integer number_of_electrons_replaced>
 
        ...

     <string tag> <string shell_type>
     <real r-exponent> <real Gaussian-exponent> <real list_of_coefficients>
        ...
     
  END
\end{verbatim}    

ECPs are automatically segmented, even if general contractions are input.
The projection operators defined in an ECP are spherical by default, so
there is no need to include the \verb+CARTESIAN+ or \verb+SPHERICAL+ keyword
as there is for a standard basis set.  ECPs are associated with centers in
geometries through tags or names of centers.  These tags must match in the
same manner as for basis sets the tags in a \verb+GEOMETRY+ and
\verb+ECP+ directives, and are limited to sixteen (16) characters.
Each center with the same tag will have the same ECP.  By default, the
input module prints each ECP that it encounters.  The \verb+NOPRINT+
option can be used to disable printing.  There can be only one active
ECP, even though several may exist in the input deck.  The ECP modules
load ``ecp basis'' inputs along with any ``ao basis'' inputs present.
ECPs may be used in both energy and gradient calculations.

ECPs are named in the same fashion as geometries or regular basis
sets, with the default name being \verb+"ecp basis"+.  It should be
clear from the above discussion on geometries and database entries how
indirection is supported.  All directives that are in common with the
standard Gaussian basis set input have the same function and syntax.

These are the names of the sets of ECPs available in the standard
library (their coverage is described in Appendix \ref{sec:knownbasis}).
\begin{itemize}
\item \verb,"Hay-Wadt MB (n+1) ECP",
\item \verb,"Hay-Wadt VDZ (n+1) ECP",
\item \verb+"LANL2DZ ECP"+
\item \verb+"SBKJC VDZ ECP"+
\item \verb+"Stuttgart RLC ECP"+
\item \verb+"Stuttgart RSC ECP"+
\item \verb+"CRENBL ECP"+
\item \verb+"CRENBS ECP"+
\end{itemize}

The keyword \verb+nelec+ allows the user to specify the number of core
electrons replaced by the ECP.  Additional input lines define the
specific coefficients and exponents.  The variable \verb+<shell_type>+
is used to specify the components of the ECP.  The keyword \verb+ul+
entered for \verb+<shell_type>+ denotes the local part of the ECP.
This is equivalent to the highest angular momentum functions specified
in the literature for most ECPs.  The standard entries (\verb+s, p,
d+, etc.) for \verb+shell_type+ specify the angular momentum projector
onto the local function.  The shell type label of \verb+s+ indicates
the \verb+ul-s+ projector input, \verb+p+ indicates the \verb+ul-p+,
etc.

For example, the Christiansen, Ross and Ermler ARECPs are available in
the standard basis set libary named \verb+{crenbl_ecp}+.  To perform a
calculation on uranyl ($UO_2^{2+}$) with all-electron oxygen
(aug-cc-pvdz basis), and uranium with an ARECP and using the
corresponding basis the following input can be used
\begin{verbatim}
  geometry
    U 0 0  0
    O 0 0  1.65
    O 0 0 -1.65
  end
  basis 
    U library crenbl_ecp
    O library aug-cc-pvdz
  end
  ecp
    U library crenbl_ecp
  end
\end{verbatim}

The following is an example of explicit input of an ECP for H$_2$CO.
It defines an ECP for the carbon and oxygen atoms in the molecule.

% \centerline{{\bf H$_2$CO }}

\begin{verbatim}
  ecp
    C nelec 2 # ecp replaces 2 electrons on C
    C ul      # d
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        0.5498205       -0.03990210
   C s        # s - d 
            0        0.7374760        0.63810832
            0      135.2354832       11.00916230
            2        8.5605569       20.13797020
    C p       # p - d
            2       10.6863587       -3.24684280
            2       23.4979897        0.78505765
    O nelec 2 # ecp replaces 2 electrons on O
    O ul      # d 
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        1.0953760       -0.06623814
    O s       # s - d
            0        0.9212952        0.39552179
            0       28.6481971        2.51654843
            2        9.3033500       17.04478500
    O p       # p - s 
            2       52.3427019       27.97790770
            2       30.7220233      -16.49630500
  end
\end{verbatim}

%RJH: Align six comment symbols (#) with the other two.--fmr.
%Generally contracted ECP basis sets are not in wide use, but the
%functionality has been included in NWChem for applications where they
%might be useful. 

