\label{sec:ecp}

This optional directive allows the user to describe an effective core
potential (ECP) in terms of contracted Gaussian functions.  The ECPs
are fit to Gaussians with the form
\[
 r^2V_l(r) = \sum_{k} A_{lk} r^{n_{lk}} e^{-B_{lk}r^{2}}
\]
where $A_{lk}$ is the contraction coefficient, $n_{lk}$ is the
exponent of the ``r'' term (r-exponent), and $B_{lk}$ is the Gaussian
exponent.  The $n_{lk}$ is shifted by 2, in accordance with most of the ECP
literature and implementations, i.e., an $n_{lk} = 0$ implies
$r^{-2}$.  The current implementation allows $n_{lk}$ values
of only 0, 1, or 2. 

At the time of writing, the EMSL basis library did not provide a
standard set of ECPs.  Basis sets using these functions must be
specified explicitly by user input in the \verb+ECP+ directive.  This
directive has essentially the same form as the standard \verb+BASIS+
directive, except for essential differences required for ECPs.  The
form of the input for the \verb+ECP+ directive is as follows:

\begin{verbatim}
  ECP [<string name default "ecp basis">] \
        [spherical || cartesian default cartesian] \
        [segment || nosegment default segment] \
        [print || noprint default print]

     <string tag> [nelec] <integer number_of_electrons_replaced>
 
        ...

     <string tag> <string shell_type>
     <real r-exponent> <real Gaussian-exponent> <real list_of_coefficients>
        ...
     
  END
\end{verbatim}    

By default, ECPs are automatically segmented and Cartesian, even if
general contractions are input.  ECPs are associated with centers in
geometries through tags or names of centers.  These tags must match
exactly (including case) in the \verb+GEOMETRY+ and \verb+ECP+
directives, and are limited to sixteen (16) characters.  Each center
with the same tag will have the same ECP.  By default, the input
module prints each ECP that it encounters.  The \verb+NOPRINT+ option
can be used to disable printing.  There can be only one active ECP,
even though several may exist in the input deck.  The ECP modules load
``ecp basis'' inputs along with any ``ao basis'' inputs present.  

ECPs my be used in both energy and gradient calculations.  Second
derivative code exists and will be incorporated once this
functionality is stable within the rest of NWChem.  There are limits
associated with angular momentum of both the ECP and ``ao basis'', but
these issues will be addressed. The standard Hay-Wadt, Stevens et al.,
or Christiansen-Ermler ECPs are acceptable.  The Stuttgart ECPs should
be avoided.

%RJH: Check out several suggested modifications in preceding paragraph.
%Also, need to mention what added capability the second derivative
%functionality will provide?  Re angular momentum limits, are you saying
%these limits will be removed when the functionality becomes available?
%Finallly, say why Stuttgart ECPs should be avoided?--fmr.

ECPs are named in the same fashion as geometries or regular basis
sets, with the default name being \verb+"ecp basis"+.  It should be
clear from the above discussion on geometries and database entries how
indirection is supported.

%RJH: Preferable to give some direct guidance here, or refer to discussion
%of "indirection" in the Basis sets directive Section?--fmr.

Basis functions currently may not be drawn from a standard set in the
EMSL basis set library; they must be specified explicitly.  All
directives that are in common with the standard Gaussian basis set
input have the same function and syntax.

%RJH: This paragraph seems to contradict the second paragraph of Chapter 7,
%which refers to a standard set in the EMSL basis set library.  Do you mean
%this cannot be done for the ECP directive, but can be done for the Basis
%directive?  This is not clear.  Also, not clear what you mean by "in common
%with" in the second sentence.  What I can gather here is that the BASIS
%directive and the ECP directive are two alternate ways of supplying input
%information about the number of atoms and/or electrons in a system, and
%that therefore their function and syntax are similar?  Any other directives
%similar to these two?  GEOMETRY?

The following keyword pairs are included as input options for the 
\verb+ECP+ directive:
\begin{verbatim}
  spherical || cartesian
  segment || nosegment
  print || noprint
\end{verbatim}

These keyword pairs are interpreted in the \verb+ECP+ directive in the
same manner as for the \verb+BASIS+ directive, but only the defaults
are currently available for the first two.  NWChem assumes that all
ECPs are segmented and Cartesian.  The alternate keywords are included
in the directive, however, because it is expected that eventually the
code will include the options for the user to specify basis functions
in either spherical or Cartesian coordinates, segmented or
unsegmented.  The print keyword is can be used to specify that the
descriptions of the functions will be printed or not printed by the
input module, at the user's discretion.

% , whether specified by the 
% user or defined in the standard library sets.

The keyword \verb+NELEC+ allows the user to specify the number of core
electrons replaced by the ECP.
Additional input lines define the specific
coefficients and exponents.  The variable \verb+<shell_type>+ is used to
specify the components of the ECP.  The keyword \verb+ul+ entered for
\verb+<shell_type>+ denotes the local part of the ECP.  This is equivalent to
the highest angular momentum functions specified in the literature for
most ECPs.  The standard entries (\verb+s, p, d+, etc.) for
\verb+shell_type+ specify the angular momentum projector onto the
local function.  The shell type label of \verb+s+ indicates the
\verb+ul-s+ projector input, \verb+p+ indicates the \verb+ul-p+, etc.

An application of the \verb+ECP+ directive is illustrated in the
following example for the molecule H$_2$CO.  This input defines an ECP
for the carbon and oxygen atoms in the molecule.

% \centerline{{\bf H$_2$CO }}

\begin{verbatim}
  ecp print  
    C nelec 2 # ecp replaces 2 electrons on C
    C ul      # d
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        0.5498205       -0.03990210
   C s        # s - d 
            0        0.7374760        0.63810832
            0      135.2354832       11.00916230
            2        8.5605569       20.13797020
    C p       # p - d
            2       10.6863587       -3.24684280
            2       23.4979897        0.78505765
    O nelec 2 # ecp replaces 2 electrons on O
    O ul      # d 
            1       80.0000000       -1.60000000
            1       30.0000000       -0.40000000
            2        1.0953760       -0.06623814
    O s       # s - d
            0        0.9212952        0.39552179
            0       28.6481971        2.51654843
            2        9.3033500       17.04478500
    O p       # p - s 
            2       52.3427019       27.97790770
            2       30.7220233      -16.49630500
  end
\end{verbatim}

%RJH: Align six comment symbols (#) with the other two.--fmr.
%Generally contracted ECP basis sets are not in wide use, but the
%functionality has been included in NWChem for applications where they
%might be useful. 

