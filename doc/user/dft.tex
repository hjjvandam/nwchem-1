\label{sec:dft}

The NWChem density functional theory (DFT) module uses the
gaussian basis set approach to compute
closed shell and open shell densities and Kohn-Sham orbitals
in the: 
\begin{itemize}
\item local density approximation (LDA), 
\item non-local density approximation (NLDA), 
\item local spin-density approximation (LSD), 
\item non-local spin-density approximation (NLSD), and
\item any empirical mixture of local and non-local approximations 
(inluding exact exchange).
\end{itemize}

The formal scaling of the DFT computation can be reduced by choosing
to use auxiliary gaussian basis sets to fit the charge density (CD) and/or 
fit the exchange-correlation (XC) potential.

The DFT module is invoked in NWChem 
by specifying the keyword \verb+dft+ as a TASK directive, e.g.,

\begin{verbatim}
  TASK DFT
\end{verbatim}

The keyword \verb+dft+ tells the code that this is a compound directive
potentially containing input for the DFT module.  Additional subdirectives
may be specified by the user to define a particular
problem.  The \verb+dft+ input will be processed until the
\verb+END+ directive is encountered.  

\begin{verbatim}
  DFT
    ...
  END
\end{verbatim}

The actual DFT calculation will
be performed when the input module encounters the \verb+TASK+ directive.
Refer to the \verb+TASK+ directive description in
Section \ref{sec:task} for a complete list of operations that can be
specified in the DFT module.  

Once a user has specified a geometry and a Kohn-Sham orbital basis set
the DFT module can be invoked with no input directives (defaults 
invoked throughout).  There are subdirectives which allow for 
customized application; those currently provided as options for 
the DFT module are:

\begin{verbatim}
  VECTORS [[input] (<string input_movecs default atomic>) || \
                   (project <string basisname> <string filename>)] \
           [swap [alpha|beta] <integer vec1 vec2> ...] \
           [output <string output_filename default input_movecs>] \
           [lock]


  XC [[acm] [b3lyp] [beckehandh] \
      [HFexch <real multiplicative_factor default 1.0>] \
      [becke88 [local|nonlocal] <real multiplicative_factor default 1.0>] \
      [lyp [local|nonlocal] <real multiplicative_factor default 1.0>] \
      [perdew81 <real multiplicative_factor default 1.0>] \
      [perdew86 [nonlocal] <real multiplicative_factor default 1.0>] \
      [perdew91 [nonlocal] <real multiplicative_factor default 1.0>] \
      [pw91lda <real multiplicative_factor default 1.0>] \
      [slater <real multiplicative_factor default 1.0>] \
      [vwn_1 <real multiplicative_factor default 1.0>] \
      [vwn_2 <real multiplicative_factor default 1.0>] \
      [vwn_3 <real multiplicative_factor default 1.0>] \
      [vwn_4 <real multiplicative_factor default 1.0>] \
      [vwn_5 <real multiplicative_factor default 1.0>] \
      [vwn_1_rpa <real multiplicative_factor default 1.0>]]


  CONVERGENCE [[energy <real energy default 1e-7>] \
               [density <real density default 1e-5>] \
               [gradient <real gradient default 1e-4>] \
               [dampon <real dampon default 0.0>] \
               [dampoff <real dampoff default 0.0>] \
               [diison <real diison default 0.0>] \
               [diisoff <real diisoff default 0.0>] \
               [levlon <real levlon default 0.0>] \
               [levloff <real levloff default 0.0>] \
               [ncydp <integer ncydp default 2>] \
               [ncyds <integer ncyds default 30>] \
               [ncysh <integer ncysh default 30>] \
               [damp <integer ndamp default 70>] [nodamping] \
               [diis [nfock <integer nfock default 30>]] \
               [nodiis] [lshift <real lshift default 0.5>] \
               [nolevelshifting] \
               [hl_tol <real hl_tol default 0.1>]]


  GRID [[delley|becke] [gausleg|(lebedev <integer iangquad default 4>)] \
        [coarse|medium|fine|xfine|(user <integer nagrid default 10> \
        <integer nradpts default 40>)] \
        [store_wght] [nquad_task <integer nquad_task default 1>] \
        [rm <real rm default 2.0>]]


  TOLERANCES [[tight] [tol_rho <real tol_rho default 1.0>] \
              [accAOfunc <integer accAOfunc default 20>] \
              [accCoul <integer accCoul default 15>] \
              [accQrad <integer accQrad default 40>] \
              [accXCfunc <integer accXCfunc default 20>] \
              [radius <real radius default 16.0>]]


  DECOMP
  DFT|ODFT
  DIRECT
  INCORE
  ITERATIONS <integer iterations default 30>
  MAX_OVL
  MULLIKEN
  MULT <integer mult default 1>
  NOIO
  PRINT|NOPRINT
\end{verbatim}

The following 
subsections describe these keywords and
optional subdirectives that can be specified for a \verb+DFT+ calculation
in NWChem.

\subsection{Geometry Specification for the DFT Module}

\subsection{Basis Sets Specification for the DFT Module}
The DFT module requires at a minimum the basis set for the Kohn-Sham 
molecular orbitals.  This basis set must be in the default basis set named
{\tt "ao basis"}, or it must be assigned to this default name using the
\verb+SET+ directive (see Section \ref{sec:set}).

In addition to the basis set for the Kohn-Sham orbitals, 
the charge density fitting basis set can also be specified in the 
input directives for the DFT module.  This basis set is used for the 
evaluation of the Coulomb potential in the Dunlap scheme\footnote{B.I.~Dunlap, 
J.W.D.~Connolly and J.R.~Sabin, J.~Chem.~Phys.~{\bf 71},  4993 (1979)}.
The charge density fitting basis set must have the name {\tt "cd basis"}.
This can be the actual name of a basis set, or a basis set can be 
assigned this name using the \verb+SET+ directive, as described in
Section \ref{sec:set}.  If this basis set is not defined by input,
the $O(N^4)$ exact Coulomb contribution is computed.

The user also has the option of specifying a third basis set for the 
evaluation of the exchange-correlation potential.  This basis set must
have the name {\tt "xc basis"}.  If this basis set is not specified
by input, the exchange contribution (XC) is evaluated by numerical
quadrature.  In most applications, this approach is efficient enough,
so the {\tt "xc basis"} basis set is not generally required.

For the DFT module, the input options for defining the basis sets in a given
calculation can be summarized as follows;

\begin{itemize}
\item {\tt "ao basis"} -- Kohn-Sham molecular orbitals; required for all 
calculations

\item {\tt "cd basis"} -- charge density fitting basis set; optional, but
recommended for evaluation of the Coulomb potential

\item {\tt "xc basis"} -- exchange-correlation (XC) fitting basis set; 
optional, and usually not recommended

\end{itemize}


\subsection{Input/Output of KS-MO Vectors in the DFT Module}
\begin{verbatim}
  VECTORS [[input] (<string input_movecs default atomic>) || \
                   (project <string basisname> <string filename>)] \
           [swap [alpha|beta] <integer vec1 vec2> ...] \
           [output <string output_filename default input_movecs>] \
           [lock]


  MAX_OVL (same as LOCK in VECTORS directive although not yet
  implemented as such)
\end{verbatim}

\subsection{Exchange-Correlation Potentials in the DFT Module}
\begin{verbatim}
  XC [[acm] [b3lyp] [beckehandh] \
      [HFexch <real multiplicative_factor default 1.0>] \
      [becke88 [local|nonlocal] <real multiplicative_factor default 1.0>] \
      [lyp [local|nonlocal] <real multiplicative_factor default 1.0>] \
      [perdew81 <real multiplicative_factor default 1.0>] \
      [perdew86 [nonlocal] <real multiplicative_factor default 1.0>] \
      [perdew91 [nonlocal] <real multiplicative_factor default 1.0>] \
      [pw91lda <real multiplicative_factor default 1.0>] \
      [slater <real multiplicative_factor default 1.0>] \
      [vwn_1 <real multiplicative_factor default 1.0>] \
      [vwn_2 <real multiplicative_factor default 1.0>] \
      [vwn_3 <real multiplicative_factor default 1.0>] \
      [vwn_4 <real multiplicative_factor default 1.0>] \
      [vwn_5 <real multiplicative_factor default 1.0>] \
      [vwn_1_rpa <real multiplicative_factor default 1.0>]]


  DECOMP
\end{verbatim}

The user has the option of specifying the exchange-correlation treatment 
in the DFT Module.  The default exchange-correlation functional is defined
as the local density approximation (LDA) for closed shell systems and it's
counterpart the local spin-density (LSD) approximation for open shell
systems.  Within this approximation the exchange functional is the 
the Slater $\rho^{1/3}$ functional (from J.C.~Slater, 
{\sl Quantum Theory of Molecules and
Solids, Vol.~4: The Self-Consistent Field for Molecules and Solids}
(McGraw-Hill, New York, 1974)), and the correlation
functional is the Vosk-Wilk-Nusair (VWN) functional (functional V)
(S.J.~Vosko, L.~Wilk and M.~Nusair, 
Can.~J.~Phys.~{\bf  58}, 1200 (1980)).  The parameters used in this
formula are obtained by fitting to the {\bf Ceperley \&
Alder\footnotemark[1]} Quantum
MonteCarlo solution of the {\bf homogenous electron gas}.

These defaults can be invoked explicitly by specifying the following
keywords within the DFT module input directive,

\begin{verbatim}
  XC slater vwn_5
\end{verbatim}

Many alternative exchange and correlation functionals are available to
the user.  The following subsections describe these options.

\subsubsection{Optional Exchange Functionals}

There are two exchange functionals in addition to the default exchange
functional.  These are the Becke gradient-corrected functional (see A.D.~Becke, 
J.~Chem.~Phys.~88, 3098 (1988)), and the Hartree-Fock exact exchange.

The Becke gradient-corrected functional is invoked by specifying the input
line,

\begin{verbatim}
   XC becke88
\end{verbatim}

The Hartree-Fock exact exchange functional, (which is exact to $O(N^4)$),
is invoked by specifying the input line,

\begin{verbatim}
   XC HFexch
\end{verbatim}

Note that the user also has the ability to include only the local or
nonlocal contributions of a given functional.  In addition the user
can specify a multiplicative factor for the local/nonlocal component
or total.  An example of this might be,

\begin{verbatim}
   XC becke88 nonlocal 0.72
\end{verbatim}

The user should be aware that the Becke88 local component is simply
the slater exchange and should be input as such.

Any combination of the supported exchange functional options can be
used.  For example the popular Gaussian B3 exchange could be specified
as:

\begin{verbatim}
   XC slater 0.8 becke88 nonlocal 0.72 HFexch 0.2
\end{verbatim}

  
\subsubsection{Optional Correlation Functionals}

In addition to the default \verb+vwn_5+ correlation functional, the user has
10 alternative correlation functionals to choose from: lyp, perdew81,
perdew86, perdew91, pw91lda, \verb+vwn_1+, \verb+vwn_2+, \verb+vwn_3+,
\verb+vwn_4+, and \verb+vwn_1_rpa+.

As in the exchange functional input, individual local/nonlocal
components as well as multiplicative factors can be invoked where
appropriate.  Each of the correlation functionals is listed below along with
appropriate citation. 

\begin{itemize}
\item VWN local density functionals; S.J.~Vosko, L.~Wilk and M.~Nusair, 
  Can.~J.~Phys.~{\bf  58}, 1200 (1980); all five (5) functionals as
  described in this paper (addressed in the paper as I - V) have been
  implemented.  These functionals can be invoked with the keywords:
\begin{verbatim}
   XC vwn_1
   XC vwn_2
   XC vwn_3
   XC vwn_4
   XC vwn_5
\end{verbatim}

Note that functionals; \verb+vwn_2+, \verb+vwn_3+, and \verb+vwn_4+ require both sets of 
parameters (the Monte Carlo parameters of Ceperley and Alder and
VWN's RPA parameters) used in fitting the homogenous electron gas
correlation energy.  Functionals \verb+vwn_1+ and \verb+vwn_5+ require only the
Monte Carlo fitting parameters.  In order to reproduce results in the
literature another functional was added; the \verb+vwn_1_rpa+.  This is the
original \verb+vwn_1+ functional with RPA paramenters as opposed to the
prescribed Monte Carlo parameters.  This functional can be invoked
with the keyword,

\begin{verbatim}
   XC vwn_1_rpa
\end{verbatim}

\item Perdew81 local density functional; J.~P.~Perdew and A.~Zunger,
  Phys.~Rev.~B {\bf23}, 5048 (1981). This functional can be invoked with the
  keyword,
  
\begin{verbatim}
   XC perdew81
\end{verbatim}

\item Perdew \& Wang 1991 local density functional;  J.P.~Perdew
  and Y.~Wang, Phys. Rev. B {\bf 45}, 13244 (1992).  The parameters
  used in this formula are obtained by fitting to the {\bf Ceperley \&
  Alder\footnotemark[1]} Quantum Monte Carlo solution of the {\bf
  homogenous electron gas}.  This functional can be invoked with the
  keyword,
  
\begin{verbatim}
   XC pw91lda
\end{verbatim}

\item Perdew86 gradient-corrected functional; J.~P.~Perdew, Phys.~Rev.~B 
  {\bf33}, 8822 (1986).  Note that this is a nonlocal functional and
  in the absence of any local functional specification the local
  component is defaulted to the perdew81 local correlation
  functional. This functional can be invoked with the
  keyword,
  
\begin{verbatim}
   XC perdew86
\end{verbatim}

\item Perdew91 gradient-corrected functional;  J.P.~Perdew,
  J.A.~Chevary, S.H.~Vosko, K.A.~Jackson, M.R.~Pederson, D.J.~Singh
  and C.~Fiolhais, Phys. Rev. B {\bf 46}, 6671 (1992). Note that this
  is a nonlocal functional and in the absence of any local functional 
  specification the local component is defaulted to the pw91lda local 
  correlation functional.  This functional can be invoked with the keyword,

\begin{verbatim}
   XC perdew91
\end{verbatim}

\item LYP gradient-corrected functional; C.~Lee, W.~Yang and
   R.~G.~Parr, Phys.~Rev.~B {\bf 37}, 785 (1988).  Note that this
  is a local and nonlocal functional but cannot be conveniently split
  into the individual components.  The option to scale the total remains.
  This functional can be invoked with the keyword,
  
\begin{verbatim}
   XC lyp
\end{verbatim}

\end{itemize}

Any combination of the supported correlation functional options can be
used.  For example the correlation component of the popular B3LYP
could be specified as:

\begin{verbatim}
   XC vwn_1_rpa 0.19 lyp 0.81
\end{verbatim}

  
\footnotetext[1]{D.M.~Ceperley and B.J.~Alder, Phys. Rev. Lett. {\bf 45},
  566 (1980).}

\subsubsection{Hybrid Methods for Determining the Exchange and Correlation 
Functionals}

In addition to the options listed above for the exchange and correlation
functionals, the user has the alternative of specifying a ``canned'' hybrid
functional.  The available hybrid functionals consist of the Becke
``{\sl half and half}'' (see A.D.~Becke, J.~Chem.~Phys.~98, 1372 (1992)), the
adiabatic connection method (see A.D.~Becke, J.~Chem.~Phys.~98, 5648
(1993)), and the b3lyp (popularized by Gaussian9X).

These options can be invoked by specifying any of the following input lines,

\begin{verbatim}
   XC beckehandh
   XC acm
   XC b3lyp
\end{verbatim}

The keyword \verb+beckehandh+ specifies that the exchange-correlation energy will be
computed as 
\begin{eqnarray*}
E_{X} \ = \ \frac{1}{2} E^{\rm HF}_X + \frac{1}{2} E^{\rm
  Slater}_{X} + \frac{1}{2} E^{\rm PW91LDA}_{C}
\end{eqnarray*}

The keyword \verb+acm+ specifies that the exchange-correlation energy
is computed as

\begin{eqnarray*}
E_{XC} \ &=& \ a_0 E^{\rm HF}_X + (1-a_0) E^{\rm Slater}_{X} +
a_X \Delta E^{\rm Becke88}_{X} + E^{\rm VWN}_C + a_C \Delta E^{Perdew91}_C \\
& &{\rm where } \\
a_0 &=& 0.20, \ a_X = 0.72, \ a_C = 0.81
\end{eqnarray*}

The keyword \verb+b3lyp+ specifies that the exchange-correlation energy
is computed as

\begin{eqnarray*}
E_{XC} \ &=& \ a_0 E^{\rm HF}_X + (1-a_0) E^{\rm Slater}_{X} +
a_X \Delta E^{\rm Becke88}_{X} + (1-a_C)E^{\rm \verb+VWN_1_RPA+}_C + a_C E^{LYP}_C \\
& &{\rm where } \\
a_0 &=& 0.20, \ a_X = 0.72, \ a_C = 0.81
\end{eqnarray*}


\subsection{SCF Convergence Control in the DFT Module}
\begin{verbatim}

  ITERATIONS <integer iterations default 30>

  CONVERGENCE [[energy <real energy default 1e-7>] \
               [density <real density default 1e-5>] \
               [gradient <real gradient default 1e-4>] \
               [dampon <real dampon default 0.0>] \
               [dampoff <real dampoff default 0.0>] \
               [diison <real diison default 0.0>] \
               [diisoff <real diisoff default 0.0>] \
               [levlon <real levlon default 0.0>] \
               [levloff <real levloff default 0.0>] \
               [ncydp <integer ncydp default 2>] \
               [ncyds <integer ncyds default 30>] \
               [ncysh <integer ncysh default 30>] \
               [damp <integer ndamp default 70>] [nodamping] \
               [diis [nfock <integer nfock default 30>]] \
               [nodiis] [lshift <real lshift default 0.5>] \
               [nolevelshifting] \
               [hl_tol <real hl_tol default 0.1>]]


\end{verbatim}

The default optimization in the DFT module is to iterate on the 
Kohn-Sham (SCF) equations for a specified number of iterations
(default 30).  The keyword that controls this optimization 
is \verb+ITERATIONS+, and has the following general form,

\begin{verbatim}
   iterations <integer iterations default 30>
\end{verbatim}

The optimization procedure will stop when the specified number of
iterations is reached or convergence is meant.  Convergence is
satisfied by meeting any or all of three criteria; 

\begin{itemize}
\item convergence of the total energy; this is defined to be when the
  total DFT energy at iteration N and at iteration N-1 differ by a value less
  than some value (the default is 1e-7).  This value can be modified
  using the key word,

\begin{verbatim}
  CONVERGENCE energy <real energy default 1e-7>
\end{verbatim}

\item convergence of the total density; this is defined to be when the
  total DFT density matrix at iteration N and at iteration N-1 have a
  RMS difference less than some value (the default is 1e-5).  This value can be modified
  using the key word,

\begin{verbatim}
  CONVERGENCE density <real density default 1e-5>
\end{verbatim}

\item convergence of the orbital gradient; this is defined to be when the
  DIIS error vector becomes less than some value (the default is
  1e-4).  This value can be modified using the key word,

\begin{verbatim}
  CONVERGENCE gradient <real gradient default 1e-4>
\end{verbatim}
\end{itemize}

The default optimization strategy is to immediately begin direct inversion of the
iterative subspace\footnote {P.~Pulay,  Chem.\ Phys.\ Lett.\ {\bf 73}, 
393 (1980) and P.~Pulay,  J.~Comp.~Chem.~{\bf 3}, 566 (1982)}.
Damping is also initiated (using 70% of the previous density) for
the first 2 iteration.  In addition, if the HOMO - LUMO gap is small
and the Fock matrix somewhat diagonally dominant, then levelshifting
is automatically initiated.  There are a variety of ways to customize
this procedure to whatever is desired.

An alternative optimization strategy is to specify, by using the change 
in total energy (from iterations when N and N-1), when to turn
damping, levelshifting, and/or diis on/off.  Start and stop keywords for
each of these is available as,

\begin{verbatim}
  CONVERGENCE  [dampon <real dampon default 0.0>] \
               [dampoff <real dampoff default 0.0>] \
               [diison <real diison default 0.0>] \
               [diisoff <real diisoff default 0.0>] \
               [levlon <real levlon default 0.0>] \
               [levloff <real levloff default 0.0>]
\end{verbatim}

So, for example, damping, diis, and/or levelshifting can be turned
on/off as desired.

Another strategy can be to simply specify how many iterations (cycles) you wish
each type of procedure to be used.  The necessary keywords to control
the number of damping cycles (ncydp), the number of diis cycles
(ncyds), and the number of levelshifting cycles (ncysh) are input as,

\begin{verbatim}
  CONVERGENCE  [ncydp <integer ncydp default 2>] \
               [ncyds <integer ncyds default 30>] \
               [ncysh <integer ncysh default 0>]
\end{verbatim}

\begin{verbatim}
JEFF STOPED HERE 2-19-97

\end{verbatim}




The damping to be imposed after \verb+itrscf+ iterations is specified
as a percent of ***what?***, using the following keyword,

\begin{verbatim}
   damp <integer ndamp default 0>
\end{verbatim}

% \item Use direct inversion of the iterative subspace (DIIS) optimization
%   (P.~Pulay,  Chem.\ Phys.\ Lett.\ {\bf 73}, 393 (1980) and P.~Pulay,
%   J.~Comp.~Chem.~{\bf 3}, 566 (1982)):

\begin{verbatim}
   diis
   nfock <integer nfock default 10>
\end{verbatim}

The user also has the option of level-shifting\footnote {M.F.~Guest and 
V.R.~Saunders, Mol.~Phys.~{\bf 28}, 819 (1974)} the Fock matrix by specifying
the keyword \verb+lshift+.  The form of this directive is as follows,

\begin{verbatim}
   lshift <real lshift default 0> 
\end{verbatim}

Specifying this keyword causes the diagonal elements of the Fock matrix
corresponding to the virtual orbitals to be shifted by \verb+lshift+.
By default, this level-shifting procedure is switched off after 99 iterations.
The user can specify the point at which it is switched off by defining
the keyword {\tt ncyshft}.  The form of the input line is as follows,

\begin{verbatim}
  ncyshft <integer ncyshft default 99> 
\end{verbatim}

% \item Density matrix damping. Damp by {\tt ndamp} percent (default 0\%):
% \begin{verbatim}
%    damp <integer ndamp>  
% \end{verbatim}
% \item Fock matrix level shifting (M.F.~Guest and V.R.~Saunders,
%   Mol.~Phys.~{\bf 28}, 819 (1974)). The diagonal elements of
% the Fock matrix corresponding to virtual orbitals are shifted by 
% {\tt  lshift} Hartree (default 0):
% \begin{verbatim}
%    lshift <real lshift> 
% \end{verbatim}
% The level shifting procedure may be switched off after {\tt ncyshft} cycles
% (default 99):
% \begin{verbatim}
%   ncyshft <integer ncyshft> 
% \end{verbatim}
% \end{itemize}



When the option for direct inversion of the iterative subspace is
specified (by entering the keyword \verb+DIIS+; see Section \ref{opt}),
the user can define the DIIS error norm convergence tolerance.  This
is done by specifying an input line of the form,

\begin{verbatim}
  idiisoff <integer idiisoff default 7>
\end{verbatim}

The error norm convergence tolerance is defined as $10^{-{\tt idiisoff}}$.

% \begin{itemize}
% \item Delta energy convergence tolerance $10^{-{\tt iscfcon}}$(default 7):
% \begin{verbatim}
%   scfcon <integer iscfcon>
% \end{verbatim}
% \item Delta density convergence tolerance $10^{-{\tt igcon}}$
%   (default -1 [meaning ignore]):
% \begin{verbatim}
%   gcon <integer igcon>
% \end{verbatim}
% \item DIIS error norm convergence tolerance $10^{-{\tt idiisoff}}$ 
%   (only used with DIIS, default 7):
% \begin{verbatim}
%   idiisoff <integer idiisoff>
% \end{verbatim}
% \end{itemize}

\subsection{Control of the Numerical Integration (Grid Control) of the
  Exchange-Correlation Potential in the DFT Module}
\begin{verbatim}
  GRID [[delley|becke] [gausleg|(lebedev <integer iangquad default 4>)] \
        [coarse|medium|fine|xfine|(user <integer nagrid default 10> \
        <integer nradpts default 40>)] \
        [store_wght] [nquad_task <integer nquad_task default 1>] \
        [rm <real rm default 2.0>]]


\end{verbatim}


% \begin{itemize}
% \item 
Two types of angular grid have been implemented in the DFT module.  These
are the Gauss-Legendre grid, and the Lebedev grid\footnote{The subroutine 
for the Lebedev grid was supplied by M.~Caus\`a of the University of Torino.}
The default in the DFT calculation is to select the Gauss-Legendre grid,
but the user can specify this input explicitly using the following input
line,

%  Gauss-Legendre (default):
\begin{verbatim}
   KEYWORD  <string grid_type default gausleg>  \
     <string tag> <string radial_density default medium>  \
                  <string ang_density default medium>     \
   END
\end{verbatim}

By default, the string \verb+grid_type+ is set to \verb+gausleg+, for the
Gauss-Legendre grid.  The Lebedev grid is specified with \verb+grid_type+
entered as \verb+lebedev+.  The default grid density for every atom or
center in the molecule is set to \verb+medium+ by default.  The user has the
option of defining the radial and angular grid density for a given atom 
or center of the molecule, within
the range from coarse to extra-fine.  This is done by specifying the string 
\verb+tag+ that identifies the atom or center in the basis set (see Section
\ref{sec:basis}), and entering \verb+coarse+, \verb+medium+, \verb+fine+,
or \verb+xfine+ for the strings \verb+radial_density+ and \verb+ang_density+.

% or Lebedev (routine supplied by M.~Caus\`a of the University of Torino):
%  \begin{verbatim}
%    lebedev
% \end{verbatim}
% \item Choices of grid density (default is {\tt medium}), range from 
% \begin{verbatim}
%    coarse
% \end{verbatim}
% to
% \begin{verbatim}
%    xfine
% \end{verbatim}

The effect of this input on the grid size for each atom or center is listed
in the following table.

% with the following definitions around each center:

  \begin{tabular}[right]{|l|r r r r|} \hline
Keyword & {\tt coarse} & {\tt medium} & {\tt fine} & {\tt xfine} \\ \hline
$N_{radial}$ & 30 & 40 & 60 & 90 \\
$N_{angular}$ & 6 & 8 & 10 & 10 \\  \hline
%$\Delta E/E$ $^a$  & & & &\\ 
%$\Delta \nabla E/|\nabla E|$$^a$  & & & &\\
%\multicolumn{5}{l}{$^a$ Based on calculations of 12-crown-6} \\
%\multicolumn{5}{l}{   with a 6-31g$*$ basis} \\
  \end{tabular}

\Large
***NOTE: I guessed at the proper form of the input for this feature, based
on the input conventions defined earlier.  Someone needs to check this,
and supply the correct names for the variables and keywords that I've made
up.***
\normalsize

% \item  Grid cutoff: for a given center (i.e.~atom) $A$, points that lie
% more than {\tt iRmax} bohr from center $A$ are neglected. (Default value: 40)

The user also has the option of specifying the grid cut-off for the
DFT calculation, using the keyword \verb+accQrad+.  The input line for
this option is as follows,

\begin{verbatim}
   accQrad <integer iRmax default 40>
\end{verbatim}
% \end{itemize}

The value entered for \verb+iRmax+ is the cutoff distance, in bohr, for grid
points around a given center or atom.  Grid points that lie more than 
\verb+iRmax+ bohr from the center or atom are neglected. 


\subsection{Control of Screening (Setting Tolerances) in the DFT Module}
\begin{verbatim}
  TOLERANCES [[tight] [tol_rho <real tol_rho default 1.0>] \
              [accAOfunc <integer accAOfunc default 20>] \
              [accCoul <integer accCoul default 15>] \
              [accQrad <integer accQrad default 40>] \
              [accXCfunc <integer accXCfunc default 20>] \
              [radius <real radius default 16.0>]]


\end{verbatim}


The user has the option of controlling screening for the tolerances in
the integral evaluations for the DFT module.  In most applications, the
default values will be adequate for the calculation, but different values
can be specified in the input for the DFT module using the keywords
described below.

The input to define a screening tolerance for evaluation of the AO 
Gaussian functions is specified with the keyword \verb+accAOfunc+, as
follows,

\begin{verbatim}
   accAOfunc <integer iAOacc default 20>
\end{verbatim}

A Gaussian orbital basis (AO) function with exponent $\zeta$
and radial factor $e^{-\zeta\cdot r_i^2}$ is 
evaluated  at a point $r_i$ only if 
$\zeta\cdot r_i^2$ is greater than the value specified for ${\tt iAOacc}$.

The input to define a screening tolerance for evaluation of the exchange-
correlation (XC) Gaussian fitting functions is specified with the
keyword \verb+accXCfunc+, as follows,
 
\begin{verbatim}
   accXCfunc <integer iXCacc default 20>
\end{verbatim}

An exchange-correlation (XC) fitting function with exponent $\zeta$
and radial factor $e^{-\zeta\cdot r_i^2}$ is 
evaluated  at a point $r_i$ only if 
$\zeta\cdot r_i^2$ is greater than the value specified for ${\tt iXCacc}$.

The input to define a screening tolerance for evaluation of the
charge-density (CD) Gaussian fitting functions is specified with the
keyword \verb+accCoul+, as follows,

\begin{verbatim}
   accCoul <integer itol2e default 15>
\end{verbatim}
% \end{itemize}

A  charge-density (CD) fitting function with exponent $\zeta$
and radial factor $e^{-\zeta\cdot r_i^2}$ is evaluated  at a 
point $r_i$ only if $\zeta\cdot r_i^2$ is greater than ${\tt itol2e}$
In addition, the input
parameter {\tt itol2e} is also used to define the tolerance  in Schwarz 
screening for the Coulomb integrals.  Only integrals with estimated
values greater than $10^{(-{\tt itol2e})}$ are evaluated.

% \begin{itemize}
% \item  A Gaussian orbital basis (AO) function with exponent $\zeta$
% and radial factor $e^{-\zeta\cdot r_i^2}$ is 
% evaluated  at a point $r_i$ only if 
% $\zeta\cdot r_i^2 > {\tt iAOacc}$ (default {\tt iAOacc} value: 20)
% \begin{verbatim}
%    accAOfunc <integer iAOacc>
% \end{verbatim}
% \item Similarly, a XC fitting function with exponent $\zeta$
% and radial factor $e^{-\zeta\cdot r_i^2}$ is 
% evaluated  at a point $r_i$ only if 
% $\zeta\cdot r_i^2 > {\tt iXCacc}$ (default {\tt iXCacc} value: 20)
% \begin{verbatim}
%    accXCfunc <integer iXCacc>
% \end{verbatim}
% \item As above, for the Coulomb fitting basis.  A  CD fitting function 
% with exponent $\zeta$
% and radial factor $e^{-\zeta\cdot r_i^2}$ is 
% evaluated  at a point $r_i$ only if 
% $\zeta\cdot r_i^2 > {\tt itol2e}$
% In addition, the same
% parameter {\tt itol2e} is used in Schwarz screening for the 
%  Coulomb integrals: only integrals with estimated
% values greater than $10^{(-{\tt itol2e})}$ are evaluated. (Default
% {\tt itol2e} value: 15):
% \begin{verbatim}
%    accCoul <integer itol2e>
% \end{verbatim}
% \end{itemize}

\subsection{Hardware Resource Control in the DFT Module}
\begin{verbatim}
  DIRECT
  INCORE
  NOIO
\end{verbatim}

The inverted charge-density and exchange-correlation matrices
for a DFT calculation are normally written to disk storage.  The user
can prevent this by specifying the keyword \verb+noio+ within the
input for the DFT directive.  The input to exercise this option is
as follows,

\begin{verbatim}
   noio
\end{verbatim}

\Large
**What are the consequences of exercising this option?  Are the matrices
needed for something later on?  Will they have to be recomputed at some
point?***
\normalsize


\subsection{Control of Open Shells in the DFT Module}
\begin{verbatim}
  DFT|ODFT
  MULT <integer mult default 1>
\end{verbatim}

Both {\sl closed-shell} and {\sl open-shell} systems can be studied using
the DFT module.  Specifying the keyword \verb+MULT+ within the \verb+DFT+
directive allows the user to define the spin multiplicity of the system.
The form of the input line is as follows;

\begin{verbatim}
   mult <integer mult default 1> 
\end{verbatim}

When the keyword \verb+MULT+ is specified, the user can define the integer
variable \verb+mult+, where \verb+mult+ is equal to the number of alpha 
electrons minus beta electrons, plus 1.

\subsection{Standard Property Control in the DFT Module}
\begin{verbatim}
  MULLIKEN
\end{verbatim}


Mulliken analysis of the charge distribution is invoked by the keyword:
\begin{verbatim}
   mulliken
\end{verbatim}

\Large
**What is this, and why would the user want to do it?  What is the default?**
\normalsize



\subsection{Print Control in the DFT Module}
\begin{verbatim}
  PRINT|NOPRINT
\end{verbatim}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
