C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_x_m08.F 
C> The nwxcm_x_m08 functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_x_m08 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_4} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_5} &=& {{4.557799872345596\,\rho_\alpha^{{{5}\over{3}}}}\over{\tau_\alpha}}\\\\ 
C>   {\it t_6} &=& {\it t_5}-1.0\\\\ 
C>   {\it t_7} &=& {\it t_6}^{11}\\\\ 
C>   {\it t_8} &=& {\it t_5}+1.0\\\\ 
C>   {\it t_9} &=& {{1}\over{{\it t_8}^{11}}}\\\\ 
C>   {\it t_{10}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{11}} &=& {\it t_6}^{10}\\\\ 
C>   {\it t_{12}} &=& {{1}\over{{\it t_8}^{10}}}\\\\ 
C>   {\it t_{13}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{14}} &=& {\it t_6}^9\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_8}^9}}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{17}} &=& {\it t_6}^8\\\\ 
C>   {\it t_{18}} &=& {{1}\over{{\it t_8}^8}}\\\\ 
C>   {\it t_{19}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{20}} &=& {\it t_6}^7\\\\ 
C>   {\it t_{21}} &=& {{1}\over{{\it t_8}^7}}\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{23}} &=& {\it t_6}^6\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_8}^6}}\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{26}} &=& {\it t_6}^5\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_8}^5}}\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{29}} &=& {\it t_6}^4\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_8}^4}}\\\\ 
C>   {\it t_{31}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{32}} &=& {\it t_6}^3\\\\ 
C>   {\it t_{33}} &=& {{1}\over{{\it t_8}^3}}\\\\ 
C>   {\it t_{34}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{35}} &=& {\it t_6}^2\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_8}^2}}\\\\ 
C>   {\it t_{37}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_8}}}\\\\ 
C>   {\it t_{39}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{51}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{52}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{53}} &=& {{4.557799872345596\,\rho_\beta^{{{5}\over{3}}}}\over{\tau_\beta}}\\\\ 
C>   {\it t_{54}} &=& {\it t_{53}}-1.0\\\\ 
C>   {\it t_{55}} &=& {\it t_{54}}^{11}\\\\ 
C>   {\it t_{56}} &=& {\it t_{53}}+1.0\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}^{11}}}\\\\ 
C>   {\it t_{58}} &=& {\it t_{54}}^{10}\\\\ 
C>   {\it t_{59}} &=& {{1}\over{{\it t_{56}}^{10}}}\\\\ 
C>   {\it t_{60}} &=& {\it t_{54}}^9\\\\ 
C>   {\it t_{61}} &=& {{1}\over{{\it t_{56}}^9}}\\\\ 
C>   {\it t_{62}} &=& {\it t_{54}}^8\\\\ 
C>   {\it t_{63}} &=& {{1}\over{{\it t_{56}}^8}}\\\\ 
C>   {\it t_{64}} &=& {\it t_{54}}^7\\\\ 
C>   {\it t_{65}} &=& {{1}\over{{\it t_{56}}^7}}\\\\ 
C>   {\it t_{66}} &=& {\it t_{54}}^6\\\\ 
C>   {\it t_{67}} &=& {{1}\over{{\it t_{56}}^6}}\\\\ 
C>   {\it t_{68}} &=& {\it t_{54}}^5\\\\ 
C>   {\it t_{69}} &=& {{1}\over{{\it t_{56}}^5}}\\\\ 
C>   {\it t_{70}} &=& {\it t_{54}}^4\\\\ 
C>   {\it t_{71}} &=& {{1}\over{{\it t_{56}}^4}}\\\\ 
C>   {\it t_{72}} &=& {\it t_{54}}^3\\\\ 
C>   {\it t_{73}} &=& {{1}\over{{\it t_{56}}^3}}\\\\ 
C>   {\it t_{74}} &=& {\it t_{54}}^2\\\\ 
C>   {\it t_{75}} &=& {{1}\over{{\it t_{56}}^2}}\\\\ 
C>   {\it t_{76}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{77}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {{4.557799872345596\,\rho_s^{{{5}\over{3}}}}\over{\tau_s}}\\\\ 
C>   {\it t_{80}} &=& {\it t_{79}}-1.0\\\\ 
C>   {\it t_{81}} &=& {\it t_{80}}^{11}\\\\ 
C>   {\it t_{82}} &=& {\it t_{79}}+1.0\\\\ 
C>   {\it t_{83}} &=& {{1}\over{{\it t_{82}}^{11}}}\\\\ 
C>   {\it t_{84}} &=& {\it t_{80}}^{10}\\\\ 
C>   {\it t_{85}} &=& {{1}\over{{\it t_{82}}^{10}}}\\\\ 
C>   {\it t_{86}} &=& {\it t_{80}}^9\\\\ 
C>   {\it t_{87}} &=& {{1}\over{{\it t_{82}}^9}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{80}}^8\\\\ 
C>   {\it t_{89}} &=& {{1}\over{{\it t_{82}}^8}}\\\\ 
C>   {\it t_{90}} &=& {\it t_{80}}^7\\\\ 
C>   {\it t_{91}} &=& {{1}\over{{\it t_{82}}^7}}\\\\ 
C>   {\it t_{92}} &=& {\it t_{80}}^6\\\\ 
C>   {\it t_{93}} &=& {{1}\over{{\it t_{82}}^6}}\\\\ 
C>   {\it t_{94}} &=& {\it t_{80}}^5\\\\ 
C>   {\it t_{95}} &=& {{1}\over{{\it t_{82}}^5}}\\\\ 
C>   {\it t_{96}} &=& {\it t_{80}}^4\\\\ 
C>   {\it t_{97}} &=& {{1}\over{{\it t_{82}}^4}}\\\\ 
C>   {\it t_{98}} &=& {\it t_{80}}^3\\\\ 
C>   {\it t_{99}} &=& {{1}\over{{\it t_{82}}^3}}\\\\ 
C>   {\it t_{100}} &=& {\it t_{80}}^2\\\\ 
C>   {\it t_{101}} &=& {{1}\over{{\it t_{82}}^2}}\\\\ 
C>   {\it t_{102}} &=& {{1}\over{{\it t_{82}}}}\\\\ 
C>   f &=& 1.0\,\left(-.9305257363491002\,{\it t_{51}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{52}}\,\sigma_{\beta\beta}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{49}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{48}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{47}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{46}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{45}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{44}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{43}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{42}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{41}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_{40}}\,{\it t_{55}}\,{\it t_{57}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{51}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{52}}\,\sigma_{\beta\beta}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{34}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{31}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{28}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{25}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{22}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{19}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{16}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{13}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{10}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_4}\,{\it t_{55}}\,{\it t_{57}}+{\it t_3}\right)\right)+1.0\,\left(-.9305257363491002\,{\it t_1}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_2}\,\sigma_{\alpha\alpha}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_6}\,{\it t_{38}}+{\it t_{49}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{48}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{47}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{46}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{45}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{44}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{43}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{42}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{41}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_{40}}\,{\it t_7}\,{\it t_9}+{\it t_{39}}\right)-.9305257363491002\,{\it t_1}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_6}\,{\it t_{38}}+{\it t_{34}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{31}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{28}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{25}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{22}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{19}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{16}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{13}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{10}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_4}\,{\it t_7}\,{\it t_9}+{\it t_3}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(-.9305257363491002\,{\it t_{77}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{78}}\,\sigma_{ss}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{49}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{48}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{47}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{46}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{45}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{44}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{43}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{42}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{41}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_{40}}\,{\it t_{81}}\,{\it t_{83}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{77}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{78}}\,\sigma_{ss}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{34}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{31}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{28}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{25}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{22}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{19}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{16}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{13}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{10}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_4}\,{\it t_{81}}\,{\it t_{83}}+{\it t_3}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] Y Zhao, DG Truhlar, J.Chem.TheoryComput. 4, 1849 (2008)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800246v "> 
C> 10.1021/ct800246v </a> 
C> 
      subroutine nwxcm_x_m08(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Cmat,Mmat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
            t1 = 1/rhoa**2.6666666666666666d+0
            t2 = 4.492667444378077d-3*gammaaa*t1+1.0d+0
            t3 = 8.04d-1*(1.0d+0-1.0d+0/t2)+1.0d+0
            t4 = rhoa**1.3333333333333333d+0
            t5 = param(12)
            t6 = rhoa**1.6666666666666669d+0
            t7 = 1/taua
            t8 = 4.557799872345596d+0*t6*t7
            t9 = t8-1.0d+0
            t10 = t9**11
            t11 = t8+1.0d+0
            t12 = 1/t11**11
            t13 = param(11)
            t14 = t9**10
            t15 = 1/t11**10
            t16 = param(10)
            t17 = t9**9
            t18 = 1/t11**9
            t19 = param(9)
            t20 = t9**8
            t21 = 1/t11**8
            t22 = param(8)
            t23 = t9**7
            t24 = 1/t11**7
            t25 = param(7)
            t26 = t9**6
            t27 = 1/t11**6
            t28 = param(6)
            t29 = t9**5
            t30 = 1/t11**5
            t31 = param(5)
            t32 = t9**4
            t33 = 1/t11**4
            t34 = param(4)
            t35 = t9**3
            t36 = 1/t11**3
            t37 = param(3)
            t38 = t9**2
            t39 = 1/t11**2
            t40 = param(2)
            t41 = 1/t11
            t42 = t40*t41*t9+t10*t12*t5+t37*t38*t39+t34*t35*t36+t31*t32*
     1         t33+t28*t29*t30+t25*t26*t27+t22*t23*t24+t19*t20*t21+t16*t
     2         17*t18+t13*t14*t15+param(1)
            t43 = exp(-3.6802889260199856d-3*gammaaa*t1)
            t44 = 5.52d-1*(1.0d+0-t43)+1.0d+0
            t45 = param(24)
            t46 = param(23)
            t47 = param(22)
            t48 = param(21)
            t49 = param(20)
            t50 = param(19)
            t51 = param(18)
            t52 = param(17)
            t53 = param(16)
            t54 = param(15)
            t55 = param(14)
            t56 = t41*t55*t9+t38*t39*t54+t35*t36*t53+t32*t33*t52+t29*t30
     1         *t51+t26*t27*t50+t23*t24*t49+t20*t21*t48+t17*t18*t47+t14*
     2         t15*t46+t10*t12*t45+param(13)
            t57 = 1/t2**2
            t58 = 1/rhoa**2.3333333333333334d+0
            t59 = rhoa**3.333333333333333d-1
            t60 = rhoa**6.666666666666666d-1
            t61 = 1/t11**12
            t62 = 1/t4
            t63 = 2.0d+0*(-3.361156316208638d-3*t42*t57*t62-1.8903811666
     1         99927d-3*t43*t56*t62)*wght
            t64 = 1/taua**2
            fnc(iq) = 2.0d+0*(-9.305257363491002d-1*t4*t44*t56-9.3052573
     1         63491002d-1*t3*t4*t42)*wght+fnc(iq)
            Amat(iq,D1_RA) = 2.0d+0*(-9.305257363491002d-1*t4*t44*(-7.59
     1         6333120575993d+0*t39*t55*t60*t7*t9+1.5192666241151986d+1*
     2         t39*t54*t60*t7*t9-8.355966432633593d+1*t10*t45*t60*t61*t7
     3         +7.596333120575993d+0*t41*t55*t60*t7-1.5192666241151986d+
     4         1*t36*t38*t54*t60*t7+2.2788999361727982d+1*t36*t38*t53*t6
     5         0*t7-2.2788999361727982d+1*t33*t35*t53*t60*t7+3.038533248
     6         230397d+1*t33*t35*t52*t60*t7-3.038533248230397d+1*t30*t32
     7         *t52*t60*t7+3.7981665602879966d+1*t30*t32*t51*t60*t7-3.79
     8         81665602879966d+1*t27*t29*t51*t60*t7+4.5577998723455965d+
     9         1*t27*t29*t50*t60*t7-4.5577998723455965d+1*t24*t26*t50*t6
     :         0*t7+5.317433184403195d+1*t24*t26*t49*t60*t7-5.3174331844
     ;         03195d+1*t21*t23*t49*t60*t7+6.077066496460795d+1*t21*t23*
     <         t48*t60*t7-6.077066496460795d+1*t18*t20*t48*t60*t7+6.8366
     =         99808518394d+1*t18*t20*t47*t60*t7-6.836699808518394d+1*t1
     >         5*t17*t47*t60*t7+7.596333120575993d+1*t15*t17*t46*t60*t7-
     ?         7.596333120575993d+1*t12*t14*t46*t60*t7+8.355966432633593
     @         d+1*t12*t14*t45*t60*t7)-9.305257363491002d-1*t3*t4*(-7.59
     1         6333120575993d+0*t39*t40*t60*t7*t9+1.5192666241151986d+1*
     2         t37*t39*t60*t7*t9-8.355966432633593d+1*t10*t5*t60*t61*t7+
     3         8.355966432633593d+1*t12*t14*t5*t60*t7+7.596333120575993d
     4         +0*t40*t41*t60*t7-1.5192666241151986d+1*t36*t37*t38*t60*t
     5         7+2.2788999361727982d+1*t34*t36*t38*t60*t7-2.278899936172
     6         7982d+1*t33*t34*t35*t60*t7+3.038533248230397d+1*t31*t33*t
     7         35*t60*t7-3.038533248230397d+1*t30*t31*t32*t60*t7+3.79816
     8         65602879966d+1*t28*t30*t32*t60*t7-3.7981665602879966d+1*t
     9         27*t28*t29*t60*t7+4.5577998723455965d+1*t25*t27*t29*t60*t
     :         7-4.5577998723455965d+1*t24*t25*t26*t60*t7+5.317433184403
     ;         195d+1*t22*t24*t26*t60*t7-5.317433184403195d+1*t21*t22*t2
     <         3*t60*t7+6.077066496460795d+1*t19*t21*t23*t60*t7-6.077066
     =         496460795d+1*t18*t19*t20*t60*t7+6.836699808518394d+1*t16*
     >         t18*t20*t60*t7-6.836699808518394d+1*t15*t16*t17*t60*t7+7.
     ?         596333120575993d+1*t13*t15*t17*t60*t7-7.596333120575993d+
     @         1*t12*t13*t14*t60*t7)-1.2407009817988002d+0*t44*t56*t59-1
     1         .2407009817988002d+0*t3*t42*t59+8.963083509889702d-3*gamm
     2         aaa*t42*t57*t58+5.041016444533138d-3*gammaaa*t43*t56*t58)
     3         *wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = t63+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t63+Cmat(iq,D1_GAB)
            Amat(iq,D1_TA) = 2.0d+0*(-9.305257363491002d-1*t4*t44*(4.557
     1         799872345596d+0*t39*t55*t6*t64*t9-9.115599744691192d+0*t3
     2         9*t54*t6*t64*t9+5.013579859580155d+1*t10*t45*t6*t61*t64-4
     3         .557799872345596d+0*t41*t55*t6*t64+9.115599744691192d+0*t
     4         36*t38*t54*t6*t64-1.3673399617036788d+1*t36*t38*t53*t6*t6
     5         4+1.3673399617036788d+1*t33*t35*t53*t6*t64-1.823119948938
     6         2383d+1*t33*t35*t52*t6*t64+1.8231199489382383d+1*t30*t32*
     7         t52*t6*t64-2.2788999361727982d+1*t30*t32*t51*t6*t64+2.278
     8         8999361727982d+1*t27*t29*t51*t6*t64-2.7346799234073577d+1
     9         *t27*t29*t50*t6*t64+2.7346799234073577d+1*t24*t26*t50*t6*
     :         t64-3.190459910641917d+1*t24*t26*t49*t6*t64+3.19045991064
     ;         1917d+1*t21*t23*t49*t6*t64-3.6462398978764765d+1*t21*t23*
     <         t48*t6*t64+3.6462398978764765d+1*t18*t20*t48*t6*t64-4.102
     =         019885111037d+1*t18*t20*t47*t6*t64+4.102019885111037d+1*t
     >         15*t17*t47*t6*t64-4.5577998723455965d+1*t15*t17*t46*t6*t6
     ?         4+4.5577998723455965d+1*t12*t14*t46*t6*t64-5.013579859580
     @         155d+1*t12*t14*t45*t6*t64)-9.305257363491002d-1*t3*t4*(4.
     1         557799872345596d+0*t39*t40*t6*t64*t9-9.115599744691192d+0
     2         *t37*t39*t6*t64*t9+5.013579859580155d+1*t10*t5*t6*t61*t64
     3         -5.013579859580155d+1*t12*t14*t5*t6*t64-4.557799872345596
     4         d+0*t40*t41*t6*t64+9.115599744691192d+0*t36*t37*t38*t6*t6
     5         4-1.3673399617036788d+1*t34*t36*t38*t6*t64+1.367339961703
     6         6788d+1*t33*t34*t35*t6*t64-1.8231199489382383d+1*t31*t33*
     7         t35*t6*t64+1.8231199489382383d+1*t30*t31*t32*t6*t64-2.278
     8         8999361727982d+1*t28*t30*t32*t6*t64+2.2788999361727982d+1
     9         *t27*t28*t29*t6*t64-2.7346799234073577d+1*t25*t27*t29*t6*
     :         t64+2.7346799234073577d+1*t24*t25*t26*t6*t64-3.1904599106
     ;         41917d+1*t22*t24*t26*t6*t64+3.190459910641917d+1*t21*t22*
     <         t23*t6*t64-3.6462398978764765d+1*t19*t21*t23*t6*t64+3.646
     =         2398978764765d+1*t18*t19*t20*t6*t64-4.102019885111037d+1*
     >         t16*t18*t20*t6*t64+4.102019885111037d+1*t15*t16*t17*t6*t6
     ?         4-4.5577998723455965d+1*t13*t15*t17*t6*t64+4.557799872345
     @         5965d+1*t12*t13*t14*t6*t64))*wght+Amat(iq,D1_TA)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = 1/rhoa**2.6666666666666666d+0
            t2 = 4.492667444378077d-3*gammaaa*t1+1.0d+0
            t3 = 8.04d-1*(1.0d+0-1.0d+0/t2)+1.0d+0
            t4 = rhoa**1.3333333333333333d+0
            t5 = param(1)
            t6 = param(12)
            t7 = rhoa**1.6666666666666669d+0
            t8 = 1/taua
            t9 = 4.557799872345596d+0*t7*t8
            t10 = t9-1.0d+0
            t11 = t10**11
            t12 = t9+1.0d+0
            t13 = 1/t12**11
            t14 = param(11)
            t15 = t10**10
            t16 = 1/t12**10
            t17 = param(10)
            t18 = t10**9
            t19 = 1/t12**9
            t20 = param(9)
            t21 = t10**8
            t22 = 1/t12**8
            t23 = param(8)
            t24 = t10**7
            t25 = 1/t12**7
            t26 = param(7)
            t27 = t10**6
            t28 = 1/t12**6
            t29 = param(6)
            t30 = t10**5
            t31 = 1/t12**5
            t32 = param(5)
            t33 = t10**4
            t34 = 1/t12**4
            t35 = param(4)
            t36 = t10**3
            t37 = 1/t12**3
            t38 = param(3)
            t39 = t10**2
            t40 = 1/t12**2
            t41 = param(2)
            t42 = 1/t12
            t43 = t11*t13*t6+t5+t10*t41*t42+t38*t39*t40+t35*t36*t37+t32*
     1         t33*t34+t29*t30*t31+t26*t27*t28+t23*t24*t25+t20*t21*t22+t
     2         17*t18*t19+t14*t15*t16
            t44 = exp(-3.6802889260199856d-3*gammaaa*t1)
            t45 = 5.52d-1*(1.0d+0-t44)+1.0d+0
            t46 = param(13)
            t47 = param(24)
            t48 = param(23)
            t49 = param(22)
            t50 = param(21)
            t51 = param(20)
            t52 = param(19)
            t53 = param(18)
            t54 = param(17)
            t55 = param(16)
            t56 = param(15)
            t57 = param(14)
            t58 = t10*t42*t57+t39*t40*t56+t36*t37*t55+t33*t34*t54+t30*t3
     1         1*t53+t27*t28*t52+t24*t25*t51+t21*t22*t50+t18*t19*t49+t15
     2         *t16*t48+t11*t13*t47+t46
            t59 = 1/rhob**2.6666666666666666d+0
            t60 = 4.492667444378077d-3*gammabb*t59+1.0d+0
            t61 = 8.04d-1*(1.0d+0-1.0d+0/t60)+1.0d+0
            t62 = rhob**1.3333333333333333d+0
            t63 = rhob**1.6666666666666669d+0
            t64 = 1/taub
            t65 = 4.557799872345596d+0*t63*t64
            t66 = t65-1.0d+0
            t67 = t66**11
            t68 = t65+1.0d+0
            t69 = 1/t68**11
            t70 = t66**10
            t71 = 1/t68**10
            t72 = t66**9
            t73 = 1/t68**9
            t74 = t66**8
            t75 = 1/t68**8
            t76 = t66**7
            t77 = 1/t68**7
            t78 = t66**6
            t79 = 1/t68**6
            t80 = t66**5
            t81 = 1/t68**5
            t82 = t66**4
            t83 = 1/t68**4
            t84 = t66**3
            t85 = 1/t68**3
            t86 = t66**2
            t87 = 1/t68**2
            t88 = 1/t68
            t89 = t41*t66*t88+t38*t86*t87+t35*t84*t85+t32*t82*t83+t29*t8
     1         0*t81+t26*t78*t79+t23*t76*t77+t20*t74*t75+t17*t72*t73+t14
     2         *t70*t71+t6*t67*t69+t5
            t90 = exp(-3.6802889260199856d-3*gammabb*t59)
            t91 = 5.52d-1*(1.0d+0-t90)+1.0d+0
            t92 = t57*t66*t88+t56*t86*t87+t55*t84*t85+t54*t82*t83+t53*t8
     1         0*t81+t52*t78*t79+t51*t76*t77+t50*t74*t75+t49*t72*t73+t48
     2         *t70*t71+t47*t67*t69+t46
            t93 = 1/t2**2
            t94 = 1/rhoa**2.3333333333333334d+0
            t95 = rhoa**3.333333333333333d-1
            t96 = rhoa**6.666666666666666d-1
            t97 = 1/t12**12
            t98 = 1/t60**2
            t99 = 1/rhob**2.3333333333333334d+0
            t100 = rhob**3.333333333333333d-1
            t101 = rhob**6.666666666666666d-1
            t102 = 1/t68**12
            t103 = 1/t4
            t104 = 1/t62
            t105 = 1/taua**2
            t106 = 1/taub**2
            fnc(iq) = (1.0d+0*(-9.305257363491002d-1*t62*t91*t92-9.30525
     1         7363491002d-1*t61*t62*t89)+1.0d+0*(-9.305257363491002d-1*
     2         t4*t45*t58-9.305257363491002d-1*t3*t4*t43))*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(-9.305257363491002d-1*t3*t4*(-8.355
     1         966432633593d+1*t11*t6*t8*t96*t97+8.355966432633593d+1*t1
     2         3*t15*t6*t8*t96+7.596333120575993d+0*t41*t42*t8*t96-7.596
     3         333120575993d+0*t10*t40*t41*t8*t96+1.5192666241151986d+1*
     4         t10*t38*t40*t8*t96-1.5192666241151986d+1*t37*t38*t39*t8*t
     5         96+2.2788999361727982d+1*t35*t37*t39*t8*t96-2.27889993617
     6         27982d+1*t34*t35*t36*t8*t96+3.038533248230397d+1*t32*t34*
     7         t36*t8*t96-3.038533248230397d+1*t31*t32*t33*t8*t96+3.7981
     8         665602879966d+1*t29*t31*t33*t8*t96-3.7981665602879966d+1*
     9         t28*t29*t30*t8*t96+4.5577998723455965d+1*t26*t28*t30*t8*t
     :         96-4.5577998723455965d+1*t25*t26*t27*t8*t96+5.31743318440
     ;         3195d+1*t23*t25*t27*t8*t96-5.317433184403195d+1*t22*t23*t
     <         24*t8*t96+6.077066496460795d+1*t20*t22*t24*t8*t96-6.07706
     =         6496460795d+1*t19*t20*t21*t8*t96+6.836699808518394d+1*t17
     >         *t19*t21*t8*t96-6.836699808518394d+1*t16*t17*t18*t8*t96+7
     ?         .596333120575993d+1*t14*t16*t18*t8*t96-7.596333120575993d
     @         +1*t13*t14*t15*t8*t96)-9.305257363491002d-1*t4*t45*(-8.35
     1         5966432633593d+1*t11*t47*t8*t96*t97+7.596333120575993d+0*
     2         t42*t57*t8*t96-7.596333120575993d+0*t10*t40*t57*t8*t96+1.
     3         5192666241151986d+1*t10*t40*t56*t8*t96-1.5192666241151986
     4         d+1*t37*t39*t56*t8*t96+2.2788999361727982d+1*t37*t39*t55*
     5         t8*t96-2.2788999361727982d+1*t34*t36*t55*t8*t96+3.0385332
     6         48230397d+1*t34*t36*t54*t8*t96-3.038533248230397d+1*t31*t
     7         33*t54*t8*t96+3.7981665602879966d+1*t31*t33*t53*t8*t96-3.
     8         7981665602879966d+1*t28*t30*t53*t8*t96+4.5577998723455965
     9         d+1*t28*t30*t52*t8*t96-4.5577998723455965d+1*t25*t27*t52*
     :         t8*t96+5.317433184403195d+1*t25*t27*t51*t8*t96-5.31743318
     ;         4403195d+1*t22*t24*t51*t8*t96+6.077066496460795d+1*t22*t2
     <         4*t50*t8*t96-6.077066496460795d+1*t19*t21*t50*t8*t96+6.83
     =         6699808518394d+1*t19*t21*t49*t8*t96-6.836699808518394d+1*
     >         t16*t18*t49*t8*t96+7.596333120575993d+1*t16*t18*t48*t8*t9
     ?         6-7.596333120575993d+1*t13*t15*t48*t8*t96+8.3559664326335
     @         93d+1*t13*t15*t47*t8*t96)-1.2407009817988002d+0*t45*t58*t
     1         95-1.2407009817988002d+0*t3*t43*t95+8.963083509889702d-3*
     2         gammaaa*t43*t93*t94+5.041016444533138d-3*gammaaa*t44*t58*
     3         t94)*wght+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = 1.0d+0*(8.963083509889702d-3*gammabb*t89*t9
     1         8*t99+5.041016444533138d-3*gammabb*t90*t92*t99-1.24070098
     2         17988002d+0*t100*t91*t92-9.305257363491002d-1*t62*(7.5963
     3         33120575993d+0*t101*t57*t64*t88-7.596333120575993d+0*t101
     4         *t57*t64*t66*t87+1.5192666241151986d+1*t101*t56*t64*t66*t
     5         87-1.5192666241151986d+1*t101*t56*t64*t85*t86+2.278899936
     6         1727982d+1*t101*t55*t64*t85*t86-2.2788999361727982d+1*t10
     7         1*t55*t64*t83*t84+3.038533248230397d+1*t101*t54*t64*t83*t
     8         84-3.038533248230397d+1*t101*t54*t64*t81*t82+3.7981665602
     9         879966d+1*t101*t53*t64*t81*t82-3.7981665602879966d+1*t101
     :         *t53*t64*t79*t80+4.5577998723455965d+1*t101*t52*t64*t79*t
     ;         80-4.5577998723455965d+1*t101*t52*t64*t77*t78+5.317433184
     <         403195d+1*t101*t51*t64*t77*t78-5.317433184403195d+1*t101*
     =         t51*t64*t75*t76+6.077066496460795d+1*t101*t50*t64*t75*t76
     >         -6.077066496460795d+1*t101*t50*t64*t73*t74+6.836699808518
     ?         394d+1*t101*t49*t64*t73*t74-6.836699808518394d+1*t101*t49
     @         *t64*t71*t72+7.596333120575993d+1*t101*t48*t64*t71*t72-7.
     1         596333120575993d+1*t101*t48*t64*t69*t70+8.355966432633593
     2         d+1*t101*t47*t64*t69*t70-8.355966432633593d+1*t101*t102*t
     3         47*t64*t67)*t91-1.2407009817988002d+0*t100*t61*t89-9.3052
     4         57363491002d-1*t61*t62*(7.596333120575993d+0*t101*t41*t64
     5         *t88-7.596333120575993d+0*t101*t41*t64*t66*t87+1.51926662
     6         41151986d+1*t101*t38*t64*t66*t87-1.5192666241151986d+1*t1
     7         01*t38*t64*t85*t86+2.2788999361727982d+1*t101*t35*t64*t85
     8         *t86-2.2788999361727982d+1*t101*t35*t64*t83*t84+3.0385332
     9         48230397d+1*t101*t32*t64*t83*t84-3.038533248230397d+1*t10
     :         1*t32*t64*t81*t82+3.7981665602879966d+1*t101*t29*t64*t81*
     ;         t82-3.7981665602879966d+1*t101*t29*t64*t79*t80+4.55779987
     <         23455965d+1*t101*t26*t64*t79*t80-4.5577998723455965d+1*t1
     =         01*t26*t64*t77*t78+5.317433184403195d+1*t101*t23*t64*t77*
     >         t78-5.317433184403195d+1*t101*t23*t64*t75*t76+6.077066496
     ?         460795d+1*t101*t20*t64*t75*t76-6.077066496460795d+1*t101*
     @         t20*t64*t73*t74+6.836699808518394d+1*t101*t17*t64*t73*t74
     1         -6.836699808518394d+1*t101*t17*t64*t71*t72+7.596333120575
     2         993d+1*t101*t14*t64*t71*t72+8.355966432633593d+1*t101*t6*
     3         t64*t69*t70-7.596333120575993d+1*t101*t14*t64*t69*t70-8.3
     4         55966432633593d+1*t101*t102*t6*t64*t67))*wght+Amat(iq,D1_
     5         RB)
            Cmat(iq,D1_GAA) = 1.0d+0*(-3.361156316208638d-3*t103*t43*t93
     1         -1.890381166699927d-3*t103*t44*t58)*wght+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = 1.0d+0*(-3.361156316208638d-3*t104*t89*t98
     1         -1.890381166699927d-3*t104*t90*t92)*wght+Cmat(iq,D1_GBB)
            Mmat(iq,D1_TA) = 1.0d+0*(-9.305257363491002d-1*t3*t4*(5.0135
     1         79859580155d+1*t105*t11*t6*t7*t97-5.013579859580155d+1*t1
     2         05*t13*t15*t6*t7-4.557799872345596d+0*t105*t41*t42*t7+4.5
     3         57799872345596d+0*t10*t105*t40*t41*t7-9.115599744691192d+
     4         0*t10*t105*t38*t40*t7+9.115599744691192d+0*t105*t37*t38*t
     5         39*t7-1.3673399617036788d+1*t105*t35*t37*t39*t7+1.3673399
     6         617036788d+1*t105*t34*t35*t36*t7-1.8231199489382383d+1*t1
     7         05*t32*t34*t36*t7+1.8231199489382383d+1*t105*t31*t32*t33*
     8         t7-2.2788999361727982d+1*t105*t29*t31*t33*t7+2.2788999361
     9         727982d+1*t105*t28*t29*t30*t7-2.7346799234073577d+1*t105*
     :         t26*t28*t30*t7+2.7346799234073577d+1*t105*t25*t26*t27*t7-
     ;         3.190459910641917d+1*t105*t23*t25*t27*t7+3.19045991064191
     <         7d+1*t105*t22*t23*t24*t7-3.6462398978764765d+1*t105*t20*t
     =         22*t24*t7+3.6462398978764765d+1*t105*t19*t20*t21*t7-4.102
     >         019885111037d+1*t105*t17*t19*t21*t7+4.102019885111037d+1*
     ?         t105*t16*t17*t18*t7-4.5577998723455965d+1*t105*t14*t16*t1
     @         8*t7+4.5577998723455965d+1*t105*t13*t14*t15*t7)-9.3052573
     1         63491002d-1*t4*t45*(5.013579859580155d+1*t105*t11*t47*t7*
     2         t97-4.557799872345596d+0*t105*t42*t57*t7+4.55779987234559
     3         6d+0*t10*t105*t40*t57*t7-9.115599744691192d+0*t10*t105*t4
     4         0*t56*t7+9.115599744691192d+0*t105*t37*t39*t56*t7-1.36733
     5         99617036788d+1*t105*t37*t39*t55*t7+1.3673399617036788d+1*
     6         t105*t34*t36*t55*t7-1.8231199489382383d+1*t105*t34*t36*t5
     7         4*t7+1.8231199489382383d+1*t105*t31*t33*t54*t7-2.27889993
     8         61727982d+1*t105*t31*t33*t53*t7+2.2788999361727982d+1*t10
     9         5*t28*t30*t53*t7-2.7346799234073577d+1*t105*t28*t30*t52*t
     :         7+2.7346799234073577d+1*t105*t25*t27*t52*t7-3.19045991064
     ;         1917d+1*t105*t25*t27*t51*t7+3.190459910641917d+1*t105*t22
     <         *t24*t51*t7-3.6462398978764765d+1*t105*t22*t24*t50*t7+3.6
     =         462398978764765d+1*t105*t19*t21*t50*t7-4.102019885111037d
     >         +1*t105*t19*t21*t49*t7+4.102019885111037d+1*t105*t16*t18*
     ?         t49*t7-4.5577998723455965d+1*t105*t16*t18*t48*t7+4.557799
     @         8723455965d+1*t105*t13*t15*t48*t7-5.013579859580155d+1*t1
     1         05*t13*t15*t47*t7))*wght+Mmat(iq,D1_TA)
            Mmat(iq,D1_TB) = 1.0d+0*(-9.305257363491002d-1*t62*(-4.55779
     1         9872345596d+0*t106*t57*t63*t88+4.557799872345596d+0*t106*
     2         t57*t63*t66*t87-9.115599744691192d+0*t106*t56*t63*t66*t87
     3         +9.115599744691192d+0*t106*t56*t63*t85*t86-1.367339961703
     4         6788d+1*t106*t55*t63*t85*t86+1.3673399617036788d+1*t106*t
     5         55*t63*t83*t84-1.8231199489382383d+1*t106*t54*t63*t83*t84
     6         +1.8231199489382383d+1*t106*t54*t63*t81*t82-2.27889993617
     7         27982d+1*t106*t53*t63*t81*t82+2.2788999361727982d+1*t106*
     8         t53*t63*t79*t80-2.7346799234073577d+1*t106*t52*t63*t79*t8
     9         0+2.7346799234073577d+1*t106*t52*t63*t77*t78-3.1904599106
     :         41917d+1*t106*t51*t63*t77*t78+3.190459910641917d+1*t106*t
     ;         51*t63*t75*t76-3.6462398978764765d+1*t106*t50*t63*t75*t76
     <         +3.6462398978764765d+1*t106*t50*t63*t73*t74-4.10201988511
     =         1037d+1*t106*t49*t63*t73*t74+4.102019885111037d+1*t106*t4
     >         9*t63*t71*t72-4.5577998723455965d+1*t106*t48*t63*t71*t72+
     ?         4.5577998723455965d+1*t106*t48*t63*t69*t70-5.013579859580
     @         155d+1*t106*t47*t63*t69*t70+5.013579859580155d+1*t102*t10
     1         6*t47*t63*t67)*t91-9.305257363491002d-1*t61*t62*(-4.55779
     2         9872345596d+0*t106*t41*t63*t88+4.557799872345596d+0*t106*
     3         t41*t63*t66*t87-9.115599744691192d+0*t106*t38*t63*t66*t87
     4         +9.115599744691192d+0*t106*t38*t63*t85*t86-1.367339961703
     5         6788d+1*t106*t35*t63*t85*t86+1.3673399617036788d+1*t106*t
     6         35*t63*t83*t84-1.8231199489382383d+1*t106*t32*t63*t83*t84
     7         +1.8231199489382383d+1*t106*t32*t63*t81*t82-2.27889993617
     8         27982d+1*t106*t29*t63*t81*t82+2.2788999361727982d+1*t106*
     9         t29*t63*t79*t80-2.7346799234073577d+1*t106*t26*t63*t79*t8
     :         0+2.7346799234073577d+1*t106*t26*t63*t77*t78-3.1904599106
     ;         41917d+1*t106*t23*t63*t77*t78+3.190459910641917d+1*t106*t
     <         23*t63*t75*t76-3.6462398978764765d+1*t106*t20*t63*t75*t76
     =         +3.6462398978764765d+1*t106*t20*t63*t73*t74-4.10201988511
     >         1037d+1*t106*t17*t63*t73*t74+4.102019885111037d+1*t106*t1
     ?         7*t63*t71*t72-4.5577998723455965d+1*t106*t14*t63*t71*t72-
     @         5.013579859580155d+1*t106*t6*t63*t69*t70+4.55779987234559
     1         65d+1*t106*t14*t63*t69*t70+5.013579859580155d+1*t102*t106
     2         *t6*t63*t67))*wght+Mmat(iq,D1_TB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = 1/rhoa**2.6666666666666666d+0
            t2 = 4.492667444378077d-3*gammaaa*t1+1.0d+0
            t3 = 8.04d-1*(1.0d+0-1.0d+0/t2)+1.0d+0
            t4 = rhoa**1.3333333333333333d+0
            t5 = param(12)
            t6 = rhoa**1.6666666666666669d+0
            t7 = 1/taua
            t8 = 4.557799872345596d+0*t6*t7
            t9 = t8-1.0d+0
            t10 = t9**11
            t11 = t8+1.0d+0
            t12 = 1/t11**11
            t13 = param(11)
            t14 = t9**10
            t15 = 1/t11**10
            t16 = param(10)
            t17 = t9**9
            t18 = 1/t11**9
            t19 = param(9)
            t20 = t9**8
            t21 = 1/t11**8
            t22 = param(8)
            t23 = t9**7
            t24 = 1/t11**7
            t25 = param(7)
            t26 = t9**6
            t27 = 1/t11**6
            t28 = param(6)
            t29 = t9**5
            t30 = 1/t11**5
            t31 = param(5)
            t32 = t9**4
            t33 = 1/t11**4
            t34 = param(4)
            t35 = t9**3
            t36 = 1/t11**3
            t37 = param(3)
            t38 = t9**2
            t39 = 1/t11**2
            t40 = param(2)
            t41 = 1/t11
            t42 = t40*t41*t9+t10*t12*t5+t37*t38*t39+t34*t35*t36+t31*t32*
     1         t33+t28*t29*t30+t25*t26*t27+t22*t23*t24+t19*t20*t21+t16*t
     2         17*t18+t13*t14*t15+param(1)
            t43 = exp(-3.6802889260199856d-3*gammaaa*t1)
            t44 = 5.52d-1*(1.0d+0-t43)+1.0d+0
            t45 = param(24)
            t46 = param(23)
            t47 = param(22)
            t48 = param(21)
            t49 = param(20)
            t50 = param(19)
            t51 = param(18)
            t52 = param(17)
            t53 = param(16)
            t54 = param(15)
            t55 = param(14)
            t56 = t41*t55*t9+t38*t39*t54+t35*t36*t53+t32*t33*t52+t29*t30
     1         *t51+t26*t27*t50+t23*t24*t49+t20*t21*t48+t17*t18*t47+t14*
     2         t15*t46+t10*t12*t45+param(13)
            t57 = 1/t2**2
            t58 = 1/rhoa**2.3333333333333334d+0
            t59 = rhoa**3.333333333333333d-1
            t60 = rhoa**6.666666666666666d-1
            t61 = 1/t11**12
            t62 = 1/t4
            t63 = 1/taua**2
            fnc(iq) = 1.0d+0*(-9.305257363491002d-1*t4*t44*t56-9.3052573
     1         63491002d-1*t3*t4*t42)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(-9.305257363491002d-1*t4*t44*(-7.59
     1         6333120575993d+0*t39*t55*t60*t7*t9+1.5192666241151986d+1*
     2         t39*t54*t60*t7*t9-8.355966432633593d+1*t10*t45*t60*t61*t7
     3         +7.596333120575993d+0*t41*t55*t60*t7-1.5192666241151986d+
     4         1*t36*t38*t54*t60*t7+2.2788999361727982d+1*t36*t38*t53*t6
     5         0*t7-2.2788999361727982d+1*t33*t35*t53*t60*t7+3.038533248
     6         230397d+1*t33*t35*t52*t60*t7-3.038533248230397d+1*t30*t32
     7         *t52*t60*t7+3.7981665602879966d+1*t30*t32*t51*t60*t7-3.79
     8         81665602879966d+1*t27*t29*t51*t60*t7+4.5577998723455965d+
     9         1*t27*t29*t50*t60*t7-4.5577998723455965d+1*t24*t26*t50*t6
     :         0*t7+5.317433184403195d+1*t24*t26*t49*t60*t7-5.3174331844
     ;         03195d+1*t21*t23*t49*t60*t7+6.077066496460795d+1*t21*t23*
     <         t48*t60*t7-6.077066496460795d+1*t18*t20*t48*t60*t7+6.8366
     =         99808518394d+1*t18*t20*t47*t60*t7-6.836699808518394d+1*t1
     >         5*t17*t47*t60*t7+7.596333120575993d+1*t15*t17*t46*t60*t7-
     ?         7.596333120575993d+1*t12*t14*t46*t60*t7+8.355966432633593
     @         d+1*t12*t14*t45*t60*t7)-9.305257363491002d-1*t3*t4*(-7.59
     1         6333120575993d+0*t39*t40*t60*t7*t9+1.5192666241151986d+1*
     2         t37*t39*t60*t7*t9-8.355966432633593d+1*t10*t5*t60*t61*t7+
     3         8.355966432633593d+1*t12*t14*t5*t60*t7+7.596333120575993d
     4         +0*t40*t41*t60*t7-1.5192666241151986d+1*t36*t37*t38*t60*t
     5         7+2.2788999361727982d+1*t34*t36*t38*t60*t7-2.278899936172
     6         7982d+1*t33*t34*t35*t60*t7+3.038533248230397d+1*t31*t33*t
     7         35*t60*t7-3.038533248230397d+1*t30*t31*t32*t60*t7+3.79816
     8         65602879966d+1*t28*t30*t32*t60*t7-3.7981665602879966d+1*t
     9         27*t28*t29*t60*t7+4.5577998723455965d+1*t25*t27*t29*t60*t
     :         7-4.5577998723455965d+1*t24*t25*t26*t60*t7+5.317433184403
     ;         195d+1*t22*t24*t26*t60*t7-5.317433184403195d+1*t21*t22*t2
     <         3*t60*t7+6.077066496460795d+1*t19*t21*t23*t60*t7-6.077066
     =         496460795d+1*t18*t19*t20*t60*t7+6.836699808518394d+1*t16*
     >         t18*t20*t60*t7-6.836699808518394d+1*t15*t16*t17*t60*t7+7.
     ?         596333120575993d+1*t13*t15*t17*t60*t7-7.596333120575993d+
     @         1*t12*t13*t14*t60*t7)-1.2407009817988002d+0*t44*t56*t59-1
     1         .2407009817988002d+0*t3*t42*t59+8.963083509889702d-3*gamm
     2         aaa*t42*t57*t58+5.041016444533138d-3*gammaaa*t43*t56*t58)
     3         *wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 1.0d+0*(-3.361156316208638d-3*t42*t57*t62-
     1         1.890381166699927d-3*t43*t56*t62)*wght+Cmat(iq,D1_GAA)
            Mmat(iq,D1_TA) = 1.0d+0*(-9.305257363491002d-1*t4*t44*(4.557
     1         799872345596d+0*t39*t55*t6*t63*t9-9.115599744691192d+0*t3
     2         9*t54*t6*t63*t9+5.013579859580155d+1*t10*t45*t6*t61*t63-4
     3         .557799872345596d+0*t41*t55*t6*t63+9.115599744691192d+0*t
     4         36*t38*t54*t6*t63-1.3673399617036788d+1*t36*t38*t53*t6*t6
     5         3+1.3673399617036788d+1*t33*t35*t53*t6*t63-1.823119948938
     6         2383d+1*t33*t35*t52*t6*t63+1.8231199489382383d+1*t30*t32*
     7         t52*t6*t63-2.2788999361727982d+1*t30*t32*t51*t6*t63+2.278
     8         8999361727982d+1*t27*t29*t51*t6*t63-2.7346799234073577d+1
     9         *t27*t29*t50*t6*t63+2.7346799234073577d+1*t24*t26*t50*t6*
     :         t63-3.190459910641917d+1*t24*t26*t49*t6*t63+3.19045991064
     ;         1917d+1*t21*t23*t49*t6*t63-3.6462398978764765d+1*t21*t23*
     <         t48*t6*t63+3.6462398978764765d+1*t18*t20*t48*t6*t63-4.102
     =         019885111037d+1*t18*t20*t47*t6*t63+4.102019885111037d+1*t
     >         15*t17*t47*t6*t63-4.5577998723455965d+1*t15*t17*t46*t6*t6
     ?         3+4.5577998723455965d+1*t12*t14*t46*t6*t63-5.013579859580
     @         155d+1*t12*t14*t45*t6*t63)-9.305257363491002d-1*t3*t4*(4.
     1         557799872345596d+0*t39*t40*t6*t63*t9-9.115599744691192d+0
     2         *t37*t39*t6*t63*t9+5.013579859580155d+1*t10*t5*t6*t61*t63
     3         -5.013579859580155d+1*t12*t14*t5*t6*t63-4.557799872345596
     4         d+0*t40*t41*t6*t63+9.115599744691192d+0*t36*t37*t38*t6*t6
     5         3-1.3673399617036788d+1*t34*t36*t38*t6*t63+1.367339961703
     6         6788d+1*t33*t34*t35*t6*t63-1.8231199489382383d+1*t31*t33*
     7         t35*t6*t63+1.8231199489382383d+1*t30*t31*t32*t6*t63-2.278
     8         8999361727982d+1*t28*t30*t32*t6*t63+2.2788999361727982d+1
     9         *t27*t28*t29*t6*t63-2.7346799234073577d+1*t25*t27*t29*t6*
     :         t63+2.7346799234073577d+1*t24*t25*t26*t6*t63-3.1904599106
     ;         41917d+1*t22*t24*t26*t6*t63+3.190459910641917d+1*t21*t22*
     <         t23*t6*t63-3.6462398978764765d+1*t19*t21*t23*t6*t63+3.646
     =         2398978764765d+1*t18*t19*t20*t6*t63-4.102019885111037d+1*
     >         t16*t18*t20*t6*t63+4.102019885111037d+1*t15*t16*t17*t6*t6
     ?         3-4.5577998723455965d+1*t13*t15*t17*t6*t63+4.557799872345
     @         5965d+1*t12*t13*t14*t6*t63))*wght+Mmat(iq,D1_TA)
            Mmat(iq,D1_TB) = Mmat(iq,D1_TB)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = 1/rhob**2.6666666666666666d+0
            t2 = 4.492667444378077d-3*gammabb*t1+1.0d+0
            t3 = 8.04d-1*(1.0d+0-1.0d+0/t2)+1.0d+0
            t4 = rhob**1.3333333333333333d+0
            t5 = param(12)
            t6 = rhob**1.6666666666666669d+0
            t7 = 1/taub
            t8 = 4.557799872345596d+0*t6*t7
            t9 = t8-1.0d+0
            t10 = t9**11
            t11 = t8+1.0d+0
            t12 = 1/t11**11
            t13 = param(11)
            t14 = t9**10
            t15 = 1/t11**10
            t16 = param(10)
            t17 = t9**9
            t18 = 1/t11**9
            t19 = param(9)
            t20 = t9**8
            t21 = 1/t11**8
            t22 = param(8)
            t23 = t9**7
            t24 = 1/t11**7
            t25 = param(7)
            t26 = t9**6
            t27 = 1/t11**6
            t28 = param(6)
            t29 = t9**5
            t30 = 1/t11**5
            t31 = param(5)
            t32 = t9**4
            t33 = 1/t11**4
            t34 = param(4)
            t35 = t9**3
            t36 = 1/t11**3
            t37 = param(3)
            t38 = t9**2
            t39 = 1/t11**2
            t40 = param(2)
            t41 = 1/t11
            t42 = t40*t41*t9+t10*t12*t5+t37*t38*t39+t34*t35*t36+t31*t32*
     1         t33+t28*t29*t30+t25*t26*t27+t22*t23*t24+t19*t20*t21+t16*t
     2         17*t18+t13*t14*t15+param(1)
            t43 = exp(-3.6802889260199856d-3*gammabb*t1)
            t44 = 5.52d-1*(1.0d+0-t43)+1.0d+0
            t45 = param(24)
            t46 = param(23)
            t47 = param(22)
            t48 = param(21)
            t49 = param(20)
            t50 = param(19)
            t51 = param(18)
            t52 = param(17)
            t53 = param(16)
            t54 = param(15)
            t55 = param(14)
            t56 = t41*t55*t9+t38*t39*t54+t35*t36*t53+t32*t33*t52+t29*t30
     1         *t51+t26*t27*t50+t23*t24*t49+t20*t21*t48+t17*t18*t47+t14*
     2         t15*t46+t10*t12*t45+param(13)
            t57 = 1/t2**2
            t58 = 1/rhob**2.3333333333333334d+0
            t59 = rhob**3.333333333333333d-1
            t60 = rhob**6.666666666666666d-1
            t61 = 1/t11**12
            t62 = 1/t4
            t63 = 1/taub**2
            fnc(iq) = 1.0d+0*(-9.305257363491002d-1*t4*t44*t56-9.3052573
     1         63491002d-1*t3*t4*t42)*wght+fnc(iq)
            Amat(iq,D1_RB) = 1.0d+0*(-9.305257363491002d-1*t4*t44*(-7.59
     1         6333120575993d+0*t39*t55*t60*t7*t9+1.5192666241151986d+1*
     2         t39*t54*t60*t7*t9-8.355966432633593d+1*t10*t45*t60*t61*t7
     3         +7.596333120575993d+0*t41*t55*t60*t7-1.5192666241151986d+
     4         1*t36*t38*t54*t60*t7+2.2788999361727982d+1*t36*t38*t53*t6
     5         0*t7-2.2788999361727982d+1*t33*t35*t53*t60*t7+3.038533248
     6         230397d+1*t33*t35*t52*t60*t7-3.038533248230397d+1*t30*t32
     7         *t52*t60*t7+3.7981665602879966d+1*t30*t32*t51*t60*t7-3.79
     8         81665602879966d+1*t27*t29*t51*t60*t7+4.5577998723455965d+
     9         1*t27*t29*t50*t60*t7-4.5577998723455965d+1*t24*t26*t50*t6
     :         0*t7+5.317433184403195d+1*t24*t26*t49*t60*t7-5.3174331844
     ;         03195d+1*t21*t23*t49*t60*t7+6.077066496460795d+1*t21*t23*
     <         t48*t60*t7-6.077066496460795d+1*t18*t20*t48*t60*t7+6.8366
     =         99808518394d+1*t18*t20*t47*t60*t7-6.836699808518394d+1*t1
     >         5*t17*t47*t60*t7+7.596333120575993d+1*t15*t17*t46*t60*t7-
     ?         7.596333120575993d+1*t12*t14*t46*t60*t7+8.355966432633593
     @         d+1*t12*t14*t45*t60*t7)-9.305257363491002d-1*t3*t4*(-7.59
     1         6333120575993d+0*t39*t40*t60*t7*t9+1.5192666241151986d+1*
     2         t37*t39*t60*t7*t9-8.355966432633593d+1*t10*t5*t60*t61*t7+
     3         8.355966432633593d+1*t12*t14*t5*t60*t7+7.596333120575993d
     4         +0*t40*t41*t60*t7-1.5192666241151986d+1*t36*t37*t38*t60*t
     5         7+2.2788999361727982d+1*t34*t36*t38*t60*t7-2.278899936172
     6         7982d+1*t33*t34*t35*t60*t7+3.038533248230397d+1*t31*t33*t
     7         35*t60*t7-3.038533248230397d+1*t30*t31*t32*t60*t7+3.79816
     8         65602879966d+1*t28*t30*t32*t60*t7-3.7981665602879966d+1*t
     9         27*t28*t29*t60*t7+4.5577998723455965d+1*t25*t27*t29*t60*t
     :         7-4.5577998723455965d+1*t24*t25*t26*t60*t7+5.317433184403
     ;         195d+1*t22*t24*t26*t60*t7-5.317433184403195d+1*t21*t22*t2
     <         3*t60*t7+6.077066496460795d+1*t19*t21*t23*t60*t7-6.077066
     =         496460795d+1*t18*t19*t20*t60*t7+6.836699808518394d+1*t16*
     >         t18*t20*t60*t7-6.836699808518394d+1*t15*t16*t17*t60*t7+7.
     ?         596333120575993d+1*t13*t15*t17*t60*t7-7.596333120575993d+
     @         1*t12*t13*t14*t60*t7)-1.2407009817988002d+0*t44*t56*t59-1
     1         .2407009817988002d+0*t3*t42*t59+8.963083509889702d-3*gamm
     2         abb*t42*t57*t58+5.041016444533138d-3*gammabb*t43*t56*t58)
     3         *wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GBB) = 1.0d+0*(-3.361156316208638d-3*t42*t57*t62-
     1         1.890381166699927d-3*t43*t56*t62)*wght+Cmat(iq,D1_GBB)
            Mmat(iq,D1_TB) = 1.0d+0*(-9.305257363491002d-1*t4*t44*(4.557
     1         799872345596d+0*t39*t55*t6*t63*t9-9.115599744691192d+0*t3
     2         9*t54*t6*t63*t9+5.013579859580155d+1*t10*t45*t6*t61*t63-4
     3         .557799872345596d+0*t41*t55*t6*t63+9.115599744691192d+0*t
     4         36*t38*t54*t6*t63-1.3673399617036788d+1*t36*t38*t53*t6*t6
     5         3+1.3673399617036788d+1*t33*t35*t53*t6*t63-1.823119948938
     6         2383d+1*t33*t35*t52*t6*t63+1.8231199489382383d+1*t30*t32*
     7         t52*t6*t63-2.2788999361727982d+1*t30*t32*t51*t6*t63+2.278
     8         8999361727982d+1*t27*t29*t51*t6*t63-2.7346799234073577d+1
     9         *t27*t29*t50*t6*t63+2.7346799234073577d+1*t24*t26*t50*t6*
     :         t63-3.190459910641917d+1*t24*t26*t49*t6*t63+3.19045991064
     ;         1917d+1*t21*t23*t49*t6*t63-3.6462398978764765d+1*t21*t23*
     <         t48*t6*t63+3.6462398978764765d+1*t18*t20*t48*t6*t63-4.102
     =         019885111037d+1*t18*t20*t47*t6*t63+4.102019885111037d+1*t
     >         15*t17*t47*t6*t63-4.5577998723455965d+1*t15*t17*t46*t6*t6
     ?         3+4.5577998723455965d+1*t12*t14*t46*t6*t63-5.013579859580
     @         155d+1*t12*t14*t45*t6*t63)-9.305257363491002d-1*t3*t4*(4.
     1         557799872345596d+0*t39*t40*t6*t63*t9-9.115599744691192d+0
     2         *t37*t39*t6*t63*t9+5.013579859580155d+1*t10*t5*t6*t61*t63
     3         -5.013579859580155d+1*t12*t14*t5*t6*t63-4.557799872345596
     4         d+0*t40*t41*t6*t63+9.115599744691192d+0*t36*t37*t38*t6*t6
     5         3-1.3673399617036788d+1*t34*t36*t38*t6*t63+1.367339961703
     6         6788d+1*t33*t34*t35*t6*t63-1.8231199489382383d+1*t31*t33*
     7         t35*t6*t63+1.8231199489382383d+1*t30*t31*t32*t6*t63-2.278
     8         8999361727982d+1*t28*t30*t32*t6*t63+2.2788999361727982d+1
     9         *t27*t28*t29*t6*t63-2.7346799234073577d+1*t25*t27*t29*t6*
     :         t63+2.7346799234073577d+1*t24*t25*t26*t6*t63-3.1904599106
     ;         41917d+1*t22*t24*t26*t6*t63+3.190459910641917d+1*t21*t22*
     <         t23*t6*t63-3.6462398978764765d+1*t19*t21*t23*t6*t63+3.646
     =         2398978764765d+1*t18*t19*t20*t6*t63-4.102019885111037d+1*
     >         t16*t18*t20*t6*t63+4.102019885111037d+1*t15*t16*t17*t6*t6
     ?         3-4.5577998723455965d+1*t13*t15*t17*t6*t63+4.557799872345
     @         5965d+1*t12*t13*t14*t6*t63))*wght+Mmat(iq,D1_TB)
            Mmat(iq,D1_TA) = Mmat(iq,D1_TA)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_x_m08 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_4} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_5} &=& {{4.557799872345596\,\rho_\alpha^{{{5}\over{3}}}}\over{\tau_\alpha}}\\\\ 
C>   {\it t_6} &=& {\it t_5}-1.0\\\\ 
C>   {\it t_7} &=& {\it t_6}^{11}\\\\ 
C>   {\it t_8} &=& {\it t_5}+1.0\\\\ 
C>   {\it t_9} &=& {{1}\over{{\it t_8}^{11}}}\\\\ 
C>   {\it t_{10}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{11}} &=& {\it t_6}^{10}\\\\ 
C>   {\it t_{12}} &=& {{1}\over{{\it t_8}^{10}}}\\\\ 
C>   {\it t_{13}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{14}} &=& {\it t_6}^9\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_8}^9}}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{17}} &=& {\it t_6}^8\\\\ 
C>   {\it t_{18}} &=& {{1}\over{{\it t_8}^8}}\\\\ 
C>   {\it t_{19}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{20}} &=& {\it t_6}^7\\\\ 
C>   {\it t_{21}} &=& {{1}\over{{\it t_8}^7}}\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{23}} &=& {\it t_6}^6\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_8}^6}}\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{26}} &=& {\it t_6}^5\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_8}^5}}\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{29}} &=& {\it t_6}^4\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_8}^4}}\\\\ 
C>   {\it t_{31}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{32}} &=& {\it t_6}^3\\\\ 
C>   {\it t_{33}} &=& {{1}\over{{\it t_8}^3}}\\\\ 
C>   {\it t_{34}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{35}} &=& {\it t_6}^2\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_8}^2}}\\\\ 
C>   {\it t_{37}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_8}}}\\\\ 
C>   {\it t_{39}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{51}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{52}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{53}} &=& {{4.557799872345596\,\rho_\beta^{{{5}\over{3}}}}\over{\tau_\beta}}\\\\ 
C>   {\it t_{54}} &=& {\it t_{53}}-1.0\\\\ 
C>   {\it t_{55}} &=& {\it t_{54}}^{11}\\\\ 
C>   {\it t_{56}} &=& {\it t_{53}}+1.0\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}^{11}}}\\\\ 
C>   {\it t_{58}} &=& {\it t_{54}}^{10}\\\\ 
C>   {\it t_{59}} &=& {{1}\over{{\it t_{56}}^{10}}}\\\\ 
C>   {\it t_{60}} &=& {\it t_{54}}^9\\\\ 
C>   {\it t_{61}} &=& {{1}\over{{\it t_{56}}^9}}\\\\ 
C>   {\it t_{62}} &=& {\it t_{54}}^8\\\\ 
C>   {\it t_{63}} &=& {{1}\over{{\it t_{56}}^8}}\\\\ 
C>   {\it t_{64}} &=& {\it t_{54}}^7\\\\ 
C>   {\it t_{65}} &=& {{1}\over{{\it t_{56}}^7}}\\\\ 
C>   {\it t_{66}} &=& {\it t_{54}}^6\\\\ 
C>   {\it t_{67}} &=& {{1}\over{{\it t_{56}}^6}}\\\\ 
C>   {\it t_{68}} &=& {\it t_{54}}^5\\\\ 
C>   {\it t_{69}} &=& {{1}\over{{\it t_{56}}^5}}\\\\ 
C>   {\it t_{70}} &=& {\it t_{54}}^4\\\\ 
C>   {\it t_{71}} &=& {{1}\over{{\it t_{56}}^4}}\\\\ 
C>   {\it t_{72}} &=& {\it t_{54}}^3\\\\ 
C>   {\it t_{73}} &=& {{1}\over{{\it t_{56}}^3}}\\\\ 
C>   {\it t_{74}} &=& {\it t_{54}}^2\\\\ 
C>   {\it t_{75}} &=& {{1}\over{{\it t_{56}}^2}}\\\\ 
C>   {\it t_{76}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{77}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {{4.557799872345596\,\rho_s^{{{5}\over{3}}}}\over{\tau_s}}\\\\ 
C>   {\it t_{80}} &=& {\it t_{79}}-1.0\\\\ 
C>   {\it t_{81}} &=& {\it t_{80}}^{11}\\\\ 
C>   {\it t_{82}} &=& {\it t_{79}}+1.0\\\\ 
C>   {\it t_{83}} &=& {{1}\over{{\it t_{82}}^{11}}}\\\\ 
C>   {\it t_{84}} &=& {\it t_{80}}^{10}\\\\ 
C>   {\it t_{85}} &=& {{1}\over{{\it t_{82}}^{10}}}\\\\ 
C>   {\it t_{86}} &=& {\it t_{80}}^9\\\\ 
C>   {\it t_{87}} &=& {{1}\over{{\it t_{82}}^9}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{80}}^8\\\\ 
C>   {\it t_{89}} &=& {{1}\over{{\it t_{82}}^8}}\\\\ 
C>   {\it t_{90}} &=& {\it t_{80}}^7\\\\ 
C>   {\it t_{91}} &=& {{1}\over{{\it t_{82}}^7}}\\\\ 
C>   {\it t_{92}} &=& {\it t_{80}}^6\\\\ 
C>   {\it t_{93}} &=& {{1}\over{{\it t_{82}}^6}}\\\\ 
C>   {\it t_{94}} &=& {\it t_{80}}^5\\\\ 
C>   {\it t_{95}} &=& {{1}\over{{\it t_{82}}^5}}\\\\ 
C>   {\it t_{96}} &=& {\it t_{80}}^4\\\\ 
C>   {\it t_{97}} &=& {{1}\over{{\it t_{82}}^4}}\\\\ 
C>   {\it t_{98}} &=& {\it t_{80}}^3\\\\ 
C>   {\it t_{99}} &=& {{1}\over{{\it t_{82}}^3}}\\\\ 
C>   {\it t_{100}} &=& {\it t_{80}}^2\\\\ 
C>   {\it t_{101}} &=& {{1}\over{{\it t_{82}}^2}}\\\\ 
C>   {\it t_{102}} &=& {{1}\over{{\it t_{82}}}}\\\\ 
C>   f &=& 1.0\,\left(-.9305257363491002\,{\it t_{51}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{52}}\,\sigma_{\beta\beta}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{49}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{48}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{47}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{46}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{45}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{44}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{43}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{42}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{41}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_{40}}\,{\it t_{55}}\,{\it t_{57}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{51}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{52}}\,\sigma_{\beta\beta}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{34}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{31}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{28}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{25}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{22}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{19}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{16}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{13}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{10}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_4}\,{\it t_{55}}\,{\it t_{57}}+{\it t_3}\right)\right)+1.0\,\left(-.9305257363491002\,{\it t_1}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_2}\,\sigma_{\alpha\alpha}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_6}\,{\it t_{38}}+{\it t_{49}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{48}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{47}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{46}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{45}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{44}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{43}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{42}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{41}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_{40}}\,{\it t_7}\,{\it t_9}+{\it t_{39}}\right)-.9305257363491002\,{\it t_1}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_6}\,{\it t_{38}}+{\it t_{34}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{31}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{28}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{25}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{22}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{19}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{16}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{13}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{10}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_4}\,{\it t_7}\,{\it t_9}+{\it t_3}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(-.9305257363491002\,{\it t_{77}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{78}}\,\sigma_{ss}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{49}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{48}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{47}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{46}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{45}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{44}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{43}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{42}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{41}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_{40}}\,{\it t_{81}}\,{\it t_{83}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{77}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{78}}\,\sigma_{ss}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{34}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{31}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{28}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{25}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{22}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{19}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{16}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{13}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{10}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_4}\,{\it t_{81}}\,{\it t_{83}}+{\it t_3}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] Y Zhao, DG Truhlar, J.Chem.TheoryComput. 4, 1849 (2008)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800246v "> 
C> 10.1021/ct800246v </a> 
C> 
      subroutine nwxcm_x_m08_d2(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Amat2,Cmat,Cmat2,Mmat,Mmat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,NCOL_AMAT2)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,NCOL_CMAT2)  !< [Output] The 2nd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat2(nq,NCOL_MMAT2)  !< [Output] The 2nd derivative wrt tau 
                                             !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_x_m08 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_4} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_5} &=& {{4.557799872345596\,\rho_\alpha^{{{5}\over{3}}}}\over{\tau_\alpha}}\\\\ 
C>   {\it t_6} &=& {\it t_5}-1.0\\\\ 
C>   {\it t_7} &=& {\it t_6}^{11}\\\\ 
C>   {\it t_8} &=& {\it t_5}+1.0\\\\ 
C>   {\it t_9} &=& {{1}\over{{\it t_8}^{11}}}\\\\ 
C>   {\it t_{10}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{11}} &=& {\it t_6}^{10}\\\\ 
C>   {\it t_{12}} &=& {{1}\over{{\it t_8}^{10}}}\\\\ 
C>   {\it t_{13}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{14}} &=& {\it t_6}^9\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_8}^9}}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{17}} &=& {\it t_6}^8\\\\ 
C>   {\it t_{18}} &=& {{1}\over{{\it t_8}^8}}\\\\ 
C>   {\it t_{19}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{20}} &=& {\it t_6}^7\\\\ 
C>   {\it t_{21}} &=& {{1}\over{{\it t_8}^7}}\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{23}} &=& {\it t_6}^6\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_8}^6}}\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{26}} &=& {\it t_6}^5\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_8}^5}}\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{29}} &=& {\it t_6}^4\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_8}^4}}\\\\ 
C>   {\it t_{31}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{32}} &=& {\it t_6}^3\\\\ 
C>   {\it t_{33}} &=& {{1}\over{{\it t_8}^3}}\\\\ 
C>   {\it t_{34}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{35}} &=& {\it t_6}^2\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_8}^2}}\\\\ 
C>   {\it t_{37}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_8}}}\\\\ 
C>   {\it t_{39}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{51}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{52}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{53}} &=& {{4.557799872345596\,\rho_\beta^{{{5}\over{3}}}}\over{\tau_\beta}}\\\\ 
C>   {\it t_{54}} &=& {\it t_{53}}-1.0\\\\ 
C>   {\it t_{55}} &=& {\it t_{54}}^{11}\\\\ 
C>   {\it t_{56}} &=& {\it t_{53}}+1.0\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}^{11}}}\\\\ 
C>   {\it t_{58}} &=& {\it t_{54}}^{10}\\\\ 
C>   {\it t_{59}} &=& {{1}\over{{\it t_{56}}^{10}}}\\\\ 
C>   {\it t_{60}} &=& {\it t_{54}}^9\\\\ 
C>   {\it t_{61}} &=& {{1}\over{{\it t_{56}}^9}}\\\\ 
C>   {\it t_{62}} &=& {\it t_{54}}^8\\\\ 
C>   {\it t_{63}} &=& {{1}\over{{\it t_{56}}^8}}\\\\ 
C>   {\it t_{64}} &=& {\it t_{54}}^7\\\\ 
C>   {\it t_{65}} &=& {{1}\over{{\it t_{56}}^7}}\\\\ 
C>   {\it t_{66}} &=& {\it t_{54}}^6\\\\ 
C>   {\it t_{67}} &=& {{1}\over{{\it t_{56}}^6}}\\\\ 
C>   {\it t_{68}} &=& {\it t_{54}}^5\\\\ 
C>   {\it t_{69}} &=& {{1}\over{{\it t_{56}}^5}}\\\\ 
C>   {\it t_{70}} &=& {\it t_{54}}^4\\\\ 
C>   {\it t_{71}} &=& {{1}\over{{\it t_{56}}^4}}\\\\ 
C>   {\it t_{72}} &=& {\it t_{54}}^3\\\\ 
C>   {\it t_{73}} &=& {{1}\over{{\it t_{56}}^3}}\\\\ 
C>   {\it t_{74}} &=& {\it t_{54}}^2\\\\ 
C>   {\it t_{75}} &=& {{1}\over{{\it t_{56}}^2}}\\\\ 
C>   {\it t_{76}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{77}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {{4.557799872345596\,\rho_s^{{{5}\over{3}}}}\over{\tau_s}}\\\\ 
C>   {\it t_{80}} &=& {\it t_{79}}-1.0\\\\ 
C>   {\it t_{81}} &=& {\it t_{80}}^{11}\\\\ 
C>   {\it t_{82}} &=& {\it t_{79}}+1.0\\\\ 
C>   {\it t_{83}} &=& {{1}\over{{\it t_{82}}^{11}}}\\\\ 
C>   {\it t_{84}} &=& {\it t_{80}}^{10}\\\\ 
C>   {\it t_{85}} &=& {{1}\over{{\it t_{82}}^{10}}}\\\\ 
C>   {\it t_{86}} &=& {\it t_{80}}^9\\\\ 
C>   {\it t_{87}} &=& {{1}\over{{\it t_{82}}^9}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{80}}^8\\\\ 
C>   {\it t_{89}} &=& {{1}\over{{\it t_{82}}^8}}\\\\ 
C>   {\it t_{90}} &=& {\it t_{80}}^7\\\\ 
C>   {\it t_{91}} &=& {{1}\over{{\it t_{82}}^7}}\\\\ 
C>   {\it t_{92}} &=& {\it t_{80}}^6\\\\ 
C>   {\it t_{93}} &=& {{1}\over{{\it t_{82}}^6}}\\\\ 
C>   {\it t_{94}} &=& {\it t_{80}}^5\\\\ 
C>   {\it t_{95}} &=& {{1}\over{{\it t_{82}}^5}}\\\\ 
C>   {\it t_{96}} &=& {\it t_{80}}^4\\\\ 
C>   {\it t_{97}} &=& {{1}\over{{\it t_{82}}^4}}\\\\ 
C>   {\it t_{98}} &=& {\it t_{80}}^3\\\\ 
C>   {\it t_{99}} &=& {{1}\over{{\it t_{82}}^3}}\\\\ 
C>   {\it t_{100}} &=& {\it t_{80}}^2\\\\ 
C>   {\it t_{101}} &=& {{1}\over{{\it t_{82}}^2}}\\\\ 
C>   {\it t_{102}} &=& {{1}\over{{\it t_{82}}}}\\\\ 
C>   f &=& 1.0\,\left(-.9305257363491002\,{\it t_{51}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{52}}\,\sigma_{\beta\beta}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{49}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{48}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{47}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{46}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{45}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{44}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{43}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{42}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{41}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_{40}}\,{\it t_{55}}\,{\it t_{57}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{51}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{52}}\,\sigma_{\beta\beta}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{54}}\,{\it t_{76}}+{\it t_{34}}\,{\it t_{74}}\,{\it t_{75}}+{\it t_{31}}\,{\it t_{72}}\,{\it t_{73}}+{\it t_{28}}\,{\it t_{70}}\,{\it t_{71}}+{\it t_{25}}\,{\it t_{68}}\,{\it t_{69}}+{\it t_{22}}\,{\it t_{66}}\,{\it t_{67}}+{\it t_{19}}\,{\it t_{64}}\,{\it t_{65}}+{\it t_{16}}\,{\it t_{62}}\,{\it t_{63}}+{\it t_{13}}\,{\it t_{60}}\,{\it t_{61}}+{\it t_{10}}\,{\it t_{58}}\,{\it t_{59}}+{\it t_4}\,{\it t_{55}}\,{\it t_{57}}+{\it t_3}\right)\right)+1.0\,\left(-.9305257363491002\,{\it t_1}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_2}\,\sigma_{\alpha\alpha}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_6}\,{\it t_{38}}+{\it t_{49}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{48}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{47}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{46}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{45}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{44}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{43}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{42}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{41}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_{40}}\,{\it t_7}\,{\it t_9}+{\it t_{39}}\right)-.9305257363491002\,{\it t_1}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_6}\,{\it t_{38}}+{\it t_{34}}\,{\it t_{35}}\,{\it t_{36}}+{\it t_{31}}\,{\it t_{32}}\,{\it t_{33}}+{\it t_{28}}\,{\it t_{29}}\,{\it t_{30}}+{\it t_{25}}\,{\it t_{26}}\,{\it t_{27}}+{\it t_{22}}\,{\it t_{23}}\,{\it t_{24}}+{\it t_{19}}\,{\it t_{20}}\,{\it t_{21}}+{\it t_{16}}\,{\it t_{17}}\,{\it t_{18}}+{\it t_{13}}\,{\it t_{14}}\,{\it t_{15}}+{\it t_{10}}\,{\it t_{11}}\,{\it t_{12}}+{\it t_4}\,{\it t_7}\,{\it t_9}+{\it t_3}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(-.9305257363491002\,{\it t_{77}}\,\left(0.552\,\left(1.0-{{1}\over{e^{.003680288926019986\,{\it t_{78}}\,\sigma_{ss}}}}\right)+1.0\right)\,\left({\it t_{50}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{49}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{48}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{47}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{46}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{45}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{44}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{43}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{42}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{41}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_{40}}\,{\it t_{81}}\,{\it t_{83}}+{\it t_{39}}\right)-.9305257363491002\,{\it t_{77}}\,\left(0.804\,\left(1.0-{{1.0}\over{.004492667444378077\,{\it t_{78}}\,\sigma_{ss}+1.0}}\right)+1.0\right)\,\left({\it t_{37}}\,{\it t_{80}}\,{\it t_{102}}+{\it t_{34}}\,{\it t_{100}}\,{\it t_{101}}+{\it t_{31}}\,{\it t_{98}}\,{\it t_{99}}+{\it t_{28}}\,{\it t_{96}}\,{\it t_{97}}+{\it t_{25}}\,{\it t_{94}}\,{\it t_{95}}+{\it t_{22}}\,{\it t_{92}}\,{\it t_{93}}+{\it t_{19}}\,{\it t_{90}}\,{\it t_{91}}+{\it t_{16}}\,{\it t_{88}}\,{\it t_{89}}+{\it t_{13}}\,{\it t_{86}}\,{\it t_{87}}+{\it t_{10}}\,{\it t_{84}}\,{\it t_{85}}+{\it t_4}\,{\it t_{81}}\,{\it t_{83}}+{\it t_3}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] Y Zhao, DG Truhlar, J.Chem.TheoryComput. 4, 1849 (2008)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800246v "> 
C> 10.1021/ct800246v </a> 
C> 
      subroutine nwxcm_x_m08_d3(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Amat2,Amat3, 
     +Cmat,Cmat2,Cmat3,Mmat,Mmat2,Mmat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,NCOL_AMAT2)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,NCOL_CMAT2)  !< [Output] The 2nd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat2(nq,NCOL_MMAT2)  !< [Output] The 2nd derivative wrt tau 
                                             !< and possibly rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,NCOL_AMAT3)  !< [Output] The 3rd derivative wrt rho 
      double precision Cmat3(nq,NCOL_CMAT3)  !< [Output] The 3rd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat3(nq,NCOL_MMAT3)  !< [Output] The 3rd derivative wrt tau 
                                             !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
