C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_c_p91_vwn5.F 
C> The nwxcm_c_p91_vwn5 functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_c_p91_vwn5 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& -\rho_\beta\\\\ 
C>   {\it t_3} &=& {\it t_2}+\rho_\alpha\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& 1.0-{\it t_3}\,{\it t_4}\\\\ 
C>   {\it t_6} &=& {\it t_3}\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.5\,{\it t_6}^{{{2}\over{3}}}+0.5\,{\it t_5}^{{{2}\over{3}}}\\\\ 
C>   {\it t_8} &=& {\it t_7}^{3.0}\\\\ 
C>   {\it t_9} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_9}^{2.0}}}\\\\ 
C>   {\it t_{11}} &=& {{1}\over{{\it t_7}^{2.0}}}\\\\ 
C>   {\it t_{12}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{13}} &=& \sigma_{\beta\beta}+{\it t_{12}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{14}} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{\sqrt{{\it t_{14}}}}}\\\\ 
C>   {\it t_{16}} &=& 1.575246635799487\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{16}}+3.72744}}\right)\\\\ 
C>   {\it t_{18}} &=& 0.7876233178997433\,{\it t_{15}}\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{20}} &=& 0.6203504908994001\,{\it t_{19}}\\\\ 
C>   {\it t_{21}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{15}}+{\it t_{20}}+12.9352\right| }}\\\\ 
C>   {\it t_{22}} &=& \log \left(1.0\,\left({\it t_{18}}+0.10498\right)^2\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{23}} &=& \left| {\it t_{19}}\right| \\\\ 
C>   {\it t_{24}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{25}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{16}}+1.13107}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{15}}+{\it t_{20}}+13.0045\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_{18}}+0.0047584\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{15}}+{\it t_{20}}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& {{1}\over{e^{{{40.4276151175637\,\left(1.125\,\left({\it t_6}^{{{4}\over{3}}}+{\it t_5}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_3}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{29}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{18}}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{24}}-9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{16}}+7.06042}}\right)-0.03878329487811301\,{\it t_{17}}\right)+0.01688686394038963\,{\it t_{28}}+6.991732350764465 \times 10^{-6}\,{\it t_{27}}+0.005365091848883601\,{\it t_{25}}\right)}\over{{\it t_1}^4}}-0.01688686394038963\,{\it t_{28}}-6.991732350764465 \times 10^{-6}\,{\it t_{27}}-0.005365091848883601\,{\it t_{25}}\right)+0.0310907\,{\it t_{24}}+9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.03878329487811301\,{\it t_{17}}\right)}\over{{\it t_8}}}}}}-1.0\\\\ 
C>   {\it t_{31}} &=& {{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}}\over{{\it t_{30}}}}\\\\ 
C>   {\it t_{32}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{33}} &=& \rho_s+{\it t_2}\\\\ 
C>   {\it t_{34}} &=& {{{\it t_{33}}}\over{{\it t_{32}}}}+1.0\\\\ 
C>   {\it t_{35}} &=& \left| {\it t_{34}}\right| ^{2.0}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{32}}^{1.166666666666667}\,{\it t_{34}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {\it t_{36}}^{2.0}\\\\ 
C>   {\it t_{38}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{12}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{32}}^{0.3333333333333333}\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\sqrt{{\it t_{39}}}}}\\\\ 
C>   {\it t_{41}} &=& 1.575246635799487\,{\it t_{40}}\\\\ 
C>   {\it t_{42}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{41}}+3.72744}}\right)\\\\ 
C>   {\it t_{43}} &=& 0.7876233178997433\,{\it t_{40}}\\\\ 
C>   {\it t_{44}} &=& {{1}\over{{\it t_{39}}}}\\\\ 
C>   {\it t_{45}} &=& 0.6203504908994001\,{\it t_{44}}\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{40}}+{\it t_{45}}+12.9352\right| }}\\\\ 
C>   {\it t_{47}} &=& \log \left(1.0\,\left({\it t_{43}}+0.10498\right)^2\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{48}} &=& \left| {\it t_{44}}\right| \\\\ 
C>   {\it t_{49}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{50}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{41}}+1.13107}}\right)\\\\ 
C>   {\it t_{51}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{40}}+{\it t_{45}}+13.0045\right| }}\\\\ 
C>   {\it t_{52}} &=& \log \left(1.0\,\left({\it t_{43}}+0.0047584\right)^2\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{53}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{54}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{40}}+{\it t_{45}}+18.0578\right| }}\\\\ 
C>   {\it t_{55}} &=& {{1}\over{e^{{{323.4209209405096\,\left(1.125\,\left({\it t_{34}}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_{33}}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{54}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{43}}+0.325\right)^2\,{\it t_{54}}\right)-0.0310907\,{\it t_{49}}-9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{41}}+7.06042}}\right)-0.03878329487811301\,{\it t_{42}}\right)+0.01688686394038963\,{\it t_{53}}+6.991732350764465 \times 10^{-6}\,{\it t_{52}}+0.005365091848883601\,{\it t_{50}}\right)}\over{{\it t_{32}}^4}}-0.01688686394038963\,{\it t_{53}}-6.991732350764465 \times 10^{-6}\,{\it t_{52}}-0.005365091848883601\,{\it t_{50}}\right)+0.0310907\,{\it t_{49}}+9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.03878329487811301\,{\it t_{42}}\right)}\over{{\it t_{35}}}}}}}-1.0\\\\ 
C>   {\it t_{56}} &=& {{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}}\over{{\it t_{55}}}}\\\\ 
C>   f &=& 0.02473556743557578\,{\it t_1}\,{\it t_8}\,\log \left({{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}\,\left({\it t_{31}}+1.0\right)}\over{{{0.02931318940773791\,{\it t_{13}}^{2.0}}\over{{\it t_9}^{4.0}\,{\it t_7}^{4.0}\,{\it t_{30}}^{2.0}}}+{\it t_{31}}+1.0}}+1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 0.003091945929446973\,{\it t_{32}}\,{\it t_{35}}\,\log \left({{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}\,\left({\it t_{56}}+1.0\right)}\over{{{0.4690110305238066\,{\it t_{36}}^{4.0}\,{\it t_{38}}^{2.0}}\over{{\it t_{55}}^{2.0}}}+{\it t_{56}}+1.0}}+1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] unpublished , DOI: 
C> <a href="http://dx.doi.org/unpublished "> 
C> unpublished </a> 
C> 
      subroutine nwxcm_c_p91_vwn5(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Cmat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
            t1 = rhoa**1.1666666666666667d+0
            t2 = 1/t1**2.0d+0
            t3 = rhoa**3.333333333333333d-1
            t4 = t3**5.0d-1
            t5 = 1/t4
            t6 = 1/t3
            t7 = 4.9237251092134837d-1*t6+2.615517080950829d+0*t5+1.2935
     1         2d+1
            t8 = abs(t7)
            t9 = 1/t8
            t10 = abs(t6)
            t11 = 7.016926042943223d-1*t5+1.0498d-1
            t12 = t11**2
            t13 = 1.4033852085886447d+0*t5+3.72744d+0
            t14 = exp(-4.0427615117563703d+1*(9.690227711544375d-4*log(1
     1         .0d+0*t12*t9)+3.10907d-2*log(4.9237251092134837d-1*t10*t9
     2         )+3.8783294878113006d-2*atan(6.15199081975908d+0/t13)))
            t15 = t14-1.0d+0
            t16 = 1/t15
            t17 = 1.358902210873991d-1*gammaaa*t16*t2
            t18 = t17+1.0d+0
            t19 = gammaaa**2.0d+0
            t20 = 1/t1**4.0d+0
            t21 = 1/t15**2.0d+0
            t22 = 1.8466152187182203d-2*t19*t20*t21+t17+1.0d+0
            t23 = 1/t22
            t24 = 1.358902210873991d-1*gammaaa*t18*t2*t23+1.0d+0
            t25 = log(t24)
            t26 = 1/t24
            t27 = rhoa**1.6666666666666674d-1
            t28 = 1/t1**3.0d+0
            t29 = -3.170771825372646d-1*gammaaa*t16*t27*t28
            t30 = 1/t10
            t31 = 1/t4**3
            t32 = 1/rhoa**6.666666666666667d-1
            t33 = -4.359195134918048d-1*t31*t32-1.6412417030711612d-1/rh
     1         oa**1.3333333333333333d+0
            t34 = 1/t7
            t35 = 1/t13**2
            t36 = 9.690227711544375d-4*t8*(-1.0d+0*t12*t33*t34*t9-2.3389
     1         75347647741d-1*t11*t31*t32*t9)/t12+6.314467057030003d-2*t
     2         30*t8*(-4.9237251092134837d-1*t10*t33*t34*t9-1.6412417030
     3         711612d-1*t30*t9/rhoa**1.6666666666666666d+0)+5.580665928
     4         883042d-2*t31*t32*t35/(3.784699104639999d+1*t35+1)
            t37 = 5.49371755636201d+0*gammaaa*t14*t2*t36/t15**2
            t38 = 1/t22**2
            t39 = 4.947113487115156d-2*rhoa*t26*(-1.358902210873991d-1*g
     1         ammaaa*t18*t2*(3.6932304374364405d-2*gammaaa*t20*t21+1.35
     2         8902210873991d-1*t16*t2)*t38+1.8466152187182205d-2*gammaa
     3         a*t16*t20*t23+1.358902210873991d-1*t18*t2*t23)*wght
            fnc(iq) = 4.947113487115156d-2*rhoa*t25*wght+fnc(iq)
            Amat(iq,D1_RA) = 4.947113487115156d-2*rhoa*t26*(-1.358902210
     1         873991d-1*gammaaa*t18*t2*(t37+1.4930849866515186d+0*t14*t
     2         19*t20*t36/t15**3.0d+0+t29-8.617537687351695d-2*t19*t21*t
     3         27/t1**5.0d+0)*t38+1.358902210873991d-1*gammaaa*t2*t23*(t
     4         37+t29)-3.170771825372646d-1*gammaaa*t18*t23*t27*t28)*wgh
     5         t+4.947113487115156d-2*t25*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = t39+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t39+Cmat(iq,D1_GAB)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = rhob+rhoa
            t2 = rhoa-rhob
            t3 = 1/t1
            t4 = 1.0d+0-t2*t3
            t5 = t2*t3+1.0d+0
            t6 = 5.0d-1*t5**6.666666666666666d-1+5.0d-1*t4**6.6666666666
     1         66666d-1
            t7 = t6**3.0d+0
            t8 = gammabb+2.0d+0*gammaab+gammaaa
            t9 = t1**1.1666666666666667d+0
            t10 = 1/t9**2.0d+0
            t11 = t6**2.0d+0
            t12 = 1/t11
            t13 = 1/t7
            t14 = t1**3.333333333333333d-1
            t15 = t14**5.0d-1
            t16 = 1/t15
            t17 = 1.5752466357994865d+0*t16
            t18 = t17+3.72744d+0
            t19 = atan(6.15199081975908d+0/t18)
            t20 = 7.876233178997433d-1*t16
            t21 = t20+1.0498d-1
            t22 = t21**2
            t23 = 1/t14
            t24 = 6.203504908994001d-1*t23
            t25 = t24+2.935818660072219d+0*t16+1.29352d+1
            t26 = abs(t25)
            t27 = 1/t26
            t28 = log(1.0d+0*t22*t27)
            t29 = abs(t23)
            t30 = log(6.203504908994001d-1*t27*t29)
            t31 = t5**1.3333333333333333d+0+t4**1.3333333333333333d+0-2.
     1         0d+0
            t32 = t17+1.13107d+0
            t33 = atan(7.123108917818117d+0/t32)
            t34 = t20+4.7584000000000004d-3
            t35 = t34**2
            t36 = t24+8.908571061768626d-1*t16+1.30045d+1
            t37 = abs(t36)
            t38 = 1/t37
            t39 = log(1.0d+0*t35*t38)
            t40 = log(6.203504908994001d-1*t29*t38)
            t41 = t2**4
            t42 = 1/t1**4
            t43 = t17+7.06042d+0
            t44 = t20+3.25d-1
            t45 = t44**2
            t46 = t24+5.560951426165704d+0*t16+1.8057800000000002d+1
            t47 = abs(t46)
            t48 = 1/t47
            t49 = 1.709920934161365d+0*(2.2478670955426108d-3*log(1.0d+0
     1         *t45*t48)+1.554535d-2*log(6.203504908994001d-1*t29*t48)+5
     2         .249139316978092d-2*atan(4.7309269095601136d+0/t43)-3.109
     3         07d-2*t30-9.690227711544375d-4*t28-3.8783294878113006d-2*
     4         t19)+1.688686394038963d-2*t40+6.991732350764465d-6*t39+5.
     5         365091848883601d-3*t33
            t50 = t41*t42*t49-1.688686394038963d-2*t40-6.991732350764465
     1         d-6*t39-5.365091848883601d-3*t33
            t51 = 1.1250000000000002d+0*t31*t50+3.10907d-2*t30+9.6902277
     1         11544375d-4*t28+3.8783294878113006d-2*t19
            t52 = exp(-4.0427615117563703d+1*t13*t51)
            t53 = t52-1.0d+0
            t54 = 1/t53
            t55 = 1.7121095002288234d-1*t10*t12*t54*t8
            t56 = t55+1.0d+0
            t57 = t8**2.0d+0
            t58 = 1/t9**4.0d+0
            t59 = 1/t6**4.0d+0
            t60 = 1/t53**2.0d+0
            t61 = 2.931318940773791d-2*t57*t58*t59*t60+t55+1.0d+0
            t62 = 1/t61
            t63 = 1.7121095002288234d-1*t10*t12*t56*t62*t8+1.0d+0
            t64 = log(t63)
            t65 = 1/t1**2
            t66 = t2*t65
            t67 = -t3
            t68 = t67+t66
            t69 = t4**3.333333333333333d-1
            t70 = 1/t69
            t71 = -t2*t65
            t72 = t71+t3
            t73 = t5**3.333333333333333d-1
            t74 = 1/t73
            t75 = 3.333333333333333d-1*t72*t74+3.333333333333333d-1*t68*
     1         t70
            t76 = 2.473556743557578d-2*t64*t7*wght
            t77 = 1/t63
            t78 = t1**1.6666666666666674d-1
            t79 = 1/t9**3.0d+0
            t80 = -3.994922167200588d-1*t12*t56*t62*t78*t79*t8
            t81 = -3.4242190004576467d-1*t10*t13*t54*t75*t8
            t82 = -3.994922167200588d-1*t12*t54*t78*t79*t8
            t83 = 1/t53**2
            t84 = 1/t1**6.666666666666667d-1
            t85 = 1/t15**3
            t86 = 1/t18**2
            t87 = 1/(3.784699104639999d+1*t86+1)
            t88 = 6.264085709464389d-2*t84*t85*t86*t87
            t89 = 1/t22
            t90 = -2.067834969664667d-1/t1**1.3333333333333333d+0
            t91 = t90-4.8930311001203647d-1*t84*t85
            t92 = 1/t25
            t93 = -1.0d+0*t22*t27*t91*t92-2.625411059665811d-1*t21*t27*t
     1         84*t85
            t94 = 9.690227711544375d-4*t26*t89*t93
            t95 = 1/t29
            t96 = 1/t1**1.6666666666666666d+0
            t97 = -2.067834969664667d-1*t27*t95*t96-6.203504908994001d-1
     1         *t27*t29*t91*t92
            t98 = 5.011795824473985d-2*t26*t95*t97
            t99 = 1/t32**2
            t100 = 1/(5.07386806551d+1*t99+1)
            t101 = -1.003330597945558d-2*t100*t84*t85*t99
            t102 = 1/t35
            t103 = t90-1.4847618436281043d-1*t84*t85
            t104 = 1/t36
            t105 = -2.625411059665811d-1*t34*t38*t84*t85-1.0d+0*t103*t10
     1         4*t35*t38
            t106 = -6.991732350764465d-6*t102*t105*t37
            t107 = -2.067834969664667d-1*t38*t95*t96-6.203504908994001d-
     1         1*t103*t104*t29*t38
            t108 = -2.722148880047894d-2*t107*t37*t95
            t109 = 1/t43**2
            t110 = t90-9.26825237694284d-1*t84*t85
            t111 = 1/t46
            t112 = t41*t42*(1.003330597945558d-2*t100*t84*t85*t99+1.7099
     1         20934161365d+0*(-5.011795824473985d-2*t26*t95*t97+2.50589
     2         79122369923d-2*t47*t95*(-2.067834969664667d-1*t48*t95*t96
     3         -6.203504908994001d-1*t110*t111*t29*t48)-9.69022771154437
     4         5d-4*t26*t89*t93-6.264085709464389d-2*t84*t85*t86*t87+2.2
     5         478670955426108d-3*t47*(-2.625411059665811d-1*t44*t48*t84
     6         *t85-1.0d+0*t110*t111*t45*t48)/t45+6.519760588836059d-2*t
     7         109*t84*t85/(2.238166942360001d+1*t109+1))+2.722148880047
     8         894d-2*t107*t37*t95+6.991732350764465d-6*t102*t105*t37)
            t113 = -4*t41*t49/t1**5
            t114 = t2**3
            t115 = 1.2128284535269111d+2*t51*t59*t75-4.0427615117563703d
     1         +1*t13*(t98+t94+t88+1.1250000000000002d+0*t50*(1.33333333
     2         33333333d+0*t72*t73+1.3333333333333333d+0*t68*t69)+1.1250
     3         000000000002d+0*t31*(4*t114*t42*t49+t113+t112+t108+t106+t
     4         101))
            t116 = -1.7121095002288234d-1*t10*t115*t12*t52*t8*t83
            t117 = 1/t61**2
            t118 = 1/t6**5.0d+0
            t119 = -1.3679488390277694d-1*t57*t59*t60*t78/t9**5.0d+0
            t120 = 1/t53**3.0d+0
            t121 = t66+t3
            t122 = t71+t67
            t123 = 3.333333333333333d-1*t122*t74+3.333333333333333d-1*t1
     1         21*t70
            t124 = -3.4242190004576467d-1*t10*t123*t13*t54*t8
            t125 = 1.2128284535269111d+2*t123*t51*t59-4.0427615117563703
     1         d+1*t13*(t98+t94+t88+1.1250000000000002d+0*t50*(1.3333333
     2         333333333d+0*t122*t73+1.3333333333333333d+0*t121*t69)+1.1
     3         250000000000002d+0*t31*(-4*t114*t42*t49+t113+t112+t108+t1
     4         06+t101))
            t126 = -1.7121095002288234d-1*t10*t12*t125*t52*t8*t83
            t127 = 2.473556743557578d-2*t1*t7*t77*(-1.7121095002288234d-
     1         1*t10*t117*t12*t56*t8*(5.862637881547582d-2*t58*t59*t60*t
     2         8+1.7121095002288234d-1*t10*t12*t54)+2.931318940773791d-2
     3         *t54*t58*t59*t62*t8+1.7121095002288234d-1*t10*t12*t56*t62
     4         )*wght
            fnc(iq) = 2.473556743557578d-2*t1*t64*t7*wght+fnc(iq)
            Amat(iq,D1_RA) = 2.473556743557578d-2*t1*t7*t77*(-1.71210950
     1         02288234d-1*t10*t117*t12*t56*t8*(t82+t81-1.17252757630951
     2         65d-1*t118*t57*t58*t60*t75-5.862637881547582d-2*t115*t120
     3         *t52*t57*t58*t59+t119+t116)+1.7121095002288234d-1*t10*t12
     4         *t62*t8*(t82+t81+t116)+t80-3.4242190004576467d-1*t10*t13*
     5         t56*t62*t75*t8)*wght+7.420670230672733d-2*t1*t11*t64*t75*
     6         wght+t76+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = 2.473556743557578d-2*t1*t7*t77*(-1.71210950
     1         02288234d-1*t10*t117*t12*t56*t8*(t82-1.1725275763095165d-
     2         1*t118*t123*t57*t58*t60-5.862637881547582d-2*t120*t125*t5
     3         2*t57*t58*t59+t126+t124+t119)+1.7121095002288234d-1*t10*t
     4         12*t62*t8*(t82+t126+t124)+t80-3.4242190004576467d-1*t10*t
     5         123*t13*t56*t62*t8)*wght+7.420670230672733d-2*t1*t11*t123
     6         *t64*wght+t76+Amat(iq,D1_RB)
            Cmat(iq,D1_GAA) = t127+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = 2.473556743557578d-2*t1*t7*t77*(-1.7121095
     1         002288234d-1*t10*t117*t12*t56*t8*(1.1725275763095165d-1*t
     2         58*t59*t60*t8+3.4242190004576467d-1*t10*t12*t54)+5.862637
     3         881547582d-2*t54*t58*t59*t62*t8+3.4242190004576467d-1*t10
     4         *t12*t56*t62)*wght+Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = t127+Cmat(iq,D1_GBB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = rhob+rhoa
            t2 = rhoa-rhob
            t3 = 1/t1
            t4 = t2*t3+1.0d+0
            t5 = abs(t4)
            t6 = t5**2.0d+0
            t7 = 1/t1**1.1666666666666667d+0
            t8 = 1/t4**6.666666666666666d-1
            t9 = t7*t8
            t10 = t9**2.0d+0
            t11 = sigmabb+2.0d+0*sigmaab+gammaaa
            t12 = 1/t6
            t13 = t1**3.333333333333333d-1
            t14 = t13**5.0d-1
            t15 = 1/t14
            t16 = 1.5752466357994865d+0*t15
            t17 = t16+3.72744d+0
            t18 = atan(6.15199081975908d+0/t17)
            t19 = 7.876233178997433d-1*t15
            t20 = t19+1.0498d-1
            t21 = t20**2
            t22 = 1/t13
            t23 = 6.203504908994001d-1*t22
            t24 = t23+2.935818660072219d+0*t15+1.29352d+1
            t25 = abs(t24)
            t26 = 1/t25
            t27 = log(1.0d+0*t21*t26)
            t28 = abs(t22)
            t29 = log(6.203504908994001d-1*t26*t28)
            t30 = t4**1.3333333333333333d+0-2.0d+0
            t31 = t16+1.13107d+0
            t32 = atan(7.123108917818117d+0/t31)
            t33 = t19+4.7584000000000004d-3
            t34 = t33**2
            t35 = t23+8.908571061768626d-1*t15+1.30045d+1
            t36 = abs(t35)
            t37 = 1/t36
            t38 = log(1.0d+0*t34*t37)
            t39 = log(6.203504908994001d-1*t28*t37)
            t40 = t2**4
            t41 = 1/t1**4
            t42 = t16+7.06042d+0
            t43 = t19+3.25d-1
            t44 = t43**2
            t45 = t23+5.560951426165704d+0*t15+1.8057800000000002d+1
            t46 = abs(t45)
            t47 = 1/t46
            t48 = 1.709920934161365d+0*(2.2478670955426108d-3*log(1.0d+0
     1         *t44*t47)+1.554535d-2*log(6.203504908994001d-1*t28*t47)+5
     2         .249139316978092d-2*atan(4.7309269095601136d+0/t42)-3.109
     3         07d-2*t29-9.690227711544375d-4*t27-3.8783294878113006d-2*
     4         t18)+1.688686394038963d-2*t39+6.991732350764465d-6*t38+5.
     5         365091848883601d-3*t32
            t49 = t40*t41*t48-1.688686394038963d-2*t39-6.991732350764465
     1         d-6*t38-5.365091848883601d-3*t32
            t50 = 1.1250000000000002d+0*t30*t49+3.10907d-2*t29+9.6902277
     1         11544375d-4*t27+3.8783294878113006d-2*t18
            t51 = exp(-3.234209209405096d+2*t12*t50)
            t52 = t51-1.0d+0
            t53 = 1/t52
            t54 = 6.848438000915293d-1*t10*t11*t53
            t55 = t54+1.0d+0
            t56 = t9**4.0d+0
            t57 = 1/t52**2.0d+0
            t58 = t11**2.0d+0
            t59 = 4.690110305238066d-1*t56*t57*t58+t54+1.0d+0
            t60 = 1/t59
            t61 = 6.848438000915293d-1*t10*t11*t55*t60+1.0d+0
            t62 = log(t61)
            t63 = 1/t61
            t64 = 1/t59**2
            t65 = t3-t2/t1**2
            t66 = -1.1666666666666667d+0*t8/t1**2.166666666666667d+0-6.6
     1         66666666666666d-1*t65*t7/t4**1.6666666666666669d+0
            t67 = 1.3696876001830588d+0*t11*t53*t66*t7*t8
            t68 = 1/t1**6.666666666666667d-1
            t69 = 1/t14**3
            t70 = 1/t17**2
            t71 = 1/(3.784699104639999d+1*t70+1)
            t72 = 1/t21
            t73 = -2.067834969664667d-1/t1**1.3333333333333333d+0
            t74 = t73-4.8930311001203647d-1*t68*t69
            t75 = 1/t24
            t76 = -1.0d+0*t21*t26*t74*t75-2.625411059665811d-1*t20*t26*t
     1         68*t69
            t77 = 1/t28
            t78 = 1/t1**1.6666666666666666d+0
            t79 = -2.067834969664667d-1*t26*t77*t78-6.203504908994001d-1
     1         *t26*t28*t74*t75
            t80 = 1/t31**2
            t81 = 1/(5.07386806551d+1*t80+1)
            t82 = 1/t34
            t83 = t73-1.4847618436281043d-1*t68*t69
            t84 = 1/t35
            t85 = -1.0d+0*t34*t37*t83*t84-2.625411059665811d-1*t33*t37*t
     1         68*t69
            t86 = -6.203504908994001d-1*t28*t37*t83*t84-2.06783496966466
     1         7d-1*t37*t77*t78
            t87 = 1/t42**2
            t88 = t73-9.26825237694284d-1*t68*t69
            t89 = 1/t45
            t90 = 6.468418418810192d+2*t4*t50*t65/t5**4.0d+0-3.234209209
     1         405096d+2*t12*(1.1250000000000002d+0*t30*(t40*t41*(1.7099
     2         20934161365d+0*(2.2478670955426108d-3*t46*(-1.0d+0*t44*t4
     3         7*t88*t89-2.625411059665811d-1*t43*t47*t68*t69)/t44+2.505
     4         8979122369923d-2*t46*t77*(-6.203504908994001d-1*t28*t47*t
     5         88*t89-2.067834969664667d-1*t47*t77*t78)+6.51976058883605
     6         9d-2*t68*t69*t87/(2.238166942360001d+1*t87+1)-5.011795824
     7         473985d-2*t25*t77*t79-9.690227711544375d-4*t25*t72*t76-6.
     8         264085709464389d-2*t68*t69*t70*t71)+2.722148880047894d-2*
     9         t36*t77*t86+6.991732350764465d-6*t36*t82*t85+1.0033305979
     :         45558d-2*t68*t69*t80*t81)-2.722148880047894d-2*t36*t77*t8
     ;         6-6.991732350764465d-6*t36*t82*t85-1.003330597945558d-2*t
     <         68*t69*t80*t81+4*t2**3*t41*t48-4*t40*t48/t1**5)+5.0117958
     =         24473985d-2*t25*t77*t79+9.690227711544375d-4*t25*t72*t76+
     >         6.264085709464389d-2*t68*t69*t70*t71+1.5000000000000002d+
     ?         0*t4**3.333333333333333d-1*t49*t65)
            t91 = -6.848438000915293d-1*t10*t11*t51*t90/t52**2
            fnc(iq) = 3.0919459294469726d-3*t1*t6*t62*wght+fnc(iq)
            Amat(iq,D1_RA) = 3.0919459294469726d-3*t1*t6*t63*(-6.8484380
     1         00915293d-1*t10*t11*t55*t64*(t91-9.380220610476132d-1*t51
     2         *t56*t58*t90/t52**3.0d+0+1.8760441220952265d+0*t57*t58*t6
     3         6*t9**3.0d+0+t67)+6.848438000915293d-1*t10*t11*t60*(t91+t
     4         67)+1.3696876001830588d+0*t11*t55*t60*t66*t7*t8)*wght+6.1
     5         83891858893945d-3*t1*t4*t62*t65*wght+3.0919459294469726d-
     6         3*t6*t62*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 3.0919459294469726d-3*t1*t6*t63*(-6.848438
     1         000915293d-1*t10*t11*t55*(9.380220610476132d-1*t11*t56*t5
     2         7+6.848438000915293d-1*t10*t53)*t64+4.690110305238066d-1*
     3         t11*t53*t56*t60+6.848438000915293d-1*t10*t55*t60)*wght+Cm
     4         at(iq,D1_GAA)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = rhob**1.1666666666666667d+0
            t2 = 1/t1**2.0d+0
            t3 = sigmabb+2.0d+0*sigmaab+gammabb
            t4 = rhob**3.333333333333333d-1
            t5 = t4**5.0d-1
            t6 = 1/t5
            t7 = 1/t4
            t8 = 4.9237251092134837d-1*t7
            t9 = t8+2.615517080950829d+0*t6+1.29352d+1
            t10 = abs(t9)
            t11 = 1/t10
            t12 = abs(t7)
            t13 = 7.016926042943223d-1*t6
            t14 = t13+1.0498d-1
            t15 = t14**2
            t16 = t8+7.936634539391791d-1*t6+1.30045d+1
            t17 = abs(t16)
            t18 = 1/t17
            t19 = t13+4.7584000000000004d-3
            t20 = t19**2
            t21 = 1.4033852085886447d+0*t6
            t22 = t21+1.13107d+0
            t23 = t21+3.72744d+0
            t24 = exp(-3.234209209405096d+2*(3.8783294878113006d-2*atan(
     1         6.15199081975908d+0/t23)-1.1250000000000002d+0*(-5.365091
     2         848883601d-3*atan(7.123108917818117d+0/t22)-6.99173235076
     3         4465d-6*log(1.0d+0*t18*t20)-1.688686394038963d-2*log(4.92
     4         37251092134837d-1*t12*t18))+9.690227711544375d-4*log(1.0d
     5         +0*t11*t15)+3.10907d-2*log(4.9237251092134837d-1*t11*t12)
     6         ))
            t25 = t24-1.0d+0
            t26 = 1/t25
            t27 = 1.358902210873991d-1*t2*t26*t3
            t28 = t27+1.0d+0
            t29 = 1/t1**4.0d+0
            t30 = 1/t25**2.0d+0
            t31 = t3**2.0d+0
            t32 = 1.8466152187182203d-2*t29*t30*t31+t27+1.0d+0
            t33 = 1/t32
            t34 = 1.358902210873991d-1*t2*t28*t3*t33+1.0d+0
            t35 = log(t34)
            t36 = 1/t34
            t37 = 1/t32**2
            t38 = rhob**1.6666666666666674d-1
            t39 = 1/t1**3.0d+0
            t40 = -3.170771825372646d-1*t26*t3*t38*t39
            t41 = 1/t12
            t42 = -1.6412417030711612d-1/rhob**1.3333333333333333d+0
            t43 = 1/t5**3
            t44 = 1/rhob**6.666666666666667d-1
            t45 = t42-4.359195134918048d-1*t43*t44
            t46 = 1/t9
            t47 = 1/rhob**1.6666666666666666d+0
            t48 = 1/t23**2
            t49 = t42-1.3227724232319651d-1*t43*t44
            t50 = 1/t16
            t51 = 1/t22**2
            t52 = -1.1250000000000002d+0*(-8.93865943580678d-3*t43*t44*t
     1         51/(5.07386806551d+1*t51+1)-6.991732350764465d-6*t17*(-1.
     2         0d+0*t18*t20*t49*t50-2.338975347647741d-1*t18*t19*t43*t44
     3         )/t20-3.429692674920095d-2*t17*t41*(-4.9237251092134837d-
     4         1*t12*t18*t49*t50-1.6412417030711612d-1*t18*t41*t47))+5.5
     5         80665928883042d-2*t43*t44*t48/(3.784699104639999d+1*t48+1
     6         )+6.314467057030003d-2*t10*t41*(-1.6412417030711612d-1*t1
     7         1*t41*t47-4.9237251092134837d-1*t11*t12*t45*t46)+9.690227
     8         711544375d-4*t10*(-1.0d+0*t11*t15*t45*t46-2.3389753476477
     9         41d-1*t11*t14*t43*t44)/t15
            t53 = 4.394974045089608d+1*t2*t24*t3*t52/t25**2
            fnc(iq) = 6.183891858893945d-3*rhob*t35*wght+fnc(iq)
            Amat(iq,D1_RB) = 6.183891858893945d-3*rhob*t36*(-1.358902210
     1         873991d-1*t2*t28*t3*t37*(t53+1.1944679893212148d+1*t24*t2
     2         9*t31*t52/t25**3.0d+0+t40-8.617537687351695d-2*t30*t31*t3
     3         8/t1**5.0d+0)+1.358902210873991d-1*t2*t3*t33*(t53+t40)-3.
     4         170771825372646d-1*t28*t3*t33*t38*t39)*wght+6.18389185889
     5         3945d-3*t35*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GBB) = 6.183891858893945d-3*rhob*t36*(-1.35890221
     1         0873991d-1*t2*t28*t3*(3.6932304374364405d-2*t29*t3*t30+1.
     2         358902210873991d-1*t2*t26)*t37+1.8466152187182205d-2*t26*
     3         t29*t3*t33+1.358902210873991d-1*t2*t28*t33)*wght+Cmat(iq,
     4         D1_GBB)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_p91_vwn5 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& -\rho_\beta\\\\ 
C>   {\it t_3} &=& {\it t_2}+\rho_\alpha\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& 1.0-{\it t_3}\,{\it t_4}\\\\ 
C>   {\it t_6} &=& {\it t_3}\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.5\,{\it t_6}^{{{2}\over{3}}}+0.5\,{\it t_5}^{{{2}\over{3}}}\\\\ 
C>   {\it t_8} &=& {\it t_7}^{3.0}\\\\ 
C>   {\it t_9} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_9}^{2.0}}}\\\\ 
C>   {\it t_{11}} &=& {{1}\over{{\it t_7}^{2.0}}}\\\\ 
C>   {\it t_{12}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{13}} &=& \sigma_{\beta\beta}+{\it t_{12}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{14}} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{\sqrt{{\it t_{14}}}}}\\\\ 
C>   {\it t_{16}} &=& 1.575246635799487\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{16}}+3.72744}}\right)\\\\ 
C>   {\it t_{18}} &=& 0.7876233178997433\,{\it t_{15}}\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{20}} &=& 0.6203504908994001\,{\it t_{19}}\\\\ 
C>   {\it t_{21}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{15}}+{\it t_{20}}+12.9352\right| }}\\\\ 
C>   {\it t_{22}} &=& \log \left(1.0\,\left({\it t_{18}}+0.10498\right)^2\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{23}} &=& \left| {\it t_{19}}\right| \\\\ 
C>   {\it t_{24}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{25}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{16}}+1.13107}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{15}}+{\it t_{20}}+13.0045\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_{18}}+0.0047584\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{15}}+{\it t_{20}}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& {{1}\over{e^{{{40.4276151175637\,\left(1.125\,\left({\it t_6}^{{{4}\over{3}}}+{\it t_5}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_3}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{29}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{18}}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{24}}-9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{16}}+7.06042}}\right)-0.03878329487811301\,{\it t_{17}}\right)+0.01688686394038963\,{\it t_{28}}+6.991732350764465 \times 10^{-6}\,{\it t_{27}}+0.005365091848883601\,{\it t_{25}}\right)}\over{{\it t_1}^4}}-0.01688686394038963\,{\it t_{28}}-6.991732350764465 \times 10^{-6}\,{\it t_{27}}-0.005365091848883601\,{\it t_{25}}\right)+0.0310907\,{\it t_{24}}+9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.03878329487811301\,{\it t_{17}}\right)}\over{{\it t_8}}}}}}-1.0\\\\ 
C>   {\it t_{31}} &=& {{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}}\over{{\it t_{30}}}}\\\\ 
C>   {\it t_{32}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{33}} &=& \rho_s+{\it t_2}\\\\ 
C>   {\it t_{34}} &=& {{{\it t_{33}}}\over{{\it t_{32}}}}+1.0\\\\ 
C>   {\it t_{35}} &=& \left| {\it t_{34}}\right| ^{2.0}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{32}}^{1.166666666666667}\,{\it t_{34}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {\it t_{36}}^{2.0}\\\\ 
C>   {\it t_{38}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{12}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{32}}^{0.3333333333333333}\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\sqrt{{\it t_{39}}}}}\\\\ 
C>   {\it t_{41}} &=& 1.575246635799487\,{\it t_{40}}\\\\ 
C>   {\it t_{42}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{41}}+3.72744}}\right)\\\\ 
C>   {\it t_{43}} &=& 0.7876233178997433\,{\it t_{40}}\\\\ 
C>   {\it t_{44}} &=& {{1}\over{{\it t_{39}}}}\\\\ 
C>   {\it t_{45}} &=& 0.6203504908994001\,{\it t_{44}}\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{40}}+{\it t_{45}}+12.9352\right| }}\\\\ 
C>   {\it t_{47}} &=& \log \left(1.0\,\left({\it t_{43}}+0.10498\right)^2\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{48}} &=& \left| {\it t_{44}}\right| \\\\ 
C>   {\it t_{49}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{50}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{41}}+1.13107}}\right)\\\\ 
C>   {\it t_{51}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{40}}+{\it t_{45}}+13.0045\right| }}\\\\ 
C>   {\it t_{52}} &=& \log \left(1.0\,\left({\it t_{43}}+0.0047584\right)^2\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{53}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{54}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{40}}+{\it t_{45}}+18.0578\right| }}\\\\ 
C>   {\it t_{55}} &=& {{1}\over{e^{{{323.4209209405096\,\left(1.125\,\left({\it t_{34}}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_{33}}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{54}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{43}}+0.325\right)^2\,{\it t_{54}}\right)-0.0310907\,{\it t_{49}}-9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{41}}+7.06042}}\right)-0.03878329487811301\,{\it t_{42}}\right)+0.01688686394038963\,{\it t_{53}}+6.991732350764465 \times 10^{-6}\,{\it t_{52}}+0.005365091848883601\,{\it t_{50}}\right)}\over{{\it t_{32}}^4}}-0.01688686394038963\,{\it t_{53}}-6.991732350764465 \times 10^{-6}\,{\it t_{52}}-0.005365091848883601\,{\it t_{50}}\right)+0.0310907\,{\it t_{49}}+9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.03878329487811301\,{\it t_{42}}\right)}\over{{\it t_{35}}}}}}}-1.0\\\\ 
C>   {\it t_{56}} &=& {{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}}\over{{\it t_{55}}}}\\\\ 
C>   f &=& 0.02473556743557578\,{\it t_1}\,{\it t_8}\,\log \left({{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}\,\left({\it t_{31}}+1.0\right)}\over{{{0.02931318940773791\,{\it t_{13}}^{2.0}}\over{{\it t_9}^{4.0}\,{\it t_7}^{4.0}\,{\it t_{30}}^{2.0}}}+{\it t_{31}}+1.0}}+1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 0.003091945929446973\,{\it t_{32}}\,{\it t_{35}}\,\log \left({{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}\,\left({\it t_{56}}+1.0\right)}\over{{{0.4690110305238066\,{\it t_{36}}^{4.0}\,{\it t_{38}}^{2.0}}\over{{\it t_{55}}^{2.0}}}+{\it t_{56}}+1.0}}+1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] unpublished , DOI: 
C> <a href="http://dx.doi.org/unpublished "> 
C> unpublished </a> 
C> 
      subroutine nwxcm_c_p91_vwn5_d2(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Cmat,Cmat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_p91_vwn5 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& -\rho_\beta\\\\ 
C>   {\it t_3} &=& {\it t_2}+\rho_\alpha\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& 1.0-{\it t_3}\,{\it t_4}\\\\ 
C>   {\it t_6} &=& {\it t_3}\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.5\,{\it t_6}^{{{2}\over{3}}}+0.5\,{\it t_5}^{{{2}\over{3}}}\\\\ 
C>   {\it t_8} &=& {\it t_7}^{3.0}\\\\ 
C>   {\it t_9} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_9}^{2.0}}}\\\\ 
C>   {\it t_{11}} &=& {{1}\over{{\it t_7}^{2.0}}}\\\\ 
C>   {\it t_{12}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{13}} &=& \sigma_{\beta\beta}+{\it t_{12}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{14}} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{\sqrt{{\it t_{14}}}}}\\\\ 
C>   {\it t_{16}} &=& 1.575246635799487\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{16}}+3.72744}}\right)\\\\ 
C>   {\it t_{18}} &=& 0.7876233178997433\,{\it t_{15}}\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{20}} &=& 0.6203504908994001\,{\it t_{19}}\\\\ 
C>   {\it t_{21}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{15}}+{\it t_{20}}+12.9352\right| }}\\\\ 
C>   {\it t_{22}} &=& \log \left(1.0\,\left({\it t_{18}}+0.10498\right)^2\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{23}} &=& \left| {\it t_{19}}\right| \\\\ 
C>   {\it t_{24}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{21}}\right)\\\\ 
C>   {\it t_{25}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{16}}+1.13107}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{15}}+{\it t_{20}}+13.0045\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_{18}}+0.0047584\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{15}}+{\it t_{20}}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& {{1}\over{e^{{{40.4276151175637\,\left(1.125\,\left({\it t_6}^{{{4}\over{3}}}+{\it t_5}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_3}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{23}}\,{\it t_{29}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{18}}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{24}}-9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{16}}+7.06042}}\right)-0.03878329487811301\,{\it t_{17}}\right)+0.01688686394038963\,{\it t_{28}}+6.991732350764465 \times 10^{-6}\,{\it t_{27}}+0.005365091848883601\,{\it t_{25}}\right)}\over{{\it t_1}^4}}-0.01688686394038963\,{\it t_{28}}-6.991732350764465 \times 10^{-6}\,{\it t_{27}}-0.005365091848883601\,{\it t_{25}}\right)+0.0310907\,{\it t_{24}}+9.690227711544375 \times 10^{-4}\,{\it t_{22}}+0.03878329487811301\,{\it t_{17}}\right)}\over{{\it t_8}}}}}}-1.0\\\\ 
C>   {\it t_{31}} &=& {{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}}\over{{\it t_{30}}}}\\\\ 
C>   {\it t_{32}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{33}} &=& \rho_s+{\it t_2}\\\\ 
C>   {\it t_{34}} &=& {{{\it t_{33}}}\over{{\it t_{32}}}}+1.0\\\\ 
C>   {\it t_{35}} &=& \left| {\it t_{34}}\right| ^{2.0}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{32}}^{1.166666666666667}\,{\it t_{34}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {\it t_{36}}^{2.0}\\\\ 
C>   {\it t_{38}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{12}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{32}}^{0.3333333333333333}\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\sqrt{{\it t_{39}}}}}\\\\ 
C>   {\it t_{41}} &=& 1.575246635799487\,{\it t_{40}}\\\\ 
C>   {\it t_{42}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{41}}+3.72744}}\right)\\\\ 
C>   {\it t_{43}} &=& 0.7876233178997433\,{\it t_{40}}\\\\ 
C>   {\it t_{44}} &=& {{1}\over{{\it t_{39}}}}\\\\ 
C>   {\it t_{45}} &=& 0.6203504908994001\,{\it t_{44}}\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{40}}+{\it t_{45}}+12.9352\right| }}\\\\ 
C>   {\it t_{47}} &=& \log \left(1.0\,\left({\it t_{43}}+0.10498\right)^2\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{48}} &=& \left| {\it t_{44}}\right| \\\\ 
C>   {\it t_{49}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{46}}\right)\\\\ 
C>   {\it t_{50}} &=& \arctan \left({{7.123108917818118}\over{{\it t_{41}}+1.13107}}\right)\\\\ 
C>   {\it t_{51}} &=& {{1}\over{\left| 0.8908571061768626\,{\it t_{40}}+{\it t_{45}}+13.0045\right| }}\\\\ 
C>   {\it t_{52}} &=& \log \left(1.0\,\left({\it t_{43}}+0.0047584\right)^2\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{53}} &=& \log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{51}}\right)\\\\ 
C>   {\it t_{54}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{40}}+{\it t_{45}}+18.0578\right| }}\\\\ 
C>   {\it t_{55}} &=& {{1}\over{e^{{{323.4209209405096\,\left(1.125\,\left({\it t_{34}}^{{{4}\over{3}}}-2.0\right)\,\left({{{\it t_{33}}^4\,\left(1.709920934161365\,\left(0.01554535\,\log \left(0.6203504908994001\,{\it t_{48}}\,{\it t_{54}}\right)+0.002247867095542611\,\log \left(1.0\,\left({\it t_{43}}+0.325\right)^2\,{\it t_{54}}\right)-0.0310907\,{\it t_{49}}-9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{41}}+7.06042}}\right)-0.03878329487811301\,{\it t_{42}}\right)+0.01688686394038963\,{\it t_{53}}+6.991732350764465 \times 10^{-6}\,{\it t_{52}}+0.005365091848883601\,{\it t_{50}}\right)}\over{{\it t_{32}}^4}}-0.01688686394038963\,{\it t_{53}}-6.991732350764465 \times 10^{-6}\,{\it t_{52}}-0.005365091848883601\,{\it t_{50}}\right)+0.0310907\,{\it t_{49}}+9.690227711544375 \times 10^{-4}\,{\it t_{47}}+0.03878329487811301\,{\it t_{42}}\right)}\over{{\it t_{35}}}}}}}-1.0\\\\ 
C>   {\it t_{56}} &=& {{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}}\over{{\it t_{55}}}}\\\\ 
C>   f &=& 0.02473556743557578\,{\it t_1}\,{\it t_8}\,\log \left({{0.1712109500228823\,{\it t_{10}}\,{\it t_{11}}\,{\it t_{13}}\,\left({\it t_{31}}+1.0\right)}\over{{{0.02931318940773791\,{\it t_{13}}^{2.0}}\over{{\it t_9}^{4.0}\,{\it t_7}^{4.0}\,{\it t_{30}}^{2.0}}}+{\it t_{31}}+1.0}}+1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 0.003091945929446973\,{\it t_{32}}\,{\it t_{35}}\,\log \left({{0.6848438000915293\,{\it t_{37}}\,{\it t_{38}}\,\left({\it t_{56}}+1.0\right)}\over{{{0.4690110305238066\,{\it t_{36}}^{4.0}\,{\it t_{38}}^{2.0}}\over{{\it t_{55}}^{2.0}}}+{\it t_{56}}+1.0}}+1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] unpublished , DOI: 
C> <a href="http://dx.doi.org/unpublished "> 
C> unpublished </a> 
C> 
      subroutine nwxcm_c_p91_vwn5_d3(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Amat3, 
     +Cmat,Cmat2,Cmat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,*)  !< [Output] The 3rd derivative wrt rho 
      double precision Cmat3(nq,*)  !< [Output] The 3rd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
