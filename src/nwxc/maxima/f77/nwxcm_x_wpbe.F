C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_x_wpbe.F 
C> The nwxcm_x_wpbe functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_x_wpbe functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {{1}\over{\rho_\alpha^4}}\\\\ 
C>   {\it t_4} &=& \sqrt{\sigma_{\alpha\alpha}}\\\\ 
C>   {\it t_5} &=& {\it t_4}^3\\\\ 
C>   {\it t_6} &=& {{1}\over{\rho_\alpha^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_7} &=& \sigma_{\alpha\alpha}^2\\\\ 
C>   {\it t_8} &=& {{1}\over{\rho_\alpha^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_9} &=& {\it t_4}^5\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^8}}\\\\ 
C>   {\it t_{11}} &=& \sigma_{\alpha\alpha}^3\\\\ 
C>   {\it t_{12}} &=& {{1}\over{\rho_\alpha^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{13}} &=& {\it t_4}^7\\\\ 
C>   {\it t_{14}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{12}}\,{\it t_{13}}-4.327677396975467 \times 10^{-7}\,{\it t_{10}}\,{\it t_{11}}+5.3020963068324 \times 10^{-6}\,{\it t_8}\,{\it t_9}-4.342399100269002 \times 10^{-5}\,{\it t_6}\,{\it t_7}+1.800551313354082 \times 10^{-4}\,{\it t_3}\,{\it t_5}+2.631878392200375 \times 10^{-4}\,{\it t_2}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_4}^9}\over{\rho_\alpha^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\alpha\alpha}^4}\over{\rho_\alpha^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{12}}\,{\it t_{13}}-2.719683267627703 \times 10^{-6}\,{\it t_{10}}\,{\it t_{11}}+5.955909787676884 \times 10^{-5}\,{\it t_8}\,{\it t_9}-0.001383706469760652\,{\it t_6}\,{\it t_7}+0.02342799068769956\,{\it t_3}\,{\it t_5}-0.2053293313026446\,{\it t_2}\,\sigma_{\alpha\alpha}+{{0.6841322473346062\,{\it t_4}}\over{{\it t_1}}}+1.0}}\\\\ 
C>   {\it t_{16}} &=& 0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& {\it t_{16}}+0.60965\\\\ 
C>   {\it t_{18}} &=& 0.06934448603031025\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}+{{0.005136628594837796\,{\it t_2}\,\sigma_{\alpha\alpha}}\over{0.00411382696150514\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}+1.0\\\\ 
C>   {\it t_{19}} &=& {\it t_{17}}^{3.5}\\\\ 
C>   {\it t_{20}} &=& {\it t_{16}}+0.757211\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{22}} &=& {{1}\over{\rho_\alpha^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{23}} &=& {\it t_{16}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{22}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{24}} &=& {{1}\over{\sqrt{{\it t_{23}}}}}\\\\ 
C>   {\it t_{25}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& {\it t_{23}}\,{\it t_{25}}\\\\ 
C>   {\it t_{27}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\\\\ 
C>   {\it t_{28}} &=& {\it t_{21}}^2\\\\ 
C>   {\it t_{29}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\alpha^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{30}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}}\\\\ 
C>   {\it t_{31}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.757211}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{{\it t_{31}}+{\it t_{30}}}}\\\\ 
C>   {\it t_{33}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.60965}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}+{\it t_{27}}}}\\\\ 
C>   {\it t_{35}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{\rho_\beta^4}}\\\\ 
C>   {\it t_{38}} &=& \sqrt{\sigma_{\beta\beta}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{38}}^3\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\rho_\beta^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{41}} &=& \sigma_{\beta\beta}^2\\\\ 
C>   {\it t_{42}} &=& {{1}\over{\rho_\beta^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{43}} &=& {\it t_{38}}^5\\\\ 
C>   {\it t_{44}} &=& {{1}\over{\rho_\beta^8}}\\\\ 
C>   {\it t_{45}} &=& \sigma_{\beta\beta}^3\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\rho_\beta^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{47}} &=& {\it t_{38}}^7\\\\ 
C>   {\it t_{48}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{46}}\,{\it t_{47}}-4.327677396975467 \times 10^{-7}\,{\it t_{44}}\,{\it t_{45}}+5.3020963068324 \times 10^{-6}\,{\it t_{42}}\,{\it t_{43}}-4.342399100269002 \times 10^{-5}\,{\it t_{40}}\,{\it t_{41}}+1.800551313354082 \times 10^{-4}\,{\it t_{37}}\,{\it t_{39}}+2.631878392200375 \times 10^{-4}\,{\it t_{36}}\,\sigma_{\beta\beta}\\\\ 
C>   {\it t_{49}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{38}}^9}\over{\rho_\beta^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\beta\beta}^4}\over{\rho_\beta^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{46}}\,{\it t_{47}}-2.719683267627703 \times 10^{-6}\,{\it t_{44}}\,{\it t_{45}}+5.955909787676884 \times 10^{-5}\,{\it t_{42}}\,{\it t_{43}}-0.001383706469760652\,{\it t_{40}}\,{\it t_{41}}+0.02342799068769956\,{\it t_{37}}\,{\it t_{39}}-0.2053293313026446\,{\it t_{36}}\,\sigma_{\beta\beta}+{{0.6841322473346062\,{\it t_{38}}}\over{{\it t_{35}}}}+1.0}}\\\\ 
C>   {\it t_{50}} &=& 0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\\\\ 
C>   {\it t_{51}} &=& {\it t_{50}}+0.60965\\\\ 
C>   {\it t_{52}} &=& 0.06934448603031025\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}+{{0.005136628594837796\,{\it t_{36}}\,\sigma_{\beta\beta}}\over{0.00411382696150514\,{\it t_{36}}\,\sigma_{\beta\beta}+1.0}}+1.0\\\\ 
C>   {\it t_{53}} &=& {\it t_{51}}^{3.5}\\\\ 
C>   {\it t_{54}} &=& {\it t_{50}}+0.757211\\\\ 
C>   {\it t_{55}} &=& {{1}\over{\rho_\beta^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{56}} &=& {\it t_{50}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{55}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{57}} &=& {{1}\over{\sqrt{{\it t_{56}}}}}\\\\ 
C>   {\it t_{58}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\\\\ 
C>   {\it t_{59}} &=& {\it t_{56}}\,{\it t_{58}}\\\\ 
C>   {\it t_{60}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\\\\ 
C>   {\it t_{61}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\beta^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{62}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}}\\\\ 
C>   {\it t_{63}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.757211}\\\\ 
C>   {\it t_{64}} &=& {{1}\over{{\it t_{63}}+{\it t_{62}}}}\\\\ 
C>   {\it t_{65}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.60965}\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{65}}+{\it t_{60}}}}\\\\ 
C>   {\it t_{67}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {{1}\over{\rho_s^4}}\\\\ 
C>   {\it t_{70}} &=& \sqrt{\sigma_{ss}}\\\\ 
C>   {\it t_{71}} &=& {\it t_{70}}^3\\\\ 
C>   {\it t_{72}} &=& {{1}\over{\rho_s^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{73}} &=& \sigma_{ss}^2\\\\ 
C>   {\it t_{74}} &=& {{1}\over{\rho_s^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{75}} &=& {\it t_{70}}^5\\\\ 
C>   {\it t_{76}} &=& {{1}\over{\rho_s^8}}\\\\ 
C>   {\it t_{77}} &=& \sigma_{ss}^3\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {\it t_{70}}^7\\\\ 
C>   {\it t_{80}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{78}}\,{\it t_{79}}-4.327677396975467 \times 10^{-7}\,{\it t_{76}}\,{\it t_{77}}+5.3020963068324 \times 10^{-6}\,{\it t_{74}}\,{\it t_{75}}-4.342399100269002 \times 10^{-5}\,{\it t_{72}}\,{\it t_{73}}+1.800551313354082 \times 10^{-4}\,{\it t_{69}}\,{\it t_{71}}+2.631878392200375 \times 10^{-4}\,{\it t_{68}}\,\sigma_{ss}\\\\ 
C>   {\it t_{81}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{70}}^9}\over{\rho_s^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{ss}^4}\over{\rho_s^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{78}}\,{\it t_{79}}-2.719683267627703 \times 10^{-6}\,{\it t_{76}}\,{\it t_{77}}+5.955909787676884 \times 10^{-5}\,{\it t_{74}}\,{\it t_{75}}-0.001383706469760652\,{\it t_{72}}\,{\it t_{73}}+0.02342799068769956\,{\it t_{69}}\,{\it t_{71}}-0.2053293313026446\,{\it t_{68}}\,\sigma_{ss}+{{0.6841322473346062\,{\it t_{70}}}\over{{\it t_{67}}}}+1.0}}\\\\ 
C>   {\it t_{82}} &=& 0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\\\\ 
C>   {\it t_{83}} &=& {\it t_{82}}+0.60965\\\\ 
C>   {\it t_{84}} &=& 0.06934448603031025\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}+{{0.005136628594837796\,{\it t_{68}}\,\sigma_{ss}}\over{0.00411382696150514\,{\it t_{68}}\,\sigma_{ss}+1.0}}+1.0\\\\ 
C>   {\it t_{85}} &=& {\it t_{83}}^{3.5}\\\\ 
C>   {\it t_{86}} &=& {\it t_{82}}+0.757211\\\\ 
C>   {\it t_{87}} &=& {{1}\over{\rho_s^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{82}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{87}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{89}} &=& {{1}\over{\sqrt{{\it t_{88}}}}}\\\\ 
C>   {\it t_{90}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\\\\ 
C>   {\it t_{91}} &=& {\it t_{88}}\,{\it t_{90}}\\\\ 
C>   {\it t_{92}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\\\\ 
C>   {\it t_{93}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_s^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{94}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}}\\\\ 
C>   {\it t_{95}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.757211}\\\\ 
C>   {\it t_{96}} &=& {{1}\over{{\it t_{95}}+{\it t_{94}}}}\\\\ 
C>   {\it t_{97}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.60965}\\\\ 
C>   {\it t_{98}} &=& {{1}\over{{\it t_{97}}+{\it t_{92}}}}\\\\ 
C>   f &=& -0.9305257363491\,{\it t_{35}}\,\left(-2.0\,{\it t_{54}}\,\log \left({{0.1475609999999999\,{\it t_{66}}}\over{{\it t_{63}}+{\it t_{65}}}}+1.0\right)+0.03291061569204112\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,\log \left(1.0-{{0.60965\,{\it t_{66}}}\over{{\it t_{65}}+{\it t_{62}}}}\right)+0.757211\,\left({{{\it t_{54}}\,{\it t_{64}}}\over{{\it t_{63}}+{\it t_{60}}}}+{{0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,{\it t_{64}}}\over{{\it t_{62}}+{\it t_{60}}}}\right)+{{0.05273288888888888\,{\it t_{52}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{56}}\,{\it t_{58}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{53}}\,\left(0.1282782438530422\,\sqrt{{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}}-\sqrt{{\it t_{54}}}\right)-1.417963080724413\,{\it t_{53}}-0.9086531999999999\,{\it t_{51}}^{3.0}+0.02836373333333333\,{\it t_{51}}^{2.0}+0.0474596\,{\it t_{51}}\,{\it t_{52}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{3.0}}}-1.0\right)-0.9305257363491\,{\it t_1}\,\left(-2.0\,{\it t_{20}}\,\log \left({{0.1475609999999999\,{\it t_{34}}}\over{{\it t_{31}}+{\it t_{33}}}}+1.0\right)+0.03291061569204112\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,\log \left(1.0-{{0.60965\,{\it t_{34}}}\over{{\it t_{33}}+{\it t_{30}}}}\right)+0.757211\,\left({{{\it t_{20}}\,{\it t_{32}}}\over{{\it t_{31}}+{\it t_{27}}}}+{{0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,{\it t_{32}}}\over{{\it t_{30}}+{\it t_{27}}}}\right)+{{0.05273288888888888\,{\it t_{18}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{23}}\,{\it t_{25}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{19}}\,\left(0.1282782438530422\,\sqrt{{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}}-\sqrt{{\it t_{20}}}\right)-1.417963080724413\,{\it t_{19}}-0.9086531999999999\,{\it t_{17}}^{3.0}+0.02836373333333333\,{\it t_{17}}^{2.0}+0.0474596\,{\it t_{17}}\,{\it t_{18}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{3.0}}}-1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& -0.9305257363491\,{\it t_{67}}\,\left(-2.0\,{\it t_{86}}\,\log \left({{0.1475609999999999\,{\it t_{98}}}\over{{\it t_{95}}+{\it t_{97}}}}+1.0\right)+0.03291061569204112\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,\log \left(1.0-{{0.60965\,{\it t_{98}}}\over{{\it t_{97}}+{\it t_{94}}}}\right)+0.757211\,\left({{{\it t_{86}}\,{\it t_{96}}}\over{{\it t_{95}}+{\it t_{92}}}}+{{0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,{\it t_{96}}}\over{{\it t_{94}}+{\it t_{92}}}}\right)+{{0.05273288888888888\,{\it t_{84}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{88}}\,{\it t_{90}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{85}}\,\left(0.1282782438530422\,\sqrt{{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}}-\sqrt{{\it t_{86}}}\right)-1.417963080724413\,{\it t_{85}}-0.9086531999999999\,{\it t_{83}}^{3.0}+0.02836373333333333\,{\it t_{83}}^{2.0}+0.0474596\,{\it t_{83}}\,{\it t_{84}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{3.0}}}-1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] E Weintraub, TM Henderson, GE Scuseria, J.Chem.Theory.Comput. 5, 754 (2009)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800530u "> 
C> 10.1021/ct800530u </a> 
C> 
      subroutine nwxcm_x_wpbe(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Cmat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
            t1 = param(1)
            t2 = rhoa**3.333333333333333d-1
            t3 = 1/t2
            t4 = t1*t3
            t5 = gammaaa**5.0d-1
            t6 = t5**7
            t7 = 1/rhoa**9.333333333333333d+0
            t8 = gammaaa**3
            t9 = 1/rhoa**8
            t10 = t5**5
            t11 = 1/rhoa**6.666666666666667d+0
            t12 = gammaaa**2
            t13 = 1/rhoa**5.333333333333333d+0
            t14 = t5**3
            t15 = 1/rhoa**4
            t16 = 1/rhoa**2.6666666666666666d+0
            t17 = -4.327677396975467d-7*t8*t9+2.4123830247695402d-8*t6*t
     1         7+2.631878392200375d-4*gammaaa*t16+1.8005513133540818d-4*
     2         t14*t15-4.342399100269002d-5*t12*t13+5.3020963068324d-6*t
     3         10*t11
            t18 = t5**9
            t19 = 1/rhoa**12
            t20 = gammaaa**4
            t21 = 1/rhoa**1.0666666666666666d+1
            t22 = rhoa**1.3333333333333333d+0
            t23 = 1/t22
            t24 = -2.7196832676277033d-6*t8*t9+1.7578986477855002d-7*t6*
     1         t7+6.841322473346062d-1*t23*t5-5.649671283776346d-9*t20*t
     2         21+3.149302550983647d-10*t18*t19-2.0532933130264455d-1*ga
     3         mmaaa*t16+2.342799068769956d-2*t14*t15-1.3837064697606524
     4         d-3*t12*t13+5.955909787676884d-5*t10*t11+1.0d+0
            t25 = 1/t24
            t26 = 1.6455307846020562d-2*gammaaa*t16*t17*t25
            t27 = 6.582123138408225d-2*t4**2.0d+0+t26+6.0965d-1
            t28 = 1/t27
            t29 = t27**5.0d-1
            t30 = 1/t29
            t31 = 2.565564877060844d-1*t1*t3*t30+1.0d+0
            t32 = 1/t31
            t33 = 4.1138269615051404d-3*gammaaa*t16+1.0d+0
            t34 = 1/t33
            t35 = 5.136628594837797d-3*gammaaa*t16*t34+6.934448603031025
     1         d-2*gammaaa*t16*t17*t25+1.0d+0
            t36 = 1.282782438530422d-1*t1*t3*t30+1.0d+0
            t37 = t27*t31
            t38 = 1/t37**2.0d+0
            t39 = t1**2
            t40 = 1/rhoa**6.666666666666666d-1
            t41 = 6.582123138408225d-2*t39*t40
            t42 = (t41+t26)**5.0d-1
            t43 = (t41+t26+6.0965d-1)**5.0d-1
            t44 = t43+t42
            t45 = 1/t44
            t46 = 2.565564877060844d-1*t1*t3
            t47 = t46+t43
            t48 = 1/t47
            t49 = 1.0d+0-6.0965d-1*t45*t48
            t50 = log(t49)
            t51 = (t41+t26+7.57211d-1)**5.0d-1
            t52 = t51+t43
            t53 = 1/t52
            t54 = 1.475609999999999d-1*t48*t53+1.0d+0
            t55 = log(t54)
            t56 = t26+7.57211d-1
            t57 = t51+t42
            t58 = 1/t57
            t59 = t51+t46
            t60 = 1/t59
            t61 = t46+t42
            t62 = 1/t61
            t63 = t26+6.0965d-1
            t64 = t63**2.0d+0
            t65 = t63**3.5d+0
            t66 = (gammaaa*t16*t17*t25)**5.0d-1
            t67 = t56**5.0d-1
            t68 = 1.282782438530422d-1*t66-t67
            t69 = -2.4d+0*t65*t68-1.417963080724413d+0*t65+2.83637333333
     1         3333d-2*t64-9.086531999999999d-1*t63**3.0d+0+4.7459599999
     2         999996d-2*t35*t63
            t70 = 1/t37**3.0d+0
            t71 = t1*t3*t30
            t72 = 2.4682961769030842d-2*t71**2.0d+0+2.8862604866934494d-
     1         1*t1*t3*t30+1.0d+0
            t73 = -8.888888888888888d-1*t69*t70*t72+7.57211d-1*(1.645530
     1         7846020562d-2*gammaaa*t16*t17*t25*t58*t62+t56*t58*t60)-2.
     2         0d+0*t55*t56+3.2910615692041123d-2*gammaaa*t16*t17*t25*t5
     3         0+5.273288888888887d-2*t35*t36*t38+4.727288888888889d-2*t
     4         28*t32-1.0d+0
            t74 = 1/t27**2
            t75 = 1/rhoa**3.6666666666666664d+0
            t76 = -4.38808209227215d-2*gammaaa*t17*t25*t75
            t77 = 1/rhoa**1.0333333333333333d+1
            t78 = 1/rhoa**9
            t79 = 1/rhoa**7.666666666666667d+0
            t80 = 1/rhoa**6.333333333333333d+0
            t81 = 1/rhoa**5
            t82 = -9.371196275079824d-2*t14*t81+7.379767838723479d-3*t12
     1         *t80+2.1757466141021625d-5*t78*t8-3.970606525117923d-4*t1
     2         0*t79-1.6407054045998d-6*t6*t77+5.475448834737188d-1*gamm
     3         aaa*t75-9.121763297794749d-1*t5/rhoa**2.3333333333333334d
     4         +0+6.026316036028103d-8*t20/rhoa**1.1666666666666665d+1-3
     5         .7791630611803767d-9*t18/rhoa**13
            t83 = 1/t24**2
            t84 = -1.6455307846020562d-2*gammaaa*t16*t17*t82*t83
            t85 = -7.202205253416327d-4*t14*t81+2.3159461868101344d-4*t1
     1         2*t80+3.462141917580374d-6*t78*t8-3.5347308712216d-5*t10*
     2         t79-2.2515574897849044d-7*t6*t77-7.018342379201d-4*gammaa
     3         a*t75
            t86 = 1.6455307846020562d-2*gammaaa*t16*t25*t85
            t87 = t86+t84+t76-4.38808209227215d-2*t1*t23*t4
            t88 = 1/t33**2
            t89 = 5.634986987915197d-5*t12*t80*t88+6.934448603031025d-2*
     1         gammaaa*t16*t25*t85-6.934448603031025d-2*gammaaa*t16*t17*
     2         t82*t83-1.369767625290079d-2*gammaaa*t34*t75-1.8491862941
     3         416065d-1*gammaaa*t17*t25*t75
            t90 = t86+t84+t76-4.38808209227215d-2*t39/rhoa**1.6666666666
     1         666669d+0
            t91 = 1/t43
            t92 = 5.0d-1*t90*t91
            t93 = -8.551882923536147d-2*t1*t23
            t94 = t93+t92
            t95 = 1/t47**2
            t96 = 1/t42
            t97 = 5.0d-1*t90*t96
            t98 = 1/t44**2
            t99 = 1/t49
            t100 = t86+t84+t76
            t101 = 1/t51
            t102 = 5.0d-1*t101*t90
            t103 = 1/t52**2
            t104 = 1/t54
            t105 = 1/t59**2
            t106 = t97+t102
            t107 = 1/t57**2
            t108 = 1/t61**2
            t109 = t63**2.5d+0
            t110 = 1/t67
            t111 = 1/t66
            t112 = 1/t31**2
            t113 = 1/t29**3
            t114 = -1.282782438530422d-1*t1*t113*t3*t87-8.55188292353614
     1         7d-2*t1*t23*t30
            t115 = t31*t87+t114*t27
            t116 = 1/t37**4.0d+0
            t117 = -8.159049802883108d-6*t12*t9-2.2598685135105387d-8*t2
     1         1*t8+6.15264526724925d-7*t10*t7+1.4171861479426412d-9*t19
     2         *t6+3.514198603154934d-2*t15*t5+3.420661236673031d-1*t23/
     3         t5-2.0532933130264455d-1*t16+1.488977446919221d-4*t11*t14
     4         -2.767412939521305d-3*gammaaa*t13
            t118 = -1.2983032190926402d-6*t12*t9+8.443340586693391d-8*t1
     1         0*t7+2.7008269700311227d-4*t15*t5+2.631878392200375d-4*t1
     2         6+1.3255240767081d-5*t11*t14-8.684798200538004d-5*gammaaa
     3         *t13
            t119 = -1.6455307846020562d-2*gammaaa*t117*t16*t17*t83+1.645
     1         5307846020562d-2*t16*t17*t25+1.6455307846020562d-2*gammaa
     2         a*t118*t16*t25
            t120 = -2.113120120468199d-5*gammaaa*t13*t88-6.9344486030310
     1         25d-2*gammaaa*t117*t16*t17*t83+5.136628594837797d-3*t16*t
     2         34+6.934448603031025d-2*t16*t17*t25+6.934448603031025d-2*
     3         gammaaa*t118*t16*t25
            t121 = 5.0d-1*t119*t96
            t122 = 5.0d-1*t119*t91
            t123 = 5.0d-1*t101*t119
            t124 = t123+t121
            t125 = t119*t31-1.282782438530422d-1*t1*t119*t3*t30
            t126 = -1.8610514726982d+0*t22*(3.2910615692041123d-2*gammaa
     1         a*t16*t17*t25*(6.0965d-1*(t122+t121)*t48*t98+3.04825d-1*t
     2         119*t45*t91*t95)*t99+7.57211d-1*(-8.227653923010281d-3*ga
     3         mmaaa*t108*t119*t16*t17*t25*t58*t96-1.6455307846020562d-2
     4         *gammaaa*t117*t16*t17*t58*t62*t83+1.6455307846020562d-2*t
     5         16*t17*t25*t58*t62+1.6455307846020562d-2*gammaaa*t118*t16
     6         *t25*t58*t62-1.6455307846020562d-2*gammaaa*t107*t124*t16*
     7         t17*t25*t62+t119*t58*t60-t107*t124*t56*t60-5.0d-1*t101*t1
     8         05*t119*t56*t58)-2.0d+0*t104*t56*(-7.378049999999994d-2*t
     9         119*t53*t91*t95-1.475609999999999d-1*t103*(t123+t122)*t48
     :         )+t70*(-8.888888888888888d-1*t72*(-2.4d+0*t65*(6.41391219
     ;         265211d-2*t111*(-gammaaa*t117*t16*t17*t83+t16*t17*t25+gam
     <         maaa*t118*t16*t25)-5.0d-1*t110*t119)-8.400000000000001d+0
     =         *t109*t119*t68-2.7259595999999997d+0*t119*t64+4.745959999
     >         9999996d-2*t120*t63+5.672746666666666d-2*t119*t63+4.74595
     ?         99999999996d-2*t119*t35-4.9628707825354457d+0*t109*t119)-
     @         8.888888888888888d-1*t69*(-2.4682961769030842d-2*t119*t39
     1         *t40*t74-1.4431302433467247d-1*t1*t113*t119*t3)-1.0546577
     2         777777776d-1*t125*t35*t36)-3.2910615692041123d-2*gammaaa*
     3         t117*t16*t17*t50*t83-4.727288888888889d-2*t119*t32*t74+2.
     4         6666666666666666d+0*t116*t125*t69*t72-2.0d+0*t119*t55+t16
     5         *t25*(3.2910615692041123d-2*t17*t50+3.2910615692041123d-2
     6         *gammaaa*t118*t50)+5.273288888888887d-2*t120*t36*t38-3.38
     7         22411899821336d-3*t1*t113*t119*t3*t35*t38+6.0640831685266
     8         58d-3*t1*t112*t119*t3/t29**5)*wght
            fnc(iq) = fnc(iq)-1.8610514726982d+0*t22*t73*wght
            Amat(iq,D1_RA) = -1.8610514726982d+0*t22*(3.2910615692041123
     1         d-2*gammaaa*t16*t17*t25*(6.0965d-1*t48*(t97+t92)*t98+6.09
     2         65d-1*t45*t94*t95)*t99+7.57211d-1*(-1.6455307846020562d-2
     3         *gammaaa*t108*t16*t17*t25*t58*(t97+t93)-t105*t56*t58*(t93
     4         +t102)+1.6455307846020562d-2*gammaaa*t16*t25*t58*t62*t85-
     5         1.6455307846020562d-2*gammaaa*t16*t17*t58*t62*t82*t83-4.3
     6         8808209227215d-2*gammaaa*t17*t25*t58*t62*t75-1.6455307846
     7         020562d-2*gammaaa*t106*t107*t16*t17*t25*t62+t100*t58*t60-
     8         t106*t107*t56*t60)-2.0d+0*t104*t56*(-1.475609999999999d-1
     9         *t53*t94*t95-1.475609999999999d-1*t103*t48*(t92+t102))-8.
     :         888888888888888d-1*t70*t72*(4.7459599999999996d-2*t63*t89
     ;         -2.4d+0*t65*(6.41391219265211d-2*t111*(gammaaa*t16*t25*t8
     <         5-gammaaa*t16*t17*t82*t83-2.6666666666666666d+0*gammaaa*t
     =         17*t25*t75)-5.0d-1*t100*t110)-8.400000000000001d+0*t100*t
     >         109*t68-2.7259595999999997d+0*t100*t64+5.672746666666666d
     ?         -2*t100*t63+4.7459599999999996d-2*t100*t35-4.962870782535
     @         4457d+0*t100*t109)+5.273288888888887d-2*t36*t38*t89-8.888
     1         888888888888d-1*t69*t70*(4.9365923538061685d-2*t71*(-5.0d
     2         -1*t1*t113*t3*t87-3.333333333333333d-1*t1*t23*t30)-1.4431
     3         302433467247d-1*t1*t113*t3*t87-9.620868288978164d-2*t1*t2
     4         3*t30)+5.273288888888887d-2*t35*t38*(-6.41391219265211d-2
     5         *t1*t113*t3*t87-4.2759414617680735d-2*t1*t23*t30)-4.72728
     6         8888888889d-2*t32*t74*t87+3.2910615692041123d-2*gammaaa*t
     7         16*t25*t50*t85-3.2910615692041123d-2*gammaaa*t16*t17*t50*
     8         t82*t83-8.7761641845443d-2*gammaaa*t17*t25*t50*t75+2.6666
     9         666666666666d+0*t115*t116*t69*t72-1.0546577777777776d-1*t
     :         115*t35*t36*t70-2.0d+0*t100*t55-4.727288888888889d-2*t112
     ;         *t114*t28)*wght-2.4814019635975998d+0*t2*t73*wght+Amat(iq
     <         ,D1_RA)
            Cmat(iq,D1_GAA) = t126+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t126+Cmat(iq,D1_GAB)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(1)
            t2 = rhoa**3.333333333333333d-1
            t3 = 1/t2
            t4 = t1*t3
            t5 = gammaaa**5.0d-1
            t6 = t5**7
            t7 = 1/rhoa**9.333333333333333d+0
            t8 = gammaaa**3
            t9 = 1/rhoa**8
            t10 = t5**5
            t11 = 1/rhoa**6.666666666666667d+0
            t12 = gammaaa**2
            t13 = 1/rhoa**5.333333333333333d+0
            t14 = t5**3
            t15 = 1/rhoa**4
            t16 = 1/rhoa**2.6666666666666666d+0
            t17 = -4.327677396975467d-7*t8*t9+2.4123830247695402d-8*t6*t
     1         7+2.631878392200375d-4*gammaaa*t16+1.8005513133540818d-4*
     2         t14*t15-4.342399100269002d-5*t12*t13+5.3020963068324d-6*t
     3         10*t11
            t18 = t5**9
            t19 = 1/rhoa**12
            t20 = gammaaa**4
            t21 = 1/rhoa**1.0666666666666666d+1
            t22 = rhoa**1.3333333333333333d+0
            t23 = 1/t22
            t24 = -2.7196832676277033d-6*t8*t9+1.7578986477855002d-7*t6*
     1         t7+6.841322473346062d-1*t23*t5-5.649671283776346d-9*t20*t
     2         21+3.149302550983647d-10*t18*t19-2.0532933130264455d-1*ga
     3         mmaaa*t16+2.342799068769956d-2*t14*t15-1.3837064697606524
     4         d-3*t12*t13+5.955909787676884d-5*t10*t11+1.0d+0
            t25 = 1/t24
            t26 = 1.6455307846020562d-2*gammaaa*t16*t17*t25
            t27 = 6.582123138408225d-2*t4**2.0d+0+t26+6.0965d-1
            t28 = 1/t27
            t29 = t27**5.0d-1
            t30 = 1/t29
            t31 = 2.565564877060844d-1*t1*t3*t30+1.0d+0
            t32 = 1/t31
            t33 = 4.1138269615051404d-3*gammaaa*t16+1.0d+0
            t34 = 1/t33
            t35 = 5.136628594837797d-3*gammaaa*t16*t34+6.934448603031025
     1         d-2*gammaaa*t16*t17*t25+1.0d+0
            t36 = 1.282782438530422d-1*t1*t3*t30+1.0d+0
            t37 = t27*t31
            t38 = 1/t37**2.0d+0
            t39 = t1**2
            t40 = 1/rhoa**6.666666666666666d-1
            t41 = 6.582123138408225d-2*t39*t40
            t42 = (t41+t26)**5.0d-1
            t43 = (t41+t26+6.0965d-1)**5.0d-1
            t44 = t43+t42
            t45 = 1/t44
            t46 = 2.565564877060844d-1*t1*t3
            t47 = t46+t43
            t48 = 1/t47
            t49 = 1.0d+0-6.0965d-1*t45*t48
            t50 = log(t49)
            t51 = (t41+t26+7.57211d-1)**5.0d-1
            t52 = t51+t43
            t53 = 1/t52
            t54 = 1.475609999999999d-1*t48*t53+1.0d+0
            t55 = log(t54)
            t56 = t26+7.57211d-1
            t57 = t51+t42
            t58 = 1/t57
            t59 = t51+t46
            t60 = 1/t59
            t61 = t46+t42
            t62 = 1/t61
            t63 = t26+6.0965d-1
            t64 = t63**2.0d+0
            t65 = t63**3.5d+0
            t66 = (gammaaa*t16*t17*t25)**5.0d-1
            t67 = t56**5.0d-1
            t68 = 1.282782438530422d-1*t66-t67
            t69 = -2.4d+0*t65*t68-1.417963080724413d+0*t65+2.83637333333
     1         3333d-2*t64-9.086531999999999d-1*t63**3.0d+0+4.7459599999
     2         999996d-2*t35*t63
            t70 = 1/t37**3.0d+0
            t71 = t1*t3*t30
            t72 = 2.4682961769030842d-2*t71**2.0d+0+2.8862604866934494d-
     1         1*t1*t3*t30+1.0d+0
            t73 = -8.888888888888888d-1*t69*t70*t72+7.57211d-1*(1.645530
     1         7846020562d-2*gammaaa*t16*t17*t25*t58*t62+t56*t58*t60)-2.
     2         0d+0*t55*t56+3.2910615692041123d-2*gammaaa*t16*t17*t25*t5
     3         0+5.273288888888887d-2*t35*t36*t38+4.727288888888889d-2*t
     4         28*t32-1.0d+0
            t74 = rhob**3.333333333333333d-1
            t75 = 1/t74
            t76 = t1*t75
            t77 = gammabb**5.0d-1
            t78 = t77**7
            t79 = 1/rhob**9.333333333333333d+0
            t80 = gammabb**3
            t81 = 1/rhob**8
            t82 = t77**5
            t83 = 1/rhob**6.666666666666667d+0
            t84 = gammabb**2
            t85 = 1/rhob**5.333333333333333d+0
            t86 = t77**3
            t87 = 1/rhob**4
            t88 = 1/rhob**2.6666666666666666d+0
            t89 = 2.631878392200375d-4*gammabb*t88+1.8005513133540818d-4
     1         *t86*t87-4.342399100269002d-5*t84*t85+5.3020963068324d-6*
     2         t82*t83-4.327677396975467d-7*t80*t81+2.4123830247695402d-
     3         8*t78*t79
            t90 = t77**9
            t91 = 1/rhob**12
            t92 = gammabb**4
            t93 = 1/rhob**1.0666666666666666d+1
            t94 = rhob**1.3333333333333333d+0
            t95 = 1/t94
            t96 = 6.841322473346062d-1*t77*t95-5.649671283776346d-9*t92*
     1         t93+3.149302550983647d-10*t90*t91-2.0532933130264455d-1*g
     2         ammabb*t88+2.342799068769956d-2*t86*t87-1.383706469760652
     3         4d-3*t84*t85+5.955909787676884d-5*t82*t83-2.7196832676277
     4         033d-6*t80*t81+1.7578986477855002d-7*t78*t79+1.0d+0
            t97 = 1/t96
            t98 = 1.6455307846020562d-2*gammabb*t88*t89*t97
            t99 = t98+6.582123138408225d-2*t76**2.0d+0+6.0965d-1
            t100 = 1/t99
            t101 = t99**5.0d-1
            t102 = 1/t101
            t103 = 2.565564877060844d-1*t1*t102*t75+1.0d+0
            t104 = 1/t103
            t105 = 4.1138269615051404d-3*gammabb*t88+1.0d+0
            t106 = 1/t105
            t107 = 6.934448603031025d-2*gammabb*t88*t89*t97+5.1366285948
     1         37797d-3*gammabb*t106*t88+1.0d+0
            t108 = 1.282782438530422d-1*t1*t102*t75+1.0d+0
            t109 = t103*t99
            t110 = 1/t109**2.0d+0
            t111 = 1/rhob**6.666666666666666d-1
            t112 = 6.582123138408225d-2*t111*t39
            t113 = (t98+t112)**5.0d-1
            t114 = (t98+t112+6.0965d-1)**5.0d-1
            t115 = t114+t113
            t116 = 1/t115
            t117 = 2.565564877060844d-1*t1*t75
            t118 = t117+t114
            t119 = 1/t118
            t120 = 1.0d+0-6.0965d-1*t116*t119
            t121 = log(t120)
            t122 = (t98+t112+7.57211d-1)**5.0d-1
            t123 = t122+t114
            t124 = 1/t123
            t125 = 1.475609999999999d-1*t119*t124+1.0d+0
            t126 = log(t125)
            t127 = t98+7.57211d-1
            t128 = t122+t113
            t129 = 1/t128
            t130 = t122+t117
            t131 = 1/t130
            t132 = t117+t113
            t133 = 1/t132
            t134 = t98+6.0965d-1
            t135 = t134**2.0d+0
            t136 = t134**3.5d+0
            t137 = (gammabb*t88*t89*t97)**5.0d-1
            t138 = t127**5.0d-1
            t139 = 1.282782438530422d-1*t137-t138
            t140 = -2.4d+0*t136*t139-1.417963080724413d+0*t136+2.8363733
     1         33333333d-2*t135-9.086531999999999d-1*t134**3.0d+0+4.7459
     2         599999999996d-2*t107*t134
            t141 = 1/t109**3.0d+0
            t142 = t1*t102*t75
            t143 = 2.8862604866934494d-1*t1*t102*t75+2.4682961769030842d
     1         -2*t142**2.0d+0+1.0d+0
            t144 = 7.57211d-1*(1.6455307846020562d-2*gammabb*t129*t133*t
     1         88*t89*t97+t127*t129*t131)+3.2910615692041123d-2*gammabb*
     2         t121*t88*t89*t97-8.888888888888888d-1*t140*t141*t143-2.0d
     3         +0*t126*t127+5.273288888888887d-2*t107*t108*t110+4.727288
     4         888888889d-2*t100*t104-1.0d+0
            t145 = 1/t27**2
            t146 = 1/rhoa**3.6666666666666664d+0
            t147 = -4.38808209227215d-2*gammaaa*t146*t17*t25
            t148 = 1/rhoa**1.0333333333333333d+1
            t149 = 1/rhoa**9
            t150 = 1/rhoa**7.666666666666667d+0
            t151 = 1/rhoa**6.333333333333333d+0
            t152 = 1/rhoa**5
            t153 = 2.1757466141021625d-5*t149*t8-1.6407054045998d-6*t148
     1         *t6-9.121763297794749d-1*t5/rhoa**2.3333333333333334d+0+6
     2         .026316036028103d-8*t20/rhoa**1.1666666666666665d+1-3.779
     3         1630611803767d-9*t18/rhoa**13-9.371196275079824d-2*t14*t1
     4         52+7.379767838723479d-3*t12*t151-3.970606525117923d-4*t10
     5         *t150+5.475448834737188d-1*gammaaa*t146
            t154 = 1/t24**2
            t155 = -1.6455307846020562d-2*gammaaa*t153*t154*t16*t17
            t156 = 3.462141917580374d-6*t149*t8-2.2515574897849044d-7*t1
     1         48*t6-7.202205253416327d-4*t14*t152+2.3159461868101344d-4
     2         *t12*t151-3.5347308712216d-5*t10*t150-7.018342379201d-4*g
     3         ammaaa*t146
            t157 = 1.6455307846020562d-2*gammaaa*t156*t16*t25
            t158 = -4.38808209227215d-2*t1*t23*t4+t157+t155+t147
            t159 = 1/t33**2
            t160 = -1.369767625290079d-2*gammaaa*t146*t34-1.849186294141
     1         6065d-1*gammaaa*t146*t17*t25+6.934448603031025d-2*gammaaa
     2         *t156*t16*t25-6.934448603031025d-2*gammaaa*t153*t154*t16*
     3         t17+5.634986987915197d-5*t12*t151*t159
            t161 = -4.38808209227215d-2*t39/rhoa**1.6666666666666669d+0+
     1         t157+t155+t147
            t162 = 1/t43
            t163 = 5.0d-1*t161*t162
            t164 = -8.551882923536147d-2*t1*t23
            t165 = t164+t163
            t166 = 1/t47**2
            t167 = 1/t42
            t168 = 5.0d-1*t161*t167
            t169 = 1/t44**2
            t170 = 1/t49
            t171 = t157+t155+t147
            t172 = 1/t51
            t173 = 5.0d-1*t161*t172
            t174 = 1/t52**2
            t175 = 1/t54
            t176 = 1/t59**2
            t177 = t173+t168
            t178 = 1/t57**2
            t179 = 1/t61**2
            t180 = t63**2.5d+0
            t181 = 1/t67
            t182 = 1/t66
            t183 = 1/t31**2
            t184 = 1/t29**3
            t185 = -8.551882923536147d-2*t1*t23*t30-1.282782438530422d-1
     1         *t1*t158*t184*t3
            t186 = t158*t31+t185*t27
            t187 = 1/t37**4.0d+0
            t188 = 1/t99**2
            t189 = 1/rhob**3.6666666666666664d+0
            t190 = -4.38808209227215d-2*gammabb*t189*t89*t97
            t191 = 1/rhob**1.0333333333333333d+1
            t192 = 1/rhob**9
            t193 = 1/rhob**7.666666666666667d+0
            t194 = 1/rhob**6.333333333333333d+0
            t195 = 1/rhob**5
            t196 = 6.026316036028103d-8*t92/rhob**1.1666666666666665d+1-
     1         3.7791630611803767d-9*t90/rhob**13-9.371196275079824d-2*t
     2         195*t86+7.379767838723479d-3*t194*t84-3.970606525117923d-
     3         4*t193*t82+2.1757466141021625d-5*t192*t80-1.6407054045998
     4         d-6*t191*t78-9.121763297794749d-1*t77/rhob**2.33333333333
     5         33334d+0+5.475448834737188d-1*gammabb*t189
            t197 = 1/t96**2
            t198 = -1.6455307846020562d-2*gammabb*t196*t197*t88*t89
            t199 = -7.202205253416327d-4*t195*t86+2.3159461868101344d-4*
     1         t194*t84-3.5347308712216d-5*t193*t82+3.462141917580374d-6
     2         *t192*t80-2.2515574897849044d-7*t191*t78-7.018342379201d-
     3         4*gammabb*t189
            t200 = 1.6455307846020562d-2*gammabb*t199*t88*t97
            t201 = -4.38808209227215d-2*t1*t76*t95+t200+t198+t190
            t202 = 1/t105**2
            t203 = -1.8491862941416065d-1*gammabb*t189*t89*t97+6.9344486
     1         03031025d-2*gammabb*t199*t88*t97-6.934448603031025d-2*gam
     2         mabb*t196*t197*t88*t89+5.634986987915197d-5*t194*t202*t84
     3         -1.369767625290079d-2*gammabb*t106*t189
            t204 = -4.38808209227215d-2*t39/rhob**1.6666666666666669d+0+
     1         t200+t198+t190
            t205 = 1/t114
            t206 = 5.0d-1*t204*t205
            t207 = -8.551882923536147d-2*t1*t95
            t208 = t207+t206
            t209 = 1/t118**2
            t210 = 1/t113
            t211 = 5.0d-1*t204*t210
            t212 = 1/t115**2
            t213 = 1/t120
            t214 = t200+t198+t190
            t215 = 1/t122
            t216 = 5.0d-1*t204*t215
            t217 = 1/t123**2
            t218 = 1/t125
            t219 = 1/t130**2
            t220 = t216+t211
            t221 = 1/t128**2
            t222 = 1/t132**2
            t223 = t134**2.5d+0
            t224 = 1/t138
            t225 = 1/t137
            t226 = 1/t103**2
            t227 = 1/t101**3
            t228 = -8.551882923536147d-2*t1*t102*t95-1.282782438530422d-
     1         1*t1*t201*t227*t75
            t229 = t228*t99+t103*t201
            t230 = 1/t109**4.0d+0
            t231 = -8.159049802883108d-6*t12*t9-2.2598685135105387d-8*t2
     1         1*t8+6.15264526724925d-7*t10*t7+1.4171861479426412d-9*t19
     2         *t6+3.514198603154934d-2*t15*t5+3.420661236673031d-1*t23/
     3         t5-2.0532933130264455d-1*t16+1.488977446919221d-4*t11*t14
     4         -2.767412939521305d-3*gammaaa*t13
            t232 = -1.2983032190926402d-6*t12*t9+8.443340586693391d-8*t1
     1         0*t7+2.7008269700311227d-4*t15*t5+2.631878392200375d-4*t1
     2         6+1.3255240767081d-5*t11*t14-8.684798200538004d-5*gammaaa
     3         *t13
            t233 = 1.6455307846020562d-2*gammaaa*t16*t232*t25+1.64553078
     1         46020562d-2*t16*t17*t25-1.6455307846020562d-2*gammaaa*t15
     2         4*t16*t17*t231
            t234 = 5.136628594837797d-3*t16*t34+6.934448603031025d-2*gam
     1         maaa*t16*t232*t25+6.934448603031025d-2*t16*t17*t25-6.9344
     2         48603031025d-2*gammaaa*t154*t16*t17*t231-2.11312012046819
     3         9d-5*gammaaa*t13*t159
            t235 = 5.0d-1*t167*t233
            t236 = 5.0d-1*t162*t233
            t237 = 5.0d-1*t172*t233
            t238 = t237+t235
            t239 = t233*t31-1.282782438530422d-1*t1*t233*t3*t30
            t240 = 3.420661236673031d-1*t95/t77-2.2598685135105387d-8*t8
     1         0*t93+1.4171861479426412d-9*t78*t91-2.0532933130264455d-1
     2         *t88+3.514198603154934d-2*t77*t87+1.488977446919221d-4*t8
     3         3*t86-2.767412939521305d-3*gammabb*t85-8.159049802883108d
     4         -6*t81*t84+6.15264526724925d-7*t79*t82
            t241 = 2.631878392200375d-4*t88+2.7008269700311227d-4*t77*t8
     1         7+1.3255240767081d-5*t83*t86-8.684798200538004d-5*gammabb
     2         *t85-1.2983032190926402d-6*t81*t84+8.443340586693391d-8*t
     3         79*t82
            t242 = 1.6455307846020562d-2*t88*t89*t97+1.6455307846020562d
     1         -2*gammabb*t241*t88*t97-1.6455307846020562d-2*gammabb*t19
     2         7*t240*t88*t89
            t243 = 6.934448603031025d-2*t88*t89*t97+6.934448603031025d-2
     1         *gammabb*t241*t88*t97-6.934448603031025d-2*gammabb*t197*t
     2         240*t88*t89+5.136628594837797d-3*t106*t88-2.1131201204681
     3         99d-5*gammabb*t202*t85
            t244 = 5.0d-1*t210*t242
            t245 = 5.0d-1*t205*t242
            t246 = 5.0d-1*t215*t242
            t247 = t246+t244
            t248 = t103*t242-1.282782438530422d-1*t1*t102*t242*t75
            fnc(iq) = (-9.305257363491d-1*t144*t94-9.305257363491d-1*t22
     1         *t73)*wght+fnc(iq)
            Amat(iq,D1_RA) = (-1.2407009817987999d+0*t2*t73-9.3052573634
     1         91d-1*t22*(-8.888888888888888d-1*(-8.400000000000001d+0*t
     2         171*t180*t68-2.4d+0*(6.41391219265211d-2*t182*(-2.6666666
     3         666666666d+0*gammaaa*t146*t17*t25+gammaaa*t156*t16*t25-ga
     4         mmaaa*t153*t154*t16*t17)-5.0d-1*t171*t181)*t65-2.72595959
     5         99999997d+0*t171*t64+5.672746666666666d-2*t171*t63+4.7459
     6         599999999996d-2*t160*t63+4.7459599999999996d-2*t171*t35-4
     7         .9628707825354457d+0*t171*t180)*t70*t72+2.666666666666666
     8         6d+0*t186*t187*t69*t72-8.888888888888888d-1*t69*t70*(4.93
     9         65923538061685d-2*(-3.333333333333333d-1*t1*t23*t30-5.0d-
     :         1*t1*t158*t184*t3)*t71-9.620868288978164d-2*t1*t23*t30-1.
     ;         4431302433467247d-1*t1*t158*t184*t3)-1.0546577777777776d-
     <         1*t186*t35*t36*t70+7.57211d-1*(-4.38808209227215d-2*gamma
     =         aa*t146*t17*t25*t58*t62+1.6455307846020562d-2*gammaaa*t15
     >         6*t16*t25*t58*t62-1.6455307846020562d-2*gammaaa*t153*t154
     ?         *t16*t17*t58*t62-1.6455307846020562d-2*gammaaa*t16*t17*t1
     @         77*t178*t25*t62+t171*t58*t60-t177*t178*t56*t60-(t173+t164
     1         )*t176*t56*t58-1.6455307846020562d-2*gammaaa*t16*(t168+t1
     2         64)*t17*t179*t25*t58)-2.0d+0*t175*(-1.475609999999999d-1*
     3         t165*t166*t53-1.475609999999999d-1*(t173+t163)*t174*t48)*
     4         t56-2.0d+0*t171*t55-8.7761641845443d-2*gammaaa*t146*t17*t
     5         25*t50+3.2910615692041123d-2*gammaaa*t156*t16*t25*t50-3.2
     6         910615692041123d-2*gammaaa*t153*t154*t16*t17*t50+3.291061
     7         5692041123d-2*gammaaa*t16*t17*t170*t25*(6.0965d-1*(t168+t
     8         163)*t169*t48+6.0965d-1*t165*t166*t45)+5.273288888888887d
     9         -2*t160*t36*t38+5.273288888888887d-2*(-4.2759414617680735
     :         d-2*t1*t23*t30-6.41391219265211d-2*t1*t158*t184*t3)*t35*t
     ;         38-4.727288888888889d-2*t145*t158*t32-4.727288888888889d-
     <         2*t183*t185*t28))*wght+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = (-9.305257363491d-1*t94*(-8.888888888888888
     1         d-1*t141*t143*(-2.4d+0*t136*(6.41391219265211d-2*t225*(-2
     2         .6666666666666666d+0*gammabb*t189*t89*t97+gammabb*t199*t8
     3         8*t97-gammabb*t196*t197*t88*t89)-5.0d-1*t214*t224)-8.4000
     4         00000000001d+0*t139*t214*t223-4.9628707825354457d+0*t214*
     5         t223-2.7259595999999997d+0*t135*t214+5.672746666666666d-2
     6         *t134*t214+4.7459599999999996d-2*t107*t214+4.745959999999
     7         9996d-2*t134*t203)+7.57211d-1*(-1.6455307846020562d-2*gam
     8         mabb*t129*(t211+t207)*t222*t88*t89*t97-1.6455307846020562
     9         d-2*gammabb*t133*t220*t221*t88*t89*t97-4.38808209227215d-
     :         2*gammabb*t129*t133*t189*t89*t97+1.6455307846020562d-2*ga
     ;         mmabb*t129*t133*t199*t88*t97-1.6455307846020562d-2*gammab
     <         b*t129*t133*t196*t197*t88*t89-t127*t131*t220*t221-t127*t1
     =         29*(t216+t207)*t219+t129*t131*t214)+3.2910615692041123d-2
     >         *gammabb*(6.0965d-1*t119*(t211+t206)*t212+6.0965d-1*t116*
     ?         t208*t209)*t213*t88*t89*t97-8.7761641845443d-2*gammabb*t1
     @         21*t189*t89*t97+3.2910615692041123d-2*gammabb*t121*t199*t
     1         88*t97-8.888888888888888d-1*t140*t141*(4.9365923538061685
     2         d-2*t142*(-3.333333333333333d-1*t1*t102*t95-5.0d-1*t1*t20
     3         1*t227*t75)-9.620868288978164d-2*t1*t102*t95-1.4431302433
     4         467247d-1*t1*t201*t227*t75)+5.273288888888887d-2*t107*t11
     5         0*(-4.2759414617680735d-2*t1*t102*t95-6.41391219265211d-2
     6         *t1*t201*t227*t75)-3.2910615692041123d-2*gammabb*t121*t19
     7         6*t197*t88*t89+2.6666666666666666d+0*t140*t143*t229*t230-
     8         1.0546577777777776d-1*t107*t108*t141*t229-4.7272888888888
     9         89d-2*t100*t226*t228-2.0d+0*t127*(-1.475609999999999d-1*t
     :         119*(t216+t206)*t217-1.475609999999999d-1*t124*t208*t209)
     ;         *t218-2.0d+0*t126*t214+5.273288888888887d-2*t108*t110*t20
     <         3-4.727288888888889d-2*t104*t188*t201)-1.2407009817987999
     =         d+0*t144*t74)*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GAA) = Cmat(iq,D1_GAA)-9.305257363491d-1*t22*(t70
     1         *(-8.888888888888888d-1*(-8.400000000000001d+0*t180*t233*
     2         t68-2.4d+0*(6.41391219265211d-2*t182*(gammaaa*t16*t232*t2
     3         5+t16*t17*t25-gammaaa*t154*t16*t17*t231)-5.0d-1*t181*t233
     4         )*t65-2.7259595999999997d+0*t233*t64+4.7459599999999996d-
     5         2*t234*t63+5.672746666666666d-2*t233*t63+4.74595999999999
     6         96d-2*t233*t35-4.9628707825354457d+0*t180*t233)*t72-8.888
     7         888888888888d-1*(-2.4682961769030842d-2*t145*t233*t39*t40
     8         -1.4431302433467247d-1*t1*t184*t233*t3)*t69-1.05465777777
     9         77776d-1*t239*t35*t36)+2.6666666666666666d+0*t187*t239*t6
     :         9*t72+7.57211d-1*(1.6455307846020562d-2*gammaaa*t16*t232*
     ;         t25*t58*t62+1.6455307846020562d-2*t16*t17*t25*t58*t62-1.6
     <         455307846020562d-2*gammaaa*t154*t16*t17*t231*t58*t62-1.64
     =         55307846020562d-2*gammaaa*t16*t17*t178*t238*t25*t62+t233*
     >         t58*t60-t178*t238*t56*t60-5.0d-1*t172*t176*t233*t56*t58-8
     ?         .227653923010281d-3*gammaaa*t16*t167*t17*t179*t233*t25*t5
     @         8)-2.0d+0*t175*(-7.378049999999994d-2*t162*t166*t233*t53-
     1         1.475609999999999d-1*t174*(t237+t236)*t48)*t56-2.0d+0*t23
     2         3*t55+t16*t25*(3.2910615692041123d-2*gammaaa*t232*t50+3.2
     3         910615692041123d-2*t17*t50)-3.2910615692041123d-2*gammaaa
     4         *t154*t16*t17*t231*t50+3.2910615692041123d-2*gammaaa*t16*
     5         t17*t170*t25*(6.0965d-1*t169*(t236+t235)*t48+3.04825d-1*t
     6         162*t166*t233*t45)+5.273288888888887d-2*t234*t36*t38-3.38
     7         22411899821336d-3*t1*t184*t233*t3*t35*t38-4.7272888888888
     8         89d-2*t145*t233*t32+6.064083168526658d-3*t1*t183*t233*t3/
     9         t29**5)*wght
            Cmat(iq,D1_GAB) = Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = Cmat(iq,D1_GBB)-9.305257363491d-1*t94*(t14
     1         1*(-8.888888888888888d-1*t143*(-2.4d+0*t136*(6.4139121926
     2         5211d-2*t225*(t88*t89*t97+gammabb*t241*t88*t97-gammabb*t1
     3         97*t240*t88*t89)-5.0d-1*t224*t242)+4.7459599999999996d-2*
     4         t134*t243-8.400000000000001d+0*t139*t223*t242-4.962870782
     5         5354457d+0*t223*t242-2.7259595999999997d+0*t135*t242+5.67
     6         2746666666666d-2*t134*t242+4.7459599999999996d-2*t107*t24
     7         2)-8.888888888888888d-1*t140*(-1.4431302433467247d-1*t1*t
     8         227*t242*t75-2.4682961769030842d-2*t111*t188*t242*t39)-1.
     9         0546577777777776d-1*t107*t108*t248)+7.57211d-1*(-1.645530
     :         7846020562d-2*gammabb*t133*t221*t247*t88*t89*t97-8.227653
     ;         923010281d-3*gammabb*t129*t210*t222*t242*t88*t89*t97+1.64
     <         55307846020562d-2*t129*t133*t88*t89*t97+1.645530784602056
     =         2d-2*gammabb*t129*t133*t241*t88*t97-1.6455307846020562d-2
     >         *gammabb*t129*t133*t197*t240*t88*t89-t127*t131*t221*t247-
     ?         5.0d-1*t127*t129*t215*t219*t242+t129*t131*t242)+t88*(3.29
     @         10615692041123d-2*t121*t89+3.2910615692041123d-2*gammabb*
     1         t121*t241)*t97+3.2910615692041123d-2*gammabb*t213*(6.0965
     2         d-1*t119*t212*(t245+t244)+3.04825d-1*t116*t205*t209*t242)
     3         *t88*t89*t97-3.2910615692041123d-2*gammabb*t121*t197*t240
     4         *t88*t89-3.3822411899821336d-3*t1*t107*t110*t227*t242*t75
     5         +6.064083168526658d-3*t1*t226*t242*t75/t101**5+2.66666666
     6         66666666d+0*t140*t143*t230*t248-2.0d+0*t127*t218*(-1.4756
     7         09999999999d-1*t119*t217*(t246+t245)-7.378049999999994d-2
     8         *t124*t205*t209*t242)+5.273288888888887d-2*t108*t110*t243
     9         -4.727288888888889d-2*t104*t188*t242-2.0d+0*t126*t242)*wg
     :         ht
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = param(1)
            t2 = rhoa**3.333333333333333d-1
            t3 = 1/t2
            t4 = t1*t3
            t5 = gammaaa**5.0d-1
            t6 = t5**7
            t7 = 1/rhoa**9.333333333333333d+0
            t8 = gammaaa**3
            t9 = 1/rhoa**8
            t10 = t5**5
            t11 = 1/rhoa**6.666666666666667d+0
            t12 = gammaaa**2
            t13 = 1/rhoa**5.333333333333333d+0
            t14 = t5**3
            t15 = 1/rhoa**4
            t16 = 1/rhoa**2.6666666666666666d+0
            t17 = -4.327677396975467d-7*t8*t9+2.4123830247695402d-8*t6*t
     1         7+2.631878392200375d-4*gammaaa*t16+1.8005513133540818d-4*
     2         t14*t15-4.342399100269002d-5*t12*t13+5.3020963068324d-6*t
     3         10*t11
            t18 = t5**9
            t19 = 1/rhoa**12
            t20 = gammaaa**4
            t21 = 1/rhoa**1.0666666666666666d+1
            t22 = rhoa**1.3333333333333333d+0
            t23 = 1/t22
            t24 = -2.7196832676277033d-6*t8*t9+1.7578986477855002d-7*t6*
     1         t7+6.841322473346062d-1*t23*t5-5.649671283776346d-9*t20*t
     2         21+3.149302550983647d-10*t18*t19-2.0532933130264455d-1*ga
     3         mmaaa*t16+2.342799068769956d-2*t14*t15-1.3837064697606524
     4         d-3*t12*t13+5.955909787676884d-5*t10*t11+1.0d+0
            t25 = 1/t24
            t26 = 1.6455307846020562d-2*gammaaa*t16*t17*t25
            t27 = 6.582123138408225d-2*t4**2.0d+0+t26+6.0965d-1
            t28 = 1/t27
            t29 = t27**5.0d-1
            t30 = 1/t29
            t31 = 2.565564877060844d-1*t1*t3*t30+1.0d+0
            t32 = 1/t31
            t33 = 4.1138269615051404d-3*gammaaa*t16+1.0d+0
            t34 = 1/t33
            t35 = 5.136628594837797d-3*gammaaa*t16*t34+6.934448603031025
     1         d-2*gammaaa*t16*t17*t25+1.0d+0
            t36 = 1.282782438530422d-1*t1*t3*t30+1.0d+0
            t37 = t27*t31
            t38 = 1/t37**2.0d+0
            t39 = t1**2
            t40 = 1/rhoa**6.666666666666666d-1
            t41 = 6.582123138408225d-2*t39*t40
            t42 = (t41+t26)**5.0d-1
            t43 = (t41+t26+6.0965d-1)**5.0d-1
            t44 = t43+t42
            t45 = 1/t44
            t46 = 2.565564877060844d-1*t1*t3
            t47 = t46+t43
            t48 = 1/t47
            t49 = 1.0d+0-6.0965d-1*t45*t48
            t50 = log(t49)
            t51 = (t41+t26+7.57211d-1)**5.0d-1
            t52 = t51+t43
            t53 = 1/t52
            t54 = 1.475609999999999d-1*t48*t53+1.0d+0
            t55 = log(t54)
            t56 = t26+7.57211d-1
            t57 = t51+t42
            t58 = 1/t57
            t59 = t51+t46
            t60 = 1/t59
            t61 = t46+t42
            t62 = 1/t61
            t63 = t26+6.0965d-1
            t64 = t63**2.0d+0
            t65 = t63**3.5d+0
            t66 = (gammaaa*t16*t17*t25)**5.0d-1
            t67 = t56**5.0d-1
            t68 = 1.282782438530422d-1*t66-t67
            t69 = -2.4d+0*t65*t68-1.417963080724413d+0*t65+2.83637333333
     1         3333d-2*t64-9.086531999999999d-1*t63**3.0d+0+4.7459599999
     2         999996d-2*t35*t63
            t70 = 1/t37**3.0d+0
            t71 = t1*t3*t30
            t72 = 2.4682961769030842d-2*t71**2.0d+0+2.8862604866934494d-
     1         1*t1*t3*t30+1.0d+0
            t73 = -8.888888888888888d-1*t69*t70*t72+7.57211d-1*(1.645530
     1         7846020562d-2*gammaaa*t16*t17*t25*t58*t62+t56*t58*t60)-2.
     2         0d+0*t55*t56+3.2910615692041123d-2*gammaaa*t16*t17*t25*t5
     3         0+5.273288888888887d-2*t35*t36*t38+4.727288888888889d-2*t
     4         28*t32-1.0d+0
            t74 = 1/t27**2
            t75 = 1/rhoa**3.6666666666666664d+0
            t76 = -4.38808209227215d-2*gammaaa*t17*t25*t75
            t77 = 1/rhoa**1.0333333333333333d+1
            t78 = 1/rhoa**9
            t79 = 1/rhoa**7.666666666666667d+0
            t80 = 1/rhoa**6.333333333333333d+0
            t81 = 1/rhoa**5
            t82 = -9.371196275079824d-2*t14*t81+7.379767838723479d-3*t12
     1         *t80+2.1757466141021625d-5*t78*t8-3.970606525117923d-4*t1
     2         0*t79-1.6407054045998d-6*t6*t77+5.475448834737188d-1*gamm
     3         aaa*t75-9.121763297794749d-1*t5/rhoa**2.3333333333333334d
     4         +0+6.026316036028103d-8*t20/rhoa**1.1666666666666665d+1-3
     5         .7791630611803767d-9*t18/rhoa**13
            t83 = 1/t24**2
            t84 = -1.6455307846020562d-2*gammaaa*t16*t17*t82*t83
            t85 = -7.202205253416327d-4*t14*t81+2.3159461868101344d-4*t1
     1         2*t80+3.462141917580374d-6*t78*t8-3.5347308712216d-5*t10*
     2         t79-2.2515574897849044d-7*t6*t77-7.018342379201d-4*gammaa
     3         a*t75
            t86 = 1.6455307846020562d-2*gammaaa*t16*t25*t85
            t87 = t86+t84+t76-4.38808209227215d-2*t1*t23*t4
            t88 = 1/t33**2
            t89 = 5.634986987915197d-5*t12*t80*t88+6.934448603031025d-2*
     1         gammaaa*t16*t25*t85-6.934448603031025d-2*gammaaa*t16*t17*
     2         t82*t83-1.369767625290079d-2*gammaaa*t34*t75-1.8491862941
     3         416065d-1*gammaaa*t17*t25*t75
            t90 = t86+t84+t76-4.38808209227215d-2*t39/rhoa**1.6666666666
     1         666669d+0
            t91 = 1/t43
            t92 = 5.0d-1*t90*t91
            t93 = -8.551882923536147d-2*t1*t23
            t94 = t93+t92
            t95 = 1/t47**2
            t96 = 1/t42
            t97 = 5.0d-1*t90*t96
            t98 = 1/t44**2
            t99 = 1/t49
            t100 = t86+t84+t76
            t101 = 1/t51
            t102 = 5.0d-1*t101*t90
            t103 = 1/t52**2
            t104 = 1/t54
            t105 = 1/t59**2
            t106 = t97+t102
            t107 = 1/t57**2
            t108 = 1/t61**2
            t109 = t63**2.5d+0
            t110 = 1/t67
            t111 = 1/t66
            t112 = 1/t31**2
            t113 = 1/t29**3
            t114 = -1.282782438530422d-1*t1*t113*t3*t87-8.55188292353614
     1         7d-2*t1*t23*t30
            t115 = t31*t87+t114*t27
            t116 = 1/t37**4.0d+0
            t117 = -8.159049802883108d-6*t12*t9-2.2598685135105387d-8*t2
     1         1*t8+6.15264526724925d-7*t10*t7+1.4171861479426412d-9*t19
     2         *t6+3.514198603154934d-2*t15*t5+3.420661236673031d-1*t23/
     3         t5-2.0532933130264455d-1*t16+1.488977446919221d-4*t11*t14
     4         -2.767412939521305d-3*gammaaa*t13
            t118 = -1.2983032190926402d-6*t12*t9+8.443340586693391d-8*t1
     1         0*t7+2.7008269700311227d-4*t15*t5+2.631878392200375d-4*t1
     2         6+1.3255240767081d-5*t11*t14-8.684798200538004d-5*gammaaa
     3         *t13
            t119 = -1.6455307846020562d-2*gammaaa*t117*t16*t17*t83+1.645
     1         5307846020562d-2*t16*t17*t25+1.6455307846020562d-2*gammaa
     2         a*t118*t16*t25
            t120 = -2.113120120468199d-5*gammaaa*t13*t88-6.9344486030310
     1         25d-2*gammaaa*t117*t16*t17*t83+5.136628594837797d-3*t16*t
     2         34+6.934448603031025d-2*t16*t17*t25+6.934448603031025d-2*
     3         gammaaa*t118*t16*t25
            t121 = 5.0d-1*t119*t96
            t122 = 5.0d-1*t119*t91
            t123 = 5.0d-1*t101*t119
            t124 = t123+t121
            t125 = t119*t31-1.282782438530422d-1*t1*t119*t3*t30
            fnc(iq) = fnc(iq)-9.305257363491d-1*t22*t73*wght
            Amat(iq,D1_RA) = -9.305257363491d-1*t22*(3.2910615692041123d
     1         -2*gammaaa*t16*t17*t25*(6.0965d-1*t48*(t97+t92)*t98+6.096
     2         5d-1*t45*t94*t95)*t99+7.57211d-1*(-1.6455307846020562d-2*
     3         gammaaa*t108*t16*t17*t25*t58*(t97+t93)-t105*t56*t58*(t93+
     4         t102)+1.6455307846020562d-2*gammaaa*t16*t25*t58*t62*t85-1
     5         .6455307846020562d-2*gammaaa*t16*t17*t58*t62*t82*t83-4.38
     6         808209227215d-2*gammaaa*t17*t25*t58*t62*t75-1.64553078460
     7         20562d-2*gammaaa*t106*t107*t16*t17*t25*t62+t100*t58*t60-t
     8         106*t107*t56*t60)-2.0d+0*t104*t56*(-1.475609999999999d-1*
     9         t53*t94*t95-1.475609999999999d-1*t103*t48*(t92+t102))-8.8
     :         88888888888888d-1*t70*t72*(4.7459599999999996d-2*t63*t89-
     ;         2.4d+0*t65*(6.41391219265211d-2*t111*(gammaaa*t16*t25*t85
     <         -gammaaa*t16*t17*t82*t83-2.6666666666666666d+0*gammaaa*t1
     =         7*t25*t75)-5.0d-1*t100*t110)-8.400000000000001d+0*t100*t1
     >         09*t68-2.7259595999999997d+0*t100*t64+5.672746666666666d-
     ?         2*t100*t63+4.7459599999999996d-2*t100*t35-4.9628707825354
     @         457d+0*t100*t109)+5.273288888888887d-2*t36*t38*t89-8.8888
     1         88888888888d-1*t69*t70*(4.9365923538061685d-2*t71*(-5.0d-
     2         1*t1*t113*t3*t87-3.333333333333333d-1*t1*t23*t30)-1.44313
     3         02433467247d-1*t1*t113*t3*t87-9.620868288978164d-2*t1*t23
     4         *t30)+5.273288888888887d-2*t35*t38*(-6.41391219265211d-2*
     5         t1*t113*t3*t87-4.2759414617680735d-2*t1*t23*t30)-4.727288
     6         888888889d-2*t32*t74*t87+3.2910615692041123d-2*gammaaa*t1
     7         6*t25*t50*t85-3.2910615692041123d-2*gammaaa*t16*t17*t50*t
     8         82*t83-8.7761641845443d-2*gammaaa*t17*t25*t50*t75+2.66666
     9         66666666666d+0*t115*t116*t69*t72-1.0546577777777776d-1*t1
     :         15*t35*t36*t70-2.0d+0*t100*t55-4.727288888888889d-2*t112*
     ;         t114*t28)*wght-1.2407009817987999d+0*t2*t73*wght+Amat(iq,
     <         D1_RA)
            Cmat(iq,D1_GAA) = Cmat(iq,D1_GAA)-9.305257363491d-1*t22*(3.2
     1         910615692041123d-2*gammaaa*t16*t17*t25*(6.0965d-1*(t122+t
     2         121)*t48*t98+3.04825d-1*t119*t45*t91*t95)*t99+7.57211d-1*
     3         (-8.227653923010281d-3*gammaaa*t108*t119*t16*t17*t25*t58*
     4         t96-1.6455307846020562d-2*gammaaa*t117*t16*t17*t58*t62*t8
     5         3+1.6455307846020562d-2*t16*t17*t25*t58*t62+1.64553078460
     6         20562d-2*gammaaa*t118*t16*t25*t58*t62-1.6455307846020562d
     7         -2*gammaaa*t107*t124*t16*t17*t25*t62+t119*t58*t60-t107*t1
     8         24*t56*t60-5.0d-1*t101*t105*t119*t56*t58)-2.0d+0*t104*t56
     9         *(-7.378049999999994d-2*t119*t53*t91*t95-1.47560999999999
     :         9d-1*t103*(t123+t122)*t48)+t70*(-8.888888888888888d-1*t72
     ;         *(-2.4d+0*t65*(6.41391219265211d-2*t111*(-gammaaa*t117*t1
     <         6*t17*t83+t16*t17*t25+gammaaa*t118*t16*t25)-5.0d-1*t110*t
     =         119)-8.400000000000001d+0*t109*t119*t68-2.725959599999999
     >         7d+0*t119*t64+4.7459599999999996d-2*t120*t63+5.6727466666
     ?         66666d-2*t119*t63+4.7459599999999996d-2*t119*t35-4.962870
     @         7825354457d+0*t109*t119)-8.888888888888888d-1*t69*(-2.468
     1         2961769030842d-2*t119*t39*t40*t74-1.4431302433467247d-1*t
     2         1*t113*t119*t3)-1.0546577777777776d-1*t125*t35*t36)-3.291
     3         0615692041123d-2*gammaaa*t117*t16*t17*t50*t83-4.727288888
     4         888889d-2*t119*t32*t74+2.6666666666666666d+0*t116*t125*t6
     5         9*t72-2.0d+0*t119*t55+t16*t25*(3.2910615692041123d-2*t17*
     6         t50+3.2910615692041123d-2*gammaaa*t118*t50)+5.27328888888
     7         8887d-2*t120*t36*t38-3.3822411899821336d-3*t1*t113*t119*t
     8         3*t35*t38+6.064083168526658d-3*t1*t112*t119*t3/t29**5)*wg
     9         ht
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(1)
            t2 = rhob**3.333333333333333d-1
            t3 = 1/t2
            t4 = t1*t3
            t5 = gammabb**5.0d-1
            t6 = t5**7
            t7 = 1/rhob**9.333333333333333d+0
            t8 = gammabb**3
            t9 = 1/rhob**8
            t10 = t5**5
            t11 = 1/rhob**6.666666666666667d+0
            t12 = gammabb**2
            t13 = 1/rhob**5.333333333333333d+0
            t14 = t5**3
            t15 = 1/rhob**4
            t16 = 1/rhob**2.6666666666666666d+0
            t17 = -4.327677396975467d-7*t8*t9+2.4123830247695402d-8*t6*t
     1         7+2.631878392200375d-4*gammabb*t16+1.8005513133540818d-4*
     2         t14*t15-4.342399100269002d-5*t12*t13+5.3020963068324d-6*t
     3         10*t11
            t18 = t5**9
            t19 = 1/rhob**12
            t20 = gammabb**4
            t21 = 1/rhob**1.0666666666666666d+1
            t22 = rhob**1.3333333333333333d+0
            t23 = 1/t22
            t24 = -2.7196832676277033d-6*t8*t9+1.7578986477855002d-7*t6*
     1         t7+6.841322473346062d-1*t23*t5-5.649671283776346d-9*t20*t
     2         21+3.149302550983647d-10*t18*t19-2.0532933130264455d-1*ga
     3         mmabb*t16+2.342799068769956d-2*t14*t15-1.3837064697606524
     4         d-3*t12*t13+5.955909787676884d-5*t10*t11+1.0d+0
            t25 = 1/t24
            t26 = 1.6455307846020562d-2*gammabb*t16*t17*t25
            t27 = 6.582123138408225d-2*t4**2.0d+0+t26+6.0965d-1
            t28 = 1/t27
            t29 = t27**5.0d-1
            t30 = 1/t29
            t31 = 2.565564877060844d-1*t1*t3*t30+1.0d+0
            t32 = 1/t31
            t33 = 4.1138269615051404d-3*gammabb*t16+1.0d+0
            t34 = 1/t33
            t35 = 5.136628594837797d-3*gammabb*t16*t34+6.934448603031025
     1         d-2*gammabb*t16*t17*t25+1.0d+0
            t36 = 1.282782438530422d-1*t1*t3*t30+1.0d+0
            t37 = t27*t31
            t38 = 1/t37**2.0d+0
            t39 = t1**2
            t40 = 1/rhob**6.666666666666666d-1
            t41 = 6.582123138408225d-2*t39*t40
            t42 = (t41+t26)**5.0d-1
            t43 = (t41+t26+6.0965d-1)**5.0d-1
            t44 = t43+t42
            t45 = 1/t44
            t46 = 2.565564877060844d-1*t1*t3
            t47 = t46+t43
            t48 = 1/t47
            t49 = 1.0d+0-6.0965d-1*t45*t48
            t50 = log(t49)
            t51 = (t41+t26+7.57211d-1)**5.0d-1
            t52 = t51+t43
            t53 = 1/t52
            t54 = 1.475609999999999d-1*t48*t53+1.0d+0
            t55 = log(t54)
            t56 = t26+7.57211d-1
            t57 = t51+t42
            t58 = 1/t57
            t59 = t51+t46
            t60 = 1/t59
            t61 = t46+t42
            t62 = 1/t61
            t63 = t26+6.0965d-1
            t64 = t63**2.0d+0
            t65 = t63**3.5d+0
            t66 = (gammabb*t16*t17*t25)**5.0d-1
            t67 = t56**5.0d-1
            t68 = 1.282782438530422d-1*t66-t67
            t69 = -2.4d+0*t65*t68-1.417963080724413d+0*t65+2.83637333333
     1         3333d-2*t64-9.086531999999999d-1*t63**3.0d+0+4.7459599999
     2         999996d-2*t35*t63
            t70 = 1/t37**3.0d+0
            t71 = t1*t3*t30
            t72 = 2.4682961769030842d-2*t71**2.0d+0+2.8862604866934494d-
     1         1*t1*t3*t30+1.0d+0
            t73 = -8.888888888888888d-1*t69*t70*t72+7.57211d-1*(1.645530
     1         7846020562d-2*gammabb*t16*t17*t25*t58*t62+t56*t58*t60)-2.
     2         0d+0*t55*t56+3.2910615692041123d-2*gammabb*t16*t17*t25*t5
     3         0+5.273288888888887d-2*t35*t36*t38+4.727288888888889d-2*t
     4         28*t32-1.0d+0
            t74 = 1/t27**2
            t75 = 1/rhob**3.6666666666666664d+0
            t76 = -4.38808209227215d-2*gammabb*t17*t25*t75
            t77 = 1/rhob**1.0333333333333333d+1
            t78 = 1/rhob**9
            t79 = 1/rhob**7.666666666666667d+0
            t80 = 1/rhob**6.333333333333333d+0
            t81 = 1/rhob**5
            t82 = -9.371196275079824d-2*t14*t81+7.379767838723479d-3*t12
     1         *t80+2.1757466141021625d-5*t78*t8-3.970606525117923d-4*t1
     2         0*t79-1.6407054045998d-6*t6*t77+5.475448834737188d-1*gamm
     3         abb*t75-9.121763297794749d-1*t5/rhob**2.3333333333333334d
     4         +0+6.026316036028103d-8*t20/rhob**1.1666666666666665d+1-3
     5         .7791630611803767d-9*t18/rhob**13
            t83 = 1/t24**2
            t84 = -1.6455307846020562d-2*gammabb*t16*t17*t82*t83
            t85 = -7.202205253416327d-4*t14*t81+2.3159461868101344d-4*t1
     1         2*t80+3.462141917580374d-6*t78*t8-3.5347308712216d-5*t10*
     2         t79-2.2515574897849044d-7*t6*t77-7.018342379201d-4*gammab
     3         b*t75
            t86 = 1.6455307846020562d-2*gammabb*t16*t25*t85
            t87 = t86+t84+t76-4.38808209227215d-2*t1*t23*t4
            t88 = 1/t33**2
            t89 = 5.634986987915197d-5*t12*t80*t88+6.934448603031025d-2*
     1         gammabb*t16*t25*t85-6.934448603031025d-2*gammabb*t16*t17*
     2         t82*t83-1.369767625290079d-2*gammabb*t34*t75-1.8491862941
     3         416065d-1*gammabb*t17*t25*t75
            t90 = t86+t84+t76-4.38808209227215d-2*t39/rhob**1.6666666666
     1         666669d+0
            t91 = 1/t43
            t92 = 5.0d-1*t90*t91
            t93 = -8.551882923536147d-2*t1*t23
            t94 = t93+t92
            t95 = 1/t47**2
            t96 = 1/t42
            t97 = 5.0d-1*t90*t96
            t98 = 1/t44**2
            t99 = 1/t49
            t100 = t86+t84+t76
            t101 = 1/t51
            t102 = 5.0d-1*t101*t90
            t103 = 1/t52**2
            t104 = 1/t54
            t105 = 1/t59**2
            t106 = t97+t102
            t107 = 1/t57**2
            t108 = 1/t61**2
            t109 = t63**2.5d+0
            t110 = 1/t67
            t111 = 1/t66
            t112 = 1/t31**2
            t113 = 1/t29**3
            t114 = -1.282782438530422d-1*t1*t113*t3*t87-8.55188292353614
     1         7d-2*t1*t23*t30
            t115 = t31*t87+t114*t27
            t116 = 1/t37**4.0d+0
            t117 = -8.159049802883108d-6*t12*t9-2.2598685135105387d-8*t2
     1         1*t8+6.15264526724925d-7*t10*t7+1.4171861479426412d-9*t19
     2         *t6+3.514198603154934d-2*t15*t5+3.420661236673031d-1*t23/
     3         t5-2.0532933130264455d-1*t16+1.488977446919221d-4*t11*t14
     4         -2.767412939521305d-3*gammabb*t13
            t118 = -1.2983032190926402d-6*t12*t9+8.443340586693391d-8*t1
     1         0*t7+2.7008269700311227d-4*t15*t5+2.631878392200375d-4*t1
     2         6+1.3255240767081d-5*t11*t14-8.684798200538004d-5*gammabb
     3         *t13
            t119 = -1.6455307846020562d-2*gammabb*t117*t16*t17*t83+1.645
     1         5307846020562d-2*t16*t17*t25+1.6455307846020562d-2*gammab
     2         b*t118*t16*t25
            t120 = -2.113120120468199d-5*gammabb*t13*t88-6.9344486030310
     1         25d-2*gammabb*t117*t16*t17*t83+5.136628594837797d-3*t16*t
     2         34+6.934448603031025d-2*t16*t17*t25+6.934448603031025d-2*
     3         gammabb*t118*t16*t25
            t121 = 5.0d-1*t119*t96
            t122 = 5.0d-1*t119*t91
            t123 = 5.0d-1*t101*t119
            t124 = t123+t121
            t125 = t119*t31-1.282782438530422d-1*t1*t119*t3*t30
            fnc(iq) = fnc(iq)-9.305257363491d-1*t22*t73*wght
            Amat(iq,D1_RB) = -9.305257363491d-1*t22*(3.2910615692041123d
     1         -2*gammabb*t16*t17*t25*(6.0965d-1*t48*(t97+t92)*t98+6.096
     2         5d-1*t45*t94*t95)*t99+7.57211d-1*(-1.6455307846020562d-2*
     3         gammabb*t108*t16*t17*t25*t58*(t97+t93)-t105*t56*t58*(t93+
     4         t102)+1.6455307846020562d-2*gammabb*t16*t25*t58*t62*t85-1
     5         .6455307846020562d-2*gammabb*t16*t17*t58*t62*t82*t83-4.38
     6         808209227215d-2*gammabb*t17*t25*t58*t62*t75-1.64553078460
     7         20562d-2*gammabb*t106*t107*t16*t17*t25*t62+t100*t58*t60-t
     8         106*t107*t56*t60)-2.0d+0*t104*t56*(-1.475609999999999d-1*
     9         t53*t94*t95-1.475609999999999d-1*t103*t48*(t92+t102))-8.8
     :         88888888888888d-1*t70*t72*(4.7459599999999996d-2*t63*t89-
     ;         2.4d+0*t65*(6.41391219265211d-2*t111*(gammabb*t16*t25*t85
     <         -gammabb*t16*t17*t82*t83-2.6666666666666666d+0*gammabb*t1
     =         7*t25*t75)-5.0d-1*t100*t110)-8.400000000000001d+0*t100*t1
     >         09*t68-2.7259595999999997d+0*t100*t64+5.672746666666666d-
     ?         2*t100*t63+4.7459599999999996d-2*t100*t35-4.9628707825354
     @         457d+0*t100*t109)+5.273288888888887d-2*t36*t38*t89-8.8888
     1         88888888888d-1*t69*t70*(4.9365923538061685d-2*t71*(-5.0d-
     2         1*t1*t113*t3*t87-3.333333333333333d-1*t1*t23*t30)-1.44313
     3         02433467247d-1*t1*t113*t3*t87-9.620868288978164d-2*t1*t23
     4         *t30)+5.273288888888887d-2*t35*t38*(-6.41391219265211d-2*
     5         t1*t113*t3*t87-4.2759414617680735d-2*t1*t23*t30)-4.727288
     6         888888889d-2*t32*t74*t87+3.2910615692041123d-2*gammabb*t1
     7         6*t25*t50*t85-3.2910615692041123d-2*gammabb*t16*t17*t50*t
     8         82*t83-8.7761641845443d-2*gammabb*t17*t25*t50*t75+2.66666
     9         66666666666d+0*t115*t116*t69*t72-1.0546577777777776d-1*t1
     :         15*t35*t36*t70-2.0d+0*t100*t55-4.727288888888889d-2*t112*
     ;         t114*t28)*wght-1.2407009817987999d+0*t2*t73*wght+Amat(iq,
     <         D1_RB)
            Cmat(iq,D1_GBB) = Cmat(iq,D1_GBB)-9.305257363491d-1*t22*(3.2
     1         910615692041123d-2*gammabb*t16*t17*t25*(6.0965d-1*(t122+t
     2         121)*t48*t98+3.04825d-1*t119*t45*t91*t95)*t99+7.57211d-1*
     3         (-8.227653923010281d-3*gammabb*t108*t119*t16*t17*t25*t58*
     4         t96-1.6455307846020562d-2*gammabb*t117*t16*t17*t58*t62*t8
     5         3+1.6455307846020562d-2*t16*t17*t25*t58*t62+1.64553078460
     6         20562d-2*gammabb*t118*t16*t25*t58*t62-1.6455307846020562d
     7         -2*gammabb*t107*t124*t16*t17*t25*t62+t119*t58*t60-t107*t1
     8         24*t56*t60-5.0d-1*t101*t105*t119*t56*t58)-2.0d+0*t104*t56
     9         *(-7.378049999999994d-2*t119*t53*t91*t95-1.47560999999999
     :         9d-1*t103*(t123+t122)*t48)+t70*(-8.888888888888888d-1*t72
     ;         *(-2.4d+0*t65*(6.41391219265211d-2*t111*(-gammabb*t117*t1
     <         6*t17*t83+t16*t17*t25+gammabb*t118*t16*t25)-5.0d-1*t110*t
     =         119)-8.400000000000001d+0*t109*t119*t68-2.725959599999999
     >         7d+0*t119*t64+4.7459599999999996d-2*t120*t63+5.6727466666
     ?         66666d-2*t119*t63+4.7459599999999996d-2*t119*t35-4.962870
     @         7825354457d+0*t109*t119)-8.888888888888888d-1*t69*(-2.468
     1         2961769030842d-2*t119*t39*t40*t74-1.4431302433467247d-1*t
     2         1*t113*t119*t3)-1.0546577777777776d-1*t125*t35*t36)-3.291
     3         0615692041123d-2*gammabb*t117*t16*t17*t50*t83-4.727288888
     4         888889d-2*t119*t32*t74+2.6666666666666666d+0*t116*t125*t6
     5         9*t72-2.0d+0*t119*t55+t16*t25*(3.2910615692041123d-2*t17*
     6         t50+3.2910615692041123d-2*gammabb*t118*t50)+5.27328888888
     7         8887d-2*t120*t36*t38-3.3822411899821336d-3*t1*t113*t119*t
     8         3*t35*t38+6.064083168526658d-3*t1*t112*t119*t3/t29**5)*wg
     9         ht
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_x_wpbe functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {{1}\over{\rho_\alpha^4}}\\\\ 
C>   {\it t_4} &=& \sqrt{\sigma_{\alpha\alpha}}\\\\ 
C>   {\it t_5} &=& {\it t_4}^3\\\\ 
C>   {\it t_6} &=& {{1}\over{\rho_\alpha^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_7} &=& \sigma_{\alpha\alpha}^2\\\\ 
C>   {\it t_8} &=& {{1}\over{\rho_\alpha^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_9} &=& {\it t_4}^5\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^8}}\\\\ 
C>   {\it t_{11}} &=& \sigma_{\alpha\alpha}^3\\\\ 
C>   {\it t_{12}} &=& {{1}\over{\rho_\alpha^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{13}} &=& {\it t_4}^7\\\\ 
C>   {\it t_{14}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{12}}\,{\it t_{13}}-4.327677396975467 \times 10^{-7}\,{\it t_{10}}\,{\it t_{11}}+5.3020963068324 \times 10^{-6}\,{\it t_8}\,{\it t_9}-4.342399100269002 \times 10^{-5}\,{\it t_6}\,{\it t_7}+1.800551313354082 \times 10^{-4}\,{\it t_3}\,{\it t_5}+2.631878392200375 \times 10^{-4}\,{\it t_2}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_4}^9}\over{\rho_\alpha^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\alpha\alpha}^4}\over{\rho_\alpha^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{12}}\,{\it t_{13}}-2.719683267627703 \times 10^{-6}\,{\it t_{10}}\,{\it t_{11}}+5.955909787676884 \times 10^{-5}\,{\it t_8}\,{\it t_9}-0.001383706469760652\,{\it t_6}\,{\it t_7}+0.02342799068769956\,{\it t_3}\,{\it t_5}-0.2053293313026446\,{\it t_2}\,\sigma_{\alpha\alpha}+{{0.6841322473346062\,{\it t_4}}\over{{\it t_1}}}+1.0}}\\\\ 
C>   {\it t_{16}} &=& 0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& {\it t_{16}}+0.60965\\\\ 
C>   {\it t_{18}} &=& 0.06934448603031025\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}+{{0.005136628594837796\,{\it t_2}\,\sigma_{\alpha\alpha}}\over{0.00411382696150514\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}+1.0\\\\ 
C>   {\it t_{19}} &=& {\it t_{17}}^{3.5}\\\\ 
C>   {\it t_{20}} &=& {\it t_{16}}+0.757211\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{22}} &=& {{1}\over{\rho_\alpha^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{23}} &=& {\it t_{16}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{22}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{24}} &=& {{1}\over{\sqrt{{\it t_{23}}}}}\\\\ 
C>   {\it t_{25}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& {\it t_{23}}\,{\it t_{25}}\\\\ 
C>   {\it t_{27}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\\\\ 
C>   {\it t_{28}} &=& {\it t_{21}}^2\\\\ 
C>   {\it t_{29}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\alpha^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{30}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}}\\\\ 
C>   {\it t_{31}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.757211}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{{\it t_{31}}+{\it t_{30}}}}\\\\ 
C>   {\it t_{33}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.60965}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}+{\it t_{27}}}}\\\\ 
C>   {\it t_{35}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{\rho_\beta^4}}\\\\ 
C>   {\it t_{38}} &=& \sqrt{\sigma_{\beta\beta}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{38}}^3\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\rho_\beta^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{41}} &=& \sigma_{\beta\beta}^2\\\\ 
C>   {\it t_{42}} &=& {{1}\over{\rho_\beta^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{43}} &=& {\it t_{38}}^5\\\\ 
C>   {\it t_{44}} &=& {{1}\over{\rho_\beta^8}}\\\\ 
C>   {\it t_{45}} &=& \sigma_{\beta\beta}^3\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\rho_\beta^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{47}} &=& {\it t_{38}}^7\\\\ 
C>   {\it t_{48}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{46}}\,{\it t_{47}}-4.327677396975467 \times 10^{-7}\,{\it t_{44}}\,{\it t_{45}}+5.3020963068324 \times 10^{-6}\,{\it t_{42}}\,{\it t_{43}}-4.342399100269002 \times 10^{-5}\,{\it t_{40}}\,{\it t_{41}}+1.800551313354082 \times 10^{-4}\,{\it t_{37}}\,{\it t_{39}}+2.631878392200375 \times 10^{-4}\,{\it t_{36}}\,\sigma_{\beta\beta}\\\\ 
C>   {\it t_{49}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{38}}^9}\over{\rho_\beta^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\beta\beta}^4}\over{\rho_\beta^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{46}}\,{\it t_{47}}-2.719683267627703 \times 10^{-6}\,{\it t_{44}}\,{\it t_{45}}+5.955909787676884 \times 10^{-5}\,{\it t_{42}}\,{\it t_{43}}-0.001383706469760652\,{\it t_{40}}\,{\it t_{41}}+0.02342799068769956\,{\it t_{37}}\,{\it t_{39}}-0.2053293313026446\,{\it t_{36}}\,\sigma_{\beta\beta}+{{0.6841322473346062\,{\it t_{38}}}\over{{\it t_{35}}}}+1.0}}\\\\ 
C>   {\it t_{50}} &=& 0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\\\\ 
C>   {\it t_{51}} &=& {\it t_{50}}+0.60965\\\\ 
C>   {\it t_{52}} &=& 0.06934448603031025\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}+{{0.005136628594837796\,{\it t_{36}}\,\sigma_{\beta\beta}}\over{0.00411382696150514\,{\it t_{36}}\,\sigma_{\beta\beta}+1.0}}+1.0\\\\ 
C>   {\it t_{53}} &=& {\it t_{51}}^{3.5}\\\\ 
C>   {\it t_{54}} &=& {\it t_{50}}+0.757211\\\\ 
C>   {\it t_{55}} &=& {{1}\over{\rho_\beta^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{56}} &=& {\it t_{50}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{55}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{57}} &=& {{1}\over{\sqrt{{\it t_{56}}}}}\\\\ 
C>   {\it t_{58}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\\\\ 
C>   {\it t_{59}} &=& {\it t_{56}}\,{\it t_{58}}\\\\ 
C>   {\it t_{60}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\\\\ 
C>   {\it t_{61}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\beta^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{62}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}}\\\\ 
C>   {\it t_{63}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.757211}\\\\ 
C>   {\it t_{64}} &=& {{1}\over{{\it t_{63}}+{\it t_{62}}}}\\\\ 
C>   {\it t_{65}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.60965}\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{65}}+{\it t_{60}}}}\\\\ 
C>   {\it t_{67}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {{1}\over{\rho_s^4}}\\\\ 
C>   {\it t_{70}} &=& \sqrt{\sigma_{ss}}\\\\ 
C>   {\it t_{71}} &=& {\it t_{70}}^3\\\\ 
C>   {\it t_{72}} &=& {{1}\over{\rho_s^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{73}} &=& \sigma_{ss}^2\\\\ 
C>   {\it t_{74}} &=& {{1}\over{\rho_s^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{75}} &=& {\it t_{70}}^5\\\\ 
C>   {\it t_{76}} &=& {{1}\over{\rho_s^8}}\\\\ 
C>   {\it t_{77}} &=& \sigma_{ss}^3\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {\it t_{70}}^7\\\\ 
C>   {\it t_{80}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{78}}\,{\it t_{79}}-4.327677396975467 \times 10^{-7}\,{\it t_{76}}\,{\it t_{77}}+5.3020963068324 \times 10^{-6}\,{\it t_{74}}\,{\it t_{75}}-4.342399100269002 \times 10^{-5}\,{\it t_{72}}\,{\it t_{73}}+1.800551313354082 \times 10^{-4}\,{\it t_{69}}\,{\it t_{71}}+2.631878392200375 \times 10^{-4}\,{\it t_{68}}\,\sigma_{ss}\\\\ 
C>   {\it t_{81}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{70}}^9}\over{\rho_s^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{ss}^4}\over{\rho_s^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{78}}\,{\it t_{79}}-2.719683267627703 \times 10^{-6}\,{\it t_{76}}\,{\it t_{77}}+5.955909787676884 \times 10^{-5}\,{\it t_{74}}\,{\it t_{75}}-0.001383706469760652\,{\it t_{72}}\,{\it t_{73}}+0.02342799068769956\,{\it t_{69}}\,{\it t_{71}}-0.2053293313026446\,{\it t_{68}}\,\sigma_{ss}+{{0.6841322473346062\,{\it t_{70}}}\over{{\it t_{67}}}}+1.0}}\\\\ 
C>   {\it t_{82}} &=& 0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\\\\ 
C>   {\it t_{83}} &=& {\it t_{82}}+0.60965\\\\ 
C>   {\it t_{84}} &=& 0.06934448603031025\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}+{{0.005136628594837796\,{\it t_{68}}\,\sigma_{ss}}\over{0.00411382696150514\,{\it t_{68}}\,\sigma_{ss}+1.0}}+1.0\\\\ 
C>   {\it t_{85}} &=& {\it t_{83}}^{3.5}\\\\ 
C>   {\it t_{86}} &=& {\it t_{82}}+0.757211\\\\ 
C>   {\it t_{87}} &=& {{1}\over{\rho_s^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{82}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{87}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{89}} &=& {{1}\over{\sqrt{{\it t_{88}}}}}\\\\ 
C>   {\it t_{90}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\\\\ 
C>   {\it t_{91}} &=& {\it t_{88}}\,{\it t_{90}}\\\\ 
C>   {\it t_{92}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\\\\ 
C>   {\it t_{93}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_s^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{94}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}}\\\\ 
C>   {\it t_{95}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.757211}\\\\ 
C>   {\it t_{96}} &=& {{1}\over{{\it t_{95}}+{\it t_{94}}}}\\\\ 
C>   {\it t_{97}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.60965}\\\\ 
C>   {\it t_{98}} &=& {{1}\over{{\it t_{97}}+{\it t_{92}}}}\\\\ 
C>   f &=& -0.9305257363491\,{\it t_{35}}\,\left(-2.0\,{\it t_{54}}\,\log \left({{0.1475609999999999\,{\it t_{66}}}\over{{\it t_{63}}+{\it t_{65}}}}+1.0\right)+0.03291061569204112\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,\log \left(1.0-{{0.60965\,{\it t_{66}}}\over{{\it t_{65}}+{\it t_{62}}}}\right)+0.757211\,\left({{{\it t_{54}}\,{\it t_{64}}}\over{{\it t_{63}}+{\it t_{60}}}}+{{0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,{\it t_{64}}}\over{{\it t_{62}}+{\it t_{60}}}}\right)+{{0.05273288888888888\,{\it t_{52}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{56}}\,{\it t_{58}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{53}}\,\left(0.1282782438530422\,\sqrt{{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}}-\sqrt{{\it t_{54}}}\right)-1.417963080724413\,{\it t_{53}}-0.9086531999999999\,{\it t_{51}}^{3.0}+0.02836373333333333\,{\it t_{51}}^{2.0}+0.0474596\,{\it t_{51}}\,{\it t_{52}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{3.0}}}-1.0\right)-0.9305257363491\,{\it t_1}\,\left(-2.0\,{\it t_{20}}\,\log \left({{0.1475609999999999\,{\it t_{34}}}\over{{\it t_{31}}+{\it t_{33}}}}+1.0\right)+0.03291061569204112\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,\log \left(1.0-{{0.60965\,{\it t_{34}}}\over{{\it t_{33}}+{\it t_{30}}}}\right)+0.757211\,\left({{{\it t_{20}}\,{\it t_{32}}}\over{{\it t_{31}}+{\it t_{27}}}}+{{0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,{\it t_{32}}}\over{{\it t_{30}}+{\it t_{27}}}}\right)+{{0.05273288888888888\,{\it t_{18}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{23}}\,{\it t_{25}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{19}}\,\left(0.1282782438530422\,\sqrt{{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}}-\sqrt{{\it t_{20}}}\right)-1.417963080724413\,{\it t_{19}}-0.9086531999999999\,{\it t_{17}}^{3.0}+0.02836373333333333\,{\it t_{17}}^{2.0}+0.0474596\,{\it t_{17}}\,{\it t_{18}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{3.0}}}-1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& -0.9305257363491\,{\it t_{67}}\,\left(-2.0\,{\it t_{86}}\,\log \left({{0.1475609999999999\,{\it t_{98}}}\over{{\it t_{95}}+{\it t_{97}}}}+1.0\right)+0.03291061569204112\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,\log \left(1.0-{{0.60965\,{\it t_{98}}}\over{{\it t_{97}}+{\it t_{94}}}}\right)+0.757211\,\left({{{\it t_{86}}\,{\it t_{96}}}\over{{\it t_{95}}+{\it t_{92}}}}+{{0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,{\it t_{96}}}\over{{\it t_{94}}+{\it t_{92}}}}\right)+{{0.05273288888888888\,{\it t_{84}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{88}}\,{\it t_{90}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{85}}\,\left(0.1282782438530422\,\sqrt{{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}}-\sqrt{{\it t_{86}}}\right)-1.417963080724413\,{\it t_{85}}-0.9086531999999999\,{\it t_{83}}^{3.0}+0.02836373333333333\,{\it t_{83}}^{2.0}+0.0474596\,{\it t_{83}}\,{\it t_{84}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{3.0}}}-1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] E Weintraub, TM Henderson, GE Scuseria, J.Chem.Theory.Comput. 5, 754 (2009)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800530u "> 
C> 10.1021/ct800530u </a> 
C> 
      subroutine nwxcm_x_wpbe_d2(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Cmat,Cmat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_x_wpbe functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{{{4}\over{3}}}\\\\ 
C>   {\it t_2} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_3} &=& {{1}\over{\rho_\alpha^4}}\\\\ 
C>   {\it t_4} &=& \sqrt{\sigma_{\alpha\alpha}}\\\\ 
C>   {\it t_5} &=& {\it t_4}^3\\\\ 
C>   {\it t_6} &=& {{1}\over{\rho_\alpha^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_7} &=& \sigma_{\alpha\alpha}^2\\\\ 
C>   {\it t_8} &=& {{1}\over{\rho_\alpha^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_9} &=& {\it t_4}^5\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^8}}\\\\ 
C>   {\it t_{11}} &=& \sigma_{\alpha\alpha}^3\\\\ 
C>   {\it t_{12}} &=& {{1}\over{\rho_\alpha^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{13}} &=& {\it t_4}^7\\\\ 
C>   {\it t_{14}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{12}}\,{\it t_{13}}-4.327677396975467 \times 10^{-7}\,{\it t_{10}}\,{\it t_{11}}+5.3020963068324 \times 10^{-6}\,{\it t_8}\,{\it t_9}-4.342399100269002 \times 10^{-5}\,{\it t_6}\,{\it t_7}+1.800551313354082 \times 10^{-4}\,{\it t_3}\,{\it t_5}+2.631878392200375 \times 10^{-4}\,{\it t_2}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_4}^9}\over{\rho_\alpha^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\alpha\alpha}^4}\over{\rho_\alpha^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{12}}\,{\it t_{13}}-2.719683267627703 \times 10^{-6}\,{\it t_{10}}\,{\it t_{11}}+5.955909787676884 \times 10^{-5}\,{\it t_8}\,{\it t_9}-0.001383706469760652\,{\it t_6}\,{\it t_7}+0.02342799068769956\,{\it t_3}\,{\it t_5}-0.2053293313026446\,{\it t_2}\,\sigma_{\alpha\alpha}+{{0.6841322473346062\,{\it t_4}}\over{{\it t_1}}}+1.0}}\\\\ 
C>   {\it t_{16}} &=& 0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\\\\ 
C>   {\it t_{17}} &=& {\it t_{16}}+0.60965\\\\ 
C>   {\it t_{18}} &=& 0.06934448603031025\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}+{{0.005136628594837796\,{\it t_2}\,\sigma_{\alpha\alpha}}\over{0.00411382696150514\,{\it t_2}\,\sigma_{\alpha\alpha}+1.0}}+1.0\\\\ 
C>   {\it t_{19}} &=& {\it t_{17}}^{3.5}\\\\ 
C>   {\it t_{20}} &=& {\it t_{16}}+0.757211\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{22}} &=& {{1}\over{\rho_\alpha^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{23}} &=& {\it t_{16}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{22}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{24}} &=& {{1}\over{\sqrt{{\it t_{23}}}}}\\\\ 
C>   {\it t_{25}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& {\it t_{23}}\,{\it t_{25}}\\\\ 
C>   {\it t_{27}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{22}}\\\\ 
C>   {\it t_{28}} &=& {\it t_{21}}^2\\\\ 
C>   {\it t_{29}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\alpha^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{30}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}}\\\\ 
C>   {\it t_{31}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.757211}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{{\it t_{31}}+{\it t_{30}}}}\\\\ 
C>   {\it t_{33}} &=& \sqrt{{\it t_{16}}+{\it t_{29}}+0.60965}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}+{\it t_{27}}}}\\\\ 
C>   {\it t_{35}} &=& \rho_\beta^{{{4}\over{3}}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{\rho_\beta^4}}\\\\ 
C>   {\it t_{38}} &=& \sqrt{\sigma_{\beta\beta}}\\\\ 
C>   {\it t_{39}} &=& {\it t_{38}}^3\\\\ 
C>   {\it t_{40}} &=& {{1}\over{\rho_\beta^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{41}} &=& \sigma_{\beta\beta}^2\\\\ 
C>   {\it t_{42}} &=& {{1}\over{\rho_\beta^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{43}} &=& {\it t_{38}}^5\\\\ 
C>   {\it t_{44}} &=& {{1}\over{\rho_\beta^8}}\\\\ 
C>   {\it t_{45}} &=& \sigma_{\beta\beta}^3\\\\ 
C>   {\it t_{46}} &=& {{1}\over{\rho_\beta^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{47}} &=& {\it t_{38}}^7\\\\ 
C>   {\it t_{48}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{46}}\,{\it t_{47}}-4.327677396975467 \times 10^{-7}\,{\it t_{44}}\,{\it t_{45}}+5.3020963068324 \times 10^{-6}\,{\it t_{42}}\,{\it t_{43}}-4.342399100269002 \times 10^{-5}\,{\it t_{40}}\,{\it t_{41}}+1.800551313354082 \times 10^{-4}\,{\it t_{37}}\,{\it t_{39}}+2.631878392200375 \times 10^{-4}\,{\it t_{36}}\,\sigma_{\beta\beta}\\\\ 
C>   {\it t_{49}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{38}}^9}\over{\rho_\beta^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{\beta\beta}^4}\over{\rho_\beta^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{46}}\,{\it t_{47}}-2.719683267627703 \times 10^{-6}\,{\it t_{44}}\,{\it t_{45}}+5.955909787676884 \times 10^{-5}\,{\it t_{42}}\,{\it t_{43}}-0.001383706469760652\,{\it t_{40}}\,{\it t_{41}}+0.02342799068769956\,{\it t_{37}}\,{\it t_{39}}-0.2053293313026446\,{\it t_{36}}\,\sigma_{\beta\beta}+{{0.6841322473346062\,{\it t_{38}}}\over{{\it t_{35}}}}+1.0}}\\\\ 
C>   {\it t_{50}} &=& 0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\\\\ 
C>   {\it t_{51}} &=& {\it t_{50}}+0.60965\\\\ 
C>   {\it t_{52}} &=& 0.06934448603031025\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}+{{0.005136628594837796\,{\it t_{36}}\,\sigma_{\beta\beta}}\over{0.00411382696150514\,{\it t_{36}}\,\sigma_{\beta\beta}+1.0}}+1.0\\\\ 
C>   {\it t_{53}} &=& {\it t_{51}}^{3.5}\\\\ 
C>   {\it t_{54}} &=& {\it t_{50}}+0.757211\\\\ 
C>   {\it t_{55}} &=& {{1}\over{\rho_\beta^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{56}} &=& {\it t_{50}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{55}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{57}} &=& {{1}\over{\sqrt{{\it t_{56}}}}}\\\\ 
C>   {\it t_{58}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\\\\ 
C>   {\it t_{59}} &=& {\it t_{56}}\,{\it t_{58}}\\\\ 
C>   {\it t_{60}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{55}}\\\\ 
C>   {\it t_{61}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_\beta^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{62}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}}\\\\ 
C>   {\it t_{63}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.757211}\\\\ 
C>   {\it t_{64}} &=& {{1}\over{{\it t_{63}}+{\it t_{62}}}}\\\\ 
C>   {\it t_{65}} &=& \sqrt{{\it t_{50}}+{\it t_{61}}+0.60965}\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{65}}+{\it t_{60}}}}\\\\ 
C>   {\it t_{67}} &=& \rho_s^{{{4}\over{3}}}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {{1}\over{\rho_s^4}}\\\\ 
C>   {\it t_{70}} &=& \sqrt{\sigma_{ss}}\\\\ 
C>   {\it t_{71}} &=& {\it t_{70}}^3\\\\ 
C>   {\it t_{72}} &=& {{1}\over{\rho_s^{{{16}\over{3}}}}}\\\\ 
C>   {\it t_{73}} &=& \sigma_{ss}^2\\\\ 
C>   {\it t_{74}} &=& {{1}\over{\rho_s^{{{20}\over{3}}}}}\\\\ 
C>   {\it t_{75}} &=& {\it t_{70}}^5\\\\ 
C>   {\it t_{76}} &=& {{1}\over{\rho_s^8}}\\\\ 
C>   {\it t_{77}} &=& \sigma_{ss}^3\\\\ 
C>   {\it t_{78}} &=& {{1}\over{\rho_s^{{{28}\over{3}}}}}\\\\ 
C>   {\it t_{79}} &=& {\it t_{70}}^7\\\\ 
C>   {\it t_{80}} &=& 2.41238302476954 \times 10^{-8}\,{\it t_{78}}\,{\it t_{79}}-4.327677396975467 \times 10^{-7}\,{\it t_{76}}\,{\it t_{77}}+5.3020963068324 \times 10^{-6}\,{\it t_{74}}\,{\it t_{75}}-4.342399100269002 \times 10^{-5}\,{\it t_{72}}\,{\it t_{73}}+1.800551313354082 \times 10^{-4}\,{\it t_{69}}\,{\it t_{71}}+2.631878392200375 \times 10^{-4}\,{\it t_{68}}\,\sigma_{ss}\\\\ 
C>   {\it t_{81}} &=& {{1}\over{{{3.149302550983647 \times 10^{-10}\,{\it t_{70}}^9}\over{\rho_s^{12}}}-{{5.649671283776346 \times 10^{-9}\,\sigma_{ss}^4}\over{\rho_s^{{{32}\over{3}}}}}+1.7578986477855 \times 10^{-7}\,{\it t_{78}}\,{\it t_{79}}-2.719683267627703 \times 10^{-6}\,{\it t_{76}}\,{\it t_{77}}+5.955909787676884 \times 10^{-5}\,{\it t_{74}}\,{\it t_{75}}-0.001383706469760652\,{\it t_{72}}\,{\it t_{73}}+0.02342799068769956\,{\it t_{69}}\,{\it t_{71}}-0.2053293313026446\,{\it t_{68}}\,\sigma_{ss}+{{0.6841322473346062\,{\it t_{70}}}\over{{\it t_{67}}}}+1.0}}\\\\ 
C>   {\it t_{82}} &=& 0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\\\\ 
C>   {\it t_{83}} &=& {\it t_{82}}+0.60965\\\\ 
C>   {\it t_{84}} &=& 0.06934448603031025\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}+{{0.005136628594837796\,{\it t_{68}}\,\sigma_{ss}}\over{0.00411382696150514\,{\it t_{68}}\,\sigma_{ss}+1.0}}+1.0\\\\ 
C>   {\it t_{85}} &=& {\it t_{83}}^{3.5}\\\\ 
C>   {\it t_{86}} &=& {\it t_{82}}+0.757211\\\\ 
C>   {\it t_{87}} &=& {{1}\over{\rho_s^{{{1}\over{3}}}}}\\\\ 
C>   {\it t_{88}} &=& {\it t_{82}}+0.06582123138408225\,\left({\it t_{21}}\,{\it t_{87}}\right)^{2.0}+0.60965\\\\ 
C>   {\it t_{89}} &=& {{1}\over{\sqrt{{\it t_{88}}}}}\\\\ 
C>   {\it t_{90}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\\\\ 
C>   {\it t_{91}} &=& {\it t_{88}}\,{\it t_{90}}\\\\ 
C>   {\it t_{92}} &=& 0.2565564877060844\,{\it t_{21}}\,{\it t_{87}}\\\\ 
C>   {\it t_{93}} &=& {{0.06582123138408225\,{\it t_{28}}}\over{\rho_s^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{94}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}}\\\\ 
C>   {\it t_{95}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.757211}\\\\ 
C>   {\it t_{96}} &=& {{1}\over{{\it t_{95}}+{\it t_{94}}}}\\\\ 
C>   {\it t_{97}} &=& \sqrt{{\it t_{82}}+{\it t_{93}}+0.60965}\\\\ 
C>   {\it t_{98}} &=& {{1}\over{{\it t_{97}}+{\it t_{92}}}}\\\\ 
C>   f &=& -0.9305257363491\,{\it t_{35}}\,\left(-2.0\,{\it t_{54}}\,\log \left({{0.1475609999999999\,{\it t_{66}}}\over{{\it t_{63}}+{\it t_{65}}}}+1.0\right)+0.03291061569204112\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,\log \left(1.0-{{0.60965\,{\it t_{66}}}\over{{\it t_{65}}+{\it t_{62}}}}\right)+0.757211\,\left({{{\it t_{54}}\,{\it t_{64}}}\over{{\it t_{63}}+{\it t_{60}}}}+{{0.01645530784602056\,{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}\,{\it t_{64}}}\over{{\it t_{62}}+{\it t_{60}}}}\right)+{{0.05273288888888888\,{\it t_{52}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{56}}\,{\it t_{58}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{53}}\,\left(0.1282782438530422\,\sqrt{{\it t_{36}}\,\sigma_{\beta\beta}\,{\it t_{48}}\,{\it t_{49}}}-\sqrt{{\it t_{54}}}\right)-1.417963080724413\,{\it t_{53}}-0.9086531999999999\,{\it t_{51}}^{3.0}+0.02836373333333333\,{\it t_{51}}^{2.0}+0.0474596\,{\it t_{51}}\,{\it t_{52}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{55}}\,{\it t_{57}}+1.0\right)}\over{{\it t_{59}}^{3.0}}}-1.0\right)-0.9305257363491\,{\it t_1}\,\left(-2.0\,{\it t_{20}}\,\log \left({{0.1475609999999999\,{\it t_{34}}}\over{{\it t_{31}}+{\it t_{33}}}}+1.0\right)+0.03291061569204112\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,\log \left(1.0-{{0.60965\,{\it t_{34}}}\over{{\it t_{33}}+{\it t_{30}}}}\right)+0.757211\,\left({{{\it t_{20}}\,{\it t_{32}}}\over{{\it t_{31}}+{\it t_{27}}}}+{{0.01645530784602056\,{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}\,{\it t_{32}}}\over{{\it t_{30}}+{\it t_{27}}}}\right)+{{0.05273288888888888\,{\it t_{18}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{23}}\,{\it t_{25}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{19}}\,\left(0.1282782438530422\,\sqrt{{\it t_2}\,\sigma_{\alpha\alpha}\,{\it t_{14}}\,{\it t_{15}}}-\sqrt{{\it t_{20}}}\right)-1.417963080724413\,{\it t_{19}}-0.9086531999999999\,{\it t_{17}}^{3.0}+0.02836373333333333\,{\it t_{17}}^{2.0}+0.0474596\,{\it t_{17}}\,{\it t_{18}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{22}}\,{\it t_{24}}+1.0\right)}\over{{\it t_{26}}^{3.0}}}-1.0\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& -0.9305257363491\,{\it t_{67}}\,\left(-2.0\,{\it t_{86}}\,\log \left({{0.1475609999999999\,{\it t_{98}}}\over{{\it t_{95}}+{\it t_{97}}}}+1.0\right)+0.03291061569204112\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,\log \left(1.0-{{0.60965\,{\it t_{98}}}\over{{\it t_{97}}+{\it t_{94}}}}\right)+0.757211\,\left({{{\it t_{86}}\,{\it t_{96}}}\over{{\it t_{95}}+{\it t_{92}}}}+{{0.01645530784602056\,{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}\,{\it t_{96}}}\over{{\it t_{94}}+{\it t_{92}}}}\right)+{{0.05273288888888888\,{\it t_{84}}\,\left(0.1282782438530422\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{2.0}}}+{{0.04727288888888889}\over{{\it t_{88}}\,{\it t_{90}}}}-{{0.8888888888888888\,\left(-2.4\,{\it t_{85}}\,\left(0.1282782438530422\,\sqrt{{\it t_{68}}\,\sigma_{ss}\,{\it t_{80}}\,{\it t_{81}}}-\sqrt{{\it t_{86}}}\right)-1.417963080724413\,{\it t_{85}}-0.9086531999999999\,{\it t_{83}}^{3.0}+0.02836373333333333\,{\it t_{83}}^{2.0}+0.0474596\,{\it t_{83}}\,{\it t_{84}}\right)\,\left(0.02468296176903084\,\left({\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}\right)^{2.0}+0.2886260486693449\,{\it t_{21}}\,{\it t_{87}}\,{\it t_{89}}+1.0\right)}\over{{\it t_{91}}^{3.0}}}-1.0\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] E Weintraub, TM Henderson, GE Scuseria, J.Chem.Theory.Comput. 5, 754 (2009)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/ct800530u "> 
C> 10.1021/ct800530u </a> 
C> 
      subroutine nwxcm_x_wpbe_d3(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Amat3, 
     +Cmat,Cmat2,Cmat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,*)  !< [Output] The 3rd derivative wrt rho 
      double precision Cmat3(nq,*)  !< [Output] The 3rd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
