C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_c_m11.F 
C> The nwxcm_c_m11 functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_c_m11 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& 0.1325688999052018\,{\it t_3}+1.0\\\\ 
C>   {\it t_5} &=& \sqrt{{\it t_2}}\\\\ 
C>   {\it t_6} &=& {{1}\over{{\it t_5}}}\\\\ 
C>   {\it t_7} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.02414199311453321\,{\it t_6}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_8} &=& -\rho_\beta\\\\ 
C>   {\it t_9} &=& {\it t_8}+\rho_\alpha\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{11}} &=& 1.0-{\it t_9}\,{\it t_{10}}\\\\ 
C>   {\it t_{12}} &=& {\it t_9}\,{\it t_{10}}+1.0\\\\ 
C>   {\it t_{13}} &=& 0.06901399211255826\,{\it t_3}+1.0\\\\ 
C>   {\it t_{14}} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01321299881039884\,{\it t_6}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{15}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{12}}^{{{4}\over{3}}}+1.923661050931536\,{\it t_{11}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_9}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_4}\,{\it t_7}-0.0310907\,\left(0.1274696188700087\,{\it t_3}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01530901310039024\,{\it t_6}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)}\over{{\it t_1}^4}}+0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)-0.0621814\,{\it t_4}\,{\it t_7}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{17}} &=& {{2.871234000188191\,{\it t_1}^{{{5}\over{3}}}}\over{\tau_\beta+\tau_\alpha}}\\\\ 
C>   {\it t_{18}} &=& {\it t_{17}}-1.0\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{17}}+1.0}}\\\\ 
C>   {\it t_{20}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{23}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{24}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{26}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{27}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{29}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{30}} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_{31}} &=& 0.5\,{\it t_{12}}^{{{2}\over{3}}}+0.5\,{\it t_{11}}^{{{2}\over{3}}}\\\\ 
C>   {\it t_{32}} &=& {\it t_{31}}^{3.0}\\\\ 
C>   {\it t_{33}} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}^{2.0}}}\\\\ 
C>   {\it t_{35}} &=& {{1}\over{{\it t_{31}}^{2.0}}}\\\\ 
C>   {\it t_{36}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{37}} &=& \sigma_{\beta\beta}+{\it t_{36}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{e^{{{32.16396844291483\,{\it t_{15}}}\over{{\it t_{32}}}}}}}-1.0\\\\ 
C>   {\it t_{39}} &=& {{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}}\over{{\it t_{38}}}}\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{51}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{52}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{53}} &=& {\it t_{52}}^{0.3333333333333333}\\\\ 
C>   {\it t_{54}} &=& {{1}\over{{\it t_{53}}}}\\\\ 
C>   {\it t_{55}} &=& 0.1325688999052018\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{56}} &=& \sqrt{{\it t_{53}}}\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{58}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.02414199311453321\,{\it t_{57}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{59}} &=& \rho_s+{\it t_8}\\\\ 
C>   {\it t_{60}} &=& {{{\it t_{59}}}\over{{\it t_{52}}}}+1.0\\\\ 
C>   {\it t_{61}} &=& 0.06901399211255826\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{62}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01321299881039884\,{\it t_{57}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{63}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{60}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{59}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{55}}\,{\it t_{58}}-0.0310907\,\left(0.1274696188700087\,{\it t_{54}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01530901310039024\,{\it t_{57}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)}\over{{\it t_{52}}^4}}+0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)-0.0621814\,{\it t_{55}}\,{\it t_{58}}\\\\ 
C>   {\it t_{64}} &=& {{2.871234000188191\,{\it t_{52}}^{{{5}\over{3}}}}\over{\tau_{\bar s}+\tau_s}}\\\\ 
C>   {\it t_{65}} &=& {\it t_{64}}-1.0\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{64}}+1.0}}\\\\ 
C>   {\it t_{67}} &=& \left| {\it t_{60}}\right| ^{2.0}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{{\it t_{52}}^{1.166666666666667}\,{\it t_{60}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {\it t_{68}}^{2.0}\\\\ 
C>   {\it t_{70}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{36}}\\\\ 
C>   {\it t_{71}} &=& {{1}\over{e^{{{257.3117475433186\,{\it t_{63}}}\over{{\it t_{67}}}}}}}-1.0\\\\ 
C>   {\it t_{72}} &=& {{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}}\over{{\it t_{71}}}}\\\\ 
C>   f &=& 1.0\,\left(0.03109069086965489\,{\it t_1}\,{\it t_{32}}\,\log \left({{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}\,\left({\it t_{39}}+1.0\right)}\over{{{0.01855337900098064\,{\it t_{37}}^{2.0}}\over{{\it t_{33}}^{4.0}\,{\it t_{31}}^{4.0}\,{\it t_{38}}^{2.0}}}+{\it t_{39}}+1.0}}+1.0\right)\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{51}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_1}\,{\it t_{15}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{30}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.003886336358706861\,{\it t_{52}}\,{\it t_{67}}\,\log \left({{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}\,\left({\it t_{72}}+1.0\right)}\over{{{0.2968540640156903\,{\it t_{68}}^{4.0}\,{\it t_{70}}^{2.0}}\over{{\it t_{71}}^{2.0}}}+{\it t_{72}}+1.0}}+1.0\right)\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{51}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_{52}}\,{\it t_{63}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{30}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] R Peverati, DG Truhlar, J.Phys.Chem.Lett. 2, 2810 (2011)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/jz201170d "> 
C> 10.1021/jz201170d </a> 
C> 
      subroutine nwxcm_c_m11(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Cmat,Mmat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
            t1 = rhoa**3.333333333333333d-1
            t2 = t1**5.0d-1
            t3 = 1/t2
            t4 = 2.150807071909054d-2*t3+1.0186556948d-1
            t5 = 7.016926042943223d-1*t3*t4+2.2308199064d-1
            t6 = 7.016926042943223d-1*t3*t5+4.7231125998d-1
            t7 = 1/t6
            t8 = 1.4251254664507676d+0*t2*t7+1.0d+0
            t9 = log(t8)
            t10 = 1.0522000558389215d-1/t1+1.0d+0
            t11 = param(12)
            t12 = 1.5874010519681994d+0
            t13 = rhoa**1.6666666666666669d+0
            t14 = 1/taua
            t15 = 2.871234000188191d+0*t12*t13*t14
            t16 = t15-1.0d+0
            t17 = t15+1.0d+0
            t18 = 1/t17
            t19 = t11*t16*t18+param(11)
            t20 = t16*t18*t19+param(10)
            t21 = t16*t18*t20+param(9)
            t22 = t16*t18*t21+param(8)
            t23 = t16*t18*t22+param(7)
            t24 = t16*t18*t23+param(6)
            t25 = t16*t18*t24+param(5)
            t26 = t16*t18*t25+param(4)
            t27 = t16*t18*t26+param(3)
            t28 = t16*t18*t27+param(2)
            t29 = t16*t18*t28+param(1)
            t30 = rhoa**1.1666666666666667d+0
            t31 = 1/t30**2.0d+0
            t32 = exp(2.0000005873362642d+0*t10*t9)
            t33 = t32-1.0d+0
            t34 = 1/t33
            t35 = 1.0811057476031892d-1*gammaaa*t31*t34
            t36 = t35+1.0d+0
            t37 = gammaaa**2.0d+0
            t38 = 1/t30**4.0d+0
            t39 = 1/t33**2.0d+0
            t40 = 1.1687896375006504d-2*t37*t38*t39+t35+1.0d+0
            t41 = 1/t40
            t42 = 1.0811057476031892d-1*gammaaa*t31*t36*t41+1.0d+0
            t43 = log(t42)
            t44 = param(24)
            t45 = t16*t18*t44+param(23)
            t46 = t16*t18*t45+param(22)
            t47 = t16*t18*t46+param(21)
            t48 = t16*t18*t47+param(20)
            t49 = t16*t18*t48+param(19)
            t50 = t16*t18*t49+param(18)
            t51 = t16*t18*t50+param(17)
            t52 = t16*t18*t51+param(16)
            t53 = t16*t18*t52+param(15)
            t54 = t16*t18*t53+param(14)
            t55 = t16*t18*t54+param(13)
            t56 = 1/t8
            t57 = 1/t2**3
            t58 = 1/rhoa**6.666666666666667d-1
            t59 = 2.375209110751279d-1*t3*t58*t7-1.4251254664507676d+0*t
     1         2*(7.016926042943223d-1*t3*(-1.1694876738238705d-1*t4*t57
     2         *t58-2.51534235937085d-3/rhoa**1.3333333333333336d+0)-1.1
     3         694876738238705d-1*t5*t57*t58)/t6**2
            t60 = 1/t42
            t61 = rhoa**1.6666666666666674d-1
            t62 = 1/t30**3.0d+0
            t63 = -2.522580077740775d-1*gammaaa*t34*t61*t62
            t64 = 2.0000005873362642d+0*t10*t56*t59-7.014669098910309d-2
     1         *t9/rhoa**1.3333333333333333d+0
            t65 = -1.0811057476031892d-1*gammaaa*t31*t32*t64/t33**2
            t66 = 1/t40**2
            t67 = rhoa**6.666666666666666d-1
            t68 = 1/t17**2
            t69 = 6.218138173930978d-2*rhoa*t55*t60*(-1.0811057476031892
     1         d-1*gammaaa*t31*t36*(2.3375792750013008d-2*gammaaa*t38*t3
     2         9+1.0811057476031892d-1*t31*t34)*t66+1.1687896375006507d-
     3         2*gammaaa*t34*t38*t41+1.0811057476031892d-1*t31*t36*t41)*
     4         wght
            t70 = 1/taua**2
            fnc(iq) = 1.0d+0*(6.218138173930978d-2*rhoa*t43*t55-1.243628
     1         d-1*rhoa*t10*t29*t9)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(-1.243628d-1*rhoa*t10*(t16*t18*(t16
     1         *t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t1
     2         8*(t16*t18*(t16*t18*(4.785390000313652d+0*t11*t12*t14*t18
     3         *t67-4.785390000313652d+0*t11*t12*t14*t16*t67*t68)-4.7853
     4         90000313652d+0*t12*t14*t16*t19*t67*t68+4.785390000313652d
     5         +0*t12*t14*t18*t19*t67)-4.785390000313652d+0*t12*t14*t16*
     6         t20*t67*t68+4.785390000313652d+0*t12*t14*t18*t20*t67)-4.7
     7         85390000313652d+0*t12*t14*t16*t21*t67*t68+4.7853900003136
     8         52d+0*t12*t14*t18*t21*t67)-4.785390000313652d+0*t12*t14*t
     9         16*t22*t67*t68+4.785390000313652d+0*t12*t14*t18*t22*t67)-
     :         4.785390000313652d+0*t12*t14*t16*t23*t67*t68+4.7853900003
     ;         13652d+0*t12*t14*t18*t23*t67)-4.785390000313652d+0*t12*t1
     <         4*t16*t24*t67*t68+4.785390000313652d+0*t12*t14*t18*t24*t6
     =         7)-4.785390000313652d+0*t12*t14*t16*t25*t67*t68+4.7853900
     >         00313652d+0*t12*t14*t18*t25*t67)-4.785390000313652d+0*t12
     ?         *t14*t16*t26*t67*t68+4.785390000313652d+0*t12*t14*t18*t26
     @         *t67)-4.785390000313652d+0*t12*t14*t16*t27*t67*t68+4.7853
     1         90000313652d+0*t12*t14*t18*t27*t67)-4.785390000313652d+0*
     2         t12*t14*t16*t28*t67*t68+4.785390000313652d+0*t12*t14*t18*
     3         t28*t67)*t9-1.243628d-1*t10*t29*t9+4.36181817014282d-3*t2
     4         9*t9/rhoa**3.3333333333333326d-1+6.218138173930978d-2*rho
     5         a*t43*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t
     6         18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(4.785390000313652
     7         d+0*t12*t14*t18*t44*t67-4.785390000313652d+0*t12*t14*t16*
     8         t44*t67*t68)-4.785390000313652d+0*t12*t14*t16*t45*t67*t68
     9         +4.785390000313652d+0*t12*t14*t18*t45*t67)-4.785390000313
     :         652d+0*t12*t14*t16*t46*t67*t68+4.785390000313652d+0*t12*t
     ;         14*t18*t46*t67)-4.785390000313652d+0*t12*t14*t16*t47*t67*
     <         t68+4.785390000313652d+0*t12*t14*t18*t47*t67)-4.785390000
     =         313652d+0*t12*t14*t16*t48*t67*t68+4.785390000313652d+0*t1
     >         2*t14*t18*t48*t67)-4.785390000313652d+0*t12*t14*t16*t49*t
     ?         67*t68+4.785390000313652d+0*t12*t14*t18*t49*t67)-4.785390
     @         000313652d+0*t12*t14*t16*t50*t67*t68+4.785390000313652d+0
     1         *t12*t14*t18*t50*t67)-4.785390000313652d+0*t12*t14*t16*t5
     2         1*t67*t68+4.785390000313652d+0*t12*t14*t18*t51*t67)-4.785
     3         390000313652d+0*t12*t14*t16*t52*t67*t68+4.785390000313652
     4         d+0*t12*t14*t18*t52*t67)-4.785390000313652d+0*t12*t14*t16
     5         *t53*t67*t68+4.785390000313652d+0*t12*t14*t18*t53*t67)-4.
     6         785390000313652d+0*t12*t14*t16*t54*t67*t68+4.785390000313
     7         652d+0*t12*t14*t18*t54*t67)+6.218138173930978d-2*rhoa*t55
     8         *t60*(-1.0811057476031892d-1*gammaaa*t31*t36*(t65-2.33757
     9         92750013008d-2*t32*t37*t38*t64/t33**3.0d+0+t63-5.45435164
     :         1669702d-2*t37*t39*t61/t30**5.0d+0)*t66+1.081105747603189
     ;         2d-1*gammaaa*t31*t41*(t65+t63)-2.522580077740775d-1*gamma
     <         aa*t36*t41*t61*t62)-1.243628d-1*rhoa*t10*t29*t56*t59+6.21
     =         8138173930978d-2*t43*t55)*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = t69+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t69+Cmat(iq,D1_GAB)
            Amat(iq,D1_TA) = 1.0d+0*(6.218138173930978d-2*rhoa*t43*(t16*
     1         t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18
     2         *(t16*t18*(t16*t18*(t16*t18*(2.871234000188191d+0*t12*t13
     3         *t16*t44*t68*t70-2.871234000188191d+0*t12*t13*t18*t44*t70
     4         )+2.871234000188191d+0*t12*t13*t16*t45*t68*t70-2.87123400
     5         0188191d+0*t12*t13*t18*t45*t70)+2.871234000188191d+0*t12*
     6         t13*t16*t46*t68*t70-2.871234000188191d+0*t12*t13*t18*t46*
     7         t70)+2.871234000188191d+0*t12*t13*t16*t47*t68*t70-2.87123
     8         4000188191d+0*t12*t13*t18*t47*t70)+2.871234000188191d+0*t
     9         12*t13*t16*t48*t68*t70-2.871234000188191d+0*t12*t13*t18*t
     :         48*t70)+2.871234000188191d+0*t12*t13*t16*t49*t68*t70-2.87
     ;         1234000188191d+0*t12*t13*t18*t49*t70)+2.871234000188191d+
     <         0*t12*t13*t16*t50*t68*t70-2.871234000188191d+0*t12*t13*t1
     =         8*t50*t70)+2.871234000188191d+0*t12*t13*t16*t51*t68*t70-2
     >         .871234000188191d+0*t12*t13*t18*t51*t70)+2.87123400018819
     ?         1d+0*t12*t13*t16*t52*t68*t70-2.871234000188191d+0*t12*t13
     @         *t18*t52*t70)+2.871234000188191d+0*t12*t13*t16*t53*t68*t7
     1         0-2.871234000188191d+0*t12*t13*t18*t53*t70)+2.87123400018
     2         8191d+0*t12*t13*t16*t54*t68*t70-2.871234000188191d+0*t12*
     3         t13*t18*t54*t70)-1.243628d-1*rhoa*t10*(t16*t18*(t16*t18*(
     4         t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16*t18*(t16
     5         *t18*(t16*t18*(2.871234000188191d+0*t11*t12*t13*t16*t68*t
     6         70-2.871234000188191d+0*t11*t12*t13*t18*t70)+2.8712340001
     7         88191d+0*t12*t13*t16*t19*t68*t70-2.871234000188191d+0*t12
     8         *t13*t18*t19*t70)+2.871234000188191d+0*t12*t13*t16*t20*t6
     9         8*t70-2.871234000188191d+0*t12*t13*t18*t20*t70)+2.8712340
     :         00188191d+0*t12*t13*t16*t21*t68*t70-2.871234000188191d+0*
     ;         t12*t13*t18*t21*t70)+2.871234000188191d+0*t12*t13*t16*t22
     <         *t68*t70-2.871234000188191d+0*t12*t13*t18*t22*t70)+2.8712
     =         34000188191d+0*t12*t13*t16*t23*t68*t70-2.871234000188191d
     >         +0*t12*t13*t18*t23*t70)+2.871234000188191d+0*t12*t13*t16*
     ?         t24*t68*t70-2.871234000188191d+0*t12*t13*t18*t24*t70)+2.8
     @         71234000188191d+0*t12*t13*t16*t25*t68*t70-2.8712340001881
     1         91d+0*t12*t13*t18*t25*t70)+2.871234000188191d+0*t12*t13*t
     2         16*t26*t68*t70-2.871234000188191d+0*t12*t13*t18*t26*t70)+
     3         2.871234000188191d+0*t12*t13*t16*t27*t68*t70-2.8712340001
     4         88191d+0*t12*t13*t18*t27*t70)+2.871234000188191d+0*t12*t1
     5         3*t16*t28*t68*t70-2.871234000188191d+0*t12*t13*t18*t28*t7
     6         0)*t9)*wght+Amat(iq,D1_TA)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = rhob+rhoa
            t2 = t1**3.333333333333333d-1
            t3 = 1/t2
            t4 = 1.325688999052018d-1*t3+1.0d+0
            t5 = t2**5.0d-1
            t6 = 1/t5
            t7 = 2.4141993114533214d-2*t6+1.0186556948d-1
            t8 = 7.876233178997433d-1*t6*t7+2.2308199064d-1
            t9 = 7.876233178997433d-1*t6*t8+4.7231125998d-1
            t10 = 1/t9
            t11 = 1.269642451250142d+0*t10*t5+1.0d+0
            t12 = log(t11)
            t13 = rhoa-rhob
            t14 = 1/t1
            t15 = 1.0d+0-t13*t14
            t16 = t13*t14+1.0d+0
            t17 = 1.923661050931536d+0*t16**1.3333333333333333d+0+1.9236
     1         61050931536d+0*t15**1.3333333333333333d+0-3.8473221018630
     2         72d+0
            t18 = 6.901399211255826d-2*t3+1.0d+0
            t19 = 1.3212998810398843d-2*t6+2.9729725188d-2
            t20 = 7.876233178997433d-1*t19*t6+1.2236585478d-1
            t21 = 7.876233178997433d-1*t20*t6+3.497952466d-1
            t22 = 1/t21
            t23 = 1.269642451250142d+0*t22*t5+1.0d+0
            t24 = log(t23)
            t25 = t13**4
            t26 = 1/t1**4
            t27 = 1.2746961887000874d-1*t3+1.0d+0
            t28 = 1.530901310039024d-2*t6+1.0465751434d-1
            t29 = 7.876233178997433d-1*t28*t6+1.9269083139d-1
            t30 = 7.876233178997433d-1*t29*t6+4.3896648423d-1
            t31 = 1/t30
            t32 = 1.269642451250142d+0*t31*t5+1.0d+0
            t33 = log(t32)
            t34 = 1.709920934161365d+0*(6.21814d-2*t12*t4-3.10907d-2*t27
     1         *t33)-3.37738d-2*t18*t24
            t35 = t25*t26*t34+3.37738d-2*t18*t24
            t36 = 5.848223622634648d-1*t17*t35-6.21814d-2*t12*t4
            t37 = t1**1.6666666666666669d+0
            t38 = taub+taua
            t39 = 1/t38
            t40 = 2.871234000188191d+0*t37*t39
            t41 = t40-1.0d+0
            t42 = t40+1.0d+0
            t43 = 1/t42
            t44 = param(12)
            t45 = t41*t43*t44+param(11)
            t46 = t41*t43*t45+param(10)
            t47 = t41*t43*t46+param(9)
            t48 = t41*t43*t47+param(8)
            t49 = t41*t43*t48+param(7)
            t50 = t41*t43*t49+param(6)
            t51 = t41*t43*t50+param(5)
            t52 = t41*t43*t51+param(4)
            t53 = t41*t43*t52+param(3)
            t54 = t41*t43*t53+param(2)
            t55 = t41*t43*t54+param(1)
            t56 = 5.0d-1*t16**6.666666666666666d-1+5.0d-1*t15**6.6666666
     1         66666666d-1
            t57 = t56**3.0d+0
            t58 = gammabb+2.0d+0*gammaab+gammaaa
            t59 = t1**1.1666666666666667d+0
            t60 = 1/t59**2.0d+0
            t61 = t56**2.0d+0
            t62 = 1/t61
            t63 = 1/t57
            t64 = exp(-3.216396844291483d+1*t36*t63)
            t65 = t64-1.0d+0
            t66 = 1/t65
            t67 = 1.3621078885675922d-1*t58*t60*t62*t66
            t68 = t67+1.0d+0
            t69 = t58**2.0d+0
            t70 = 1/t59**4.0d+0
            t71 = 1/t56**4.0d+0
            t72 = 1/t65**2.0d+0
            t73 = 1.855337900098064d-2*t69*t70*t71*t72+t67+1.0d+0
            t74 = 1/t73
            t75 = 1.3621078885675922d-1*t58*t60*t62*t68*t74+1.0d+0
            t76 = log(t75)
            t77 = param(24)
            t78 = t41*t43*t77+param(23)
            t79 = t41*t43*t78+param(22)
            t80 = t41*t43*t79+param(21)
            t81 = t41*t43*t80+param(20)
            t82 = t41*t43*t81+param(19)
            t83 = t41*t43*t82+param(18)
            t84 = t41*t43*t83+param(17)
            t85 = t41*t43*t84+param(16)
            t86 = t41*t43*t85+param(15)
            t87 = t41*t43*t86+param(14)
            t88 = t41*t43*t87+param(13)
            t89 = t1**6.666666666666666d-1
            t90 = 1/t42**2
            t91 = 1.0d+0*t1*t36*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41
     1         *t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(4.7853
     2         90000313652d+0*t39*t43*t44*t89-4.785390000313652d+0*t39*t
     3         41*t44*t89*t90)-4.785390000313652d+0*t39*t41*t45*t89*t90+
     4         4.785390000313652d+0*t39*t43*t45*t89)-4.785390000313652d+
     5         0*t39*t41*t46*t89*t90+4.785390000313652d+0*t39*t43*t46*t8
     6         9)-4.785390000313652d+0*t39*t41*t47*t89*t90+4.78539000031
     7         3652d+0*t39*t43*t47*t89)-4.785390000313652d+0*t39*t41*t48
     8         *t89*t90+4.785390000313652d+0*t39*t43*t48*t89)-4.78539000
     9         0313652d+0*t39*t41*t49*t89*t90+4.785390000313652d+0*t39*t
     :         43*t49*t89)-4.785390000313652d+0*t39*t41*t50*t89*t90+4.78
     ;         5390000313652d+0*t39*t43*t50*t89)-4.785390000313652d+0*t3
     <         9*t41*t51*t89*t90+4.785390000313652d+0*t39*t43*t51*t89)-4
     =         .785390000313652d+0*t39*t41*t52*t89*t90+4.785390000313652
     >         d+0*t39*t43*t52*t89)-4.785390000313652d+0*t39*t41*t53*t89
     ?         *t90+4.785390000313652d+0*t39*t43*t53*t89)-4.785390000313
     @         652d+0*t39*t41*t54*t89*t90+4.785390000313652d+0*t39*t43*t
     1         54*t89)
            t92 = 1/t1**1.3333333333333336d+0
            t93 = 1/t1**6.666666666666667d-1
            t94 = 1/t5**3
            t95 = 2.11607075208357d-1*t10*t6*t93-1.269642451250142d+0*t5
     1         *(7.876233178997433d-1*t6*(-1.3127055298329054d-1*t7*t93*
     2         t94-3.169132786263567d-3*t92)-1.3127055298329054d-1*t8*t9
     3         3*t94)/t9**2
            t96 = 1/t11
            t97 = -6.21814d-2*t4*t95*t96
            t98 = 1/t1**1.3333333333333333d+0
            t99 = 2.747773264188438d-3*t12*t98
            t100 = 2.11607075208357d-1*t22*t6*t93-1.269642451250142d+0*t
     1         5*(7.876233178997433d-1*t6*(-1.3127055298329054d-1*t19*t9
     2         3*t94-1.7344776604086162d-3*t92)-1.3127055298329054d-1*t2
     3         0*t93*t94)/t21**2
            t101 = 1/t23
            t102 = 3.37738d-2*t100*t101*t18
            t103 = -7.769549222703733d-4*t24*t98
            t104 = t25*t26*(1.709920934161365d+0*(1.3210398931339265d-3*
     1         t33*t98-2.747773264188438d-3*t12*t98+6.21814d-2*t4*t95*t9
     2         6-3.10907d-2*t27*(2.11607075208357d-1*t31*t6*t93-1.269642
     3         451250142d+0*t5*(7.876233178997433d-1*t6*(-1.312705529832
     4         9054d-1*t28*t93*t94-2.0096226153166658d-3*t92)-1.31270552
     5         98329054d-1*t29*t93*t94)/t30**2)/t32)+7.769549222703733d-
     6         4*t24*t98-3.37738d-2*t100*t101*t18)
            t105 = -4*t25*t34/t1**5
            t106 = t13**3
            t107 = 1/t1**2
            t108 = t107*t13
            t109 = -t14
            t110 = t109+t108
            t111 = t15**3.333333333333333d-1
            t112 = -t107*t13
            t113 = t14+t112
            t114 = t16**3.333333333333333d-1
            t115 = t99+t97+5.848223622634648d-1*(2.564881401242048d+0*t1
     1         13*t114+2.564881401242048d+0*t110*t111)*t35+5.84822362263
     2         4648d-1*t17*(4*t106*t26*t34+t105+t104+t103+t102)
            t116 = 1.0d+0*t36*t55
            t117 = 3.109069086965489d-2*t1*t57*t76*(t41*t43*(t41*t43*(t4
     1         1*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t
     2         43*(t41*t43*(4.785390000313652d+0*t39*t43*t77*t89-4.78539
     3         0000313652d+0*t39*t41*t77*t89*t90)-4.785390000313652d+0*t
     4         39*t41*t78*t89*t90+4.785390000313652d+0*t39*t43*t78*t89)-
     5         4.785390000313652d+0*t39*t41*t79*t89*t90+4.78539000031365
     6         2d+0*t39*t43*t79*t89)-4.785390000313652d+0*t39*t41*t80*t8
     7         9*t90+4.785390000313652d+0*t39*t43*t80*t89)-4.78539000031
     8         3652d+0*t39*t41*t81*t89*t90+4.785390000313652d+0*t39*t43*
     9         t81*t89)-4.785390000313652d+0*t39*t41*t82*t89*t90+4.78539
     :         0000313652d+0*t39*t43*t82*t89)-4.785390000313652d+0*t39*t
     ;         41*t83*t89*t90+4.785390000313652d+0*t39*t43*t83*t89)-4.78
     <         5390000313652d+0*t39*t41*t84*t89*t90+4.785390000313652d+0
     =         *t39*t43*t84*t89)-4.785390000313652d+0*t39*t41*t85*t89*t9
     >         0+4.785390000313652d+0*t39*t43*t85*t89)-4.785390000313652
     ?         d+0*t39*t41*t86*t89*t90+4.785390000313652d+0*t39*t43*t86*
     @         t89)-4.785390000313652d+0*t39*t41*t87*t89*t90+4.785390000
     1         313652d+0*t39*t43*t87*t89)
            t118 = 1/t75
            t119 = 1/t111
            t120 = 1/t114
            t121 = 3.333333333333333d-1*t113*t120+3.333333333333333d-1*t
     1         110*t119
            t122 = t1**1.6666666666666674d-1
            t123 = 1/t59**3.0d+0
            t124 = -3.1782517399910487d-1*t122*t123*t58*t62*t68*t74
            t125 = -2.7242157771351844d-1*t121*t58*t60*t63*t66
            t126 = -3.1782517399910487d-1*t122*t123*t58*t62*t66
            t127 = 1/t65**2
            t128 = 9.649190532874448d+1*t121*t36*t71-3.216396844291483d+
     1         1*t115*t63
            t129 = -1.3621078885675922d-1*t127*t128*t58*t60*t62*t64
            t130 = 1/t73**2
            t131 = 1/t56**5.0d+0
            t132 = -8.658243533790966d-2*t122*t69*t71*t72/t59**5.0d+0
            t133 = 1/t65**3.0d+0
            t134 = 3.109069086965489d-2*t57*t76*t88
            t135 = t14+t108
            t136 = t112+t109
            t137 = t99+t97+5.848223622634648d-1*(2.564881401242048d+0*t1
     1         14*t136+2.564881401242048d+0*t111*t135)*t35+5.84822362263
     2         4648d-1*t17*(-4*t106*t26*t34+t105+t104+t103+t102)
            t138 = 3.333333333333333d-1*t120*t136+3.333333333333333d-1*t
     1         119*t135
            t139 = -2.7242157771351844d-1*t138*t58*t60*t63*t66
            t140 = 9.649190532874448d+1*t138*t36*t71-3.216396844291483d+
     1         1*t137*t63
            t141 = -1.3621078885675922d-1*t127*t140*t58*t60*t62*t64
            t142 = 3.109069086965489d-2*t1*t118*t57*(1.855337900098064d-
     1         2*t58*t66*t70*t71*t74+1.3621078885675922d-1*t60*t62*t68*t
     2         74-1.3621078885675922d-1*t130*t58*t60*t62*t68*(3.71067580
     3         0196128d-2*t58*t70*t71*t72+1.3621078885675922d-1*t60*t62*
     4         t66))*t88*wght
            t143 = 1/t38**2
            t144 = 1.0d+0*(3.109069086965489d-2*t1*t57*t76*(t41*t43*(t41
     1         *t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t4
     2         3*(t41*t43*(t41*t43*(2.871234000188191d+0*t143*t37*t41*t7
     3         7*t90-2.871234000188191d+0*t143*t37*t43*t77)+2.8712340001
     4         88191d+0*t143*t37*t41*t78*t90-2.871234000188191d+0*t143*t
     5         37*t43*t78)+2.871234000188191d+0*t143*t37*t41*t79*t90-2.8
     6         71234000188191d+0*t143*t37*t43*t79)+2.871234000188191d+0*
     7         t143*t37*t41*t80*t90-2.871234000188191d+0*t143*t37*t43*t8
     8         0)+2.871234000188191d+0*t143*t37*t41*t81*t90-2.8712340001
     9         88191d+0*t143*t37*t43*t81)+2.871234000188191d+0*t143*t37*
     :         t41*t82*t90-2.871234000188191d+0*t143*t37*t43*t82)+2.8712
     ;         34000188191d+0*t143*t37*t41*t83*t90-2.871234000188191d+0*
     <         t143*t37*t43*t83)+2.871234000188191d+0*t143*t37*t41*t84*t
     =         90-2.871234000188191d+0*t143*t37*t43*t84)+2.8712340001881
     >         91d+0*t143*t37*t41*t85*t90-2.871234000188191d+0*t143*t37*
     ?         t43*t85)+2.871234000188191d+0*t143*t37*t41*t86*t90-2.8712
     @         34000188191d+0*t143*t37*t43*t86)+2.871234000188191d+0*t14
     1         3*t37*t41*t87*t90-2.871234000188191d+0*t143*t37*t43*t87)+
     2         1.0d+0*t1*t36*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t4
     3         3*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(t41*t43*(2.8712340
     4         00188191d+0*t143*t37*t41*t44*t90-2.871234000188191d+0*t14
     5         3*t37*t43*t44)+2.871234000188191d+0*t143*t37*t41*t45*t90-
     6         2.871234000188191d+0*t143*t37*t43*t45)+2.871234000188191d
     7         +0*t143*t37*t41*t46*t90-2.871234000188191d+0*t143*t37*t43
     8         *t46)+2.871234000188191d+0*t143*t37*t41*t47*t90-2.8712340
     9         00188191d+0*t143*t37*t43*t47)+2.871234000188191d+0*t143*t
     :         37*t41*t48*t90-2.871234000188191d+0*t143*t37*t43*t48)+2.8
     ;         71234000188191d+0*t143*t37*t41*t49*t90-2.871234000188191d
     <         +0*t143*t37*t43*t49)+2.871234000188191d+0*t143*t37*t41*t5
     =         0*t90-2.871234000188191d+0*t143*t37*t43*t50)+2.8712340001
     >         88191d+0*t143*t37*t41*t51*t90-2.871234000188191d+0*t143*t
     ?         37*t43*t51)+2.871234000188191d+0*t143*t37*t41*t52*t90-2.8
     @         71234000188191d+0*t143*t37*t43*t52)+2.871234000188191d+0*
     1         t143*t37*t41*t53*t90-2.871234000188191d+0*t143*t37*t43*t5
     2         3)+2.871234000188191d+0*t143*t37*t41*t54*t90-2.8712340001
     3         88191d+0*t143*t37*t43*t54))*wght
            fnc(iq) = 1.0d+0*(3.109069086965489d-2*t1*t57*t76*t88+1.0d+0
     1         *t1*t36*t55)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(t91+9.327207260896466d-2*t1*t121*t6
     1         1*t76*t88+3.109069086965489d-2*t1*t118*t57*(-2.7242157771
     2         351844d-1*t121*t58*t60*t63*t68*t74+1.3621078885675922d-1*
     3         (t129+t126+t125)*t58*t60*t62*t74-1.3621078885675922d-1*t1
     4         30*t58*t60*t62*t68*(-7.421351600392256d-2*t121*t131*t69*t
     5         70*t72-3.710675800196128d-2*t128*t133*t64*t69*t70*t71+t13
     6         2+t129+t126+t125)+t124)*t88+1.0d+0*t1*t115*t55+t134+t117+
     7         t116)*wght+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = 1.0d+0*(t91+9.327207260896466d-2*t1*t138*t6
     1         1*t76*t88+3.109069086965489d-2*t1*t118*t57*(-2.7242157771
     2         351844d-1*t138*t58*t60*t63*t68*t74+1.3621078885675922d-1*
     3         (t141+t139+t126)*t58*t60*t62*t74-1.3621078885675922d-1*t1
     4         30*t58*t60*t62*t68*(-7.421351600392256d-2*t131*t138*t69*t
     5         70*t72-3.710675800196128d-2*t133*t140*t64*t69*t70*t71+t14
     6         1+t139+t132+t126)+t124)*t88+1.0d+0*t1*t137*t55+t134+t117+
     7         t116)*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GAA) = t142+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = 3.109069086965489d-2*t1*t118*t57*(3.710675
     1         800196128d-2*t58*t66*t70*t71*t74+2.7242157771351844d-1*t6
     2         0*t62*t68*t74-1.3621078885675922d-1*t130*t58*t60*t62*t68*
     3         (7.421351600392256d-2*t58*t70*t71*t72+2.7242157771351844d
     4         -1*t60*t62*t66))*t88*wght+Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = t142+Cmat(iq,D1_GBB)
            Mmat(iq,D1_TA) = t144+Mmat(iq,D1_TA)
            Mmat(iq,D1_TB) = t144+Mmat(iq,D1_TB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = rhob+rhoa
            t2 = t1**3.333333333333333d-1
            t3 = 1/t2
            t4 = 1.325688999052018d-1*t3+1.0d+0
            t5 = t2**5.0d-1
            t6 = 1/t5
            t7 = 2.4141993114533214d-2*t6+1.0186556948d-1
            t8 = 7.876233178997433d-1*t6*t7+2.2308199064d-1
            t9 = 7.876233178997433d-1*t6*t8+4.7231125998d-1
            t10 = 1/t9
            t11 = 1.269642451250142d+0*t10*t5+1.0d+0
            t12 = log(t11)
            t13 = rhoa-rhob
            t14 = 1/t1
            t15 = t13*t14+1.0d+0
            t16 = 1.923661050931536d+0*t15**1.3333333333333333d+0-3.8473
     1         22101863072d+0
            t17 = 6.901399211255826d-2*t3+1.0d+0
            t18 = 1.3212998810398843d-2*t6+2.9729725188d-2
            t19 = 7.876233178997433d-1*t18*t6+1.2236585478d-1
            t20 = 7.876233178997433d-1*t19*t6+3.497952466d-1
            t21 = 1/t20
            t22 = 1.269642451250142d+0*t21*t5+1.0d+0
            t23 = log(t22)
            t24 = t13**4
            t25 = 1/t1**4
            t26 = 1.2746961887000874d-1*t3+1.0d+0
            t27 = 1.530901310039024d-2*t6+1.0465751434d-1
            t28 = 7.876233178997433d-1*t27*t6+1.9269083139d-1
            t29 = 7.876233178997433d-1*t28*t6+4.3896648423d-1
            t30 = 1/t29
            t31 = 1.269642451250142d+0*t30*t5+1.0d+0
            t32 = log(t31)
            t33 = 1.709920934161365d+0*(6.21814d-2*t12*t4-3.10907d-2*t26
     1         *t32)-3.37738d-2*t17*t23
            t34 = t24*t25*t33+3.37738d-2*t17*t23
            t35 = 5.848223622634648d-1*t16*t34-6.21814d-2*t12*t4
            t36 = t1**1.6666666666666669d+0
            t37 = taub+taua
            t38 = 1/t37
            t39 = 2.871234000188191d+0*t36*t38
            t40 = t39-1.0d+0
            t41 = t39+1.0d+0
            t42 = 1/t41
            t43 = param(12)
            t44 = t40*t42*t43+param(11)
            t45 = t40*t42*t44+param(10)
            t46 = t40*t42*t45+param(9)
            t47 = t40*t42*t46+param(8)
            t48 = t40*t42*t47+param(7)
            t49 = t40*t42*t48+param(6)
            t50 = t40*t42*t49+param(5)
            t51 = t40*t42*t50+param(4)
            t52 = t40*t42*t51+param(3)
            t53 = t40*t42*t52+param(2)
            t54 = t40*t42*t53+param(1)
            t55 = abs(t15)
            t56 = t55**2.0d+0
            t57 = 1/t1**1.1666666666666667d+0
            t58 = 1/t15**6.666666666666666d-1
            t59 = t57*t58
            t60 = t59**2.0d+0
            t61 = sigmabb+2.0d+0*sigmaab+gammaaa
            t62 = 1/t56
            t63 = exp(-2.5731174754331865d+2*t35*t62)
            t64 = t63-1.0d+0
            t65 = 1/t64
            t66 = 5.448431554270369d-1*t60*t61*t65
            t67 = t66+1.0d+0
            t68 = t59**4.0d+0
            t69 = 1/t64**2.0d+0
            t70 = t61**2.0d+0
            t71 = 2.9685406401569026d-1*t68*t69*t70+t66+1.0d+0
            t72 = 1/t71
            t73 = 5.448431554270369d-1*t60*t61*t67*t72+1.0d+0
            t74 = log(t73)
            t75 = param(24)
            t76 = t40*t42*t75+param(23)
            t77 = t40*t42*t76+param(22)
            t78 = t40*t42*t77+param(21)
            t79 = t40*t42*t78+param(20)
            t80 = t40*t42*t79+param(19)
            t81 = t40*t42*t80+param(18)
            t82 = t40*t42*t81+param(17)
            t83 = t40*t42*t82+param(16)
            t84 = t40*t42*t83+param(15)
            t85 = t40*t42*t84+param(14)
            t86 = t40*t42*t85+param(13)
            t87 = t1**6.666666666666666d-1
            t88 = 1/t41**2
            t89 = 1/t1**1.3333333333333336d+0
            t90 = 1/t1**6.666666666666667d-1
            t91 = 1/t5**3
            t92 = 2.11607075208357d-1*t10*t6*t90-1.269642451250142d+0*t5
     1         *(7.876233178997433d-1*t6*(-1.3127055298329054d-1*t7*t90*
     2         t91-3.169132786263567d-3*t89)-1.3127055298329054d-1*t8*t9
     3         0*t91)/t9**2
            t93 = 1/t11
            t94 = 1/t1**1.3333333333333333d+0
            t95 = 2.11607075208357d-1*t21*t6*t90-1.269642451250142d+0*t5
     1         *(7.876233178997433d-1*t6*(-1.3127055298329054d-1*t18*t90
     2         *t91-1.7344776604086162d-3*t89)-1.3127055298329054d-1*t19
     3         *t90*t91)/t20**2
            t96 = 1/t22
            t97 = t14-t13/t1**2
            t98 = 1.5000000000000002d+0*t15**3.333333333333333d-1*t34*t9
     1         7+5.848223622634648d-1*t16*(t24*t25*(-3.37738d-2*t17*t95*
     2         t96+1.709920934161365d+0*(1.3210398931339265d-3*t32*t94-2
     3         .747773264188438d-3*t12*t94+6.21814d-2*t4*t92*t93-3.10907
     4         d-2*t26*(2.11607075208357d-1*t30*t6*t90-1.269642451250142
     5         d+0*t5*(7.876233178997433d-1*t6*(-1.3127055298329054d-1*t
     6         27*t90*t91-2.0096226153166658d-3*t89)-1.3127055298329054d
     7         -1*t28*t90*t91)/t29**2)/t31)+7.769549222703733d-4*t23*t94
     8         )+3.37738d-2*t17*t95*t96-7.769549222703733d-4*t23*t94+4*t
     9         13**3*t25*t33-4*t24*t33/t1**5)+2.747773264188438d-3*t12*t
     :         94-6.21814d-2*t4*t92*t93
            t99 = 1/t73
            t100 = 1/t71**2
            t101 = -6.666666666666666d-1*t57*t97/t15**1.6666666666666669
     1         d+0-1.1666666666666667d+0*t58/t1**2.166666666666667d+0
            t102 = 1.0896863108540737d+0*t101*t57*t58*t61*t65
            t103 = 5.146234950866373d+2*t15*t35*t97/t55**4.0d+0-2.573117
     1         4754331865d+2*t62*t98
            t104 = -5.448431554270369d-1*t103*t60*t61*t63/t64**2
            t105 = 1/t37**2
            t106 = 1.0d+0*(3.886336358706861d-3*t1*t56*t74*(t40*t42*(t40
     1         *t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t4
     2         2*(t40*t42*(t40*t42*(2.871234000188191d+0*t105*t36*t40*t7
     3         5*t88-2.871234000188191d+0*t105*t36*t42*t75)+2.8712340001
     4         88191d+0*t105*t36*t40*t76*t88-2.871234000188191d+0*t105*t
     5         36*t42*t76)+2.871234000188191d+0*t105*t36*t40*t77*t88-2.8
     6         71234000188191d+0*t105*t36*t42*t77)+2.871234000188191d+0*
     7         t105*t36*t40*t78*t88-2.871234000188191d+0*t105*t36*t42*t7
     8         8)+2.871234000188191d+0*t105*t36*t40*t79*t88-2.8712340001
     9         88191d+0*t105*t36*t42*t79)+2.871234000188191d+0*t105*t36*
     :         t40*t80*t88-2.871234000188191d+0*t105*t36*t42*t80)+2.8712
     ;         34000188191d+0*t105*t36*t40*t81*t88-2.871234000188191d+0*
     <         t105*t36*t42*t81)+2.871234000188191d+0*t105*t36*t40*t82*t
     =         88-2.871234000188191d+0*t105*t36*t42*t82)+2.8712340001881
     >         91d+0*t105*t36*t40*t83*t88-2.871234000188191d+0*t105*t36*
     ?         t42*t83)+2.871234000188191d+0*t105*t36*t40*t84*t88-2.8712
     @         34000188191d+0*t105*t36*t42*t84)+2.871234000188191d+0*t10
     1         5*t36*t40*t85*t88-2.871234000188191d+0*t105*t36*t42*t85)+
     2         1.0d+0*t1*t35*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t4
     3         2*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(2.8712340
     4         00188191d+0*t105*t36*t40*t43*t88-2.871234000188191d+0*t10
     5         5*t36*t42*t43)+2.871234000188191d+0*t105*t36*t40*t44*t88-
     6         2.871234000188191d+0*t105*t36*t42*t44)+2.871234000188191d
     7         +0*t105*t36*t40*t45*t88-2.871234000188191d+0*t105*t36*t42
     8         *t45)+2.871234000188191d+0*t105*t36*t40*t46*t88-2.8712340
     9         00188191d+0*t105*t36*t42*t46)+2.871234000188191d+0*t105*t
     :         36*t40*t47*t88-2.871234000188191d+0*t105*t36*t42*t47)+2.8
     ;         71234000188191d+0*t105*t36*t40*t48*t88-2.871234000188191d
     <         +0*t105*t36*t42*t48)+2.871234000188191d+0*t105*t36*t40*t4
     =         9*t88-2.871234000188191d+0*t105*t36*t42*t49)+2.8712340001
     >         88191d+0*t105*t36*t40*t50*t88-2.871234000188191d+0*t105*t
     ?         36*t42*t50)+2.871234000188191d+0*t105*t36*t40*t51*t88-2.8
     @         71234000188191d+0*t105*t36*t42*t51)+2.871234000188191d+0*
     1         t105*t36*t40*t52*t88-2.871234000188191d+0*t105*t36*t42*t5
     2         2)+2.871234000188191d+0*t105*t36*t40*t53*t88-2.8712340001
     3         88191d+0*t105*t36*t42*t53))*wght
            fnc(iq) = 1.0d+0*(3.886336358706861d-3*t1*t56*t74*t86+1.0d+0
     1         *t1*t35*t54)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(3.886336358706861d-3*t1*t56*(1.0896
     1         863108540737d+0*t101*t57*t58*t61*t67*t72+5.44843155427036
     2         9d-1*(t104+t102)*t60*t61*t72-5.448431554270369d-1*t100*t6
     3         0*t61*t67*(1.187416256062761d+0*t101*t59**3.0d+0*t69*t70-
     4         5.937081280313805d-1*t103*t63*t68*t70/t64**3.0d+0+t104+t1
     5         02))*t86*t99+1.0d+0*t1*t54*t98+7.772672717413722d-3*t1*t1
     6         5*t74*t86*t97+3.886336358706861d-3*t1*t56*t74*(t40*t42*(t
     7         40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*
     8         t42*(t40*t42*(t40*t42*(4.785390000313652d+0*t38*t42*t75*t
     9         87-4.785390000313652d+0*t38*t40*t75*t87*t88)-4.7853900003
     :         13652d+0*t38*t40*t76*t87*t88+4.785390000313652d+0*t38*t42
     ;         *t76*t87)-4.785390000313652d+0*t38*t40*t77*t87*t88+4.7853
     <         90000313652d+0*t38*t42*t77*t87)-4.785390000313652d+0*t38*
     =         t40*t78*t87*t88+4.785390000313652d+0*t38*t42*t78*t87)-4.7
     >         85390000313652d+0*t38*t40*t79*t87*t88+4.785390000313652d+
     ?         0*t38*t42*t79*t87)-4.785390000313652d+0*t38*t40*t80*t87*t
     @         88+4.785390000313652d+0*t38*t42*t80*t87)-4.78539000031365
     1         2d+0*t38*t40*t81*t87*t88+4.785390000313652d+0*t38*t42*t81
     2         *t87)-4.785390000313652d+0*t38*t40*t82*t87*t88+4.78539000
     3         0313652d+0*t38*t42*t82*t87)-4.785390000313652d+0*t38*t40*
     4         t83*t87*t88+4.785390000313652d+0*t38*t42*t83*t87)-4.78539
     5         0000313652d+0*t38*t40*t84*t87*t88+4.785390000313652d+0*t3
     6         8*t42*t84*t87)-4.785390000313652d+0*t38*t40*t85*t87*t88+4
     7         .785390000313652d+0*t38*t42*t85*t87)+1.0d+0*t1*t35*(t40*t
     8         42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*(t40*t42*
     9         (t40*t42*(t40*t42*(t40*t42*(4.785390000313652d+0*t38*t42*
     :         t43*t87-4.785390000313652d+0*t38*t40*t43*t87*t88)-4.78539
     ;         0000313652d+0*t38*t40*t44*t87*t88+4.785390000313652d+0*t3
     <         8*t42*t44*t87)-4.785390000313652d+0*t38*t40*t45*t87*t88+4
     =         .785390000313652d+0*t38*t42*t45*t87)-4.785390000313652d+0
     >         *t38*t40*t46*t87*t88+4.785390000313652d+0*t38*t42*t46*t87
     ?         )-4.785390000313652d+0*t38*t40*t47*t87*t88+4.785390000313
     @         652d+0*t38*t42*t47*t87)-4.785390000313652d+0*t38*t40*t48*
     1         t87*t88+4.785390000313652d+0*t38*t42*t48*t87)-4.785390000
     2         313652d+0*t38*t40*t49*t87*t88+4.785390000313652d+0*t38*t4
     3         2*t49*t87)-4.785390000313652d+0*t38*t40*t50*t87*t88+4.785
     4         390000313652d+0*t38*t42*t50*t87)-4.785390000313652d+0*t38
     5         *t40*t51*t87*t88+4.785390000313652d+0*t38*t42*t51*t87)-4.
     6         785390000313652d+0*t38*t40*t52*t87*t88+4.785390000313652d
     7         +0*t38*t42*t52*t87)-4.785390000313652d+0*t38*t40*t53*t87*
     8         t88+4.785390000313652d+0*t38*t42*t53*t87)+3.8863363587068
     9         61d-3*t56*t74*t86+1.0d+0*t35*t54)*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 3.886336358706861d-3*t1*t56*(2.96854064015
     1         69026d-1*t61*t65*t68*t72+5.448431554270369d-1*t60*t67*t72
     2         -5.448431554270369d-1*t100*t60*t61*t67*(5.937081280313805
     3         d-1*t61*t68*t69+5.448431554270369d-1*t60*t65))*t86*t99*wg
     4         ht+Cmat(iq,D1_GAA)
            Mmat(iq,D1_TA) = t106+Mmat(iq,D1_TA)
            Mmat(iq,D1_TB) = t106+Mmat(iq,D1_TB)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = rhob**3.333333333333333d-1
            t2 = t1**5.0d-1
            t3 = 1/t2
            t4 = 1.1771443702974159d-2*t3+2.9729725188d-2
            t5 = 7.016926042943223d-1*t3*t4+1.2236585478d-1
            t6 = 7.016926042943223d-1*t3*t5+3.497952466d-1
            t7 = 1/t6
            t8 = 1.4251254664507676d+0*t2*t7+1.0d+0
            t9 = log(t8)
            t10 = 1/t1
            t11 = 5.477644184000001d-2*t10+1.0d+0
            t12 = 2.150807071909054d-2*t3+1.0186556948d-1
            t13 = 7.016926042943223d-1*t12*t3+2.2308199064d-1
            t14 = 7.016926042943223d-1*t13*t3+4.7231125998d-1
            t15 = 1/t14
            t16 = 1.4251254664507676d+0*t15*t2+1.0d+0
            t17 = log(t16)
            t18 = 1.0522000558389215d-1*t10+1.0d+0
            t19 = -3.799552500000001d-2*t11*t9-6.21814d-2*t17*t18
            t20 = 3.174802103936399d+0
            t21 = rhob**1.6666666666666669d+0
            t22 = taub+taua
            t23 = 1/t22
            t24 = 2.871234000188191d+0*t20*t21*t23
            t25 = t24-1.0d+0
            t26 = t24+1.0d+0
            t27 = 1/t26
            t28 = param(12)
            t29 = t25*t27*t28+param(11)
            t30 = t25*t27*t29+param(10)
            t31 = t25*t27*t30+param(9)
            t32 = t25*t27*t31+param(8)
            t33 = t25*t27*t32+param(7)
            t34 = t25*t27*t33+param(6)
            t35 = t25*t27*t34+param(5)
            t36 = t25*t27*t35+param(4)
            t37 = t25*t27*t36+param(3)
            t38 = t25*t27*t37+param(2)
            t39 = t25*t27*t38+param(1)
            t40 = rhob**1.1666666666666667d+0
            t41 = 1/t40**2.0d+0
            t42 = sigmabb+2.0d+0*sigmaab+gammabb
            t43 = exp(-2.5731174754331865d+2*t19)
            t44 = t43-1.0d+0
            t45 = 1/t44
            t46 = 1.0811057476031892d-1*t41*t42*t45
            t47 = t46+1.0d+0
            t48 = 1/t40**4.0d+0
            t49 = 1/t44**2.0d+0
            t50 = t42**2.0d+0
            t51 = 1.1687896375006504d-2*t48*t49*t50+t46+1.0d+0
            t52 = 1/t51
            t53 = 1.0811057476031892d-1*t41*t42*t47*t52+1.0d+0
            t54 = log(t53)
            t55 = param(24)
            t56 = t25*t27*t55+param(23)
            t57 = t25*t27*t56+param(22)
            t58 = t25*t27*t57+param(21)
            t59 = t25*t27*t58+param(20)
            t60 = t25*t27*t59+param(19)
            t61 = t25*t27*t60+param(18)
            t62 = t25*t27*t61+param(17)
            t63 = t25*t27*t62+param(16)
            t64 = t25*t27*t63+param(15)
            t65 = t25*t27*t64+param(14)
            t66 = t25*t27*t65+param(13)
            t67 = rhob**6.666666666666666d-1
            t68 = 1/t26**2
            t69 = 1/rhob**1.3333333333333333d+0
            t70 = 1/rhob**1.3333333333333336d+0
            t71 = 1/t2**3
            t72 = 1/rhob**6.666666666666667d-1
            t73 = 6.937532217809221d-4*t69*t9-3.799552500000001d-2*t11*(
     1         2.375209110751279d-1*t3*t7*t72-1.4251254664507676d+0*t2*(
     2         7.016926042943223d-1*t3*(-1.1694876738238705d-1*t4*t71*t7
     3         2-1.3766558313739896d-3*t70)-1.1694876738238705d-1*t5*t71
     4         *t72)/t6**2)/t8-6.21814d-2*t18*(2.375209110751279d-1*t15*
     5         t3*t72-1.4251254664507676d+0*t2*(7.016926042943223d-1*t3*
     6         (-1.1694876738238705d-1*t12*t71*t72-2.51534235937085d-3*t
     7         70)-1.1694876738238705d-1*t13*t71*t72)/t14**2)/t16+2.1809
     8         0908507141d-3*t17*t69
            t74 = 1/t53
            t75 = 1/t51**2
            t76 = rhob**1.6666666666666674d-1
            t77 = 1/t40**3.0d+0
            t78 = -2.522580077740775d-1*t42*t45*t76*t77
            t79 = 2.781812091949026d+1*t41*t42*t43*t73/t44**2
            t80 = 1/t22**2
            t81 = 1.0d+0*(7.772672717413722d-3*rhob*t54*(t25*t27*(t25*t2
     1         7*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(
     2         t25*t27*(t25*t27*(2.871234000188191d+0*t20*t21*t25*t55*t6
     3         8*t80-2.871234000188191d+0*t20*t21*t27*t55*t80)+2.8712340
     4         00188191d+0*t20*t21*t25*t56*t68*t80-2.871234000188191d+0*
     5         t20*t21*t27*t56*t80)+2.871234000188191d+0*t20*t21*t25*t57
     6         *t68*t80-2.871234000188191d+0*t20*t21*t27*t57*t80)+2.8712
     7         34000188191d+0*t20*t21*t25*t58*t68*t80-2.871234000188191d
     8         +0*t20*t21*t27*t58*t80)+2.871234000188191d+0*t20*t21*t25*
     9         t59*t68*t80-2.871234000188191d+0*t20*t21*t27*t59*t80)+2.8
     :         71234000188191d+0*t20*t21*t25*t60*t68*t80-2.8712340001881
     ;         91d+0*t20*t21*t27*t60*t80)+2.871234000188191d+0*t20*t21*t
     <         25*t61*t68*t80-2.871234000188191d+0*t20*t21*t27*t61*t80)+
     =         2.871234000188191d+0*t20*t21*t25*t62*t68*t80-2.8712340001
     >         88191d+0*t20*t21*t27*t62*t80)+2.871234000188191d+0*t20*t2
     ?         1*t25*t63*t68*t80-2.871234000188191d+0*t20*t21*t27*t63*t8
     @         0)+2.871234000188191d+0*t20*t21*t25*t64*t68*t80-2.8712340
     1         00188191d+0*t20*t21*t27*t64*t80)+2.871234000188191d+0*t20
     2         *t21*t25*t65*t68*t80-2.871234000188191d+0*t20*t21*t27*t65
     3         *t80)+2.0d+0*rhob*t19*(t25*t27*(t25*t27*(t25*t27*(t25*t27
     4         *(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(2
     5         .871234000188191d+0*t20*t21*t25*t28*t68*t80-2.87123400018
     6         8191d+0*t20*t21*t27*t28*t80)+2.871234000188191d+0*t20*t21
     7         *t25*t29*t68*t80-2.871234000188191d+0*t20*t21*t27*t29*t80
     8         )+2.871234000188191d+0*t20*t21*t25*t30*t68*t80-2.87123400
     9         0188191d+0*t20*t21*t27*t30*t80)+2.871234000188191d+0*t20*
     :         t21*t25*t31*t68*t80-2.871234000188191d+0*t20*t21*t27*t31*
     ;         t80)+2.871234000188191d+0*t20*t21*t25*t32*t68*t80-2.87123
     <         4000188191d+0*t20*t21*t27*t32*t80)+2.871234000188191d+0*t
     =         20*t21*t25*t33*t68*t80-2.871234000188191d+0*t20*t21*t27*t
     >         33*t80)+2.871234000188191d+0*t20*t21*t25*t34*t68*t80-2.87
     ?         1234000188191d+0*t20*t21*t27*t34*t80)+2.871234000188191d+
     @         0*t20*t21*t25*t35*t68*t80-2.871234000188191d+0*t20*t21*t2
     1         7*t35*t80)+2.871234000188191d+0*t20*t21*t25*t36*t68*t80-2
     2         .871234000188191d+0*t20*t21*t27*t36*t80)+2.87123400018819
     3         1d+0*t20*t21*t25*t37*t68*t80-2.871234000188191d+0*t20*t21
     4         *t27*t37*t80)+2.871234000188191d+0*t20*t21*t25*t38*t68*t8
     5         0-2.871234000188191d+0*t20*t21*t27*t38*t80))*wght
            fnc(iq) = 1.0d+0*(7.772672717413722d-3*rhob*t54*t66+2.0d+0*r
     1         hob*t19*t39)*wght+fnc(iq)
            Amat(iq,D1_RB) = 1.0d+0*(7.772672717413722d-3*rhob*t66*t74*(
     1         -1.0811057476031892d-1*t41*t42*t47*t75*(t79+t78-5.4543516
     2         41669702d-2*t49*t50*t76/t40**5.0d+0+6.014866082716286d+0*
     3         t43*t48*t50*t73/t44**3.0d+0)+1.0811057476031892d-1*t41*t4
     4         2*t52*(t79+t78)-2.522580077740775d-1*t42*t47*t52*t76*t77)
     5         +2.0d+0*rhob*t39*t73+7.772672717413722d-3*rhob*t54*(t25*t
     6         27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*
     7         (t25*t27*(t25*t27*(t25*t27*(4.785390000313652d+0*t20*t23*
     8         t27*t55*t67-4.785390000313652d+0*t20*t23*t25*t55*t67*t68)
     9         -4.785390000313652d+0*t20*t23*t25*t56*t67*t68+4.785390000
     :         313652d+0*t20*t23*t27*t56*t67)-4.785390000313652d+0*t20*t
     ;         23*t25*t57*t67*t68+4.785390000313652d+0*t20*t23*t27*t57*t
     <         67)-4.785390000313652d+0*t20*t23*t25*t58*t67*t68+4.785390
     =         000313652d+0*t20*t23*t27*t58*t67)-4.785390000313652d+0*t2
     >         0*t23*t25*t59*t67*t68+4.785390000313652d+0*t20*t23*t27*t5
     ?         9*t67)-4.785390000313652d+0*t20*t23*t25*t60*t67*t68+4.785
     @         390000313652d+0*t20*t23*t27*t60*t67)-4.785390000313652d+0
     1         *t20*t23*t25*t61*t67*t68+4.785390000313652d+0*t20*t23*t27
     2         *t61*t67)-4.785390000313652d+0*t20*t23*t25*t62*t67*t68+4.
     3         785390000313652d+0*t20*t23*t27*t62*t67)-4.785390000313652
     4         d+0*t20*t23*t25*t63*t67*t68+4.785390000313652d+0*t20*t23*
     5         t27*t63*t67)-4.785390000313652d+0*t20*t23*t25*t64*t67*t68
     6         +4.785390000313652d+0*t20*t23*t27*t64*t67)-4.785390000313
     7         652d+0*t20*t23*t25*t65*t67*t68+4.785390000313652d+0*t20*t
     8         23*t27*t65*t67)+2.0d+0*rhob*t19*(t25*t27*(t25*t27*(t25*t2
     9         7*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(t25*t27*(
     :         t25*t27*(4.785390000313652d+0*t20*t23*t27*t28*t67-4.78539
     ;         0000313652d+0*t20*t23*t25*t28*t67*t68)-4.785390000313652d
     <         +0*t20*t23*t25*t29*t67*t68+4.785390000313652d+0*t20*t23*t
     =         27*t29*t67)-4.785390000313652d+0*t20*t23*t25*t30*t67*t68+
     >         4.785390000313652d+0*t20*t23*t27*t30*t67)-4.7853900003136
     ?         52d+0*t20*t23*t25*t31*t67*t68+4.785390000313652d+0*t20*t2
     @         3*t27*t31*t67)-4.785390000313652d+0*t20*t23*t25*t32*t67*t
     1         68+4.785390000313652d+0*t20*t23*t27*t32*t67)-4.7853900003
     2         13652d+0*t20*t23*t25*t33*t67*t68+4.785390000313652d+0*t20
     3         *t23*t27*t33*t67)-4.785390000313652d+0*t20*t23*t25*t34*t6
     4         7*t68+4.785390000313652d+0*t20*t23*t27*t34*t67)-4.7853900
     5         00313652d+0*t20*t23*t25*t35*t67*t68+4.785390000313652d+0*
     6         t20*t23*t27*t35*t67)-4.785390000313652d+0*t20*t23*t25*t36
     7         *t67*t68+4.785390000313652d+0*t20*t23*t27*t36*t67)-4.7853
     8         90000313652d+0*t20*t23*t25*t37*t67*t68+4.785390000313652d
     9         +0*t20*t23*t27*t37*t67)-4.785390000313652d+0*t20*t23*t25*
     :         t38*t67*t68+4.785390000313652d+0*t20*t23*t27*t38*t67)+7.7
     ;         72672717413722d-3*t54*t66+2.0d+0*t19*t39)*wght+Amat(iq,D1
     <         _RB)
            Cmat(iq,D1_GBB) = 7.772672717413722d-3*rhob*t66*t74*(-1.0811
     1         057476031892d-1*t41*t42*t47*(2.3375792750013008d-2*t42*t4
     2         8*t49+1.0811057476031892d-1*t41*t45)*t75+1.16878963750065
     3         07d-2*t42*t45*t48*t52+1.0811057476031892d-1*t41*t47*t52)*
     4         wght+Cmat(iq,D1_GBB)
            Mmat(iq,D1_TB) = t81+Mmat(iq,D1_TB)
            Mmat(iq,D1_TA) = t81+Mmat(iq,D1_TA)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_m11 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& 0.1325688999052018\,{\it t_3}+1.0\\\\ 
C>   {\it t_5} &=& \sqrt{{\it t_2}}\\\\ 
C>   {\it t_6} &=& {{1}\over{{\it t_5}}}\\\\ 
C>   {\it t_7} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.02414199311453321\,{\it t_6}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_8} &=& -\rho_\beta\\\\ 
C>   {\it t_9} &=& {\it t_8}+\rho_\alpha\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{11}} &=& 1.0-{\it t_9}\,{\it t_{10}}\\\\ 
C>   {\it t_{12}} &=& {\it t_9}\,{\it t_{10}}+1.0\\\\ 
C>   {\it t_{13}} &=& 0.06901399211255826\,{\it t_3}+1.0\\\\ 
C>   {\it t_{14}} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01321299881039884\,{\it t_6}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{15}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{12}}^{{{4}\over{3}}}+1.923661050931536\,{\it t_{11}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_9}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_4}\,{\it t_7}-0.0310907\,\left(0.1274696188700087\,{\it t_3}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01530901310039024\,{\it t_6}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)}\over{{\it t_1}^4}}+0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)-0.0621814\,{\it t_4}\,{\it t_7}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{17}} &=& {{2.871234000188191\,{\it t_1}^{{{5}\over{3}}}}\over{\tau_\beta+\tau_\alpha}}\\\\ 
C>   {\it t_{18}} &=& {\it t_{17}}-1.0\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{17}}+1.0}}\\\\ 
C>   {\it t_{20}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{23}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{24}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{26}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{27}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{29}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{30}} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_{31}} &=& 0.5\,{\it t_{12}}^{{{2}\over{3}}}+0.5\,{\it t_{11}}^{{{2}\over{3}}}\\\\ 
C>   {\it t_{32}} &=& {\it t_{31}}^{3.0}\\\\ 
C>   {\it t_{33}} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}^{2.0}}}\\\\ 
C>   {\it t_{35}} &=& {{1}\over{{\it t_{31}}^{2.0}}}\\\\ 
C>   {\it t_{36}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{37}} &=& \sigma_{\beta\beta}+{\it t_{36}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{e^{{{32.16396844291483\,{\it t_{15}}}\over{{\it t_{32}}}}}}}-1.0\\\\ 
C>   {\it t_{39}} &=& {{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}}\over{{\it t_{38}}}}\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{51}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{52}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{53}} &=& {\it t_{52}}^{0.3333333333333333}\\\\ 
C>   {\it t_{54}} &=& {{1}\over{{\it t_{53}}}}\\\\ 
C>   {\it t_{55}} &=& 0.1325688999052018\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{56}} &=& \sqrt{{\it t_{53}}}\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{58}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.02414199311453321\,{\it t_{57}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{59}} &=& \rho_s+{\it t_8}\\\\ 
C>   {\it t_{60}} &=& {{{\it t_{59}}}\over{{\it t_{52}}}}+1.0\\\\ 
C>   {\it t_{61}} &=& 0.06901399211255826\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{62}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01321299881039884\,{\it t_{57}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{63}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{60}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{59}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{55}}\,{\it t_{58}}-0.0310907\,\left(0.1274696188700087\,{\it t_{54}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01530901310039024\,{\it t_{57}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)}\over{{\it t_{52}}^4}}+0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)-0.0621814\,{\it t_{55}}\,{\it t_{58}}\\\\ 
C>   {\it t_{64}} &=& {{2.871234000188191\,{\it t_{52}}^{{{5}\over{3}}}}\over{\tau_{\bar s}+\tau_s}}\\\\ 
C>   {\it t_{65}} &=& {\it t_{64}}-1.0\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{64}}+1.0}}\\\\ 
C>   {\it t_{67}} &=& \left| {\it t_{60}}\right| ^{2.0}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{{\it t_{52}}^{1.166666666666667}\,{\it t_{60}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {\it t_{68}}^{2.0}\\\\ 
C>   {\it t_{70}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{36}}\\\\ 
C>   {\it t_{71}} &=& {{1}\over{e^{{{257.3117475433186\,{\it t_{63}}}\over{{\it t_{67}}}}}}}-1.0\\\\ 
C>   {\it t_{72}} &=& {{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}}\over{{\it t_{71}}}}\\\\ 
C>   f &=& 1.0\,\left(0.03109069086965489\,{\it t_1}\,{\it t_{32}}\,\log \left({{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}\,\left({\it t_{39}}+1.0\right)}\over{{{0.01855337900098064\,{\it t_{37}}^{2.0}}\over{{\it t_{33}}^{4.0}\,{\it t_{31}}^{4.0}\,{\it t_{38}}^{2.0}}}+{\it t_{39}}+1.0}}+1.0\right)\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{51}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_1}\,{\it t_{15}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{30}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.003886336358706861\,{\it t_{52}}\,{\it t_{67}}\,\log \left({{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}\,\left({\it t_{72}}+1.0\right)}\over{{{0.2968540640156903\,{\it t_{68}}^{4.0}\,{\it t_{70}}^{2.0}}\over{{\it t_{71}}^{2.0}}}+{\it t_{72}}+1.0}}+1.0\right)\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{51}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_{52}}\,{\it t_{63}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{30}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] R Peverati, DG Truhlar, J.Phys.Chem.Lett. 2, 2810 (2011)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/jz201170d "> 
C> 10.1021/jz201170d </a> 
C> 
      subroutine nwxcm_c_m11_d2(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Amat2,Cmat,Cmat2,Mmat,Mmat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,NCOL_AMAT2)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,NCOL_CMAT2)  !< [Output] The 2nd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat2(nq,NCOL_MMAT2)  !< [Output] The 2nd derivative wrt tau 
                                             !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_m11 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{0.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& 0.1325688999052018\,{\it t_3}+1.0\\\\ 
C>   {\it t_5} &=& \sqrt{{\it t_2}}\\\\ 
C>   {\it t_6} &=& {{1}\over{{\it t_5}}}\\\\ 
C>   {\it t_7} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.02414199311453321\,{\it t_6}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_8} &=& -\rho_\beta\\\\ 
C>   {\it t_9} &=& {\it t_8}+\rho_\alpha\\\\ 
C>   {\it t_{10}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{11}} &=& 1.0-{\it t_9}\,{\it t_{10}}\\\\ 
C>   {\it t_{12}} &=& {\it t_9}\,{\it t_{10}}+1.0\\\\ 
C>   {\it t_{13}} &=& 0.06901399211255826\,{\it t_3}+1.0\\\\ 
C>   {\it t_{14}} &=& \log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01321299881039884\,{\it t_6}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{15}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{12}}^{{{4}\over{3}}}+1.923661050931536\,{\it t_{11}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_9}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_4}\,{\it t_7}-0.0310907\,\left(0.1274696188700087\,{\it t_3}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_5}}\over{0.7876233178997433\,{\it t_6}\,\left(0.7876233178997433\,{\it t_6}\,\left(0.01530901310039024\,{\it t_6}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)}\over{{\it t_1}^4}}+0.0337738\,{\it t_{13}}\,{\it t_{14}}\right)-0.0621814\,{\it t_4}\,{\it t_7}\\\\ 
C>   {\it t_{16}} &=& {\it param}\left(1\right)\\\\ 
C>   {\it t_{17}} &=& {{2.871234000188191\,{\it t_1}^{{{5}\over{3}}}}\over{\tau_\beta+\tau_\alpha}}\\\\ 
C>   {\it t_{18}} &=& {\it t_{17}}-1.0\\\\ 
C>   {\it t_{19}} &=& {{1}\over{{\it t_{17}}+1.0}}\\\\ 
C>   {\it t_{20}} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_{21}} &=& {\it param}\left(3\right)\\\\ 
C>   {\it t_{22}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{23}} &=& {\it param}\left(5\right)\\\\ 
C>   {\it t_{24}} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{25}} &=& {\it param}\left(7\right)\\\\ 
C>   {\it t_{26}} &=& {\it param}\left(8\right)\\\\ 
C>   {\it t_{27}} &=& {\it param}\left(9\right)\\\\ 
C>   {\it t_{28}} &=& {\it param}\left(10\right)\\\\ 
C>   {\it t_{29}} &=& {\it param}\left(11\right)\\\\ 
C>   {\it t_{30}} &=& {\it param}\left(12\right)\\\\ 
C>   {\it t_{31}} &=& 0.5\,{\it t_{12}}^{{{2}\over{3}}}+0.5\,{\it t_{11}}^{{{2}\over{3}}}\\\\ 
C>   {\it t_{32}} &=& {\it t_{31}}^{3.0}\\\\ 
C>   {\it t_{33}} &=& {\it t_1}^{1.166666666666667}\\\\ 
C>   {\it t_{34}} &=& {{1}\over{{\it t_{33}}^{2.0}}}\\\\ 
C>   {\it t_{35}} &=& {{1}\over{{\it t_{31}}^{2.0}}}\\\\ 
C>   {\it t_{36}} &=& 2.0\,\sigma_{\alpha\beta}\\\\ 
C>   {\it t_{37}} &=& \sigma_{\beta\beta}+{\it t_{36}}+\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{e^{{{32.16396844291483\,{\it t_{15}}}\over{{\it t_{32}}}}}}}-1.0\\\\ 
C>   {\it t_{39}} &=& {{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}}\over{{\it t_{38}}}}\\\\ 
C>   {\it t_{40}} &=& {\it param}\left(13\right)\\\\ 
C>   {\it t_{41}} &=& {\it param}\left(14\right)\\\\ 
C>   {\it t_{42}} &=& {\it param}\left(15\right)\\\\ 
C>   {\it t_{43}} &=& {\it param}\left(16\right)\\\\ 
C>   {\it t_{44}} &=& {\it param}\left(17\right)\\\\ 
C>   {\it t_{45}} &=& {\it param}\left(18\right)\\\\ 
C>   {\it t_{46}} &=& {\it param}\left(19\right)\\\\ 
C>   {\it t_{47}} &=& {\it param}\left(20\right)\\\\ 
C>   {\it t_{48}} &=& {\it param}\left(21\right)\\\\ 
C>   {\it t_{49}} &=& {\it param}\left(22\right)\\\\ 
C>   {\it t_{50}} &=& {\it param}\left(23\right)\\\\ 
C>   {\it t_{51}} &=& {\it param}\left(24\right)\\\\ 
C>   {\it t_{52}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{53}} &=& {\it t_{52}}^{0.3333333333333333}\\\\ 
C>   {\it t_{54}} &=& {{1}\over{{\it t_{53}}}}\\\\ 
C>   {\it t_{55}} &=& 0.1325688999052018\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{56}} &=& \sqrt{{\it t_{53}}}\\\\ 
C>   {\it t_{57}} &=& {{1}\over{{\it t_{56}}}}\\\\ 
C>   {\it t_{58}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.02414199311453321\,{\it t_{57}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{59}} &=& \rho_s+{\it t_8}\\\\ 
C>   {\it t_{60}} &=& {{{\it t_{59}}}\over{{\it t_{52}}}}+1.0\\\\ 
C>   {\it t_{61}} &=& 0.06901399211255826\,{\it t_{54}}+1.0\\\\ 
C>   {\it t_{62}} &=& \log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01321299881039884\,{\it t_{57}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{63}} &=& 0.5848223622634648\,\left(1.923661050931536\,{\it t_{60}}^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{59}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{55}}\,{\it t_{58}}-0.0310907\,\left(0.1274696188700087\,{\it t_{54}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{56}}}\over{0.7876233178997433\,{\it t_{57}}\,\left(0.7876233178997433\,{\it t_{57}}\,\left(0.01530901310039024\,{\it t_{57}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)}\over{{\it t_{52}}^4}}+0.0337738\,{\it t_{61}}\,{\it t_{62}}\right)-0.0621814\,{\it t_{55}}\,{\it t_{58}}\\\\ 
C>   {\it t_{64}} &=& {{2.871234000188191\,{\it t_{52}}^{{{5}\over{3}}}}\over{\tau_{\bar s}+\tau_s}}\\\\ 
C>   {\it t_{65}} &=& {\it t_{64}}-1.0\\\\ 
C>   {\it t_{66}} &=& {{1}\over{{\it t_{64}}+1.0}}\\\\ 
C>   {\it t_{67}} &=& \left| {\it t_{60}}\right| ^{2.0}\\\\ 
C>   {\it t_{68}} &=& {{1}\over{{\it t_{52}}^{1.166666666666667}\,{\it t_{60}}^{{{2}\over{3}}}}}\\\\ 
C>   {\it t_{69}} &=& {\it t_{68}}^{2.0}\\\\ 
C>   {\it t_{70}} &=& \sigma_{ss}+\sigma_{\beta\beta}+{\it t_{36}}\\\\ 
C>   {\it t_{71}} &=& {{1}\over{e^{{{257.3117475433186\,{\it t_{63}}}\over{{\it t_{67}}}}}}}-1.0\\\\ 
C>   {\it t_{72}} &=& {{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}}\over{{\it t_{71}}}}\\\\ 
C>   f &=& 1.0\,\left(0.03109069086965489\,{\it t_1}\,{\it t_{32}}\,\log \left({{0.1362107888567592\,{\it t_{34}}\,{\it t_{35}}\,{\it t_{37}}\,\left({\it t_{39}}+1.0\right)}\over{{{0.01855337900098064\,{\it t_{37}}^{2.0}}\over{{\it t_{33}}^{4.0}\,{\it t_{31}}^{4.0}\,{\it t_{38}}^{2.0}}}+{\it t_{39}}+1.0}}+1.0\right)\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{51}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_1}\,{\it t_{15}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{18}}\,{\it t_{19}}\,\left({\it t_{30}}\,{\it t_{18}}\,{\it t_{19}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.003886336358706861\,{\it t_{52}}\,{\it t_{67}}\,\log \left({{0.5448431554270369\,{\it t_{69}}\,{\it t_{70}}\,\left({\it t_{72}}+1.0\right)}\over{{{0.2968540640156903\,{\it t_{68}}^{4.0}\,{\it t_{70}}^{2.0}}\over{{\it t_{71}}^{2.0}}}+{\it t_{72}}+1.0}}+1.0\right)\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{51}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{50}}\right)+{\it t_{49}}\right)+{\it t_{48}}\right)+{\it t_{47}}\right)+{\it t_{46}}\right)+{\it t_{45}}\right)+{\it t_{44}}\right)+{\it t_{43}}\right)+{\it t_{42}}\right)+{\it t_{41}}\right)+{\it t_{40}}\right)+1.0\,{\it t_{52}}\,{\it t_{63}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{65}}\,{\it t_{66}}\,\left({\it t_{30}}\,{\it t_{65}}\,{\it t_{66}}+{\it t_{29}}\right)+{\it t_{28}}\right)+{\it t_{27}}\right)+{\it t_{26}}\right)+{\it t_{25}}\right)+{\it t_{24}}\right)+{\it t_{23}}\right)+{\it t_{22}}\right)+{\it t_{21}}\right)+{\it t_{20}}\right)+{\it t_{16}}\right)\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] R Peverati, DG Truhlar, J.Phys.Chem.Lett. 2, 2810 (2011)  , DOI: 
C> <a href="http://dx.doi.org/10.1021/jz201170d "> 
C> 10.1021/jz201170d </a> 
C> 
      subroutine nwxcm_c_m11_d3(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,tau,fnc,Amat,Amat2,Amat3, 
     +Cmat,Cmat2,Cmat3,Mmat,Mmat2,Mmat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,NCOL_RHO)      !< [Input] The density 
      double precision rgamma(nq,NCOL_GAMMA) !< [Input] The norm of the density 
                                             !< gradients 
      double precision tau(nq,NCOL_TAU)      !< [Input] The kinetic energy density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,NCOL_AMAT)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,NCOL_CMAT)   !< [Output] The derivative wrt rgamma 
      double precision Mmat(nq,NCOL_MMAT)   !< [Output] The derivative wrt tau 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,NCOL_AMAT2)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,NCOL_CMAT2)  !< [Output] The 2nd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat2(nq,NCOL_MMAT2)  !< [Output] The 2nd derivative wrt tau 
                                             !< and possibly rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,NCOL_AMAT3)  !< [Output] The 3rd derivative wrt rho 
      double precision Cmat3(nq,NCOL_CMAT3)  !< [Output] The 3rd derivative wrt rgamma 
                                             !< and possibly rho 
      double precision Mmat3(nq,NCOL_MMAT3)  !< [Output] The 3rd derivative wrt tau 
                                             !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          taua    = 0.5d0*tau(iq,T_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          taua    = tau(iq,T_A) 
          taub    = tau(iq,T_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
