C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_c_b97.F 
C> The nwxcm_c_b97 functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_c_b97 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{0.3333333333333333}\\\\ 
C>   {\it t_2} &=& \sqrt{{\it t_1}}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& \log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_3}+0.10186556948\right)\,{\it t_3}+0.22308199064\right)\,{\it t_3}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_6} &=& 0.1325688999052018\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_5}\,{\it t_6}-0.0310907\,\log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_3}+0.10465751434\right)\,{\it t_3}+0.19269083139\right)\,{\it t_3}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_4}+1.0\right)\right)-0.0621814\,{\it t_5}\,{\it t_6}\\\\ 
C>   {\it t_8} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_9} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{11}} &=& 0.2\,{\it t_{10}}\,\sigma_{\alpha\alpha}+1.0\\\\ 
C>   {\it t_{12}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{13}} &=& \rho_\beta^{0.3333333333333333}\\\\ 
C>   {\it t_{14}} &=& \sqrt{{\it t_{13}}}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{16}} &=& {{1}\over{{\it t_{13}}}}\\\\ 
C>   {\it t_{17}} &=& \log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{15}}+0.10186556948\right)\,{\it t_{15}}+0.22308199064\right)\,{\it t_{15}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{18}} &=& 0.1325688999052018\,{\it t_{16}}+1.0\\\\ 
C>   {\it t_{19}} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_{17}}\,{\it t_{18}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{15}}+0.10465751434\right)\,{\it t_{15}}+0.19269083139\right)\,{\it t_{15}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{16}}+1.0\right)\right)-0.0621814\,{\it t_{17}}\,{\it t_{18}}\\\\ 
C>   {\it t_{20}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{21}} &=& 0.2\,{\it t_{20}}\,\sigma_{\beta\beta}+1.0\\\\ 
C>   {\it t_{22}} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_{23}} &=& {\it t_{22}}^{0.3333333333333333}\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_{23}}}}\\\\ 
C>   {\it t_{25}} &=& 0.1325688999052018\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& \sqrt{{\it t_{23}}}\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_{26}}}}\\\\ 
C>   {\it t_{28}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.02414199311453321\,{\it t_{27}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{29}} &=& \rho_\alpha-\rho_\beta\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_{22}}}}\\\\ 
C>   {\it t_{31}} &=& 0.06901399211255826\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{32}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01321299881039884\,{\it t_{27}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{33}} &=& {\it t_{20}}\,\sigma_{\beta\beta}+{\it t_{10}}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{34}} &=& 0.003\,{\it t_{33}}+1.0\\\\ 
C>   {\it t_{35}} &=& \rho_s^{0.3333333333333333}\\\\ 
C>   {\it t_{36}} &=& \sqrt{{\it t_{35}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{{\it t_{36}}}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_{35}}}}\\\\ 
C>   {\it t_{39}} &=& \log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{37}}+0.10186556948\right)\,{\it t_{37}}+0.22308199064\right)\,{\it t_{37}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{40}} &=& 0.1325688999052018\,{\it t_{38}}+1.0\\\\ 
C>   {\it t_{41}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{42}} &=& 0.2\,{\it t_{41}}\,\sigma_{ss}+1.0\\\\ 
C>   f &=& 1.0\,\left(\left(1.0\,{\it t_{22}}\,\left(0.5848223622634648\,\left(1.923661050931536\,\left({\it t_{29}}\,{\it t_{30}}+1.0\right)^{{{4}\over{3}}}+1.923661050931536\,\left(1.0-{\it t_{29}}\,{\it t_{30}}\right)^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{29}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{25}}\,{\it t_{28}}-0.0310907\,\left(0.1274696188700087\,{\it t_{24}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01530901310039024\,{\it t_{27}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)}\over{{\it t_{22}}^4}}+0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)-0.0621814\,{\it t_{25}}\,{\it t_{28}}\right)-1.0\,{\it t_{19}}\,\rho_\beta-1.0\,{\it t_7}\,\rho_\alpha\right)\,\left({{0.003\,{\it param}\left(5\right)\,{\it t_{33}}}\over{{\it t_{34}}}}+{{9.0 \times 10^{-6}\,{\it param}\left(7\right)\,{\it t_{33}}^2}\over{{\it t_{34}}^2}}+{\it param}\left(3\right)\right)+1.0\,{\it t_{19}}\,\rho_\beta\,\left({{0.2\,{\it t_{12}}\,{\it t_{20}}\,\sigma_{\beta\beta}}\over{{\it t_{21}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\beta\beta}^2}\over{\rho_\beta^{{{16}\over{3}}}\,{\it t_{21}}^2}}+{\it t_8}\right)+1.0\,{\it t_7}\,\rho_\alpha\,\left({{0.2\,{\it t_{12}}\,{\it t_{10}}\,\sigma_{\alpha\alpha}}\over{{\it t_{11}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\alpha\alpha}^2}\over{\rho_\alpha^{{{16}\over{3}}}\,{\it t_{11}}^2}}+{\it t_8}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.9999999999999991\,\left(0.0621814\,{\it t_{39}}\,{\it t_{40}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{37}}+0.10465751434\right)\,{\it t_{37}}+0.19269083139\right)\,{\it t_{37}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{38}}+1.0\right)\right)-0.0621814\,{\it t_{39}}\,{\it t_{40}}\right)\,\rho_s\,\left({{0.2\,{\it t_{12}}\,{\it t_{41}}\,\sigma_{ss}}\over{{\it t_{42}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{ss}^2}\over{\rho_s^{{{16}\over{3}}}\,{\it t_{42}}^2}}+{\it t_8}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] AD Becke, J.Chem.Phys. 107, 8554 (1997)  , DOI: 
C> <a href="http://dx.doi.org/10.1063/1.475007 "> 
C> 10.1063/1.475007 </a> 
C> 
      subroutine nwxcm_c_b97(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Cmat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      double precision nwxcm_heaviside 
      external         nwxcm_heaviside 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = param(7)
            t30 = 6.0d-3*gammaaa*t3+1.0d+0
            t31 = 1/t30**2
            t32 = param(5)
            t33 = 1/t30
            t34 = 3.6d-5*t2*t29*t31*t6+6.0d-3*gammaaa*t3*t32*t33+param(3
     1         )
            t35 = 2.150807071909054d-2*t12+1.0186556948d-1
            t36 = 7.016926042943223d-1*t12*t35+2.2308199064d-1
            t37 = 7.016926042943223d-1*t12*t36+4.7231125998d-1
            t38 = 1/t37
            t39 = 1.4251254664507676d+0*t11*t38+1.0d+0
            t40 = log(t39)
            t41 = 1.0522000558389215d-1*t19+1.0d+0
            t42 = -1.243628d-1*rhoa*t40*t41-2.0d+0*rhoa*t28
            t43 = gammaaa**3
            t44 = 1/t4**3
            t45 = 1/rhoa**9
            t46 = 1/rhoa**6.333333333333333d+0
            t47 = 1/rhoa**3.6666666666666664d+0
            t48 = 1/rhoa**1.3333333333333333d+0
            t49 = 1/rhoa**1.3333333333333336d+0
            t50 = 1/t11**3
            t51 = 1/rhoa**6.666666666666667d-1
            t52 = 1/t25
            t53 = 2.11607075208357d-1*t12*t24*t51-1.269642451250142d+0*t
     1         11*(7.876233178997433d-1*t12*(-1.3127055298329054d-1*t21*
     2         t50*t51-3.169132786263567d-3*t49)-1.3127055298329054d-1*t
     3         22*t50*t51)/t23**2
            t54 = 9.999999999999991d-1*(6.21814d-2*t27*t52*t53-3.10907d-
     1         2*t20*(2.11607075208357d-1*t12*t16*t51-1.269642451250142d
     2         +0*t11*(7.876233178997433d-1*t12*(-1.3127055298329054d-1*
     3         t13*t50*t51-2.0096226153166658d-3*t49)-1.3127055298329054
     4         d-1*t14*t50*t51)/t15**2)/t17-2.747773264188438d-3*t26*t48
     5         +1.3210398931339265d-3*t18*t48)-6.21814d-2*t27*t52*t53+2.
     6         747773264188438d-3*t26*t48
            t55 = 1/t30**3
            t56 = 1/rhoa**8
            t57 = 1.0d+0*(2.0d+0*rhoa*t28*(2.0d-1*t3*t7*t8-4.00000000000
     1         0001d-2*gammaaa*t5*t6*t7+8.000000000000002d-2*gammaaa*t1*
     2         t5*t6-1.6000000000000003d-2*t1*t2*t44*t56)+t42*(-3.6d-5*g
     3         ammaaa*t31*t32*t6+7.2d-5*gammaaa*t29*t31*t6-4.32d-7*t2*t2
     4         9*t55*t56+6.0d-3*t3*t32*t33))*wght
            fnc(iq) = 1.0d+0*(2.0d+0*rhoa*t28*t9+t34*t42)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(2.0d+0*rhoa*t54*t9+2.0d+0*t28*t9+2.
     1         0d+0*rhoa*t28*(-5.333333333333333d-1*gammaaa*t47*t7*t8+1.
     2         0666666666666667d-1*t2*t46*t5*t7-2.1333333333333337d-1*t1
     3         *t2*t46*t5+4.2666666666666675d-2*t1*t43*t44*t45)+t42*(1.1
     4         520000000000001d-6*t29*t43*t45*t55-1.6d-2*gammaaa*t32*t33
     5         *t47+9.600000000000001d-5*t2*t31*t32*t46-1.92d-4*t2*t29*t
     6         31*t46)+t34*(-2.0d+0*rhoa*t54-1.243628d-1*rhoa*t41*(2.375
     7         209110751279d-1*t12*t38*t51-1.4251254664507676d+0*t11*(7.
     8         016926042943223d-1*t12*(-1.1694876738238705d-1*t35*t50*t5
     9         1-2.51534235937085d-3*t49)-1.1694876738238705d-1*t36*t50*
     :         t51)/t37**2)/t39-1.243628d-1*t40*t41+4.36181817014282d-3*
     ;         t40/rhoa**3.3333333333333326d-1-2.0d+0*t28))*wght+Amat(iq
     <         ,D1_RA)
            Cmat(iq,D1_GAA) = t57+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t57+Cmat(iq,D1_GAB)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(2)
            t2 = param(6)
            t3 = gammaaa**2
            t4 = 1/rhoa**2.6666666666666666d+0
            t5 = 2.0d-1*gammaaa*t4+1.0d+0
            t6 = 1/t5**2
            t7 = 1/rhoa**5.333333333333333d+0
            t8 = param(4)
            t9 = 1/t5
            t10 = 2.0d-1*gammaaa*t4*t8*t9+4.000000000000001d-2*t2*t3*t6*
     1         t7+t1
            t11 = rhoa**3.333333333333333d-1
            t12 = t11**5.0d-1
            t13 = 1/t12
            t14 = 1.530901310039024d-2*t13+1.0465751434d-1
            t15 = 7.876233178997433d-1*t13*t14+1.9269083139d-1
            t16 = 7.876233178997433d-1*t13*t15+4.3896648423d-1
            t17 = 1/t16
            t18 = 1.269642451250142d+0*t12*t17+1.0d+0
            t19 = log(t18)
            t20 = 1/t11
            t21 = 1.2746961887000874d-1*t20+1.0d+0
            t22 = 2.4141993114533214d-2*t13+1.0186556948d-1
            t23 = 7.876233178997433d-1*t13*t22+2.2308199064d-1
            t24 = 7.876233178997433d-1*t13*t23+4.7231125998d-1
            t25 = 1/t24
            t26 = 1.269642451250142d+0*t12*t25+1.0d+0
            t27 = log(t26)
            t28 = 1.325688999052018d-1*t20+1.0d+0
            t29 = 9.999999999999991d-1*(6.21814d-2*t27*t28-3.10907d-2*t1
     1         9*t21)-6.21814d-2*t27*t28
            t30 = gammabb**2
            t31 = 1/rhob**2.6666666666666666d+0
            t32 = 2.0d-1*gammabb*t31+1.0d+0
            t33 = 1/t32**2
            t34 = 1/rhob**5.333333333333333d+0
            t35 = 1/t32
            t36 = 2.0d-1*gammabb*t31*t35*t8+4.000000000000001d-2*t2*t30*
     1         t33*t34+t1
            t37 = rhob**3.333333333333333d-1
            t38 = t37**5.0d-1
            t39 = 1/t38
            t40 = 1.530901310039024d-2*t39+1.0465751434d-1
            t41 = 7.876233178997433d-1*t39*t40+1.9269083139d-1
            t42 = 7.876233178997433d-1*t39*t41+4.3896648423d-1
            t43 = 1/t42
            t44 = 1.269642451250142d+0*t38*t43+1.0d+0
            t45 = log(t44)
            t46 = 1/t37
            t47 = 1.2746961887000874d-1*t46+1.0d+0
            t48 = 2.4141993114533214d-2*t39+1.0186556948d-1
            t49 = 7.876233178997433d-1*t39*t48+2.2308199064d-1
            t50 = 7.876233178997433d-1*t39*t49+4.7231125998d-1
            t51 = 1/t50
            t52 = 1.269642451250142d+0*t38*t51+1.0d+0
            t53 = log(t52)
            t54 = 1.325688999052018d-1*t46+1.0d+0
            t55 = 9.999999999999991d-1*(6.21814d-2*t53*t54-3.10907d-2*t4
     1         5*t47)-6.21814d-2*t53*t54
            t56 = param(7)
            t57 = gammaaa*t4+gammabb*t31
            t58 = t57**2
            t59 = 3.0d-3*t57+1.0d+0
            t60 = 1/t59**2
            t61 = param(5)
            t62 = 1/t59
            t63 = 3.0d-3*t57*t61*t62+9.0d-6*t56*t58*t60+param(3)
            t64 = rhob+rhoa
            t65 = t64**3.333333333333333d-1
            t66 = 1/t65
            t67 = 1.325688999052018d-1*t66+1.0d+0
            t68 = t65**5.0d-1
            t69 = 1/t68
            t70 = 2.4141993114533214d-2*t69+1.0186556948d-1
            t71 = 7.876233178997433d-1*t69*t70+2.2308199064d-1
            t72 = 7.876233178997433d-1*t69*t71+4.7231125998d-1
            t73 = 1/t72
            t74 = 1.269642451250142d+0*t68*t73+1.0d+0
            t75 = log(t74)
            t76 = rhoa-rhob
            t77 = 1/t64
            t78 = 1.0d+0-t76*t77
            t79 = t76*t77+1.0d+0
            t80 = 1.923661050931536d+0*t79**1.3333333333333333d+0+1.9236
     1         61050931536d+0*t78**1.3333333333333333d+0-3.8473221018630
     2         72d+0
            t81 = 6.901399211255826d-2*t66+1.0d+0
            t82 = 1.3212998810398843d-2*t69+2.9729725188d-2
            t83 = 7.876233178997433d-1*t69*t82+1.2236585478d-1
            t84 = 7.876233178997433d-1*t69*t83+3.497952466d-1
            t85 = 1/t84
            t86 = 1.269642451250142d+0*t68*t85+1.0d+0
            t87 = log(t86)
            t88 = t76**4
            t89 = 1/t64**4
            t90 = 1.2746961887000874d-1*t66+1.0d+0
            t91 = 1.530901310039024d-2*t69+1.0465751434d-1
            t92 = 7.876233178997433d-1*t69*t91+1.9269083139d-1
            t93 = 7.876233178997433d-1*t69*t92+4.3896648423d-1
            t94 = 1/t93
            t95 = 1.269642451250142d+0*t68*t94+1.0d+0
            t96 = log(t95)
            t97 = 1.709920934161365d+0*(6.21814d-2*t67*t75-3.10907d-2*t9
     1         0*t96)-3.37738d-2*t81*t87
            t98 = t88*t89*t97+3.37738d-2*t81*t87
            t99 = 5.848223622634648d-1*t80*t98-6.21814d-2*t67*t75
            t100 = 1.0d+0*t64*t99-1.0d+0*rhob*t55-1.0d+0*rhoa*t29
            t101 = 1/t5**3
            t102 = 1/rhoa**6.333333333333333d+0
            t103 = 1/rhoa**3.6666666666666664d+0
            t104 = 1/rhoa**1.3333333333333333d+0
            t105 = 1/rhoa**1.3333333333333336d+0
            t106 = 1/t12**3
            t107 = 1/rhoa**6.666666666666667d-1
            t108 = 1/t26
            t109 = 2.11607075208357d-1*t107*t13*t25-1.269642451250142d+0
     1         *t12*(7.876233178997433d-1*t13*(-1.3127055298329054d-1*t1
     2         06*t107*t22-3.169132786263567d-3*t105)-1.3127055298329054
     3         d-1*t106*t107*t23)/t24**2
            t110 = 9.999999999999991d-1*(6.21814d-2*t108*t109*t28-2.7477
     1         73264188438d-3*t104*t27-3.10907d-2*(2.11607075208357d-1*t
     2         107*t13*t17-1.269642451250142d+0*t12*(7.876233178997433d-
     3         1*t13*(-1.3127055298329054d-1*t106*t107*t14-2.00962261531
     4         66658d-3*t105)-1.3127055298329054d-1*t106*t107*t15)/t16**
     5         2)*t21/t18+1.3210398931339265d-3*t104*t19)-6.21814d-2*t10
     6         8*t109*t28+2.747773264188438d-3*t104*t27
            t111 = 1/t64**1.3333333333333336d+0
            t112 = 1/t64**6.666666666666667d-1
            t113 = 1/t68**3
            t114 = 2.11607075208357d-1*t112*t69*t73-1.269642451250142d+0
     1         *t68*(7.876233178997433d-1*t69*(-1.3127055298329054d-1*t1
     2         12*t113*t70-3.169132786263567d-3*t111)-1.3127055298329054
     3         d-1*t112*t113*t71)/t72**2
            t115 = 1/t74
            t116 = -6.21814d-2*t114*t115*t67
            t117 = 1/t64**1.3333333333333333d+0
            t118 = 2.747773264188438d-3*t117*t75
            t119 = 2.11607075208357d-1*t112*t69*t85-1.269642451250142d+0
     1         *t68*(7.876233178997433d-1*t69*(-1.3127055298329054d-1*t1
     2         12*t113*t82-1.7344776604086162d-3*t111)-1.312705529832905
     3         4d-1*t112*t113*t83)/t84**2
            t120 = 1/t86
            t121 = 3.37738d-2*t119*t120*t81
            t122 = -7.769549222703733d-4*t117*t87
            t123 = t88*t89*(1.709920934161365d+0*(1.3210398931339265d-3*
     1         t117*t96-3.10907d-2*t90*(2.11607075208357d-1*t112*t69*t94
     2         -1.269642451250142d+0*t68*(7.876233178997433d-1*t69*(-1.3
     3         127055298329054d-1*t112*t113*t91-2.0096226153166658d-3*t1
     4         11)-1.3127055298329054d-1*t112*t113*t92)/t93**2)/t95-2.74
     5         7773264188438d-3*t117*t75+6.21814d-2*t114*t115*t67)+7.769
     6         549222703733d-4*t117*t87-3.37738d-2*t119*t120*t81)
            t124 = -4*t88*t97/t64**5
            t125 = t76**3
            t126 = 1/t64**2
            t127 = t126*t76
            t128 = -t77
            t129 = t78**3.333333333333333d-1
            t130 = -t126*t76
            t131 = t79**3.333333333333333d-1
            t132 = 1.0d+0*t99
            t133 = 1/t59**3
            t134 = 1/t32**3
            t135 = 1/rhob**6.333333333333333d+0
            t136 = 1/rhob**3.6666666666666664d+0
            t137 = 1/rhob**1.3333333333333333d+0
            t138 = 1/rhob**1.3333333333333336d+0
            t139 = 1/t38**3
            t140 = 1/rhob**6.666666666666667d-1
            t141 = 1/t52
            t142 = 2.11607075208357d-1*t140*t39*t51-1.269642451250142d+0
     1         *t38*(7.876233178997433d-1*t39*(-1.3127055298329054d-1*t1
     2         39*t140*t48-3.169132786263567d-3*t138)-1.3127055298329054
     3         d-1*t139*t140*t49)/t50**2
            t143 = 9.999999999999991d-1*(6.21814d-2*t141*t142*t54-2.7477
     1         73264188438d-3*t137*t53-3.10907d-2*(2.11607075208357d-1*t
     2         140*t39*t43-1.269642451250142d+0*t38*(7.876233178997433d-
     3         1*t39*(-1.3127055298329054d-1*t139*t140*t40-2.00962261531
     4         66658d-3*t138)-1.3127055298329054d-1*t139*t140*t41)/t42**
     5         2)*t47/t44+1.3210398931339265d-3*t137*t45)-6.21814d-2*t14
     6         1*t142*t54+2.747773264188438d-3*t137*t53
            fnc(iq) = 1.0d+0*(t100*t63+1.0d+0*rhob*t36*t55+1.0d+0*rhoa*t
     1         10*t29)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622634648d
     1         -1*(2.564881401242048d+0*t131*(t77+t130)+2.56488140124204
     2         8d+0*(t128+t127)*t129)*t98+5.848223622634648d-1*t80*(4*t1
     3         25*t89*t97+t124+t123+t122+t121)+t118+t116)-1.0d+0*t29+t13
     4         2-1.0d+0*rhoa*t110)+1.0d+0*rhoa*t29*(-5.333333333333333d-
     5         1*gammaaa*t103*t8*t9+1.0666666666666667d-1*t102*t3*t6*t8-
     6         2.1333333333333337d-1*t102*t2*t3*t6+4.2666666666666675d-2
     7         *gammaaa**3*t101*t2/rhoa**9)+t100*(-8.0d-3*gammaaa*t103*t
     8         61*t62+2.4000000000000002d-5*gammaaa*t103*t57*t60*t61-4.8
     9         000000000000004d-5*gammaaa*t103*t56*t57*t60+1.44000000000
     :         00002d-7*gammaaa*t103*t133*t56*t58)+1.0d+0*t10*t29+1.0d+0
     ;         *rhoa*t10*t110)*wght+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622634648d
     1         -1*(2.564881401242048d+0*t129*(t77+t127)+2.56488140124204
     2         8d+0*(t130+t128)*t131)*t98+5.848223622634648d-1*t80*(-4*t
     3         125*t89*t97+t124+t123+t122+t121)+t118+t116)-1.0d+0*t55-1.
     4         0d+0*rhob*t143+t132)+1.0d+0*rhob*t55*(-5.333333333333333d
     5         -1*gammabb*t136*t35*t8+1.0666666666666667d-1*t135*t30*t33
     6         *t8-2.1333333333333337d-1*t135*t2*t30*t33+4.2666666666666
     7         675d-2*gammabb**3*t134*t2/rhob**9)+t100*(-8.0d-3*gammabb*
     8         t136*t61*t62+2.4000000000000002d-5*gammabb*t136*t57*t60*t
     9         61-4.8000000000000004d-5*gammabb*t136*t56*t57*t60+1.44000
     :         00000000002d-7*gammabb*t133*t136*t56*t58)+1.0d+0*t36*t55+
     ;         1.0d+0*rhob*t143*t36)*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(2.0d-1*t4*t8*t9-4
     1         .000000000000001d-2*gammaaa*t6*t7*t8+8.000000000000002d-2
     2         *gammaaa*t2*t6*t7-1.6000000000000003d-2*t101*t2*t3/rhoa**
     3         8)+t100*(3.0d-3*t4*t61*t62-9.0d-6*t4*t57*t60*t61+1.8d-5*t
     4         4*t56*t57*t60-5.4d-8*t133*t4*t56*t58))*wght+Cmat(iq,D1_GA
     5         A)
            Cmat(iq,D1_GAB) = Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(2.0d-1*t31*t35*t8
     1         -4.000000000000001d-2*gammabb*t33*t34*t8+8.00000000000000
     2         2d-2*gammabb*t2*t33*t34-1.6000000000000003d-2*t134*t2*t30
     3         /rhob**8)+t100*(3.0d-3*t31*t61*t62-9.0d-6*t31*t57*t60*t61
     4         +1.8d-5*t31*t56*t57*t60-5.4d-8*t133*t31*t56*t58))*wght+Cm
     5         at(iq,D1_GBB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = 1/t4**3
            t30 = 1/rhoa**6.333333333333333d+0
            t31 = 1/rhoa**1.3333333333333333d+0
            t32 = 1/rhoa**1.3333333333333336d+0
            t33 = 1/t11**3
            t34 = 1/rhoa**6.666666666666667d-1
            t35 = 1/t25
            t36 = 2.11607075208357d-1*t12*t24*t34-1.269642451250142d+0*t
     1         11*(7.876233178997433d-1*t12*(-1.3127055298329054d-1*t21*
     2         t33*t34-3.169132786263567d-3*t32)-1.3127055298329054d-1*t
     3         22*t33*t34)/t23**2
            fnc(iq) = 1.0d+0*rhoa*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*rhoa*(9.999999999999991d-1*(6.21814d
     1         -2*t27*t35*t36-3.10907d-2*t20*(2.11607075208357d-1*t12*t1
     2         6*t34-1.269642451250142d+0*t11*(7.876233178997433d-1*t12*
     3         (-1.3127055298329054d-1*t13*t33*t34-2.0096226153166658d-3
     4         *t32)-1.3127055298329054d-1*t14*t33*t34)/t15**2)/t17-2.74
     5         7773264188438d-3*t26*t31+1.3210398931339265d-3*t18*t31)-6
     6         .21814d-2*t27*t35*t36+2.747773264188438d-3*t26*t31)*t9*wg
     7         ht+1.0d+0*t28*t9*wght+1.0d+0*rhoa*t28*(-5.333333333333333
     8         d-1*gammaaa*t7*t8/rhoa**3.6666666666666664d+0+1.066666666
     9         6666667d-1*t2*t30*t5*t7-2.1333333333333337d-1*t1*t2*t30*t
     :         5+4.2666666666666675d-2*gammaaa**3*t1*t29/rhoa**9)*wght+A
     ;         mat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 1.0d+0*rhoa*t28*(2.0d-1*t3*t7*t8+t5*t6*(8.
     1         000000000000002d-2*gammaaa*t1-4.000000000000001d-2*gammaa
     2         a*t7)-1.6000000000000003d-2*t1*t2*t29/rhoa**8)*wght+Cmat(
     3         iq,D1_GAA)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammabb**2
            t3 = 1/rhob**2.6666666666666666d+0
            t4 = 2.0d-1*gammabb*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhob**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammabb*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhob**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = 1/t4**3
            t30 = 1/rhob**6.333333333333333d+0
            t31 = 1/rhob**1.3333333333333333d+0
            t32 = 1/rhob**1.3333333333333336d+0
            t33 = 1/t11**3
            t34 = 1/rhob**6.666666666666667d-1
            t35 = 1/t25
            t36 = 2.11607075208357d-1*t12*t24*t34-1.269642451250142d+0*t
     1         11*(7.876233178997433d-1*t12*(-1.3127055298329054d-1*t21*
     2         t33*t34-3.169132786263567d-3*t32)-1.3127055298329054d-1*t
     3         22*t33*t34)/t23**2
            fnc(iq) = 1.0d+0*rhob*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RB) = 1.0d+0*rhob*(9.999999999999991d-1*(6.21814d
     1         -2*t27*t35*t36-3.10907d-2*t20*(2.11607075208357d-1*t12*t1
     2         6*t34-1.269642451250142d+0*t11*(7.876233178997433d-1*t12*
     3         (-1.3127055298329054d-1*t13*t33*t34-2.0096226153166658d-3
     4         *t32)-1.3127055298329054d-1*t14*t33*t34)/t15**2)/t17-2.74
     5         7773264188438d-3*t26*t31+1.3210398931339265d-3*t18*t31)-6
     6         .21814d-2*t27*t35*t36+2.747773264188438d-3*t26*t31)*t9*wg
     7         ht+1.0d+0*t28*t9*wght+1.0d+0*rhob*t28*(-5.333333333333333
     8         d-1*gammabb*t7*t8/rhob**3.6666666666666664d+0+1.066666666
     9         6666667d-1*t2*t30*t5*t7-2.1333333333333337d-1*t1*t2*t30*t
     :         5+4.2666666666666675d-2*gammabb**3*t1*t29/rhob**9)*wght+A
     ;         mat(iq,D1_RB)
            Cmat(iq,D1_GBB) = 1.0d+0*rhob*t28*(2.0d-1*t3*t7*t8+t5*t6*(8.
     1         000000000000002d-2*gammabb*t1-4.000000000000001d-2*gammab
     2         b*t7)-1.6000000000000003d-2*t1*t2*t29/rhob**8)*wght+Cmat(
     3         iq,D1_GBB)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_b97 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{0.3333333333333333}\\\\ 
C>   {\it t_2} &=& \sqrt{{\it t_1}}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& \log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_3}+0.10186556948\right)\,{\it t_3}+0.22308199064\right)\,{\it t_3}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_6} &=& 0.1325688999052018\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_5}\,{\it t_6}-0.0310907\,\log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_3}+0.10465751434\right)\,{\it t_3}+0.19269083139\right)\,{\it t_3}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_4}+1.0\right)\right)-0.0621814\,{\it t_5}\,{\it t_6}\\\\ 
C>   {\it t_8} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_9} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{11}} &=& 0.2\,{\it t_{10}}\,\sigma_{\alpha\alpha}+1.0\\\\ 
C>   {\it t_{12}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{13}} &=& \rho_\beta^{0.3333333333333333}\\\\ 
C>   {\it t_{14}} &=& \sqrt{{\it t_{13}}}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{16}} &=& {{1}\over{{\it t_{13}}}}\\\\ 
C>   {\it t_{17}} &=& \log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{15}}+0.10186556948\right)\,{\it t_{15}}+0.22308199064\right)\,{\it t_{15}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{18}} &=& 0.1325688999052018\,{\it t_{16}}+1.0\\\\ 
C>   {\it t_{19}} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_{17}}\,{\it t_{18}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{15}}+0.10465751434\right)\,{\it t_{15}}+0.19269083139\right)\,{\it t_{15}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{16}}+1.0\right)\right)-0.0621814\,{\it t_{17}}\,{\it t_{18}}\\\\ 
C>   {\it t_{20}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{21}} &=& 0.2\,{\it t_{20}}\,\sigma_{\beta\beta}+1.0\\\\ 
C>   {\it t_{22}} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_{23}} &=& {\it t_{22}}^{0.3333333333333333}\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_{23}}}}\\\\ 
C>   {\it t_{25}} &=& 0.1325688999052018\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& \sqrt{{\it t_{23}}}\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_{26}}}}\\\\ 
C>   {\it t_{28}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.02414199311453321\,{\it t_{27}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{29}} &=& \rho_\alpha-\rho_\beta\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_{22}}}}\\\\ 
C>   {\it t_{31}} &=& 0.06901399211255826\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{32}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01321299881039884\,{\it t_{27}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{33}} &=& {\it t_{20}}\,\sigma_{\beta\beta}+{\it t_{10}}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{34}} &=& 0.003\,{\it t_{33}}+1.0\\\\ 
C>   {\it t_{35}} &=& \rho_s^{0.3333333333333333}\\\\ 
C>   {\it t_{36}} &=& \sqrt{{\it t_{35}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{{\it t_{36}}}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_{35}}}}\\\\ 
C>   {\it t_{39}} &=& \log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{37}}+0.10186556948\right)\,{\it t_{37}}+0.22308199064\right)\,{\it t_{37}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{40}} &=& 0.1325688999052018\,{\it t_{38}}+1.0\\\\ 
C>   {\it t_{41}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{42}} &=& 0.2\,{\it t_{41}}\,\sigma_{ss}+1.0\\\\ 
C>   f &=& 1.0\,\left(\left(1.0\,{\it t_{22}}\,\left(0.5848223622634648\,\left(1.923661050931536\,\left({\it t_{29}}\,{\it t_{30}}+1.0\right)^{{{4}\over{3}}}+1.923661050931536\,\left(1.0-{\it t_{29}}\,{\it t_{30}}\right)^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{29}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{25}}\,{\it t_{28}}-0.0310907\,\left(0.1274696188700087\,{\it t_{24}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01530901310039024\,{\it t_{27}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)}\over{{\it t_{22}}^4}}+0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)-0.0621814\,{\it t_{25}}\,{\it t_{28}}\right)-1.0\,{\it t_{19}}\,\rho_\beta-1.0\,{\it t_7}\,\rho_\alpha\right)\,\left({{0.003\,{\it param}\left(5\right)\,{\it t_{33}}}\over{{\it t_{34}}}}+{{9.0 \times 10^{-6}\,{\it param}\left(7\right)\,{\it t_{33}}^2}\over{{\it t_{34}}^2}}+{\it param}\left(3\right)\right)+1.0\,{\it t_{19}}\,\rho_\beta\,\left({{0.2\,{\it t_{12}}\,{\it t_{20}}\,\sigma_{\beta\beta}}\over{{\it t_{21}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\beta\beta}^2}\over{\rho_\beta^{{{16}\over{3}}}\,{\it t_{21}}^2}}+{\it t_8}\right)+1.0\,{\it t_7}\,\rho_\alpha\,\left({{0.2\,{\it t_{12}}\,{\it t_{10}}\,\sigma_{\alpha\alpha}}\over{{\it t_{11}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\alpha\alpha}^2}\over{\rho_\alpha^{{{16}\over{3}}}\,{\it t_{11}}^2}}+{\it t_8}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.9999999999999991\,\left(0.0621814\,{\it t_{39}}\,{\it t_{40}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{37}}+0.10465751434\right)\,{\it t_{37}}+0.19269083139\right)\,{\it t_{37}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{38}}+1.0\right)\right)-0.0621814\,{\it t_{39}}\,{\it t_{40}}\right)\,\rho_s\,\left({{0.2\,{\it t_{12}}\,{\it t_{41}}\,\sigma_{ss}}\over{{\it t_{42}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{ss}^2}\over{\rho_s^{{{16}\over{3}}}\,{\it t_{42}}^2}}+{\it t_8}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] AD Becke, J.Chem.Phys. 107, 8554 (1997)  , DOI: 
C> <a href="http://dx.doi.org/10.1063/1.475007 "> 
C> 10.1063/1.475007 </a> 
C> 
      subroutine nwxcm_c_b97_d2(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Cmat,Cmat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      double precision nwxcm_heaviside 
      external         nwxcm_heaviside 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = param(7)
            t30 = 6.0d-3*gammaaa*t3+1.0d+0
            t31 = 1/t30**2
            t32 = param(5)
            t33 = 1/t30
            t34 = 3.6d-5*t2*t29*t31*t6+6.0d-3*gammaaa*t3*t32*t33+param(3
     1         )
            t35 = 2.150807071909054d-2*t12+1.0186556948d-1
            t36 = 7.016926042943223d-1*t12*t35+2.2308199064d-1
            t37 = 7.016926042943223d-1*t12*t36+4.7231125998d-1
            t38 = 1/t37
            t39 = 1.4251254664507676d+0*t11*t38+1.0d+0
            t40 = log(t39)
            t41 = 1.0522000558389215d-1*t19+1.0d+0
            t42 = -1.243628d-1*rhoa*t40*t41-2.0d+0*rhoa*t28
            t43 = gammaaa**3
            t44 = 1/t4**3
            t45 = 1/rhoa**9
            t46 = 1/rhoa**6.333333333333333d+0
            t47 = 1/rhoa**3.6666666666666664d+0
            t48 = -5.333333333333333d-1*gammaaa*t47*t7*t8+1.066666666666
     1         6667d-1*t2*t46*t5*t7-2.1333333333333337d-1*t1*t2*t46*t5+4
     2         .2666666666666675d-2*t1*t43*t44*t45
            t49 = 1/rhoa**1.3333333333333333d+0
            t50 = 1/t17
            t51 = 1/t15**2
            t52 = 1/rhoa**1.3333333333333336d+0
            t53 = 1/t11**3
            t54 = 1/rhoa**6.666666666666667d-1
            t55 = -1.3127055298329054d-1*t13*t53*t54-2.0096226153166658d
     1         -3*t52
            t56 = 7.876233178997433d-1*t12*t55-1.3127055298329054d-1*t14
     1         *t53*t54
            t57 = 2.11607075208357d-1*t12*t16*t54-1.269642451250142d+0*t
     1         11*t51*t56
            t58 = 1/t25
            t59 = 1/t23**2
            t60 = -1.3127055298329054d-1*t21*t53*t54-3.169132786263567d-
     1         3*t52
            t61 = 7.876233178997433d-1*t12*t60-1.3127055298329054d-1*t22
     1         *t53*t54
            t62 = 2.11607075208357d-1*t12*t24*t54-1.269642451250142d+0*t
     1         11*t59*t61
            t63 = 9.999999999999991d-1*(6.21814d-2*t27*t58*t62-3.10907d-
     1         2*t20*t50*t57-2.747773264188438d-3*t26*t49+1.321039893133
     2         9265d-3*t18*t49)-6.21814d-2*t27*t58*t62+2.747773264188438
     3         d-3*t26*t49
            t64 = 1/t30**3
            t65 = 1.1520000000000001d-6*t29*t43*t45*t64-1.6d-2*gammaaa*t
     1         32*t33*t47+9.600000000000001d-5*t2*t31*t32*t46-1.92d-4*t2
     2         *t29*t31*t46
            t66 = 1/rhoa**3.3333333333333326d-1
            t67 = 1/t39
            t68 = 1/t37**2
            t69 = -1.1694876738238705d-1*t35*t53*t54-2.51534235937085d-3
     1         *t52
            t70 = 7.016926042943223d-1*t12*t69-1.1694876738238705d-1*t36
     1         *t53*t54
            t71 = 2.375209110751279d-1*t12*t38*t54-1.4251254664507676d+0
     1         *t11*t68*t70
            t72 = -1.243628d-1*rhoa*t41*t67*t71+4.36181817014282d-3*t40*
     1         t66-2.0d+0*rhoa*t63-1.243628d-1*t40*t41-2.0d+0*t28
            t73 = 1/rhoa**8
            t74 = 2.0d-1*t3*t7*t8-1.6000000000000003d-2*t1*t2*t44*t73-4.
     1         000000000000001d-2*gammaaa*t5*t6*t7+8.000000000000002d-2*
     2         gammaaa*t1*t5*t6
            t75 = -4.32d-7*t2*t29*t64*t73-3.6d-5*gammaaa*t31*t32*t6+7.2d
     1         -5*gammaaa*t29*t31*t6+6.0d-3*t3*t32*t33
            t76 = 1.0d+0*(t42*t75+2.0d+0*rhoa*t28*t74)*wght
            t77 = gammaaa**4
            t78 = 1/t4**4
            t79 = 1/rhoa**1.2666666666666665d+1
            t80 = 1/rhoa**10
            t81 = 1/rhoa**7.333333333333333d+0
            t82 = 1/rhoa**4.666666666666667d+0
            t83 = 1/rhoa**2.333333333333333d+0
            t84 = 1/rhoa**2.3333333333333334d+0
            t85 = 1/rhoa**1.6666666666666669d+0
            t86 = 1/t11**5
            t87 = 1/t25**2
            t88 = t62**2
            t89 = -1.269642451250142d+0*t11*t59*(7.876233178997433d-1*t1
     1         2*(6.563527649164527d-2*t21*t52*t86+8.751370198886037d-2*
     2         t21*t53*t85+4.753699179395351d-3*t84)+6.563527649164527d-
     3         2*t22*t52*t86+8.751370198886037d-2*t22*t53*t85-2.62541105
     4         9665811d-1*t53*t54*t60)-1.4107138347223802d-1*t12*t24*t85
     5         +2.539284902500284d+0*t11*t61**2/t23**3-4.23214150416714d
     6         -1*t12*t54*t59*t61-3.52678458680595d-2*t24*t52*t53
            t90 = 9.999999999999991d-1*(6.21814d-2*t27*t58*t89-6.21814d-
     1         2*t27*t87*t88-3.10907d-2*t20*t50*(-1.269642451250142d+0*t
     2         11*t51*(7.876233178997433d-1*t12*(6.563527649164527d-2*t1
     3         3*t52*t86+8.751370198886037d-2*t13*t53*t85+3.014433922974
     4         9983d-3*t84)+6.563527649164527d-2*t14*t52*t86+8.751370198
     5         886037d-2*t14*t53*t85-2.625411059665811d-1*t53*t54*t55)-1
     6         .4107138347223802d-1*t12*t16*t85+2.539284902500284d+0*t11
     7         *t56**2/t15**3-4.23214150416714d-1*t12*t51*t54*t56-3.5267
     8         8458680595d-2*t16*t52*t53)+3.663697685584584d-3*t26*t83-1
     9         .7613865241785687d-3*t18*t83-5.495546528376876d-3*t49*t58
     :         *t62+3.10907d-2*t20*t57**2/t17**2+2.642079786267853d-3*t4
     ;         9*t50*t57)-6.21814d-2*t27*t58*t89+6.21814d-2*t27*t87*t88-
     <         3.663697685584584d-3*t26*t83+5.495546528376876d-3*t49*t58
     =         *t62
            t91 = 1/t30**4
            t92 = 1.0d+0*(t42*(5.529600000000001d-8*t29*t77*t79*t91+5.86
     1         6666666666667d-2*gammaaa*t32*t33*t82-8.64d-4*t2*t31*t32*t
     2         81+1.2160000000000001d-3*t2*t29*t31*t81+3.072d-6*t32*t43*
     3         t64*t80-1.6512000000000002d-5*t29*t43*t64*t80)+t34*(-2.0d
     4         +0*rhoa*t90-1.243628d-1*rhoa*t41*t67*(-1.4251254664507676
     5         d+0*t11*t68*(7.016926042943223d-1*t12*(5.847438369119352d
     6         -2*t35*t52*t86+7.796584492159138d-2*t35*t53*t85+3.7730135
     7         39056276d-3*t84)+5.847438369119352d-2*t36*t52*t86+7.79658
     8         4492159138d-2*t36*t53*t85-2.338975347647741d-1*t53*t54*t6
     9         9)-1.5834727405008528d-1*t12*t38*t85+2.850250932901535d+0
     :         *t11*t70**2/t37**3-4.750418221502558d-1*t12*t54*t68*t70-3
     ;         .9586818512521316d-2*t38*t52*t53)+1.243628d-1*rhoa*t41*t7
     <         1**2/t39**2+8.72363634028564d-3*t66*t67*t71-2.487256d-1*t
     =         41*t67*t71-4.0d+0*t63+2.9078787800952133d-3*t40*t49)+2.0d
     >         +0*rhoa*t9*t90+4.0d+0*t63*t9+2.0d+0*rhoa*t28*(1.955555555
     ?         5555554d+0*gammaaa*t7*t8*t82-9.6d-1*t2*t5*t7*t81+1.351111
     @         1111111113d+0*t1*t2*t5*t81+1.1377777777777778d-1*t43*t44*
     1         t7*t80-6.115555555555556d-1*t1*t43*t44*t80+6.826666666666
     2         669d-2*t1*t77*t78*t79)+2*t65*t72+4.0d+0*rhoa*t48*t63+4.0d
     3         +0*t28*t48)*wght
            t93 = 1/rhoa**1.1666666666666665d+1
            t94 = 1.0d+0*(t42*(-2.0736000000000004d-8*t29*t43*t91*t93-1.
     1         1520000000000001d-6*t2*t32*t45*t64+5.760000000000001d-6*t
     2         2*t29*t45*t64-1.6d-2*t32*t33*t47+2.8800000000000003d-4*ga
     3         mmaaa*t31*t32*t46-3.84d-4*gammaaa*t29*t31*t46)+2.0d+0*rho
     4         a*t28*(-2.5600000000000006d-2*t1*t43*t78*t93-5.3333333333
     5         33333d-1*t47*t7*t8+3.2d-1*gammaaa*t46*t5*t7-4.26666666666
     6         66675d-2*t2*t44*t45*t7-4.2666666666666675d-1*gammaaa*t1*t
     7         46*t5+2.1333333333333337d-1*t1*t2*t44*t45)+t72*t75+2.0d+0
     8         *rhoa*t63*t74+2.0d+0*t28*t74)*wght
            t95 = 1/rhoa**1.0666666666666666d+1
            t96 = 1.0d+0*(t42*(7.776000000000002d-9*t2*t29*t91*t95+4.32d
     1         -7*gammaaa*t32*t64*t73-1.728d-6*gammaaa*t29*t64*t73-7.2d-
     2         5*t31*t32*t6+7.2d-5*t29*t31*t6)+2.0d+0*rhoa*t28*(9.600000
     3         000000004d-3*t1*t2*t78*t95+1.6000000000000003d-2*gammaaa*
     4         t44*t7*t73-6.400000000000001d-2*gammaaa*t1*t44*t73-8.0000
     5         00000000002d-2*t5*t6*t7+8.000000000000002d-2*t1*t5*t6))*w
     6         ght
            fnc(iq) = 1.0d+0*(2.0d+0*rhoa*t28*t9+t34*t42)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(2.0d+0*rhoa*t63*t9+2.0d+0*t28*t9+t3
     1         4*t72+t42*t65+2.0d+0*rhoa*t28*t48)*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = t76+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t76+Cmat(iq,D1_GAB)
            Amat2(iq,D2_RA_RA) = t92+Amat2(iq,D2_RA_RA)
            Amat2(iq,D2_RA_RB) = t92+Amat2(iq,D2_RA_RB)
            Cmat2(iq,D2_RA_GAA) = t94+Cmat2(iq,D2_RA_GAA)
            Cmat2(iq,D2_RA_GAB) = t94+Cmat2(iq,D2_RA_GAB)
            Cmat2(iq,D2_RA_GBB) = t94+Cmat2(iq,D2_RA_GBB)
            Cmat2(iq,D2_GAA_GAA) = t96+Cmat2(iq,D2_GAA_GAA)
            Cmat2(iq,D2_GAA_GAB) = t96+Cmat2(iq,D2_GAA_GAB)
            Cmat2(iq,D2_GAA_GBB) = t96+Cmat2(iq,D2_GAA_GBB)
            Cmat2(iq,D2_GAB_GAB) = t96+Cmat2(iq,D2_GAB_GAB)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(2)
            t2 = param(6)
            t3 = gammaaa**2
            t4 = 1/rhoa**2.6666666666666666d+0
            t5 = 2.0d-1*gammaaa*t4+1.0d+0
            t6 = 1/t5**2
            t7 = 1/rhoa**5.333333333333333d+0
            t8 = param(4)
            t9 = 1/t5
            t10 = 2.0d-1*gammaaa*t4*t8*t9+4.000000000000001d-2*t2*t3*t6*
     1         t7+t1
            t11 = rhoa**3.333333333333333d-1
            t12 = t11**5.0d-1
            t13 = 1/t12
            t14 = 1.530901310039024d-2*t13+1.0465751434d-1
            t15 = 7.876233178997433d-1*t13*t14+1.9269083139d-1
            t16 = 7.876233178997433d-1*t13*t15+4.3896648423d-1
            t17 = 1/t16
            t18 = 1.269642451250142d+0*t12*t17+1.0d+0
            t19 = log(t18)
            t20 = 1/t11
            t21 = 1.2746961887000874d-1*t20+1.0d+0
            t22 = 2.4141993114533214d-2*t13+1.0186556948d-1
            t23 = 7.876233178997433d-1*t13*t22+2.2308199064d-1
            t24 = 7.876233178997433d-1*t13*t23+4.7231125998d-1
            t25 = 1/t24
            t26 = 1.269642451250142d+0*t12*t25+1.0d+0
            t27 = log(t26)
            t28 = 1.325688999052018d-1*t20+1.0d+0
            t29 = 9.999999999999991d-1*(6.21814d-2*t27*t28-3.10907d-2*t1
     1         9*t21)-6.21814d-2*t27*t28
            t30 = gammabb**2
            t31 = 1/rhob**2.6666666666666666d+0
            t32 = 2.0d-1*gammabb*t31+1.0d+0
            t33 = 1/t32**2
            t34 = 1/rhob**5.333333333333333d+0
            t35 = 1/t32
            t36 = 2.0d-1*gammabb*t31*t35*t8+4.000000000000001d-2*t2*t30*
     1         t33*t34+t1
            t37 = rhob**3.333333333333333d-1
            t38 = t37**5.0d-1
            t39 = 1/t38
            t40 = 1.530901310039024d-2*t39+1.0465751434d-1
            t41 = 7.876233178997433d-1*t39*t40+1.9269083139d-1
            t42 = 7.876233178997433d-1*t39*t41+4.3896648423d-1
            t43 = 1/t42
            t44 = 1.269642451250142d+0*t38*t43+1.0d+0
            t45 = log(t44)
            t46 = 1/t37
            t47 = 1.2746961887000874d-1*t46+1.0d+0
            t48 = 2.4141993114533214d-2*t39+1.0186556948d-1
            t49 = 7.876233178997433d-1*t39*t48+2.2308199064d-1
            t50 = 7.876233178997433d-1*t39*t49+4.7231125998d-1
            t51 = 1/t50
            t52 = 1.269642451250142d+0*t38*t51+1.0d+0
            t53 = log(t52)
            t54 = 1.325688999052018d-1*t46+1.0d+0
            t55 = 9.999999999999991d-1*(6.21814d-2*t53*t54-3.10907d-2*t4
     1         5*t47)-6.21814d-2*t53*t54
            t56 = param(7)
            t57 = gammaaa*t4+gammabb*t31
            t58 = t57**2
            t59 = 3.0d-3*t57+1.0d+0
            t60 = 1/t59**2
            t61 = param(5)
            t62 = 1/t59
            t63 = 3.0d-3*t57*t61*t62+9.0d-6*t56*t58*t60+param(3)
            t64 = rhob+rhoa
            t65 = t64**3.333333333333333d-1
            t66 = 1/t65
            t67 = 1.325688999052018d-1*t66+1.0d+0
            t68 = t65**5.0d-1
            t69 = 1/t68
            t70 = 2.4141993114533214d-2*t69+1.0186556948d-1
            t71 = 7.876233178997433d-1*t69*t70+2.2308199064d-1
            t72 = 7.876233178997433d-1*t69*t71+4.7231125998d-1
            t73 = 1/t72
            t74 = 1.269642451250142d+0*t68*t73+1.0d+0
            t75 = log(t74)
            t76 = rhoa-rhob
            t77 = 1/t64
            t78 = 1.0d+0-t76*t77
            t79 = t76*t77+1.0d+0
            t80 = 1.923661050931536d+0*t79**1.3333333333333333d+0+1.9236
     1         61050931536d+0*t78**1.3333333333333333d+0-3.8473221018630
     2         72d+0
            t81 = 6.901399211255826d-2*t66+1.0d+0
            t82 = 1.3212998810398843d-2*t69+2.9729725188d-2
            t83 = 7.876233178997433d-1*t69*t82+1.2236585478d-1
            t84 = 7.876233178997433d-1*t69*t83+3.497952466d-1
            t85 = 1/t84
            t86 = 1.269642451250142d+0*t68*t85+1.0d+0
            t87 = log(t86)
            t88 = t76**4
            t89 = 1/t64**4
            t90 = 1.2746961887000874d-1*t66+1.0d+0
            t91 = 1.530901310039024d-2*t69+1.0465751434d-1
            t92 = 7.876233178997433d-1*t69*t91+1.9269083139d-1
            t93 = 7.876233178997433d-1*t69*t92+4.3896648423d-1
            t94 = 1/t93
            t95 = 1.269642451250142d+0*t68*t94+1.0d+0
            t96 = log(t95)
            t97 = 1.709920934161365d+0*(6.21814d-2*t67*t75-3.10907d-2*t9
     1         0*t96)-3.37738d-2*t81*t87
            t98 = t88*t89*t97+3.37738d-2*t81*t87
            t99 = 5.848223622634648d-1*t80*t98-6.21814d-2*t67*t75
            t100 = 1.0d+0*t64*t99-1.0d+0*rhob*t55-1.0d+0*rhoa*t29
            t101 = gammaaa**3
            t102 = 1/t5**3
            t103 = 1/rhoa**9
            t104 = 1/rhoa**6.333333333333333d+0
            t105 = 1/rhoa**3.6666666666666664d+0
            t106 = -5.333333333333333d-1*gammaaa*t105*t8*t9+1.0666666666
     1         666667d-1*t104*t3*t6*t8-2.1333333333333337d-1*t104*t2*t3*
     2         t6+4.2666666666666675d-2*t101*t102*t103*t2
            t107 = 1/rhoa**1.3333333333333333d+0
            t108 = 1/t18
            t109 = 1/t16**2
            t110 = 1/rhoa**1.3333333333333336d+0
            t111 = 1/t12**3
            t112 = 1/rhoa**6.666666666666667d-1
            t113 = -1.3127055298329054d-1*t111*t112*t14-2.00962261531666
     1         58d-3*t110
            t114 = 7.876233178997433d-1*t113*t13-1.3127055298329054d-1*t
     1         111*t112*t15
            t115 = 2.11607075208357d-1*t112*t13*t17-1.269642451250142d+0
     1         *t109*t114*t12
            t116 = 1/t26
            t117 = 1/t24**2
            t118 = -1.3127055298329054d-1*t111*t112*t22-3.16913278626356
     1         7d-3*t110
            t119 = 7.876233178997433d-1*t118*t13-1.3127055298329054d-1*t
     1         111*t112*t23
            t120 = 2.11607075208357d-1*t112*t13*t25-1.269642451250142d+0
     1         *t117*t119*t12
            t121 = 9.999999999999991d-1*(6.21814d-2*t116*t120*t28-2.7477
     1         73264188438d-3*t107*t27-3.10907d-2*t108*t115*t21+1.321039
     2         8931339265d-3*t107*t19)-6.21814d-2*t116*t120*t28+2.747773
     3         264188438d-3*t107*t27
            t122 = 1/t64**1.3333333333333336d+0
            t123 = 1/t64**6.666666666666667d-1
            t124 = 1/t68**3
            t125 = -1.3127055298329054d-1*t123*t124*t70-3.16913278626356
     1         7d-3*t122
            t126 = 7.876233178997433d-1*t125*t69-1.3127055298329054d-1*t
     1         123*t124*t71
            t127 = 1/t72**2
            t128 = 2.11607075208357d-1*t123*t69*t73-1.269642451250142d+0
     1         *t126*t127*t68
            t129 = 1/t74
            t130 = -6.21814d-2*t128*t129*t67
            t131 = 1/t64**1.3333333333333333d+0
            t132 = 2.747773264188438d-3*t131*t75
            t133 = -1.3127055298329054d-1*t123*t124*t82-1.73447766040861
     1         62d-3*t122
            t134 = 7.876233178997433d-1*t133*t69-1.3127055298329054d-1*t
     1         123*t124*t83
            t135 = 1/t84**2
            t136 = 2.11607075208357d-1*t123*t69*t85-1.269642451250142d+0
     1         *t134*t135*t68
            t137 = 1/t86
            t138 = 3.37738d-2*t136*t137*t81
            t139 = -7.769549222703733d-4*t131*t87
            t140 = -1.3127055298329054d-1*t123*t124*t91-2.00962261531666
     1         58d-3*t122
            t141 = 7.876233178997433d-1*t140*t69-1.3127055298329054d-1*t
     1         123*t124*t92
            t142 = 1/t93**2
            t143 = 2.11607075208357d-1*t123*t69*t94-1.269642451250142d+0
     1         *t141*t142*t68
            t144 = 1/t95
            t145 = 1.709920934161365d+0*(1.3210398931339265d-3*t131*t96-
     1         3.10907d-2*t143*t144*t90-2.747773264188438d-3*t131*t75+6.
     2         21814d-2*t128*t129*t67)+7.769549222703733d-4*t131*t87-3.3
     3         7738d-2*t136*t137*t81
            t146 = t145*t88*t89
            t147 = 1/t64**5
            t148 = -4*t147*t88*t97
            t149 = t76**3
            t150 = 4*t149*t89*t97+t148+t146+t139+t138
            t151 = 1/t64**2
            t152 = t151*t76
            t153 = -t77
            t154 = t153+t152
            t155 = t78**3.333333333333333d-1
            t156 = -t151*t76
            t157 = t77+t156
            t158 = t79**3.333333333333333d-1
            t159 = 2.564881401242048d+0*t157*t158+2.564881401242048d+0*t
     1         154*t155
            t160 = 5.848223622634648d-1*t159*t98+5.848223622634648d-1*t1
     1         50*t80+t132+t130
            t161 = 1.0d+0*t99
            t162 = 1.0d+0*t160*t64-1.0d+0*t29+t161-1.0d+0*rhoa*t121
            t163 = 1/t59**3
            t164 = -8.0d-3*gammaaa*t105*t61*t62+2.4000000000000002d-5*ga
     1         mmaaa*t105*t57*t60*t61-4.8000000000000004d-5*gammaaa*t105
     2         *t56*t57*t60+1.4400000000000002d-7*gammaaa*t105*t163*t56*
     3         t58
            t165 = gammabb**3
            t166 = 1/t32**3
            t167 = 1/rhob**9
            t168 = 1/rhob**6.333333333333333d+0
            t169 = 1/rhob**3.6666666666666664d+0
            t170 = -5.333333333333333d-1*gammabb*t169*t35*t8+1.066666666
     1         6666667d-1*t168*t30*t33*t8-2.1333333333333337d-1*t168*t2*
     2         t30*t33+4.2666666666666675d-2*t165*t166*t167*t2
            t171 = 1/rhob**1.3333333333333333d+0
            t172 = 1/t44
            t173 = 1/t42**2
            t174 = 1/rhob**1.3333333333333336d+0
            t175 = 1/t38**3
            t176 = 1/rhob**6.666666666666667d-1
            t177 = -1.3127055298329054d-1*t175*t176*t40-2.00962261531666
     1         58d-3*t174
            t178 = 7.876233178997433d-1*t177*t39-1.3127055298329054d-1*t
     1         175*t176*t41
            t179 = 2.11607075208357d-1*t176*t39*t43-1.269642451250142d+0
     1         *t173*t178*t38
            t180 = 1/t52
            t181 = 1/t50**2
            t182 = -1.3127055298329054d-1*t175*t176*t48-3.16913278626356
     1         7d-3*t174
            t183 = 7.876233178997433d-1*t182*t39-1.3127055298329054d-1*t
     1         175*t176*t49
            t184 = 2.11607075208357d-1*t176*t39*t51-1.269642451250142d+0
     1         *t181*t183*t38
            t185 = 9.999999999999991d-1*(6.21814d-2*t180*t184*t54-2.7477
     1         73264188438d-3*t171*t53-3.10907d-2*t172*t179*t47+1.321039
     2         8931339265d-3*t171*t45)-6.21814d-2*t180*t184*t54+2.747773
     3         264188438d-3*t171*t53
            t186 = -4*t149*t89*t97+t148+t146+t139+t138
            t187 = t77+t152
            t188 = t156+t153
            t189 = 2.564881401242048d+0*t158*t188+2.564881401242048d+0*t
     1         155*t187
            t190 = 5.848223622634648d-1*t189*t98+5.848223622634648d-1*t1
     1         86*t80+t132+t130
            t191 = 1.0d+0*t190*t64-1.0d+0*t55-1.0d+0*rhob*t185+t161
            t192 = -8.0d-3*gammabb*t169*t61*t62+2.4000000000000002d-5*ga
     1         mmabb*t169*t57*t60*t61-4.8000000000000004d-5*gammabb*t169
     2         *t56*t57*t60+1.4400000000000002d-7*gammabb*t163*t169*t56*
     3         t58
            t193 = 1/rhoa**8
            t194 = 2.0d-1*t4*t8*t9-4.000000000000001d-2*gammaaa*t6*t7*t8
     1         +8.000000000000002d-2*gammaaa*t2*t6*t7-1.6000000000000003
     2         d-2*t102*t193*t2*t3
            t195 = 3.0d-3*t4*t61*t62-9.0d-6*t4*t57*t60*t61+1.8d-5*t4*t56
     1         *t57*t60-5.4d-8*t163*t4*t56*t58
            t196 = 1/rhob**8
            t197 = 2.0d-1*t31*t35*t8-4.000000000000001d-2*gammabb*t33*t3
     1         4*t8+8.000000000000002d-2*gammabb*t2*t33*t34-1.6000000000
     2         000003d-2*t166*t196*t2*t30
            t198 = 3.0d-3*t31*t61*t62-9.0d-6*t31*t57*t60*t61+1.8d-5*t31*
     1         t56*t57*t60-5.4d-8*t163*t31*t56*t58
            t199 = 1/t5**4
            t200 = 1/rhoa**10
            t201 = 1/rhoa**7.333333333333333d+0
            t202 = 1/rhoa**4.666666666666667d+0
            t203 = 1/rhoa**2.333333333333333d+0
            t204 = 1/rhoa**2.3333333333333334d+0
            t205 = 1/rhoa**1.6666666666666669d+0
            t206 = 1/t12**5
            t207 = 1/t26**2
            t208 = t120**2
            t209 = -1.4107138347223802d-1*t13*t205*t25-3.52678458680595d
     1         -2*t110*t111*t25+2.539284902500284d+0*t119**2*t12/t24**3-
     2         1.269642451250142d+0*t117*t12*(6.563527649164527d-2*t110*
     3         t206*t23+8.751370198886037d-2*t111*t205*t23+7.87623317899
     4         7433d-1*t13*(6.563527649164527d-2*t110*t206*t22+8.7513701
     5         98886037d-2*t111*t205*t22+4.753699179395351d-3*t204)-2.62
     6         5411059665811d-1*t111*t112*t118)-4.23214150416714d-1*t112
     7         *t117*t119*t13
            t210 = 9.999999999999991d-1*(6.21814d-2*t116*t209*t28-6.2181
     1         4d-2*t207*t208*t28+3.663697685584584d-3*t203*t27-3.10907d
     2         -2*t108*(-1.269642451250142d+0*t109*t12*(7.87623317899743
     3         3d-1*t13*(6.563527649164527d-2*t110*t14*t206+8.7513701988
     4         86037d-2*t111*t14*t205+3.0144339229749983d-3*t204)+6.5635
     5         27649164527d-2*t110*t15*t206+8.751370198886037d-2*t111*t1
     6         5*t205-2.625411059665811d-1*t111*t112*t113)-1.41071383472
     7         23802d-1*t13*t17*t205-3.52678458680595d-2*t110*t111*t17+2
     8         .539284902500284d+0*t114**2*t12/t16**3-4.23214150416714d-
     9         1*t109*t112*t114*t13)*t21+3.10907d-2*t115**2*t21/t18**2-1
     :         .7613865241785687d-3*t19*t203-5.495546528376876d-3*t107*t
     ;         116*t120+2.642079786267853d-3*t107*t108*t115)-6.21814d-2*
     <         t116*t209*t28+6.21814d-2*t207*t208*t28-3.663697685584584d
     =         -3*t203*t27+5.495546528376876d-3*t107*t116*t120
            t211 = t128**2
            t212 = 1/t74**2
            t213 = 6.21814d-2*t211*t212*t67
            t214 = 1/t64**2.3333333333333334d+0
            t215 = 1/t68**5
            t216 = 1/t64**1.6666666666666669d+0
            t217 = -1.4107138347223802d-1*t216*t69*t73-3.52678458680595d
     1         -2*t122*t124*t73+2.539284902500284d+0*t126**2*t68/t72**3-
     2         1.269642451250142d+0*t127*t68*(8.751370198886037d-2*t124*
     3         t216*t71+6.563527649164527d-2*t122*t215*t71+7.87623317899
     4         7433d-1*t69*(8.751370198886037d-2*t124*t216*t70+6.5635276
     5         49164527d-2*t122*t215*t70+4.753699179395351d-3*t214)-2.62
     6         5411059665811d-1*t123*t124*t125)-4.23214150416714d-1*t123
     7         *t126*t127*t69
            t218 = -6.21814d-2*t129*t217*t67
            t219 = 5.495546528376876d-3*t128*t129*t131
            t220 = 1/t64**2.333333333333333d+0
            t221 = -3.663697685584584d-3*t220*t75
            t222 = t136**2
            t223 = 1/t86**2
            t224 = -3.37738d-2*t222*t223*t81
            t225 = -1.4107138347223802d-1*t216*t69*t85-3.52678458680595d
     1         -2*t122*t124*t85+2.539284902500284d+0*t134**2*t68/t84**3-
     2         1.269642451250142d+0*t135*t68*(8.751370198886037d-2*t124*
     3         t216*t83+6.563527649164527d-2*t122*t215*t83+7.87623317899
     4         7433d-1*t69*(8.751370198886037d-2*t124*t216*t82+6.5635276
     5         49164527d-2*t122*t215*t82+2.601716490612924d-3*t214)-2.62
     6         5411059665811d-1*t123*t124*t133)-4.23214150416714d-1*t123
     7         *t134*t135*t69
            t226 = 3.37738d-2*t137*t225*t81
            t227 = -1.5539098445407465d-3*t131*t136*t137
            t228 = 1.0359398963604977d-3*t220*t87
            t229 = t88*t89*(1.709920934161365d+0*(-1.7613865241785687d-3
     1         *t220*t96+3.10907d-2*t143**2*t90/t95**2-3.10907d-2*t144*t
     2         90*(-1.4107138347223802d-1*t216*t69*t94-3.52678458680595d
     3         -2*t122*t124*t94+2.539284902500284d+0*t141**2*t68/t93**3-
     4         1.269642451250142d+0*t142*t68*(8.751370198886037d-2*t124*
     5         t216*t92+6.563527649164527d-2*t122*t215*t92+7.87623317899
     6         7433d-1*t69*(8.751370198886037d-2*t124*t216*t91+6.5635276
     7         49164527d-2*t122*t215*t91+3.0144339229749983d-3*t214)-2.6
     8         25411059665811d-1*t123*t124*t140)-4.23214150416714d-1*t12
     9         3*t141*t142*t69)+3.663697685584584d-3*t220*t75+6.21814d-2
     :         *t129*t217*t67-6.21814d-2*t211*t212*t67+2.642079786267853
     ;         d-3*t131*t143*t144-5.495546528376876d-3*t128*t129*t131)-1
     <         .0359398963604977d-3*t220*t87-3.37738d-2*t137*t225*t81+3.
     =         37738d-2*t222*t223*t81+1.5539098445407465d-3*t131*t136*t1
     >         37)
            t230 = -8*t145*t147*t88
            t231 = 20*t88*t97/t64**6
            t232 = t76**2
            t233 = 12*t232*t89*t97
            t234 = 1/t78**6.666666666666666d-1
            t235 = 1/t64**3
            t236 = -2*t235*t76
            t237 = 2*t151
            t238 = 1/t79**6.666666666666666d-1
            t239 = 2*t235*t76
            t240 = -2*t151
            t241 = 1/t59**4
            t242 = 1/t32**4
            t243 = 1/rhob**10
            t244 = 1/rhob**7.333333333333333d+0
            t245 = 1/rhob**4.666666666666667d+0
            t246 = 1/rhob**2.333333333333333d+0
            t247 = 1/rhob**2.3333333333333334d+0
            t248 = 1/rhob**1.6666666666666669d+0
            t249 = 1/t38**5
            t250 = 1/t52**2
            t251 = t184**2
            t252 = -1.4107138347223802d-1*t248*t39*t51-3.52678458680595d
     1         -2*t174*t175*t51+2.539284902500284d+0*t183**2*t38/t50**3-
     2         1.269642451250142d+0*t181*t38*(6.563527649164527d-2*t174*
     3         t249*t49+8.751370198886037d-2*t175*t248*t49+7.87623317899
     4         7433d-1*t39*(6.563527649164527d-2*t174*t249*t48+8.7513701
     5         98886037d-2*t175*t248*t48+4.753699179395351d-3*t247)-2.62
     6         5411059665811d-1*t175*t176*t182)-4.23214150416714d-1*t176
     7         *t181*t183*t39
            t253 = 9.999999999999991d-1*(6.21814d-2*t180*t252*t54-6.2181
     1         4d-2*t250*t251*t54+3.663697685584584d-3*t246*t53+3.10907d
     2         -2*t179**2*t47/t44**2-3.10907d-2*t172*(-1.410713834722380
     3         2d-1*t248*t39*t43-3.52678458680595d-2*t174*t175*t43+2.539
     4         284902500284d+0*t178**2*t38/t42**3-1.269642451250142d+0*t
     5         173*t38*(6.563527649164527d-2*t174*t249*t41+8.75137019888
     6         6037d-2*t175*t248*t41+7.876233178997433d-1*t39*(6.5635276
     7         49164527d-2*t174*t249*t40+8.751370198886037d-2*t175*t248*
     8         t40+3.0144339229749983d-3*t247)-2.625411059665811d-1*t175
     9         *t176*t177)-4.23214150416714d-1*t173*t176*t178*t39)*t47-1
     :         .7613865241785687d-3*t246*t45-5.495546528376876d-3*t171*t
     ;         180*t184+2.642079786267853d-3*t171*t172*t179)-6.21814d-2*
     <         t180*t252*t54+6.21814d-2*t250*t251*t54-3.663697685584584d
     =         -3*t246*t53+5.495546528376876d-3*t171*t180*t184
            fnc(iq) = 1.0d+0*(t100*t63+1.0d+0*rhob*t36*t55+1.0d+0*rhoa*t
     1         10*t29)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(t162*t63+1.0d+0*rhoa*t106*t29+1.0d+
     1         0*t10*t29+t100*t164+1.0d+0*rhoa*t10*t121)*wght+Amat(iq,D1
     2         _RA)
            Amat(iq,D1_RB) = 1.0d+0*(t191*t63+1.0d+0*t36*t55+1.0d+0*rhob
     1         *t170*t55+1.0d+0*rhob*t185*t36+t100*t192)*wght+Amat(iq,D1
     2         _RB)
            Cmat(iq,D1_GAA) = 1.0d+0*(1.0d+0*rhoa*t194*t29+t100*t195)*wg
     1         ht+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = 1.0d+0*(1.0d+0*rhob*t197*t55+t100*t198)*wg
     1         ht+Cmat(iq,D1_GBB)
            Amat2(iq,D2_RA_RA) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622634
     1         648d-1*(2.564881401242048d+0*t158*(t240+t239)+8.549604670
     2         806825d-1*t157**2*t238+2.564881401242048d+0*t155*(t237+t2
     3         36)+8.549604670806825d-1*t154**2*t234)*t98+5.848223622634
     4         648d-1*t80*(-32*t147*t149*t97+8*t145*t149*t89+t233+t231+t
     5         230+t229+t228+t227+t226+t224)+t221+t219+t218+t213+1.16964
     6         47245269297d+0*t150*t159)-1.0d+0*rhoa*t210+2.0d+0*t160-2.
     7         0d+0*t121)+1.0d+0*rhoa*t29*(1.9555555555555554d+0*gammaaa
     8         *t202*t8*t9-9.6d-1*t201*t3*t6*t8+1.1377777777777778d-1*t1
     9         01*t102*t200*t8+1.3511111111111113d+0*t2*t201*t3*t6-6.115
     :         555555555556d-1*t101*t102*t2*t200+6.826666666666669d-2*ga
     ;         mmaaa**4*t199*t2/rhoa**1.2666666666666665d+1)+t100*(2.933
     <         3333333333333d-2*gammaaa*t202*t61*t62-8.8d-5*gammaaa*t202
     =         *t57*t60*t61-1.28d-4*t201*t3*t60*t61+3.84d-7*t163*t201*t3
     >         *t57*t61+1.76d-4*gammaaa*t202*t56*t57*t60+1.28d-4*t201*t3
     ?         *t56*t60+3.456000000000001d-9*t201*t241*t3*t56*t58-5.28d-
     @         7*gammaaa*t163*t202*t56*t58-1.5360000000000001d-6*t163*t2
     1         01*t3*t56*t57)+2.0d+0*t106*t29+1.0d+0*rhoa*t10*t210+2*t16
     2         2*t164+2.0d+0*rhoa*t106*t121+2.0d+0*t10*t121)*wght+Amat2(
     3         iq,D2_RA_RA)
            Amat2(iq,D2_RA_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622634
     1         648d-1*(5.129762802484096d+0*t158*t235*t76-5.129762802484
     2         096d+0*t155*t235*t76+8.549604670806825d-1*t157*t188*t238+
     3         8.549604670806825d-1*t154*t187*t234)*t98+5.84822362263464
     4         8d-1*t80*(-12*t232*t89*t97+t231+t230+t229+t228+t227+t226+
     5         t224)+t221+t219+t218+t213+5.848223622634648d-1*t150*t189+
     6         5.848223622634648d-1*t159*t186)+1.0d+0*t190+1.0d+0*t160)+
     7         t100*(-1.28d-4*gammaaa*gammabb*t105*t169*t60*t61+3.84d-7*
     8         gammaaa*gammabb*t105*t163*t169*t57*t61+1.28d-4*gammaaa*ga
     9         mmabb*t105*t169*t56*t60+3.456000000000001d-9*gammaaa*gamm
     :         abb*t105*t169*t241*t56*t58-1.5360000000000001d-6*gammaaa*
     ;         gammabb*t105*t163*t169*t56*t57)+t162*t192+t164*t191)*wght
     <         +Amat2(iq,D2_RA_RB)
            Amat2(iq,D2_RB_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622634
     1         648d-1*(2.564881401242048d+0*t155*(t240+t236)+2.564881401
     2         242048d+0*t158*(t239+t237)+8.549604670806825d-1*t188**2*t
     3         238+8.549604670806825d-1*t187**2*t234)*t98+5.848223622634
     4         648d-1*t80*(32*t147*t149*t97-8*t145*t149*t89+t233+t231+t2
     5         30+t229+t228+t227+t226+t224)+t221+t219+t218+t213+1.169644
     6         7245269297d+0*t186*t189)-1.0d+0*rhob*t253+2.0d+0*t190-2.0
     7         d+0*t185)+1.0d+0*rhob*t55*(1.9555555555555554d+0*gammabb*
     8         t245*t35*t8-9.6d-1*t244*t30*t33*t8+1.1377777777777778d-1*
     9         t165*t166*t243*t8+1.3511111111111113d+0*t2*t244*t30*t33-6
     :         .115555555555556d-1*t165*t166*t2*t243+6.826666666666669d-
     ;         2*gammabb**4*t2*t242/rhob**1.2666666666666665d+1)+t100*(2
     <         .9333333333333333d-2*gammabb*t245*t61*t62-8.8d-5*gammabb*
     =         t245*t57*t60*t61-1.28d-4*t244*t30*t60*t61+3.84d-7*t163*t2
     >         44*t30*t57*t61+1.76d-4*gammabb*t245*t56*t57*t60+1.28d-4*t
     ?         244*t30*t56*t60+3.456000000000001d-9*t241*t244*t30*t56*t5
     @         8-5.28d-7*gammabb*t163*t245*t56*t58-1.5360000000000001d-6
     1         *t163*t244*t30*t56*t57)+2.0d+0*t170*t55+1.0d+0*rhob*t253*
     2         t36+2.0d+0*t185*t36+2*t191*t192+2.0d+0*rhob*t170*t185)*wg
     3         ht+Amat2(iq,D2_RB_RB)
            Cmat2(iq,D2_RA_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(-5.3333333333
     1         33333d-1*t105*t8*t9+3.2d-1*gammaaa*t104*t6*t8-4.266666666
     2         6666675d-2*t102*t103*t3*t8-4.2666666666666675d-1*gammaaa*
     3         t104*t2*t6+2.1333333333333337d-1*t102*t103*t2*t3-2.560000
     4         0000000006d-2*t101*t199*t2/rhoa**1.1666666666666665d+1)+t
     5         100*(-8.0d-3*t105*t61*t62+2.4000000000000002d-5*t105*t57*
     6         t60*t61+4.8000000000000004d-5*gammaaa*t104*t60*t61-1.4400
     7         000000000002d-7*gammaaa*t104*t163*t57*t61-4.8000000000000
     8         004d-5*t105*t56*t57*t60-4.8000000000000004d-5*gammaaa*t10
     9         4*t56*t60-1.2960000000000002d-9*gammaaa*t104*t241*t56*t58
     :         +1.4400000000000002d-7*t105*t163*t56*t58+5.76000000000000
     ;         1d-7*gammaaa*t104*t163*t56*t57)+1.0d+0*t194*t29+t162*t195
     <         +1.0d+0*rhoa*t121*t194)*wght+Cmat2(iq,D2_RA_GAA)
            Cmat2(iq,D2_RA_GAB) = Cmat2(iq,D2_RA_GAB)
            Cmat2(iq,D2_RA_GBB) = 1.0d+0*(t100*(4.8000000000000004d-5*ga
     1         mmaaa*t105*t31*t60*t61-1.4400000000000002d-7*gammaaa*t105
     2         *t163*t31*t57*t61-4.8000000000000004d-5*gammaaa*t105*t31*
     3         t56*t60-1.2960000000000002d-9*gammaaa*t105*t241*t31*t56*t
     4         58+5.760000000000001d-7*gammaaa*t105*t163*t31*t56*t57)+t1
     5         62*t198)*wght+Cmat2(iq,D2_RA_GBB)
            Cmat2(iq,D2_RB_GAA) = 1.0d+0*(t100*(4.8000000000000004d-5*ga
     1         mmabb*t169*t4*t60*t61-1.4400000000000002d-7*gammabb*t163*
     2         t169*t4*t57*t61-4.8000000000000004d-5*gammabb*t169*t4*t56
     3         *t60-1.2960000000000002d-9*gammabb*t169*t241*t4*t56*t58+5
     4         .760000000000001d-7*gammabb*t163*t169*t4*t56*t57)+t191*t1
     5         95)*wght+Cmat2(iq,D2_RB_GAA)
            Cmat2(iq,D2_RB_GAB) = Cmat2(iq,D2_RB_GAB)
            Cmat2(iq,D2_RB_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(-5.3333333333
     1         33333d-1*t169*t35*t8+3.2d-1*gammabb*t168*t33*t8-4.2666666
     2         666666675d-2*t166*t167*t30*t8-4.2666666666666675d-1*gamma
     3         bb*t168*t2*t33+2.1333333333333337d-1*t166*t167*t2*t30-2.5
     4         600000000000006d-2*t165*t2*t242/rhob**1.1666666666666665d
     5         +1)+t100*(-8.0d-3*t169*t61*t62+2.4000000000000002d-5*t169
     6         *t57*t60*t61+4.8000000000000004d-5*gammabb*t168*t60*t61-1
     7         .4400000000000002d-7*gammabb*t163*t168*t57*t61-4.80000000
     8         00000004d-5*t169*t56*t57*t60-4.8000000000000004d-5*gammab
     9         b*t168*t56*t60-1.2960000000000002d-9*gammabb*t168*t241*t5
     :         6*t58+1.4400000000000002d-7*t163*t169*t56*t58+5.760000000
     ;         000001d-7*gammabb*t163*t168*t56*t57)+1.0d+0*t197*t55+t191
     <         *t198+1.0d+0*rhob*t185*t197)*wght+Cmat2(iq,D2_RB_GBB)
            Cmat2(iq,D2_GAA_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(-8.000000000
     1         000002d-2*t6*t7*t8+1.6000000000000003d-2*gammaaa*t102*t19
     2         3*t8+8.000000000000002d-2*t2*t6*t7+9.600000000000004d-3*t
     3         199*t2*t3/rhoa**1.0666666666666666d+1-6.400000000000001d-
     4         2*gammaaa*t102*t193*t2)+t100*(-1.8d-5*t60*t61*t7+5.4d-8*t
     5         163*t57*t61*t7+1.8d-5*t56*t60*t7+4.860000000000001d-10*t2
     6         41*t56*t58*t7-2.16d-7*t163*t56*t57*t7))*wght+Cmat2(iq,D2_
     7         GAA_GAA)
            Cmat2(iq,D2_GAA_GAB) = Cmat2(iq,D2_GAA_GAB)
            Cmat2(iq,D2_GAA_GBB) = 1.0d+0*t100*(t163*t31*t4*(5.4d-8*t57*
     1         t61-2.16d-7*t56*t57)+t31*t4*t60*(1.8d-5*t56-1.8d-5*t61)+4
     2         .860000000000001d-10*t241*t31*t4*t56*t58)*wght+Cmat2(iq,D
     3         2_GAA_GBB)
            Cmat2(iq,D2_GAB_GAB) = Cmat2(iq,D2_GAB_GAB)
            Cmat2(iq,D2_GAB_GBB) = Cmat2(iq,D2_GAB_GBB)
            Cmat2(iq,D2_GBB_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(-8.000000000
     1         000002d-2*t33*t34*t8+1.6000000000000003d-2*gammabb*t166*t
     2         196*t8+8.000000000000002d-2*t2*t33*t34+9.600000000000004d
     3         -3*t2*t242*t30/rhob**1.0666666666666666d+1-6.400000000000
     4         001d-2*gammabb*t166*t196*t2)+t100*(-1.8d-5*t34*t60*t61+5.
     5         4d-8*t163*t34*t57*t61+1.8d-5*t34*t56*t60+4.86000000000000
     6         1d-10*t241*t34*t56*t58-2.16d-7*t163*t34*t56*t57))*wght+Cm
     7         at2(iq,D2_GBB_GBB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = gammaaa**3
            t30 = 1/t4**3
            t31 = 1/rhoa**9
            t32 = 1/rhoa**6.333333333333333d+0
            t33 = 1/rhoa**3.6666666666666664d+0
            t34 = -5.333333333333333d-1*gammaaa*t33*t7*t8+1.066666666666
     1         6667d-1*t2*t32*t5*t7-2.1333333333333337d-1*t1*t2*t32*t5+4
     2         .2666666666666675d-2*t1*t29*t30*t31
            t35 = 1/rhoa**1.3333333333333333d+0
            t36 = 1/t17
            t37 = 1/t15**2
            t38 = 1/rhoa**1.3333333333333336d+0
            t39 = 1/t11**3
            t40 = 1/rhoa**6.666666666666667d-1
            t41 = -1.3127055298329054d-1*t13*t39*t40-2.0096226153166658d
     1         -3*t38
            t42 = 7.876233178997433d-1*t12*t41-1.3127055298329054d-1*t14
     1         *t39*t40
            t43 = 2.11607075208357d-1*t12*t16*t40-1.269642451250142d+0*t
     1         11*t37*t42
            t44 = 1/t25
            t45 = 1/t23**2
            t46 = -1.3127055298329054d-1*t21*t39*t40-3.169132786263567d-
     1         3*t38
            t47 = 7.876233178997433d-1*t12*t46-1.3127055298329054d-1*t22
     1         *t39*t40
            t48 = 2.11607075208357d-1*t12*t24*t40-1.269642451250142d+0*t
     1         11*t45*t47
            t49 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t48-3.10907d-
     1         2*t20*t36*t43-2.747773264188438d-3*t26*t35+1.321039893133
     2         9265d-3*t18*t35)-6.21814d-2*t27*t44*t48+2.747773264188438
     3         d-3*t26*t35
            t50 = 1/rhoa**8
            t51 = -1.6000000000000003d-2*t1*t2*t30*t50
            t52 = 8.000000000000002d-2*gammaaa*t1-4.000000000000001d-2*g
     1         ammaaa*t7
            t53 = 2.0d-1*t3*t7*t8
            t54 = 1/t4**4
            t55 = 1/rhoa**10
            t56 = 1/rhoa**7.333333333333333d+0
            t57 = 1/rhoa**2.333333333333333d+0
            t58 = 1/rhoa**2.3333333333333334d+0
            t59 = 1/rhoa**1.6666666666666669d+0
            t60 = 1/t11**5
            t61 = 1/t25**2
            t62 = t48**2
            t63 = -1.269642451250142d+0*t11*t45*(7.876233178997433d-1*t1
     1         2*(6.563527649164527d-2*t21*t38*t60+8.751370198886037d-2*
     2         t21*t39*t59+4.753699179395351d-3*t58)+6.563527649164527d-
     3         2*t22*t38*t60+8.751370198886037d-2*t22*t39*t59-2.62541105
     4         9665811d-1*t39*t40*t46)-1.4107138347223802d-1*t12*t24*t59
     5         +2.539284902500284d+0*t11*t47**2/t23**3-4.23214150416714d
     6         -1*t12*t40*t45*t47-3.52678458680595d-2*t24*t38*t39
            t64 = -4.000000000000001d-2*gammaaa*t5*t6*t7+8.0000000000000
     1         02d-2*gammaaa*t1*t5*t6+t53+t51
            fnc(iq) = 1.0d+0*rhoa*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*rhoa*t49*t9*wght+1.0d+0*t28*t9*wght+
     1         1.0d+0*rhoa*t28*t34*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 1.0d+0*rhoa*t28*(t5*t52*t6+t53+t51)*wght+C
     1         mat(iq,D1_GAA)
            Amat2(iq,D2_RA_RA) = 1.0d+0*rhoa*(9.999999999999991d-1*(6.21
     1         814d-2*t27*t44*t63-6.21814d-2*t27*t61*t62-3.10907d-2*t20*
     2         t36*(-1.269642451250142d+0*t11*t37*(7.876233178997433d-1*
     3         t12*(6.563527649164527d-2*t13*t38*t60+8.751370198886037d-
     4         2*t13*t39*t59+3.0144339229749983d-3*t58)+6.56352764916452
     5         7d-2*t14*t38*t60+8.751370198886037d-2*t14*t39*t59-2.62541
     6         1059665811d-1*t39*t40*t41)-1.4107138347223802d-1*t12*t16*
     7         t59+2.539284902500284d+0*t11*t42**2/t15**3-4.232141504167
     8         14d-1*t12*t37*t40*t42-3.52678458680595d-2*t16*t38*t39)+3.
     9         663697685584584d-3*t26*t57-1.7613865241785687d-3*t18*t57-
     :         5.495546528376876d-3*t35*t44*t48+3.10907d-2*t20*t43**2/t1
     ;         7**2+2.642079786267853d-3*t35*t36*t43)-6.21814d-2*t27*t44
     <         *t63+6.21814d-2*t27*t61*t62-3.663697685584584d-3*t26*t57+
     =         5.495546528376876d-3*t35*t44*t48)*t9*wght+2.0d+0*t49*t9*w
     >         ght+1.0d+0*rhoa*t28*(1.9555555555555554d+0*gammaaa*t7*t8/
     ?         rhoa**4.666666666666667d+0-9.6d-1*t2*t5*t56*t7+1.13777777
     @         77777778d-1*t29*t30*t55*t7+1.3511111111111113d+0*t1*t2*t5
     1         *t56-6.115555555555556d-1*t1*t29*t30*t55+6.82666666666666
     2         9d-2*gammaaa**4*t1*t54/rhoa**1.2666666666666665d+1)*wght+
     3         2.0d+0*rhoa*t34*t49*wght+2.0d+0*t28*t34*wght+Amat2(iq,D2_
     4         RA_RA)
            Cmat2(iq,D2_RA_GAA) = 1.0d+0*rhoa*t28*(-5.333333333333333d-1
     1         *t33*t7*t8+3.2d-1*gammaaa*t32*t5*t7-4.2666666666666675d-2
     2         *t2*t30*t31*t7-2.5600000000000006d-2*t1*t29*t54/rhoa**1.1
     3         666666666666665d+1-4.2666666666666675d-1*gammaaa*t1*t32*t
     4         5+2.1333333333333337d-1*t1*t2*t30*t31)*wght+1.0d+0*rhoa*t
     5         49*t64*wght+1.0d+0*t28*t64*wght+Cmat2(iq,D2_RA_GAA)
            Cmat2(iq,D2_GAA_GAA) = 1.0d+0*rhoa*t28*(t5*t6*(8.00000000000
     1         0002d-2*t1-8.000000000000002d-2*t7)+9.600000000000004d-3*
     2         t1*t2*t54/rhoa**1.0666666666666666d+1+t30*t50*(-4.0d-1*t5
     3         2-3.2000000000000006d-2*gammaaa*t1))*wght+Cmat2(iq,D2_GAA
     4         _GAA)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammabb**2
            t3 = 1/rhob**2.6666666666666666d+0
            t4 = 2.0d-1*gammabb*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhob**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammabb*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhob**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = gammabb**3
            t30 = 1/t4**3
            t31 = 1/rhob**9
            t32 = 1/rhob**6.333333333333333d+0
            t33 = 1/rhob**3.6666666666666664d+0
            t34 = -5.333333333333333d-1*gammabb*t33*t7*t8+1.066666666666
     1         6667d-1*t2*t32*t5*t7-2.1333333333333337d-1*t1*t2*t32*t5+4
     2         .2666666666666675d-2*t1*t29*t30*t31
            t35 = 1/rhob**1.3333333333333333d+0
            t36 = 1/t17
            t37 = 1/t15**2
            t38 = 1/rhob**1.3333333333333336d+0
            t39 = 1/t11**3
            t40 = 1/rhob**6.666666666666667d-1
            t41 = -1.3127055298329054d-1*t13*t39*t40-2.0096226153166658d
     1         -3*t38
            t42 = 7.876233178997433d-1*t12*t41-1.3127055298329054d-1*t14
     1         *t39*t40
            t43 = 2.11607075208357d-1*t12*t16*t40-1.269642451250142d+0*t
     1         11*t37*t42
            t44 = 1/t25
            t45 = 1/t23**2
            t46 = -1.3127055298329054d-1*t21*t39*t40-3.169132786263567d-
     1         3*t38
            t47 = 7.876233178997433d-1*t12*t46-1.3127055298329054d-1*t22
     1         *t39*t40
            t48 = 2.11607075208357d-1*t12*t24*t40-1.269642451250142d+0*t
     1         11*t45*t47
            t49 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t48-3.10907d-
     1         2*t20*t36*t43-2.747773264188438d-3*t26*t35+1.321039893133
     2         9265d-3*t18*t35)-6.21814d-2*t27*t44*t48+2.747773264188438
     3         d-3*t26*t35
            t50 = 1/rhob**8
            t51 = -1.6000000000000003d-2*t1*t2*t30*t50
            t52 = 8.000000000000002d-2*gammabb*t1-4.000000000000001d-2*g
     1         ammabb*t7
            t53 = 2.0d-1*t3*t7*t8
            t54 = 1/t4**4
            t55 = 1/rhob**10
            t56 = 1/rhob**7.333333333333333d+0
            t57 = 1/rhob**2.333333333333333d+0
            t58 = 1/rhob**2.3333333333333334d+0
            t59 = 1/rhob**1.6666666666666669d+0
            t60 = 1/t11**5
            t61 = 1/t25**2
            t62 = t48**2
            t63 = -1.269642451250142d+0*t11*t45*(7.876233178997433d-1*t1
     1         2*(6.563527649164527d-2*t21*t38*t60+8.751370198886037d-2*
     2         t21*t39*t59+4.753699179395351d-3*t58)+6.563527649164527d-
     3         2*t22*t38*t60+8.751370198886037d-2*t22*t39*t59-2.62541105
     4         9665811d-1*t39*t40*t46)-1.4107138347223802d-1*t12*t24*t59
     5         +2.539284902500284d+0*t11*t47**2/t23**3-4.23214150416714d
     6         -1*t12*t40*t45*t47-3.52678458680595d-2*t24*t38*t39
            t64 = -4.000000000000001d-2*gammabb*t5*t6*t7+8.0000000000000
     1         02d-2*gammabb*t1*t5*t6+t53+t51
            fnc(iq) = 1.0d+0*rhob*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RB) = 1.0d+0*rhob*t49*t9*wght+1.0d+0*t28*t9*wght+
     1         1.0d+0*rhob*t28*t34*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GBB) = 1.0d+0*rhob*t28*(t5*t52*t6+t53+t51)*wght+C
     1         mat(iq,D1_GBB)
            Amat2(iq,D2_RB_RB) = 1.0d+0*rhob*(9.999999999999991d-1*(6.21
     1         814d-2*t27*t44*t63-6.21814d-2*t27*t61*t62-3.10907d-2*t20*
     2         t36*(-1.269642451250142d+0*t11*t37*(7.876233178997433d-1*
     3         t12*(6.563527649164527d-2*t13*t38*t60+8.751370198886037d-
     4         2*t13*t39*t59+3.0144339229749983d-3*t58)+6.56352764916452
     5         7d-2*t14*t38*t60+8.751370198886037d-2*t14*t39*t59-2.62541
     6         1059665811d-1*t39*t40*t41)-1.4107138347223802d-1*t12*t16*
     7         t59+2.539284902500284d+0*t11*t42**2/t15**3-4.232141504167
     8         14d-1*t12*t37*t40*t42-3.52678458680595d-2*t16*t38*t39)+3.
     9         663697685584584d-3*t26*t57-1.7613865241785687d-3*t18*t57-
     :         5.495546528376876d-3*t35*t44*t48+3.10907d-2*t20*t43**2/t1
     ;         7**2+2.642079786267853d-3*t35*t36*t43)-6.21814d-2*t27*t44
     <         *t63+6.21814d-2*t27*t61*t62-3.663697685584584d-3*t26*t57+
     =         5.495546528376876d-3*t35*t44*t48)*t9*wght+2.0d+0*t49*t9*w
     >         ght+1.0d+0*rhob*t28*(1.9555555555555554d+0*gammabb*t7*t8/
     ?         rhob**4.666666666666667d+0-9.6d-1*t2*t5*t56*t7+1.13777777
     @         77777778d-1*t29*t30*t55*t7+1.3511111111111113d+0*t1*t2*t5
     1         *t56-6.115555555555556d-1*t1*t29*t30*t55+6.82666666666666
     2         9d-2*gammabb**4*t1*t54/rhob**1.2666666666666665d+1)*wght+
     3         2.0d+0*rhob*t34*t49*wght+2.0d+0*t28*t34*wght+Amat2(iq,D2_
     4         RB_RB)
            Cmat2(iq,D2_RB_GBB) = 1.0d+0*rhob*t28*(-5.333333333333333d-1
     1         *t33*t7*t8+3.2d-1*gammabb*t32*t5*t7-4.2666666666666675d-2
     2         *t2*t30*t31*t7-2.5600000000000006d-2*t1*t29*t54/rhob**1.1
     3         666666666666665d+1-4.2666666666666675d-1*gammabb*t1*t32*t
     4         5+2.1333333333333337d-1*t1*t2*t30*t31)*wght+1.0d+0*rhob*t
     5         49*t64*wght+1.0d+0*t28*t64*wght+Cmat2(iq,D2_RB_GBB)
            Cmat2(iq,D2_GBB_GBB) = 1.0d+0*rhob*t28*(t5*t6*(8.00000000000
     1         0002d-2*t1-8.000000000000002d-2*t7)+9.600000000000004d-3*
     2         t1*t2*t54/rhob**1.0666666666666666d+1+t30*t50*(-4.0d-1*t5
     3         2-3.2000000000000006d-2*gammabb*t1))*wght+Cmat2(iq,D2_GBB
     4         _GBB)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_b97 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\alpha^{0.3333333333333333}\\\\ 
C>   {\it t_2} &=& \sqrt{{\it t_1}}\\\\ 
C>   {\it t_3} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_4} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_5} &=& \log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_3}+0.10186556948\right)\,{\it t_3}+0.22308199064\right)\,{\it t_3}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_6} &=& 0.1325688999052018\,{\it t_4}+1.0\\\\ 
C>   {\it t_7} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_5}\,{\it t_6}-0.0310907\,\log \left({{1.269642451250142\,{\it t_2}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_3}+0.10465751434\right)\,{\it t_3}+0.19269083139\right)\,{\it t_3}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_4}+1.0\right)\right)-0.0621814\,{\it t_5}\,{\it t_6}\\\\ 
C>   {\it t_8} &=& {\it param}\left(2\right)\\\\ 
C>   {\it t_9} &=& {\it param}\left(6\right)\\\\ 
C>   {\it t_{10}} &=& {{1}\over{\rho_\alpha^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{11}} &=& 0.2\,{\it t_{10}}\,\sigma_{\alpha\alpha}+1.0\\\\ 
C>   {\it t_{12}} &=& {\it param}\left(4\right)\\\\ 
C>   {\it t_{13}} &=& \rho_\beta^{0.3333333333333333}\\\\ 
C>   {\it t_{14}} &=& \sqrt{{\it t_{13}}}\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_{14}}}}\\\\ 
C>   {\it t_{16}} &=& {{1}\over{{\it t_{13}}}}\\\\ 
C>   {\it t_{17}} &=& \log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{15}}+0.10186556948\right)\,{\it t_{15}}+0.22308199064\right)\,{\it t_{15}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{18}} &=& 0.1325688999052018\,{\it t_{16}}+1.0\\\\ 
C>   {\it t_{19}} &=& 0.9999999999999991\,\left(0.0621814\,{\it t_{17}}\,{\it t_{18}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{14}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{15}}+0.10465751434\right)\,{\it t_{15}}+0.19269083139\right)\,{\it t_{15}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{16}}+1.0\right)\right)-0.0621814\,{\it t_{17}}\,{\it t_{18}}\\\\ 
C>   {\it t_{20}} &=& {{1}\over{\rho_\beta^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{21}} &=& 0.2\,{\it t_{20}}\,\sigma_{\beta\beta}+1.0\\\\ 
C>   {\it t_{22}} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_{23}} &=& {\it t_{22}}^{0.3333333333333333}\\\\ 
C>   {\it t_{24}} &=& {{1}\over{{\it t_{23}}}}\\\\ 
C>   {\it t_{25}} &=& 0.1325688999052018\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{26}} &=& \sqrt{{\it t_{23}}}\\\\ 
C>   {\it t_{27}} &=& {{1}\over{{\it t_{26}}}}\\\\ 
C>   {\it t_{28}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.02414199311453321\,{\it t_{27}}+0.10186556948\right)+0.22308199064\right)+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{29}} &=& \rho_\alpha-\rho_\beta\\\\ 
C>   {\it t_{30}} &=& {{1}\over{{\it t_{22}}}}\\\\ 
C>   {\it t_{31}} &=& 0.06901399211255826\,{\it t_{24}}+1.0\\\\ 
C>   {\it t_{32}} &=& \log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01321299881039884\,{\it t_{27}}+0.029729725188\right)+0.12236585478\right)+0.3497952466}}+1.0\right)\\\\ 
C>   {\it t_{33}} &=& {\it t_{20}}\,\sigma_{\beta\beta}+{\it t_{10}}\,\sigma_{\alpha\alpha}\\\\ 
C>   {\it t_{34}} &=& 0.003\,{\it t_{33}}+1.0\\\\ 
C>   {\it t_{35}} &=& \rho_s^{0.3333333333333333}\\\\ 
C>   {\it t_{36}} &=& \sqrt{{\it t_{35}}}\\\\ 
C>   {\it t_{37}} &=& {{1}\over{{\it t_{36}}}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{{\it t_{35}}}}\\\\ 
C>   {\it t_{39}} &=& \log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.02414199311453321\,{\it t_{37}}+0.10186556948\right)\,{\it t_{37}}+0.22308199064\right)\,{\it t_{37}}+0.47231125998}}+1.0\right)\\\\ 
C>   {\it t_{40}} &=& 0.1325688999052018\,{\it t_{38}}+1.0\\\\ 
C>   {\it t_{41}} &=& {{1}\over{\rho_s^{{{8}\over{3}}}}}\\\\ 
C>   {\it t_{42}} &=& 0.2\,{\it t_{41}}\,\sigma_{ss}+1.0\\\\ 
C>   f &=& 1.0\,\left(\left(1.0\,{\it t_{22}}\,\left(0.5848223622634648\,\left(1.923661050931536\,\left({\it t_{29}}\,{\it t_{30}}+1.0\right)^{{{4}\over{3}}}+1.923661050931536\,\left(1.0-{\it t_{29}}\,{\it t_{30}}\right)^{{{4}\over{3}}}-3.847322101863072\right)\,\left({{{\it t_{29}}^4\,\left(1.709920934161365\,\left(0.0621814\,{\it t_{25}}\,{\it t_{28}}-0.0310907\,\left(0.1274696188700087\,{\it t_{24}}+1.0\right)\,\log \left({{1.269642451250142\,{\it t_{26}}}\over{0.7876233178997433\,{\it t_{27}}\,\left(0.7876233178997433\,{\it t_{27}}\,\left(0.01530901310039024\,{\it t_{27}}+0.10465751434\right)+0.19269083139\right)+0.43896648423}}+1.0\right)\right)-0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)}\over{{\it t_{22}}^4}}+0.0337738\,{\it t_{31}}\,{\it t_{32}}\right)-0.0621814\,{\it t_{25}}\,{\it t_{28}}\right)-1.0\,{\it t_{19}}\,\rho_\beta-1.0\,{\it t_7}\,\rho_\alpha\right)\,\left({{0.003\,{\it param}\left(5\right)\,{\it t_{33}}}\over{{\it t_{34}}}}+{{9.0 \times 10^{-6}\,{\it param}\left(7\right)\,{\it t_{33}}^2}\over{{\it t_{34}}^2}}+{\it param}\left(3\right)\right)+1.0\,{\it t_{19}}\,\rho_\beta\,\left({{0.2\,{\it t_{12}}\,{\it t_{20}}\,\sigma_{\beta\beta}}\over{{\it t_{21}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\beta\beta}^2}\over{\rho_\beta^{{{16}\over{3}}}\,{\it t_{21}}^2}}+{\it t_8}\right)+1.0\,{\it t_7}\,\rho_\alpha\,\left({{0.2\,{\it t_{12}}\,{\it t_{10}}\,\sigma_{\alpha\alpha}}\over{{\it t_{11}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{\alpha\alpha}^2}\over{\rho_\alpha^{{{16}\over{3}}}\,{\it t_{11}}^2}}+{\it t_8}\right)\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,\left(0.9999999999999991\,\left(0.0621814\,{\it t_{39}}\,{\it t_{40}}-0.0310907\,\log \left({{1.269642451250142\,{\it t_{36}}}\over{0.7876233178997433\,\left(0.7876233178997433\,\left(0.01530901310039024\,{\it t_{37}}+0.10465751434\right)\,{\it t_{37}}+0.19269083139\right)\,{\it t_{37}}+0.43896648423}}+1.0\right)\,\left(0.1274696188700087\,{\it t_{38}}+1.0\right)\right)-0.0621814\,{\it t_{39}}\,{\it t_{40}}\right)\,\rho_s\,\left({{0.2\,{\it t_{12}}\,{\it t_{41}}\,\sigma_{ss}}\over{{\it t_{42}}}}+{{0.04000000000000001\,{\it t_9}\,\sigma_{ss}^2}\over{\rho_s^{{{16}\over{3}}}\,{\it t_{42}}^2}}+{\it t_8}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] AD Becke, J.Chem.Phys. 107, 8554 (1997)  , DOI: 
C> <a href="http://dx.doi.org/10.1063/1.475007 "> 
C> 10.1063/1.475007 </a> 
C> 
      subroutine nwxcm_c_b97_d3(param,tol_rho,ipol,nq,wght, 
     +rho,rgamma,fnc,Amat,Amat2,Amat3, 
     +Cmat,Cmat2,Cmat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision rgamma(nq,*) !< [Input] The norm of the density 
                                    !< gradients 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      double precision Cmat(nq,*)   !< [Output] The derivative wrt rgamma 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
      double precision Cmat2(nq,*)  !< [Output] The 2nd derivative wrt rgamma 
                                    !< and possibly rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,*)  !< [Output] The 3rd derivative wrt rho 
      double precision Cmat3(nq,*)  !< [Output] The 3rd derivative wrt rgamma 
                                    !< and possibly rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      double precision nwxcm_heaviside 
      external         nwxcm_heaviside 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          gammaaa = 0.25d0*rgamma(iq,G_TT) 
          if (rhoa.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = param(7)
            t30 = 6.0d-3*gammaaa*t3+1.0d+0
            t31 = 1/t30**2
            t32 = param(5)
            t33 = 1/t30
            t34 = 3.6d-5*t2*t29*t31*t6+6.0d-3*gammaaa*t3*t32*t33+param(3
     1         )
            t35 = 2.150807071909054d-2*t12+1.0186556948d-1
            t36 = 7.016926042943223d-1*t12*t35+2.2308199064d-1
            t37 = 7.016926042943223d-1*t12*t36+4.7231125998d-1
            t38 = 1/t37
            t39 = 1.4251254664507676d+0*t11*t38+1.0d+0
            t40 = log(t39)
            t41 = 1.0522000558389215d-1*t19+1.0d+0
            t42 = -1.243628d-1*rhoa*t40*t41-2.0d+0*rhoa*t28
            t43 = gammaaa**3
            t44 = 1/t4**3
            t45 = 1/rhoa**9
            t46 = 1/rhoa**6.333333333333333d+0
            t47 = 1/rhoa**3.6666666666666664d+0
            t48 = -5.333333333333333d-1*gammaaa*t47*t7*t8+1.066666666666
     1         6667d-1*t2*t46*t5*t7-2.1333333333333337d-1*t1*t2*t46*t5+4
     2         .2666666666666675d-2*t1*t43*t44*t45
            t49 = 1/rhoa**1.3333333333333333d+0
            t50 = 1/t17
            t51 = 1/t15**2
            t52 = 1/rhoa**1.3333333333333336d+0
            t53 = 1/t11**3
            t54 = 1/rhoa**6.666666666666667d-1
            t55 = -1.3127055298329054d-1*t13*t53*t54-2.0096226153166658d
     1         -3*t52
            t56 = 7.876233178997433d-1*t12*t55-1.3127055298329054d-1*t14
     1         *t53*t54
            t57 = 2.11607075208357d-1*t12*t16*t54-1.269642451250142d+0*t
     1         11*t51*t56
            t58 = 1/t25
            t59 = 1/t23**2
            t60 = -1.3127055298329054d-1*t21*t53*t54-3.169132786263567d-
     1         3*t52
            t61 = 7.876233178997433d-1*t12*t60-1.3127055298329054d-1*t22
     1         *t53*t54
            t62 = 2.11607075208357d-1*t12*t24*t54-1.269642451250142d+0*t
     1         11*t59*t61
            t63 = 9.999999999999991d-1*(6.21814d-2*t27*t58*t62-3.10907d-
     1         2*t20*t50*t57-2.747773264188438d-3*t26*t49+1.321039893133
     2         9265d-3*t18*t49)-6.21814d-2*t27*t58*t62+2.747773264188438
     3         d-3*t26*t49
            t64 = 1/t30**3
            t65 = 1.1520000000000001d-6*t29*t43*t45*t64-1.6d-2*gammaaa*t
     1         32*t33*t47+9.600000000000001d-5*t2*t31*t32*t46-1.92d-4*t2
     2         *t29*t31*t46
            t66 = 1/rhoa**3.3333333333333326d-1
            t67 = 1/t39
            t68 = 1/t37**2
            t69 = -1.1694876738238705d-1*t35*t53*t54-2.51534235937085d-3
     1         *t52
            t70 = 7.016926042943223d-1*t12*t69-1.1694876738238705d-1*t36
     1         *t53*t54
            t71 = 2.375209110751279d-1*t12*t38*t54-1.4251254664507676d+0
     1         *t11*t68*t70
            t72 = -1.243628d-1*rhoa*t41*t67*t71+4.36181817014282d-3*t40*
     1         t66-2.0d+0*rhoa*t63-1.243628d-1*t40*t41-2.0d+0*t28
            t73 = 1/rhoa**8
            t74 = 2.0d-1*t3*t7*t8-1.6000000000000003d-2*t1*t2*t44*t73-4.
     1         000000000000001d-2*gammaaa*t5*t6*t7+8.000000000000002d-2*
     2         gammaaa*t1*t5*t6
            t75 = -4.32d-7*t2*t29*t64*t73-3.6d-5*gammaaa*t31*t32*t6+7.2d
     1         -5*gammaaa*t29*t31*t6+6.0d-3*t3*t32*t33
            t76 = 1.0d+0*(t42*t75+2.0d+0*rhoa*t28*t74)*wght
            t77 = gammaaa**4
            t78 = 1/t4**4
            t79 = 1/rhoa**1.2666666666666665d+1
            t80 = 1/rhoa**10
            t81 = 1/rhoa**7.333333333333333d+0
            t82 = 1/rhoa**4.666666666666667d+0
            t83 = 1.9555555555555554d+0*gammaaa*t7*t8*t82-9.6d-1*t2*t5*t
     1         7*t81+1.3511111111111113d+0*t1*t2*t5*t81+1.13777777777777
     2         78d-1*t43*t44*t7*t80-6.115555555555556d-1*t1*t43*t44*t80+
     3         6.826666666666669d-2*t1*t77*t78*t79
            t84 = 1/rhoa**2.333333333333333d+0
            t85 = 1/t17**2
            t86 = t57**2
            t87 = 1/t15**3
            t88 = t56**2
            t89 = 1/rhoa**2.3333333333333334d+0
            t90 = 1/rhoa**1.6666666666666669d+0
            t91 = 1/t11**5
            t92 = 6.563527649164527d-2*t13*t52*t91+8.751370198886037d-2*
     1         t13*t53*t90+3.0144339229749983d-3*t89
            t93 = 7.876233178997433d-1*t12*t92+6.563527649164527d-2*t14*
     1         t52*t91+8.751370198886037d-2*t14*t53*t90-2.62541105966581
     2         1d-1*t53*t54*t55
            t94 = -1.269642451250142d+0*t11*t51*t93-1.4107138347223802d-
     1         1*t12*t16*t90+2.539284902500284d+0*t11*t87*t88-4.23214150
     2         416714d-1*t12*t51*t54*t56-3.52678458680595d-2*t16*t52*t53
            t95 = 1/t25**2
            t96 = t62**2
            t97 = 1/t23**3
            t98 = t61**2
            t99 = 6.563527649164527d-2*t21*t52*t91+8.751370198886037d-2*
     1         t21*t53*t90+4.753699179395351d-3*t89
            t100 = 7.876233178997433d-1*t12*t99+6.563527649164527d-2*t22
     1         *t52*t91+8.751370198886037d-2*t22*t53*t90-2.6254110596658
     2         11d-1*t53*t54*t60
            t101 = 2.539284902500284d+0*t11*t97*t98-1.4107138347223802d-
     1         1*t12*t24*t90-4.23214150416714d-1*t12*t54*t59*t61-1.26964
     2         2451250142d+0*t100*t11*t59-3.52678458680595d-2*t24*t52*t5
     3         3
            t102 = 9.999999999999991d-1*(-6.21814d-2*t27*t95*t96-3.10907
     1         d-2*t20*t50*t94+3.10907d-2*t20*t85*t86+3.663697685584584d
     2         -3*t26*t84-1.7613865241785687d-3*t18*t84-5.49554652837687
     3         6d-3*t49*t58*t62+6.21814d-2*t101*t27*t58+2.64207978626785
     4         3d-3*t49*t50*t57)+6.21814d-2*t27*t95*t96-3.66369768558458
     5         4d-3*t26*t84+5.495546528376876d-3*t49*t58*t62-6.21814d-2*
     6         t101*t27*t58
            t103 = 1/t30**4
            t104 = 5.866666666666667d-2*gammaaa*t32*t33*t82-8.64d-4*t2*t
     1         31*t32*t81+1.2160000000000001d-3*t2*t29*t31*t81+3.072d-6*
     2         t32*t43*t64*t80-1.6512000000000002d-5*t29*t43*t64*t80+5.5
     3         29600000000001d-8*t103*t29*t77*t79
            t105 = 1/t39**2
            t106 = t71**2
            t107 = 1/t37**3
            t108 = t70**2
            t109 = 5.847438369119352d-2*t35*t52*t91+7.796584492159138d-2
     1         *t35*t53*t90+3.773013539056276d-3*t89
            t110 = 5.847438369119352d-2*t36*t52*t91+7.796584492159138d-2
     1         *t36*t53*t90-2.338975347647741d-1*t53*t54*t69+7.016926042
     2         943223d-1*t109*t12
            t111 = -1.5834727405008528d-1*t12*t38*t90-4.750418221502558d
     1         -1*t12*t54*t68*t70-1.4251254664507676d+0*t11*t110*t68-3.9
     2         586818512521316d-2*t38*t52*t53+2.850250932901535d+0*t107*
     3         t108*t11
            t112 = 8.72363634028564d-3*t66*t67*t71-2.487256d-1*t41*t67*t
     1         71-1.243628d-1*rhoa*t111*t41*t67-4.0d+0*t63+2.90787878009
     2         52133d-3*t40*t49+1.243628d-1*rhoa*t105*t106*t41-2.0d+0*rh
     3         oa*t102
            t113 = 1.0d+0*(4.0d+0*t63*t9+2.0d+0*rhoa*t102*t9+2.0d+0*rhoa
     1         *t28*t83+2*t65*t72+4.0d+0*rhoa*t48*t63+4.0d+0*t28*t48+t10
     2         4*t42+t112*t34)*wght
            t114 = 1/rhoa**1.1666666666666665d+1
            t115 = -5.333333333333333d-1*t47*t7*t8-2.5600000000000006d-2
     1         *t1*t114*t43*t78+3.2d-1*gammaaa*t46*t5*t7-4.2666666666666
     2         675d-2*t2*t44*t45*t7-4.2666666666666675d-1*gammaaa*t1*t46
     3         *t5+2.1333333333333337d-1*t1*t2*t44*t45
            t116 = -1.1520000000000001d-6*t2*t32*t45*t64+5.7600000000000
     1         01d-6*t2*t29*t45*t64-1.6d-2*t32*t33*t47+2.880000000000000
     2         3d-4*gammaaa*t31*t32*t46-3.84d-4*gammaaa*t29*t31*t46-2.07
     3         36000000000004d-8*t103*t114*t29*t43
            t117 = 1.0d+0*(t72*t75+2.0d+0*rhoa*t63*t74+2.0d+0*t28*t74+t1
     1         16*t42+2.0d+0*rhoa*t115*t28)*wght
            t118 = 1/rhoa**1.0666666666666666d+1
            t119 = 9.600000000000004d-3*t1*t118*t2*t78+1.600000000000000
     1         3d-2*gammaaa*t44*t7*t73-6.400000000000001d-2*gammaaa*t1*t
     2         44*t73-8.000000000000002d-2*t5*t6*t7+8.000000000000002d-2
     3         *t1*t5*t6
            t120 = 4.32d-7*gammaaa*t32*t64*t73-1.728d-6*gammaaa*t29*t64*
     1         t73-7.2d-5*t31*t32*t6+7.2d-5*t29*t31*t6+7.776000000000002
     2         d-9*t103*t118*t2*t29
            t121 = 1.0d+0*(t120*t42+2.0d+0*rhoa*t119*t28)*wght
            t122 = gammaaa**5
            t123 = 1/t4**5
            t124 = 1/rhoa**1.6333333333333333d+1
            t125 = 1/rhoa**1.3666666666666666d+1
            t126 = 1/rhoa**11
            t127 = 1/rhoa**8.333333333333334d+0
            t128 = 1/rhoa**5.666666666666667d+0
            t129 = 1/rhoa**3.333333333333333d+0
            t130 = 1/rhoa**3.3333333333333337d+0
            t131 = 1/rhoa**2.666666666666667d+0
            t132 = 1/t11**7
            t133 = 1/rhoa**2.0d+0
            t134 = 1/t25**3
            t135 = t62**3
            t136 = -1.269642451250142d+0*t11*t59*(-3.9381165894987163d-1
     1         *t53*t54*t99+7.876233178997433d-1*t12*(-1.312705529832905
     2         4d-1*t21*t89*t91-1.4585616998143394d-1*t131*t21*t53-5.469
     3         606374303773d-2*t132*t133*t21-1.1708185015918181d-2*t130)
     4         -1.3127055298329054d-1*t22*t89*t91+1.9690582947493582d-1*
     5         t52*t60*t91+2.625411059665811d-1*t53*t60*t90-1.4585616998
     6         143394d-1*t131*t22*t53-5.469606374303773d-2*t132*t133*t22
     7         )+1.269642451250142d+0*t12*t54*t97*t98+7.617854707500852d
     8         +0*t100*t11*t61*t97+1.763392293402975d-2*t133*t24*t91+4.2
     9         321415041671406d-1*t12*t59*t61*t90+7.053569173611901d-2*t
     :         24*t53*t89-7.617854707500852d+0*t11*t61**3/t23**4+1.05803
     ;         53760417849d-1*t52*t53*t59*t61-6.34821225625071d-1*t100*t
     <         12*t54*t59+2.3511897245373004d-1*t12*t131*t24
            t137 = 9.999999999999991d-1*(8.243319792565315d-3*t49*t95*t9
     1         6-1.865442d-1*t101*t27*t62*t95+9.327209999999999d-2*t20*t
     2         57*t85*t94+3.96311967940178d-3*t49*t50*t94-3.10907d-2*t20
     3         *t50*(7.617854707500852d+0*t11*t56*t87*t93-6.348212256250
     4         71d-1*t12*t51*t54*t93-1.269642451250142d+0*t11*t51*(-3.93
     5         81165894987163d-1*t53*t54*t92+7.876233178997433d-1*t12*(-
     6         1.3127055298329054d-1*t13*t89*t91-1.4585616998143394d-1*t
     7         13*t131*t53-5.469606374303773d-2*t13*t132*t133-7.42443910
     8         6586571d-3*t130)-1.3127055298329054d-1*t14*t89*t91+1.9690
     9         582947493582d-1*t52*t55*t91+2.625411059665811d-1*t53*t55*
     :         t90-1.4585616998143394d-1*t131*t14*t53-5.469606374303773d
     ;         -2*t132*t133*t14)+1.763392293402975d-2*t133*t16*t91+4.232
     <         1415041671406d-1*t12*t51*t56*t90+7.053569173611901d-2*t16
     =         *t53*t89+1.269642451250142d+0*t12*t54*t87*t88-7.617854707
     >         500852d+0*t11*t56**3/t15**4+1.0580353760417849d-1*t51*t52
     ?         *t53*t56+2.3511897245373004d-1*t12*t131*t16)-3.9631196794
     @         0178d-3*t49*t85*t86+1.0991093056753751d-2*t58*t62*t84-5.2
     1         84159572535706d-3*t50*t57*t84-8.243319792565315d-3*t101*t
     2         49*t58+6.21814d-2*t136*t27*t58-6.21814d-2*t20*t57**3/t17*
     3         *3+1.243628d-1*t134*t135*t27-8.548627933030694d-3*t129*t2
     4         6+4.1099018897499934d-3*t129*t18)-8.243319792565315d-3*t4
     5         9*t95*t96+1.865442d-1*t101*t27*t62*t95-1.0991093056753751
     6         d-2*t58*t62*t84+8.243319792565315d-3*t101*t49*t58-6.21814
     7         d-2*t136*t27*t58-1.243628d-1*t134*t135*t27+8.548627933030
     8         694d-3*t129*t26
            t138 = 1/t30**5
            t139 = 1.0d+0*(t34*(-1.243628d-1*rhoa*t41*t67*(-1.4251254664
     1         507676d+0*t11*t68*(7.016926042943223d-1*t12*(-1.169487673
     2         8238708d-1*t35*t89*t91-1.2994307486931897d-1*t131*t35*t53
     3         -4.87286530759946d-2*t132*t133*t35-9.292792605453422d-3*t
     4         130)-1.1694876738238708d-1*t36*t89*t91+1.7542315107358059
     5         d-1*t52*t69*t91+2.3389753476477415d-1*t53*t69*t90-3.50846
     6         30214716117d-1*t109*t53*t54-1.2994307486931897d-1*t131*t3
     7         6*t53-4.87286530759946d-2*t132*t133*t36)+1.97934092562606
     8         58d-2*t133*t38*t91+4.750418221502558d-1*t12*t68*t70*t90+7
     9         .917363702504264d-2*t38*t53*t89-8.550752798704606d+0*t11*
     :         t70**3/t37**4+1.1876045553756394d-1*t52*t53*t68*t70+8.550
     ;         752798704606d+0*t107*t11*t110*t70-7.125627332253837d-1*t1
     <         10*t12*t54*t68+1.4251254664507673d+0*t107*t108*t12*t54+2.
     =         639121234168088d-1*t12*t131*t38)-3.8771717067936173d-3*t4
     >         0*t84-2.487256d-1*rhoa*t41*t71**3/t39**3+8.72363634028564
     ?         d-3*t49*t67*t71+3.730884d-1*rhoa*t105*t111*t41*t71+1.3085
     @         45451042846d-2*t111*t66*t67-3.730884d-1*t111*t41*t67-1.30
     1         8545451042846d-2*t105*t106*t66+3.730884d-1*t105*t106*t41-
     2         2.0d+0*rhoa*t137-6.0d+0*t102)+2.0d+0*rhoa*t137*t9+6.0d+0*
     3         t102*t9+6.0d+0*rhoa*t63*t83+6.0d+0*t28*t83+2.0d+0*rhoa*t2
     4         8*(-9.125925925925926d+0*gammaaa*t128*t7*t8+1.82044444444
     5         44445d-1*t125*t7*t77*t78-1.8432000000000004d+0*t1*t125*t7
     6         7*t78+8.082962962962963d+0*t127*t2*t5*t7-2.16177777777777
     7         8d+0*t126*t43*t44*t7-9.90814814814815d+0*t1*t127*t2*t5+7.
     8         556740740740742d+0*t1*t126*t43*t44+1.456355555555556d-1*t
     9         1*t122*t123*t124)+t42*(1.47456d-7*t103*t125*t32*t77-1.492
     :         9920000000002d-6*t103*t125*t29*t77-5.8368d-5*t126*t32*t43
     ;         *t64+2.04032d-4*t126*t29*t43*t64-2.737777777777778d-1*gam
     <         maaa*t128*t32*t33+7.274666666666666d-3*t127*t2*t31*t32-8.
     =         917333333333333d-3*t127*t2*t29*t31+3.5389440000000005d-9*
     >         t122*t124*t138*t29)+3*t104*t72+3*t112*t65+1.2d+1*t48*t63+
     ?         6.0d+0*rhoa*t102*t48)*wght
            t140 = 1/rhoa**1.5333333333333335d+1
            t141 = 1.0d+0*(2.0d+0*rhoa*t28*(1.9555555555555554d+0*t7*t8*
     1         t82-2.311111111111111d+0*gammaaa*t5*t7*t81+2.702222222222
     2         2225d+0*gammaaa*t1*t5*t81+7.253333333333334d-1*t2*t44*t7*
     3         t80-2.3751111111111115d+0*t1*t2*t44*t80-6.826666666666669
     4         d-2*t43*t7*t78*t79+6.400000000000001d-1*t1*t43*t78*t79-5.
     5         461333333333335d-2*t1*t123*t140*t77)+t42*(5.8666666666666
     6         67d-2*t32*t33*t82-2.08d-3*gammaaa*t31*t32*t81+2.432000000
     7         0000003d-3*gammaaa*t29*t31*t81+1.9584000000000001d-5*t2*t
     8         32*t64*t80-6.412800000000001d-5*t2*t29*t64*t80-5.52960000
     9         0000001d-8*t103*t32*t43*t79+5.184000000000001d-7*t103*t29
     :         *t43*t79-1.327104d-9*t138*t140*t29*t77)+t112*t75+4.0d+0*t
     ;         63*t74+2.0d+0*rhoa*t102*t74+2*t116*t72+4.0d+0*rhoa*t115*t
     <         63+4.0d+0*t115*t28)*wght
            t142 = 1/rhoa**1.4333333333333334d+1
            t143 = 1.0d+0*(2.0d+0*rhoa*t28*(2.5600000000000006d-2*t114*t
     1         2*t7*t78-2.0480000000000004d-1*t1*t114*t2*t78+4.266666666
     2         666667d-1*t46*t5*t7-2.1333333333333335d-1*gammaaa*t44*t45
     3         *t7-4.2666666666666675d-1*t1*t46*t5+5.973333333333335d-1*
     4         gammaaa*t1*t44*t45+2.048000000000001d-2*t1*t123*t142*t43)
     5         +t120*t72+t42*(-5.760000000000001d-6*gammaaa*t32*t45*t64+
     6         1.6128000000000003d-5*gammaaa*t29*t45*t64+3.84d-4*t31*t32
     7         *t46-3.84d-4*t29*t31*t46+4.9766400000000016d-10*t138*t142
     8         *t29*t43+2.0736000000000004d-8*t103*t114*t2*t32-1.6588800
     9         000000004d-7*t103*t114*t2*t29)+2.0d+0*rhoa*t119*t63+2.0d+
     :         0*t119*t28)*wght
            t144 = 1/rhoa**1.3333333333333333d+1
            t145 = 1.0d+0*(2.0d+0*rhoa*t28*(-9.600000000000004d-3*gammaa
     1         a*t118*t7*t78+5.760000000000003d-2*gammaaa*t1*t118*t78+4.
     2         8000000000000015d-2*t44*t7*t73-9.600000000000003d-2*t1*t4
     3         4*t73-7.680000000000003d-3*t1*t123*t144*t2)+t42*(1.296d-6
     4         *t32*t64*t73-2.592d-6*t29*t64*t73-7.776000000000002d-9*ga
     5         mmaaa*t103*t118*t32-1.8662400000000004d-10*t138*t144*t2*t
     6         29+4.6656000000000003d-8*gammaaa*t103*t118*t29))*wght
            fnc(iq) = 1.0d+0*(2.0d+0*rhoa*t28*t9+t34*t42)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(2.0d+0*rhoa*t63*t9+2.0d+0*t28*t9+t3
     1         4*t72+t42*t65+2.0d+0*rhoa*t28*t48)*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = t76+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = t76+Cmat(iq,D1_GAB)
            Amat2(iq,D2_RA_RA) = t113+Amat2(iq,D2_RA_RA)
            Amat2(iq,D2_RA_RB) = t113+Amat2(iq,D2_RA_RB)
            Cmat2(iq,D2_RA_GAA) = t117+Cmat2(iq,D2_RA_GAA)
            Cmat2(iq,D2_RA_GAB) = t117+Cmat2(iq,D2_RA_GAB)
            Cmat2(iq,D2_RA_GBB) = t117+Cmat2(iq,D2_RA_GBB)
            Cmat2(iq,D2_GAA_GAA) = t121+Cmat2(iq,D2_GAA_GAA)
            Cmat2(iq,D2_GAA_GAB) = t121+Cmat2(iq,D2_GAA_GAB)
            Cmat2(iq,D2_GAA_GBB) = t121+Cmat2(iq,D2_GAA_GBB)
            Cmat2(iq,D2_GAB_GAB) = t121+Cmat2(iq,D2_GAB_GAB)
            Amat3(iq,D3_RA_RA_RA) = t139+Amat3(iq,D3_RA_RA_RA)
            Amat3(iq,D3_RA_RA_RB) = t139+Amat3(iq,D3_RA_RA_RB)
            Cmat3(iq,D3_RA_RA_GAA) = t141+Cmat3(iq,D3_RA_RA_GAA)
            Cmat3(iq,D3_RA_RA_GAB) = t141+Cmat3(iq,D3_RA_RA_GAB)
            Cmat3(iq,D3_RA_RA_GBB) = t141+Cmat3(iq,D3_RA_RA_GBB)
            Cmat3(iq,D3_RA_RB_GAA) = t141+Cmat3(iq,D3_RA_RB_GAA)
            Cmat3(iq,D3_RA_RB_GAB) = t141+Cmat3(iq,D3_RA_RB_GAB)
            Cmat3(iq,D3_RA_GAA_GAA) = t143+Cmat3(iq,D3_RA_GAA_GAA)
            Cmat3(iq,D3_RA_GAA_GAB) = t143+Cmat3(iq,D3_RA_GAA_GAB)
            Cmat3(iq,D3_RA_GAA_GBB) = t143+Cmat3(iq,D3_RA_GAA_GBB)
            Cmat3(iq,D3_RA_GAB_GAB) = t143+Cmat3(iq,D3_RA_GAB_GAB)
            Cmat3(iq,D3_RA_GAB_GBB) = t143+Cmat3(iq,D3_RA_GAB_GBB)
            Cmat3(iq,D3_RA_GBB_GBB) = t143+Cmat3(iq,D3_RA_GBB_GBB)
            Cmat3(iq,D3_GAA_GAA_GAA) = t145+Cmat3(iq,D3_GAA_GAA_GAA)
            Cmat3(iq,D3_GAA_GAA_GAB) = t145+Cmat3(iq,D3_GAA_GAA_GAB)
            Cmat3(iq,D3_GAA_GAA_GBB) = t145+Cmat3(iq,D3_GAA_GAA_GBB)
            Cmat3(iq,D3_GAA_GAB_GAB) = t145+Cmat3(iq,D3_GAA_GAB_GAB)
            Cmat3(iq,D3_GAA_GAB_GBB) = t145+Cmat3(iq,D3_GAA_GAB_GBB)
            Cmat3(iq,D3_GAB_GAB_GAB) = t145+Cmat3(iq,D3_GAB_GAB_GAB)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          gammaaa = rgamma(iq,G_AA) 
          gammaab = rgamma(iq,G_AB) 
          gammabb = rgamma(iq,G_BB) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(2)
            t2 = param(6)
            t3 = gammaaa**2
            t4 = 1/rhoa**2.6666666666666666d+0
            t5 = 2.0d-1*gammaaa*t4+1.0d+0
            t6 = 1/t5**2
            t7 = 1/rhoa**5.333333333333333d+0
            t8 = param(4)
            t9 = 1/t5
            t10 = 2.0d-1*gammaaa*t4*t8*t9+4.000000000000001d-2*t2*t3*t6*
     1         t7+t1
            t11 = rhoa**3.333333333333333d-1
            t12 = t11**5.0d-1
            t13 = 1/t12
            t14 = 1.530901310039024d-2*t13+1.0465751434d-1
            t15 = 7.876233178997433d-1*t13*t14+1.9269083139d-1
            t16 = 7.876233178997433d-1*t13*t15+4.3896648423d-1
            t17 = 1/t16
            t18 = 1.269642451250142d+0*t12*t17+1.0d+0
            t19 = log(t18)
            t20 = 1/t11
            t21 = 1.2746961887000874d-1*t20+1.0d+0
            t22 = 2.4141993114533214d-2*t13+1.0186556948d-1
            t23 = 7.876233178997433d-1*t13*t22+2.2308199064d-1
            t24 = 7.876233178997433d-1*t13*t23+4.7231125998d-1
            t25 = 1/t24
            t26 = 1.269642451250142d+0*t12*t25+1.0d+0
            t27 = log(t26)
            t28 = 1.325688999052018d-1*t20+1.0d+0
            t29 = 9.999999999999991d-1*(6.21814d-2*t27*t28-3.10907d-2*t1
     1         9*t21)-6.21814d-2*t27*t28
            t30 = gammabb**2
            t31 = 1/rhob**2.6666666666666666d+0
            t32 = 2.0d-1*gammabb*t31+1.0d+0
            t33 = 1/t32**2
            t34 = 1/rhob**5.333333333333333d+0
            t35 = 1/t32
            t36 = 2.0d-1*gammabb*t31*t35*t8+4.000000000000001d-2*t2*t30*
     1         t33*t34+t1
            t37 = rhob**3.333333333333333d-1
            t38 = t37**5.0d-1
            t39 = 1/t38
            t40 = 1.530901310039024d-2*t39+1.0465751434d-1
            t41 = 7.876233178997433d-1*t39*t40+1.9269083139d-1
            t42 = 7.876233178997433d-1*t39*t41+4.3896648423d-1
            t43 = 1/t42
            t44 = 1.269642451250142d+0*t38*t43+1.0d+0
            t45 = log(t44)
            t46 = 1/t37
            t47 = 1.2746961887000874d-1*t46+1.0d+0
            t48 = 2.4141993114533214d-2*t39+1.0186556948d-1
            t49 = 7.876233178997433d-1*t39*t48+2.2308199064d-1
            t50 = 7.876233178997433d-1*t39*t49+4.7231125998d-1
            t51 = 1/t50
            t52 = 1.269642451250142d+0*t38*t51+1.0d+0
            t53 = log(t52)
            t54 = 1.325688999052018d-1*t46+1.0d+0
            t55 = 9.999999999999991d-1*(6.21814d-2*t53*t54-3.10907d-2*t4
     1         5*t47)-6.21814d-2*t53*t54
            t56 = param(7)
            t57 = gammaaa*t4+gammabb*t31
            t58 = t57**2
            t59 = 3.0d-3*t57+1.0d+0
            t60 = 1/t59**2
            t61 = param(5)
            t62 = 1/t59
            t63 = 3.0d-3*t57*t61*t62+9.0d-6*t56*t58*t60+param(3)
            t64 = rhob+rhoa
            t65 = t64**3.333333333333333d-1
            t66 = 1/t65
            t67 = 1.325688999052018d-1*t66+1.0d+0
            t68 = t65**5.0d-1
            t69 = 1/t68
            t70 = 2.4141993114533214d-2*t69+1.0186556948d-1
            t71 = 7.876233178997433d-1*t69*t70+2.2308199064d-1
            t72 = 7.876233178997433d-1*t69*t71+4.7231125998d-1
            t73 = 1/t72
            t74 = 1.269642451250142d+0*t68*t73+1.0d+0
            t75 = log(t74)
            t76 = rhoa-rhob
            t77 = 1/t64
            t78 = 1.0d+0-t76*t77
            t79 = t76*t77+1.0d+0
            t80 = 1.923661050931536d+0*t79**1.3333333333333333d+0+1.9236
     1         61050931536d+0*t78**1.3333333333333333d+0-3.8473221018630
     2         72d+0
            t81 = 6.901399211255826d-2*t66+1.0d+0
            t82 = 1.3212998810398843d-2*t69+2.9729725188d-2
            t83 = 7.876233178997433d-1*t69*t82+1.2236585478d-1
            t84 = 7.876233178997433d-1*t69*t83+3.497952466d-1
            t85 = 1/t84
            t86 = 1.269642451250142d+0*t68*t85+1.0d+0
            t87 = log(t86)
            t88 = t76**4
            t89 = 1/t64**4
            t90 = 1.2746961887000874d-1*t66+1.0d+0
            t91 = 1.530901310039024d-2*t69+1.0465751434d-1
            t92 = 7.876233178997433d-1*t69*t91+1.9269083139d-1
            t93 = 7.876233178997433d-1*t69*t92+4.3896648423d-1
            t94 = 1/t93
            t95 = 1.269642451250142d+0*t68*t94+1.0d+0
            t96 = log(t95)
            t97 = 1.709920934161365d+0*(6.21814d-2*t67*t75-3.10907d-2*t9
     1         0*t96)-3.37738d-2*t81*t87
            t98 = t88*t89*t97+3.37738d-2*t81*t87
            t99 = 5.848223622634648d-1*t80*t98-6.21814d-2*t67*t75
            t100 = 1.0d+0*t64*t99-1.0d+0*rhob*t55-1.0d+0*rhoa*t29
            t101 = gammaaa**3
            t102 = 1/t5**3
            t103 = 1/rhoa**9
            t104 = 1/rhoa**6.333333333333333d+0
            t105 = 1/rhoa**3.6666666666666664d+0
            t106 = -5.333333333333333d-1*gammaaa*t105*t8*t9+1.0666666666
     1         666667d-1*t104*t3*t6*t8-2.1333333333333337d-1*t104*t2*t3*
     2         t6+4.2666666666666675d-2*t101*t102*t103*t2
            t107 = 1/rhoa**1.3333333333333333d+0
            t108 = 1/t18
            t109 = 1/t16**2
            t110 = 1/rhoa**1.3333333333333336d+0
            t111 = 1/t12**3
            t112 = 1/rhoa**6.666666666666667d-1
            t113 = -1.3127055298329054d-1*t111*t112*t14-2.00962261531666
     1         58d-3*t110
            t114 = 7.876233178997433d-1*t113*t13-1.3127055298329054d-1*t
     1         111*t112*t15
            t115 = 2.11607075208357d-1*t112*t13*t17-1.269642451250142d+0
     1         *t109*t114*t12
            t116 = 1/t26
            t117 = 1/t24**2
            t118 = -1.3127055298329054d-1*t111*t112*t22-3.16913278626356
     1         7d-3*t110
            t119 = 7.876233178997433d-1*t118*t13-1.3127055298329054d-1*t
     1         111*t112*t23
            t120 = 2.11607075208357d-1*t112*t13*t25-1.269642451250142d+0
     1         *t117*t119*t12
            t121 = 9.999999999999991d-1*(6.21814d-2*t116*t120*t28-2.7477
     1         73264188438d-3*t107*t27-3.10907d-2*t108*t115*t21+1.321039
     2         8931339265d-3*t107*t19)-6.21814d-2*t116*t120*t28+2.747773
     3         264188438d-3*t107*t27
            t122 = 1/t64**1.3333333333333336d+0
            t123 = 1/t64**6.666666666666667d-1
            t124 = 1/t68**3
            t125 = -1.3127055298329054d-1*t123*t124*t70-3.16913278626356
     1         7d-3*t122
            t126 = 7.876233178997433d-1*t125*t69-1.3127055298329054d-1*t
     1         123*t124*t71
            t127 = 1/t72**2
            t128 = 2.11607075208357d-1*t123*t69*t73-1.269642451250142d+0
     1         *t126*t127*t68
            t129 = 1/t74
            t130 = -6.21814d-2*t128*t129*t67
            t131 = 1/t64**1.3333333333333333d+0
            t132 = 2.747773264188438d-3*t131*t75
            t133 = -1.3127055298329054d-1*t123*t124*t82-1.73447766040861
     1         62d-3*t122
            t134 = 7.876233178997433d-1*t133*t69-1.3127055298329054d-1*t
     1         123*t124*t83
            t135 = 1/t84**2
            t136 = 2.11607075208357d-1*t123*t69*t85-1.269642451250142d+0
     1         *t134*t135*t68
            t137 = 1/t86
            t138 = 3.37738d-2*t136*t137*t81
            t139 = -7.769549222703733d-4*t131*t87
            t140 = -1.3127055298329054d-1*t123*t124*t91-2.00962261531666
     1         58d-3*t122
            t141 = 7.876233178997433d-1*t140*t69-1.3127055298329054d-1*t
     1         123*t124*t92
            t142 = 1/t93**2
            t143 = 2.11607075208357d-1*t123*t69*t94-1.269642451250142d+0
     1         *t141*t142*t68
            t144 = 1/t95
            t145 = 1.709920934161365d+0*(1.3210398931339265d-3*t131*t96-
     1         3.10907d-2*t143*t144*t90-2.747773264188438d-3*t131*t75+6.
     2         21814d-2*t128*t129*t67)+7.769549222703733d-4*t131*t87-3.3
     3         7738d-2*t136*t137*t81
            t146 = t145*t88*t89
            t147 = 1/t64**5
            t148 = -4*t147*t88*t97
            t149 = t76**3
            t150 = 4*t149*t89*t97+t148+t146+t139+t138
            t151 = 1/t64**2
            t152 = t151*t76
            t153 = -t77
            t154 = t153+t152
            t155 = t78**3.333333333333333d-1
            t156 = -t151*t76
            t157 = t77+t156
            t158 = t79**3.333333333333333d-1
            t159 = 2.564881401242048d+0*t157*t158+2.564881401242048d+0*t
     1         154*t155
            t160 = 5.848223622634648d-1*t159*t98+5.848223622634648d-1*t1
     1         50*t80+t132+t130
            t161 = 1.0d+0*t99
            t162 = 1.0d+0*t160*t64-1.0d+0*t29+t161-1.0d+0*rhoa*t121
            t163 = 1/t59**3
            t164 = -8.0d-3*gammaaa*t105*t61*t62+2.4000000000000002d-5*ga
     1         mmaaa*t105*t57*t60*t61-4.8000000000000004d-5*gammaaa*t105
     2         *t56*t57*t60+1.4400000000000002d-7*gammaaa*t105*t163*t56*
     3         t58
            t165 = gammabb**3
            t166 = 1/t32**3
            t167 = 1/rhob**9
            t168 = 1/rhob**6.333333333333333d+0
            t169 = 1/rhob**3.6666666666666664d+0
            t170 = -5.333333333333333d-1*gammabb*t169*t35*t8+1.066666666
     1         6666667d-1*t168*t30*t33*t8-2.1333333333333337d-1*t168*t2*
     2         t30*t33+4.2666666666666675d-2*t165*t166*t167*t2
            t171 = 1/rhob**1.3333333333333333d+0
            t172 = 1/t44
            t173 = 1/t42**2
            t174 = 1/rhob**1.3333333333333336d+0
            t175 = 1/t38**3
            t176 = 1/rhob**6.666666666666667d-1
            t177 = -1.3127055298329054d-1*t175*t176*t40-2.00962261531666
     1         58d-3*t174
            t178 = 7.876233178997433d-1*t177*t39-1.3127055298329054d-1*t
     1         175*t176*t41
            t179 = 2.11607075208357d-1*t176*t39*t43-1.269642451250142d+0
     1         *t173*t178*t38
            t180 = 1/t52
            t181 = 1/t50**2
            t182 = -1.3127055298329054d-1*t175*t176*t48-3.16913278626356
     1         7d-3*t174
            t183 = 7.876233178997433d-1*t182*t39-1.3127055298329054d-1*t
     1         175*t176*t49
            t184 = 2.11607075208357d-1*t176*t39*t51-1.269642451250142d+0
     1         *t181*t183*t38
            t185 = 9.999999999999991d-1*(6.21814d-2*t180*t184*t54-2.7477
     1         73264188438d-3*t171*t53-3.10907d-2*t172*t179*t47+1.321039
     2         8931339265d-3*t171*t45)-6.21814d-2*t180*t184*t54+2.747773
     3         264188438d-3*t171*t53
            t186 = -4*t149*t89*t97+t148+t146+t139+t138
            t187 = t77+t152
            t188 = t156+t153
            t189 = 2.564881401242048d+0*t158*t188+2.564881401242048d+0*t
     1         155*t187
            t190 = 5.848223622634648d-1*t189*t98+5.848223622634648d-1*t1
     1         86*t80+t132+t130
            t191 = 1.0d+0*t190*t64-1.0d+0*t55-1.0d+0*rhob*t185+t161
            t192 = -8.0d-3*gammabb*t169*t61*t62+2.4000000000000002d-5*ga
     1         mmabb*t169*t57*t60*t61-4.8000000000000004d-5*gammabb*t169
     2         *t56*t57*t60+1.4400000000000002d-7*gammabb*t163*t169*t56*
     3         t58
            t193 = 1/rhoa**8
            t194 = 2.0d-1*t4*t8*t9-4.000000000000001d-2*gammaaa*t6*t7*t8
     1         +8.000000000000002d-2*gammaaa*t2*t6*t7-1.6000000000000003
     2         d-2*t102*t193*t2*t3
            t195 = 3.0d-3*t4*t61*t62-9.0d-6*t4*t57*t60*t61+1.8d-5*t4*t56
     1         *t57*t60-5.4d-8*t163*t4*t56*t58
            t196 = 1/rhob**8
            t197 = 2.0d-1*t31*t35*t8-4.000000000000001d-2*gammabb*t33*t3
     1         4*t8+8.000000000000002d-2*gammabb*t2*t33*t34-1.6000000000
     2         000003d-2*t166*t196*t2*t30
            t198 = 3.0d-3*t31*t61*t62-9.0d-6*t31*t57*t60*t61+1.8d-5*t31*
     1         t56*t57*t60-5.4d-8*t163*t31*t56*t58
            t199 = gammaaa**4
            t200 = 1/t5**4
            t201 = 1/rhoa**1.2666666666666665d+1
            t202 = 1/rhoa**10
            t203 = 1/rhoa**7.333333333333333d+0
            t204 = 1/rhoa**4.666666666666667d+0
            t205 = 1.9555555555555554d+0*gammaaa*t204*t8*t9-9.6d-1*t203*
     1         t3*t6*t8+1.1377777777777778d-1*t101*t102*t202*t8+1.351111
     2         1111111113d+0*t2*t203*t3*t6-6.115555555555556d-1*t101*t10
     3         2*t2*t202+6.826666666666669d-2*t199*t2*t200*t201
            t206 = 1/rhoa**2.333333333333333d+0
            t207 = 1/t18**2
            t208 = t115**2
            t209 = 1/t16**3
            t210 = t114**2
            t211 = 1/rhoa**2.3333333333333334d+0
            t212 = 1/rhoa**1.6666666666666669d+0
            t213 = 1/t12**5
            t214 = 6.563527649164527d-2*t110*t14*t213+8.751370198886037d
     1         -2*t111*t14*t212+3.0144339229749983d-3*t211
            t215 = 7.876233178997433d-1*t13*t214+6.563527649164527d-2*t1
     1         10*t15*t213+8.751370198886037d-2*t111*t15*t212-2.62541105
     2         9665811d-1*t111*t112*t113
            t216 = -1.269642451250142d+0*t109*t12*t215-1.410713834722380
     1         2d-1*t13*t17*t212+2.539284902500284d+0*t12*t209*t210-3.52
     2         678458680595d-2*t110*t111*t17-4.23214150416714d-1*t109*t1
     3         12*t114*t13
            t217 = 1/t26**2
            t218 = t120**2
            t219 = 1/t24**3
            t220 = t119**2
            t221 = 6.563527649164527d-2*t110*t213*t22+8.751370198886037d
     1         -2*t111*t212*t22+4.753699179395351d-3*t211
            t222 = 6.563527649164527d-2*t110*t213*t23+8.751370198886037d
     1         -2*t111*t212*t23+7.876233178997433d-1*t13*t221-2.62541105
     2         9665811d-1*t111*t112*t118
            t223 = -1.4107138347223802d-1*t13*t212*t25-3.52678458680595d
     1         -2*t110*t111*t25-1.269642451250142d+0*t117*t12*t222+2.539
     2         284902500284d+0*t12*t219*t220-4.23214150416714d-1*t112*t1
     3         17*t119*t13
            t224 = 9.999999999999991d-1*(6.21814d-2*t116*t223*t28-6.2181
     1         4d-2*t217*t218*t28+3.663697685584584d-3*t206*t27-3.10907d
     2         -2*t108*t21*t216+3.10907d-2*t207*t208*t21-1.7613865241785
     3         687d-3*t19*t206-5.495546528376876d-3*t107*t116*t120+2.642
     4         079786267853d-3*t107*t108*t115)-6.21814d-2*t116*t223*t28+
     5         6.21814d-2*t217*t218*t28-3.663697685584584d-3*t206*t27+5.
     6         495546528376876d-3*t107*t116*t120
            t225 = t128**2
            t226 = 1/t74**2
            t227 = 6.21814d-2*t225*t226*t67
            t228 = t126**2
            t229 = 1/t72**3
            t230 = 1/t64**2.3333333333333334d+0
            t231 = 1/t68**5
            t232 = 1/t64**1.6666666666666669d+0
            t233 = 8.751370198886037d-2*t124*t232*t70+6.563527649164527d
     1         -2*t122*t231*t70+4.753699179395351d-3*t230
            t234 = 8.751370198886037d-2*t124*t232*t71+6.563527649164527d
     1         -2*t122*t231*t71+7.876233178997433d-1*t233*t69-2.62541105
     2         9665811d-1*t123*t124*t125
            t235 = -1.4107138347223802d-1*t232*t69*t73-3.52678458680595d
     1         -2*t122*t124*t73-4.23214150416714d-1*t123*t126*t127*t69-1
     2         .269642451250142d+0*t127*t234*t68+2.539284902500284d+0*t2
     3         28*t229*t68
            t236 = -6.21814d-2*t129*t235*t67
            t237 = 5.495546528376876d-3*t128*t129*t131
            t238 = 1/t64**2.333333333333333d+0
            t239 = -3.663697685584584d-3*t238*t75
            t240 = t136**2
            t241 = 1/t86**2
            t242 = -3.37738d-2*t240*t241*t81
            t243 = t134**2
            t244 = 1/t84**3
            t245 = 8.751370198886037d-2*t124*t232*t82+6.563527649164527d
     1         -2*t122*t231*t82+2.601716490612924d-3*t230
            t246 = 8.751370198886037d-2*t124*t232*t83+6.563527649164527d
     1         -2*t122*t231*t83+7.876233178997433d-1*t245*t69-2.62541105
     2         9665811d-1*t123*t124*t133
            t247 = -1.4107138347223802d-1*t232*t69*t85-3.52678458680595d
     1         -2*t122*t124*t85-4.23214150416714d-1*t123*t134*t135*t69-1
     2         .269642451250142d+0*t135*t246*t68+2.539284902500284d+0*t2
     3         43*t244*t68
            t248 = 3.37738d-2*t137*t247*t81
            t249 = -1.5539098445407465d-3*t131*t136*t137
            t250 = 1.0359398963604977d-3*t238*t87
            t251 = t143**2
            t252 = 1/t95**2
            t253 = t141**2
            t254 = 1/t93**3
            t255 = 8.751370198886037d-2*t124*t232*t91+6.563527649164527d
     1         -2*t122*t231*t91+3.0144339229749983d-3*t230
            t256 = 8.751370198886037d-2*t124*t232*t92+6.563527649164527d
     1         -2*t122*t231*t92+7.876233178997433d-1*t255*t69-2.62541105
     2         9665811d-1*t123*t124*t140
            t257 = -1.4107138347223802d-1*t232*t69*t94-3.52678458680595d
     1         -2*t122*t124*t94-4.23214150416714d-1*t123*t141*t142*t69-1
     2         .269642451250142d+0*t142*t256*t68+2.539284902500284d+0*t2
     3         53*t254*t68
            t258 = 1.709920934161365d+0*(-1.7613865241785687d-3*t238*t96
     1         -3.10907d-2*t144*t257*t90+3.10907d-2*t251*t252*t90+3.6636
     2         97685584584d-3*t238*t75+6.21814d-2*t129*t235*t67-6.21814d
     3         -2*t225*t226*t67+2.642079786267853d-3*t131*t143*t144-5.49
     4         5546528376876d-3*t128*t129*t131)-1.0359398963604977d-3*t2
     5         38*t87-3.37738d-2*t137*t247*t81+3.37738d-2*t240*t241*t81+
     6         1.5539098445407465d-3*t131*t136*t137
            t259 = t258*t88*t89
            t260 = -8*t145*t147*t88
            t261 = 1/t64**6
            t262 = 20*t261*t88*t97
            t263 = t76**2
            t264 = 12*t263*t89*t97
            t265 = -32*t147*t149*t97+8*t145*t149*t89+t264+t262+t260+t259
     1         +t250+t249+t248+t242
            t266 = t154**2
            t267 = 1/t78**6.666666666666666d-1
            t268 = 1/t64**3
            t269 = -2*t268*t76
            t270 = 2*t151
            t271 = t270+t269
            t272 = t157**2
            t273 = 1/t79**6.666666666666666d-1
            t274 = 2*t268*t76
            t275 = -2*t151
            t276 = t275+t274
            t277 = 2.564881401242048d+0*t158*t276+8.549604670806825d-1*t
     1         272*t273+2.564881401242048d+0*t155*t271+8.549604670806825
     2         d-1*t266*t267
            t278 = 5.848223622634648d-1*t277*t98+5.848223622634648d-1*t2
     1         65*t80+t239+t237+t236+t227+1.1696447245269297d+0*t150*t15
     2         9
            t279 = 1.0d+0*t278*t64-1.0d+0*rhoa*t224+2.0d+0*t160-2.0d+0*t
     1         121
            t280 = 1/t59**4
            t281 = 2.9333333333333333d-2*gammaaa*t204*t61*t62-8.8d-5*gam
     1         maaa*t204*t57*t60*t61-1.28d-4*t203*t3*t60*t61+3.84d-7*t16
     2         3*t203*t3*t57*t61+1.76d-4*gammaaa*t204*t56*t57*t60+1.28d-
     3         4*t203*t3*t56*t60+3.456000000000001d-9*t203*t280*t3*t56*t
     4         58-5.28d-7*gammaaa*t163*t204*t56*t58-1.5360000000000001d-
     5         6*t163*t203*t3*t56*t57
            t282 = -12*t263*t89*t97+t262+t260+t259+t250+t249+t248+t242
            t283 = 5.129762802484096d+0*t158*t268*t76-5.129762802484096d
     1         +0*t155*t268*t76+8.549604670806825d-1*t157*t188*t273+8.54
     2         9604670806825d-1*t154*t187*t267
            t284 = 5.848223622634648d-1*t283*t98+5.848223622634648d-1*t2
     1         82*t80+t239+t237+t236+t227+5.848223622634648d-1*t150*t189
     2         +5.848223622634648d-1*t159*t186
            t285 = 1.0d+0*t284*t64+1.0d+0*t190+1.0d+0*t160
            t286 = -1.28d-4*gammaaa*gammabb*t105*t169*t60*t61+3.84d-7*ga
     1         mmaaa*gammabb*t105*t163*t169*t57*t61+1.28d-4*gammaaa*gamm
     2         abb*t105*t169*t56*t60+3.456000000000001d-9*gammaaa*gammab
     3         b*t105*t169*t280*t56*t58-1.5360000000000001d-6*gammaaa*ga
     4         mmabb*t105*t163*t169*t56*t57
            t287 = gammabb**4
            t288 = 1/t32**4
            t289 = 1/rhob**1.2666666666666665d+1
            t290 = 1/rhob**10
            t291 = 1/rhob**7.333333333333333d+0
            t292 = 1/rhob**4.666666666666667d+0
            t293 = 1.9555555555555554d+0*gammabb*t292*t35*t8-9.6d-1*t291
     1         *t30*t33*t8+1.1377777777777778d-1*t165*t166*t290*t8+1.351
     2         1111111111113d+0*t2*t291*t30*t33-6.115555555555556d-1*t16
     3         5*t166*t2*t290+6.826666666666669d-2*t2*t287*t288*t289
            t294 = 1/rhob**2.333333333333333d+0
            t295 = 1/t44**2
            t296 = t179**2
            t297 = 1/t42**3
            t298 = t178**2
            t299 = 1/rhob**2.3333333333333334d+0
            t300 = 1/rhob**1.6666666666666669d+0
            t301 = 1/t38**5
            t302 = 6.563527649164527d-2*t174*t301*t40+8.751370198886037d
     1         -2*t175*t300*t40+3.0144339229749983d-3*t299
            t303 = 6.563527649164527d-2*t174*t301*t41+8.751370198886037d
     1         -2*t175*t300*t41+7.876233178997433d-1*t302*t39-2.62541105
     2         9665811d-1*t175*t176*t177
            t304 = -1.4107138347223802d-1*t300*t39*t43-3.52678458680595d
     1         -2*t174*t175*t43-4.23214150416714d-1*t173*t176*t178*t39-1
     2         .269642451250142d+0*t173*t303*t38+2.539284902500284d+0*t2
     3         97*t298*t38
            t305 = 1/t52**2
            t306 = t184**2
            t307 = 1/t50**3
            t308 = t183**2
            t309 = 6.563527649164527d-2*t174*t301*t48+8.751370198886037d
     1         -2*t175*t300*t48+4.753699179395351d-3*t299
            t310 = 6.563527649164527d-2*t174*t301*t49+8.751370198886037d
     1         -2*t175*t300*t49+7.876233178997433d-1*t309*t39-2.62541105
     2         9665811d-1*t175*t176*t182
            t311 = -1.4107138347223802d-1*t300*t39*t51-3.52678458680595d
     1         -2*t174*t175*t51-4.23214150416714d-1*t176*t181*t183*t39-1
     2         .269642451250142d+0*t181*t310*t38+2.539284902500284d+0*t3
     3         07*t308*t38
            t312 = 9.999999999999991d-1*(6.21814d-2*t180*t311*t54-6.2181
     1         4d-2*t305*t306*t54+3.663697685584584d-3*t294*t53-3.10907d
     2         -2*t172*t304*t47+3.10907d-2*t295*t296*t47-1.7613865241785
     3         687d-3*t294*t45-5.495546528376876d-3*t171*t180*t184+2.642
     4         079786267853d-3*t171*t172*t179)-6.21814d-2*t180*t311*t54+
     5         6.21814d-2*t305*t306*t54-3.663697685584584d-3*t294*t53+5.
     6         495546528376876d-3*t171*t180*t184
            t313 = 32*t147*t149*t97-8*t145*t149*t89+t264+t262+t260+t259+
     1         t250+t249+t248+t242
            t314 = t187**2
            t315 = t275+t269
            t316 = t188**2
            t317 = t274+t270
            t318 = 2.564881401242048d+0*t158*t317+8.549604670806825d-1*t
     1         273*t316+2.564881401242048d+0*t155*t315+8.549604670806825
     2         d-1*t267*t314
            t319 = 5.848223622634648d-1*t318*t98+5.848223622634648d-1*t3
     1         13*t80+t239+t237+t236+t227+1.1696447245269297d+0*t186*t18
     2         9
            t320 = 1.0d+0*t319*t64-1.0d+0*rhob*t312+2.0d+0*t190-2.0d+0*t
     1         185
            t321 = 2.9333333333333333d-2*gammabb*t292*t61*t62-8.8d-5*gam
     1         mabb*t292*t57*t60*t61-1.28d-4*t291*t30*t60*t61+3.84d-7*t1
     2         63*t291*t30*t57*t61+1.76d-4*gammabb*t292*t56*t57*t60+1.28
     3         d-4*t291*t30*t56*t60+3.456000000000001d-9*t280*t291*t30*t
     4         56*t58-5.28d-7*gammabb*t163*t292*t56*t58-1.53600000000000
     5         01d-6*t163*t291*t30*t56*t57
            t322 = 1/rhoa**1.1666666666666665d+1
            t323 = -5.333333333333333d-1*t105*t8*t9+3.2d-1*gammaaa*t104*
     1         t6*t8-4.2666666666666675d-2*t102*t103*t3*t8-4.26666666666
     2         66675d-1*gammaaa*t104*t2*t6-2.5600000000000006d-2*t101*t2
     3         *t200*t322+2.1333333333333337d-1*t102*t103*t2*t3
            t324 = -8.0d-3*t105*t61*t62+2.4000000000000002d-5*t105*t57*t
     1         60*t61+4.8000000000000004d-5*gammaaa*t104*t60*t61-1.44000
     2         00000000002d-7*gammaaa*t104*t163*t57*t61-4.80000000000000
     3         04d-5*t105*t56*t57*t60-4.8000000000000004d-5*gammaaa*t104
     4         *t56*t60-1.2960000000000002d-9*gammaaa*t104*t280*t56*t58+
     5         1.4400000000000002d-7*t105*t163*t56*t58+5.760000000000001
     6         d-7*gammaaa*t104*t163*t56*t57
            t325 = 4.8000000000000004d-5*gammaaa*t105*t31*t60*t61-1.4400
     1         000000000002d-7*gammaaa*t105*t163*t31*t57*t61-4.800000000
     2         0000004d-5*gammaaa*t105*t31*t56*t60-1.2960000000000002d-9
     3         *gammaaa*t105*t280*t31*t56*t58+5.760000000000001d-7*gamma
     4         aa*t105*t163*t31*t56*t57
            t326 = 4.8000000000000004d-5*gammabb*t169*t4*t60*t61-1.44000
     1         00000000002d-7*gammabb*t163*t169*t4*t57*t61-4.80000000000
     2         00004d-5*gammabb*t169*t4*t56*t60-1.2960000000000002d-9*ga
     3         mmabb*t169*t280*t4*t56*t58+5.760000000000001d-7*gammabb*t
     4         163*t169*t4*t56*t57
            t327 = 1/rhob**1.1666666666666665d+1
            t328 = -5.333333333333333d-1*t169*t35*t8+3.2d-1*gammabb*t168
     1         *t33*t8-4.2666666666666675d-2*t166*t167*t30*t8-4.26666666
     2         66666675d-1*gammabb*t168*t2*t33-2.5600000000000006d-2*t16
     3         5*t2*t288*t327+2.1333333333333337d-1*t166*t167*t2*t30
            t329 = -8.0d-3*t169*t61*t62+2.4000000000000002d-5*t169*t57*t
     1         60*t61+4.8000000000000004d-5*gammabb*t168*t60*t61-1.44000
     2         00000000002d-7*gammabb*t163*t168*t57*t61-4.80000000000000
     3         04d-5*t169*t56*t57*t60-4.8000000000000004d-5*gammabb*t168
     4         *t56*t60-1.2960000000000002d-9*gammabb*t168*t280*t56*t58+
     5         1.4400000000000002d-7*t163*t169*t56*t58+5.760000000000001
     6         d-7*gammabb*t163*t168*t56*t57
            t330 = 1/rhoa**1.0666666666666666d+1
            t331 = -8.000000000000002d-2*t6*t7*t8+1.6000000000000003d-2*
     1         gammaaa*t102*t193*t8+8.000000000000002d-2*t2*t6*t7+9.6000
     2         00000000004d-3*t2*t200*t3*t330-6.400000000000001d-2*gamma
     3         aa*t102*t193*t2
            t332 = -1.8d-5*t60*t61*t7+5.4d-8*t163*t57*t61*t7+1.8d-5*t56*
     1         t60*t7+4.860000000000001d-10*t280*t56*t58*t7-2.16d-7*t163
     2         *t56*t57*t7
            t333 = 4.860000000000001d-10*t280*t31*t4*t56*t58
            t334 = 1.8d-5*t56-1.8d-5*t61
            t335 = 5.4d-8*t57*t61-2.16d-7*t56*t57
            t336 = 1/rhob**1.0666666666666666d+1
            t337 = -8.000000000000002d-2*t33*t34*t8+1.6000000000000003d-
     1         2*gammabb*t166*t196*t8+8.000000000000002d-2*t2*t33*t34+9.
     2         600000000000004d-3*t2*t288*t30*t336-6.400000000000001d-2*
     3         gammabb*t166*t196*t2
            t338 = -1.8d-5*t34*t60*t61+5.4d-8*t163*t34*t57*t61+1.8d-5*t3
     1         4*t56*t60+4.860000000000001d-10*t280*t34*t56*t58-2.16d-7*
     2         t163*t34*t56*t57
            t339 = 1/t5**5
            t340 = 1/rhoa**1.3666666666666666d+1
            t341 = 1/rhoa**11
            t342 = 1/rhoa**8.333333333333334d+0
            t343 = 1/rhoa**5.666666666666667d+0
            t344 = 1/rhoa**3.333333333333333d+0
            t345 = 1/rhoa**3.3333333333333337d+0
            t346 = 1/rhoa**2.666666666666667d+0
            t347 = 1/t12**7
            t348 = 1/rhoa**2.0d+0
            t349 = 1/t26**3
            t350 = t120**3
            t351 = -1.269642451250142d+0*t117*t12*(7.876233178997433d-1*
     1         t13*(-5.469606374303773d-2*t22*t347*t348-1.45856169981433
     2         94d-1*t111*t22*t346-1.1708185015918181d-2*t345-1.31270552
     3         98329054d-1*t211*t213*t22)-5.469606374303773d-2*t23*t347*
     4         t348-1.4585616998143394d-1*t111*t23*t346-1.31270552983290
     5         54d-1*t211*t213*t23-3.9381165894987163d-1*t111*t112*t221+
     6         1.9690582947493582d-1*t110*t118*t213+2.625411059665811d-1
     7         *t111*t118*t212)+1.763392293402975d-2*t213*t25*t348+2.351
     8         1897245373004d-1*t13*t25*t346+7.053569173611901d-2*t111*t
     9         211*t25-7.617854707500852d+0*t119**3*t12/t24**4+7.6178547
     :         07500852d+0*t119*t12*t219*t222-6.34821225625071d-1*t112*t
     ;         117*t13*t222+1.269642451250142d+0*t112*t13*t219*t220+4.23
     <         21415041671406d-1*t117*t119*t13*t212+1.0580353760417849d-
     =         1*t110*t111*t117*t119
            t352 = 9.999999999999991d-1*(6.21814d-2*t116*t28*t351+1.2436
     1         28d-1*t28*t349*t350-3.10907d-2*t108*t21*(-1.2696424512501
     2         42d+0*t109*t12*(7.876233178997433d-1*t13*(-5.469606374303
     3         773d-2*t14*t347*t348-1.4585616998143394d-1*t111*t14*t346-
     4         7.424439106586571d-3*t345-1.3127055298329054d-1*t14*t211*
     5         t213)-5.469606374303773d-2*t15*t347*t348-1.45856169981433
     6         94d-1*t111*t15*t346-3.9381165894987163d-1*t111*t112*t214-
     7         1.3127055298329054d-1*t15*t211*t213+1.9690582947493582d-1
     8         *t110*t113*t213+2.625411059665811d-1*t111*t113*t212)+1.76
     9         3392293402975d-2*t17*t213*t348+2.3511897245373004d-1*t13*
     :         t17*t346+7.617854707500852d+0*t114*t12*t209*t215-6.348212
     ;         25625071d-1*t109*t112*t13*t215+4.2321415041671406d-1*t109
     <         *t114*t13*t212+7.053569173611901d-2*t111*t17*t211+1.26964
     =         2451250142d+0*t112*t13*t209*t210-7.617854707500852d+0*t11
     >         4**3*t12/t16**4+1.0580353760417849d-1*t109*t110*t111*t114
     ?         )-8.548627933030694d-3*t27*t344+4.1099018897499934d-3*t19
     @         *t344-1.865442d-1*t120*t217*t223*t28-8.243319792565315d-3
     1         *t107*t116*t223+8.243319792565315d-3*t107*t217*t218+9.327
     2         209999999999d-2*t115*t207*t21*t216+3.96311967940178d-3*t1
     3         07*t108*t216-6.21814d-2*t115**3*t21/t18**3-3.963119679401
     4         78d-3*t107*t207*t208+1.0991093056753751d-2*t116*t120*t206
     5         -5.284159572535706d-3*t108*t115*t206)-6.21814d-2*t116*t28
     6         *t351-1.243628d-1*t28*t349*t350+8.548627933030694d-3*t27*
     7         t344+1.865442d-1*t120*t217*t223*t28+8.243319792565315d-3*
     8         t107*t116*t223-8.243319792565315d-3*t107*t217*t218-1.0991
     9         093056753751d-2*t116*t120*t206
            t353 = 1/t59**5
            t354 = t128**3
            t355 = 1/t74**3
            t356 = -1.243628d-1*t354*t355*t67
            t357 = 1.865442d-1*t128*t226*t235*t67
            t358 = -8.243319792565315d-3*t131*t225*t226
            t359 = 1/t64**3.3333333333333337d+0
            t360 = 1/t64**2.0d+0
            t361 = 1/t68**7
            t362 = 1/t64**2.666666666666667d+0
            t363 = 2.3511897245373004d-1*t362*t69*t73+1.763392293402975d
     1         -2*t231*t360*t73+7.053569173611901d-2*t124*t230*t73-7.617
     2         854707500852d+0*t126**3*t68/t72**4-1.269642451250142d+0*t
     3         127*t68*(-1.4585616998143394d-1*t124*t362*t71-5.469606374
     4         303773d-2*t360*t361*t71-1.3127055298329054d-1*t230*t231*t
     5         71+7.876233178997433d-1*t69*(-1.4585616998143394d-1*t124*
     6         t362*t70-5.469606374303773d-2*t360*t361*t70-1.31270552983
     7         29054d-1*t230*t231*t70-1.1708185015918181d-2*t359)-3.9381
     8         165894987163d-1*t123*t124*t233+2.625411059665811d-1*t124*
     9         t125*t232+1.9690582947493582d-1*t122*t125*t231)-6.3482122
     :         5625071d-1*t123*t127*t234*t69+4.2321415041671406d-1*t126*
     ;         t127*t232*t69+1.269642451250142d+0*t123*t228*t229*t69+7.6
     <         17854707500852d+0*t126*t229*t234*t68+1.0580353760417849d-
     =         1*t122*t124*t126*t127
            t364 = -6.21814d-2*t129*t363*t67
            t365 = 8.243319792565315d-3*t129*t131*t235
            t366 = -1.0991093056753751d-2*t128*t129*t238
            t367 = 1/t64**3.333333333333333d+0
            t368 = 8.548627933030694d-3*t367*t75
            t369 = 1/t78**1.6666666666666669d+0
            t370 = 6*t76*t89
            t371 = -6*t268
            t372 = 1/t79**1.6666666666666669d+0
            t373 = -6*t76*t89
            t374 = 6*t268
            t375 = t136**3
            t376 = 1/t86**3
            t377 = 6.75476d-2*t375*t376*t81
            t378 = -1.013214d-1*t136*t241*t247*t81
            t379 = 2.33086476681112d-3*t131*t240*t241
            t380 = 2.3511897245373004d-1*t362*t69*t85+1.763392293402975d
     1         -2*t231*t360*t85+7.053569173611901d-2*t124*t230*t85-7.617
     2         854707500852d+0*t134**3*t68/t84**4-1.269642451250142d+0*t
     3         135*t68*(-1.4585616998143394d-1*t124*t362*t83-5.469606374
     4         303773d-2*t360*t361*t83-1.3127055298329054d-1*t230*t231*t
     5         83+7.876233178997433d-1*t69*(-1.4585616998143394d-1*t124*
     6         t362*t82-5.469606374303773d-2*t360*t361*t82-1.31270552983
     7         29054d-1*t230*t231*t82-6.407931356509611d-3*t359)-3.93811
     8         65894987163d-1*t123*t124*t245+2.625411059665811d-1*t124*t
     9         133*t232+1.9690582947493582d-1*t122*t133*t231)-6.34821225
     :         625071d-1*t123*t135*t246*t69+1.269642451250142d+0*t123*t2
     ;         43*t244*t69+4.2321415041671406d-1*t134*t135*t232*t69+7.61
     <         7854707500852d+0*t134*t244*t246*t68+1.0580353760417849d-1
     =         *t122*t124*t134*t135
            t381 = 3.37738d-2*t137*t380*t81
            t382 = -2.33086476681112d-3*t131*t137*t247
            t383 = 3.107819689081493d-3*t136*t137*t238
            t384 = -2.4171930915078277d-3*t367*t87
            t385 = t88*t89*(1.709920934161365d+0*(4.1099018897499934d-3*
     1         t367*t96-6.21814d-2*t143**3*t90/t95**3-3.10907d-2*t144*t9
     2         0*(2.3511897245373004d-1*t362*t69*t94+1.763392293402975d-
     3         2*t231*t360*t94+7.053569173611901d-2*t124*t230*t94-7.6178
     4         54707500852d+0*t141**3*t68/t93**4-1.269642451250142d+0*t1
     5         42*t68*(-1.4585616998143394d-1*t124*t362*t92-5.4696063743
     6         03773d-2*t360*t361*t92-1.3127055298329054d-1*t230*t231*t9
     7         2+7.876233178997433d-1*t69*(-1.4585616998143394d-1*t124*t
     8         362*t91-5.469606374303773d-2*t360*t361*t91-1.312705529832
     9         9054d-1*t230*t231*t91-7.424439106586571d-3*t359)-3.938116
     :         5894987163d-1*t123*t124*t255+2.625411059665811d-1*t124*t1
     ;         40*t232+1.9690582947493582d-1*t122*t140*t231)-6.348212256
     <         25071d-1*t123*t142*t256*t69+1.269642451250142d+0*t123*t25
     =         3*t254*t69+4.2321415041671406d-1*t141*t142*t232*t69+7.617
     >         854707500852d+0*t141*t254*t256*t68+1.0580353760417849d-1*
     ?         t122*t124*t141*t142)+9.327209999999999d-2*t143*t252*t257*
     @         t90-8.548627933030694d-3*t367*t75+6.21814d-2*t129*t363*t6
     1         7+1.243628d-1*t354*t355*t67-1.865442d-1*t128*t226*t235*t6
     2         7+3.96311967940178d-3*t131*t144*t257-3.96311967940178d-3*
     3         t131*t251*t252-5.284159572535706d-3*t143*t144*t238+1.0991
     4         093056753751d-2*t128*t129*t238-8.243319792565315d-3*t129*
     5         t131*t235+8.243319792565315d-3*t131*t225*t226)+2.41719309
     6         15078277d-3*t367*t87-3.37738d-2*t137*t380*t81-6.75476d-2*
     7         t375*t376*t81+1.013214d-1*t136*t241*t247*t81+2.3308647668
     8         1112d-3*t131*t137*t247-2.33086476681112d-3*t131*t240*t241
     9         -3.107819689081493d-3*t136*t137*t238)
            t386 = -12*t147*t258*t88
            t387 = 60*t145*t261*t88
            t388 = 36*t145*t263*t89
            t389 = -120*t88*t97/t64**7
            t390 = -144*t147*t263*t97
            t391 = 24*t76*t89*t97
            t392 = 2.0d+0*t284
            t393 = -12*t145*t263*t89
            t394 = 48*t147*t263*t97
            t395 = -24*t76*t89*t97
            t396 = 1/t32**5
            t397 = 1/rhob**1.3666666666666666d+1
            t398 = 1/rhob**11
            t399 = 1/rhob**8.333333333333334d+0
            t400 = 1/rhob**5.666666666666667d+0
            t401 = 1/rhob**3.333333333333333d+0
            t402 = 1/rhob**3.3333333333333337d+0
            t403 = 1/rhob**2.666666666666667d+0
            t404 = 1/t38**7
            t405 = 1/rhob**2.0d+0
            t406 = 1/t52**3
            t407 = t184**3
            t408 = 1.763392293402975d-2*t301*t405*t51+2.3511897245373004
     1         d-1*t39*t403*t51+7.053569173611901d-2*t175*t299*t51-7.617
     2         854707500852d+0*t183**3*t38/t50**4-1.269642451250142d+0*t
     3         181*t38*(-5.469606374303773d-2*t404*t405*t49-1.4585616998
     4         143394d-1*t175*t403*t49-1.3127055298329054d-1*t299*t301*t
     5         49+7.876233178997433d-1*t39*(-5.469606374303773d-2*t404*t
     6         405*t48-1.4585616998143394d-1*t175*t403*t48-1.31270552983
     7         29054d-1*t299*t301*t48-1.1708185015918181d-2*t402)-3.9381
     8         165894987163d-1*t175*t176*t309+1.9690582947493582d-1*t174
     9         *t182*t301+2.625411059665811d-1*t175*t182*t300)-6.3482122
     :         5625071d-1*t176*t181*t310*t39+1.269642451250142d+0*t176*t
     ;         307*t308*t39+4.2321415041671406d-1*t181*t183*t300*t39+7.6
     <         17854707500852d+0*t183*t307*t310*t38+1.0580353760417849d-
     =         1*t174*t175*t181*t183
            t409 = 9.999999999999991d-1*(6.21814d-2*t180*t408*t54+1.2436
     1         28d-1*t406*t407*t54-1.865442d-1*t184*t305*t311*t54-8.5486
     2         27933030694d-3*t401*t53-6.21814d-2*t179**3*t47/t44**3-3.1
     3         0907d-2*t172*(1.763392293402975d-2*t301*t405*t43+2.351189
     4         7245373004d-1*t39*t403*t43+7.053569173611901d-2*t175*t299
     5         *t43-7.617854707500852d+0*t178**3*t38/t42**4-1.2696424512
     6         50142d+0*t173*t38*(-5.469606374303773d-2*t404*t405*t41-1.
     7         4585616998143394d-1*t175*t403*t41-1.3127055298329054d-1*t
     8         299*t301*t41+7.876233178997433d-1*t39*(-5.469606374303773
     9         d-2*t40*t404*t405-1.4585616998143394d-1*t175*t40*t403-7.4
     :         24439106586571d-3*t402-1.3127055298329054d-1*t299*t301*t4
     ;         0)-3.9381165894987163d-1*t175*t176*t302+1.969058294749358
     <         2d-1*t174*t177*t301+2.625411059665811d-1*t175*t177*t300)-
     =         6.34821225625071d-1*t173*t176*t303*t39+4.2321415041671406
     >         d-1*t173*t178*t300*t39+1.269642451250142d+0*t176*t297*t29
     ?         8*t39+7.617854707500852d+0*t178*t297*t303*t38+1.058035376
     @         0417849d-1*t173*t174*t175*t178)*t47+9.327209999999999d-2*
     1         t179*t295*t304*t47+4.1099018897499934d-3*t401*t45-8.24331
     2         9792565315d-3*t171*t180*t311+8.243319792565315d-3*t171*t3
     3         05*t306+3.96311967940178d-3*t171*t172*t304-3.963119679401
     4         78d-3*t171*t295*t296+1.0991093056753751d-2*t180*t184*t294
     5         -5.284159572535706d-3*t172*t179*t294)-6.21814d-2*t180*t40
     6         8*t54-1.243628d-1*t406*t407*t54+1.865442d-1*t184*t305*t31
     7         1*t54+8.548627933030694d-3*t401*t53+8.243319792565315d-3*
     8         t171*t180*t311-8.243319792565315d-3*t171*t305*t306-1.0991
     9         093056753751d-2*t180*t184*t294
            t410 = -1.8d-5*t31*t4*t60*t61+5.4d-8*t163*t31*t4*t57*t61+1.8
     1         d-5*t31*t4*t56*t60-2.16d-7*t163*t31*t4*t56*t57+t333
            fnc(iq) = 1.0d+0*(t100*t63+1.0d+0*rhob*t36*t55+1.0d+0*rhoa*t
     1         10*t29)*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*(t162*t63+1.0d+0*rhoa*t106*t29+1.0d+
     1         0*t10*t29+t100*t164+1.0d+0*rhoa*t10*t121)*wght+Amat(iq,D1
     2         _RA)
            Amat(iq,D1_RB) = 1.0d+0*(t191*t63+1.0d+0*t36*t55+1.0d+0*rhob
     1         *t170*t55+1.0d+0*rhob*t185*t36+t100*t192)*wght+Amat(iq,D1
     2         _RB)
            Cmat(iq,D1_GAA) = 1.0d+0*(1.0d+0*rhoa*t194*t29+t100*t195)*wg
     1         ht+Cmat(iq,D1_GAA)
            Cmat(iq,D1_GAB) = Cmat(iq,D1_GAB)
            Cmat(iq,D1_GBB) = 1.0d+0*(1.0d+0*rhob*t197*t55+t100*t198)*wg
     1         ht+Cmat(iq,D1_GBB)
            Amat2(iq,D2_RA_RA) = 1.0d+0*(t279*t63+1.0d+0*rhoa*t205*t29+2
     1         .0d+0*t106*t29+t100*t281+1.0d+0*rhoa*t10*t224+2*t162*t164
     2         +2.0d+0*rhoa*t106*t121+2.0d+0*t10*t121)*wght+Amat2(iq,D2_
     3         RA_RA)
            Amat2(iq,D2_RA_RB) = 1.0d+0*(t285*t63+t100*t286+t162*t192+t1
     1         64*t191)*wght+Amat2(iq,D2_RA_RB)
            Amat2(iq,D2_RB_RB) = 1.0d+0*(t320*t63+1.0d+0*rhob*t293*t55+2
     1         .0d+0*t170*t55+1.0d+0*rhob*t312*t36+2.0d+0*t185*t36+t100*
     2         t321+2*t191*t192+2.0d+0*rhob*t170*t185)*wght+Amat2(iq,D2_
     3         RB_RB)
            Cmat2(iq,D2_RA_GAA) = 1.0d+0*(t100*t324+1.0d+0*rhoa*t29*t323
     1         +1.0d+0*t194*t29+t162*t195+1.0d+0*rhoa*t121*t194)*wght+Cm
     2         at2(iq,D2_RA_GAA)
            Cmat2(iq,D2_RA_GAB) = Cmat2(iq,D2_RA_GAB)
            Cmat2(iq,D2_RA_GBB) = 1.0d+0*(t100*t325+t162*t198)*wght+Cmat
     1         2(iq,D2_RA_GBB)
            Cmat2(iq,D2_RB_GAA) = 1.0d+0*(t100*t326+t191*t195)*wght+Cmat
     1         2(iq,D2_RB_GAA)
            Cmat2(iq,D2_RB_GAB) = Cmat2(iq,D2_RB_GAB)
            Cmat2(iq,D2_RB_GBB) = 1.0d+0*(1.0d+0*rhob*t328*t55+1.0d+0*t1
     1         97*t55+t100*t329+t191*t198+1.0d+0*rhob*t185*t197)*wght+Cm
     2         at2(iq,D2_RB_GBB)
            Cmat2(iq,D2_GAA_GAA) = 1.0d+0*(t100*t332+1.0d+0*rhoa*t29*t33
     1         1)*wght+Cmat2(iq,D2_GAA_GAA)
            Cmat2(iq,D2_GAA_GAB) = Cmat2(iq,D2_GAA_GAB)
            Cmat2(iq,D2_GAA_GBB) = 1.0d+0*t100*(t31*t334*t4*t60+t163*t31
     1         *t335*t4+t333)*wght+Cmat2(iq,D2_GAA_GBB)
            Cmat2(iq,D2_GAB_GAB) = Cmat2(iq,D2_GAB_GAB)
            Cmat2(iq,D2_GAB_GBB) = Cmat2(iq,D2_GAB_GBB)
            Cmat2(iq,D2_GBB_GBB) = 1.0d+0*(1.0d+0*rhob*t337*t55+t100*t33
     1         8)*wght+Cmat2(iq,D2_GBB_GBB)
            Amat3(iq,D3_RA_RA_RA) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622
     1         634648d-1*(2.564881401242048d+0*t158*(t374+t373)-5.699736
     2         44720455d-1*t157**3*t372+2.564881401242048d+0*t155*(t371+
     3         t370)-5.69973644720455d-1*t154**3*t369+2.5648814012420473
     4         d+0*t157*t273*t276+2.5648814012420473d+0*t154*t267*t271)*
     5         t98+5.848223622634648d-1*t80*(240*t149*t261*t97+12*t149*t
     6         258*t89+t391+t390+t389+t388+t387+t386+t385+t384+t383+t382
     7         +t381+t379+t378+t377-96*t145*t147*t149)+t368+t366+t365+t3
     8         64+t358+t357+t356+1.7544670867903944d+0*t150*t277+1.75446
     9         70867903944d+0*t159*t265)-1.0d+0*rhoa*t352+3.0d+0*t278-3.
     :         0d+0*t224)+1.0d+0*rhoa*t29*(-9.125925925925926d+0*gammaaa
     ;         *t343*t8*t9+8.082962962962963d+0*t3*t342*t6*t8-2.16177777
     <         7777778d+0*t101*t102*t341*t8+1.8204444444444445d-1*t199*t
     =         200*t340*t8-9.90814814814815d+0*t2*t3*t342*t6+7.556740740
     >         740742d+0*t101*t102*t2*t341-1.8432000000000004d+0*t199*t2
     ?         *t200*t340+1.456355555555556d-1*gammaaa**5*t2*t339/rhoa**
     @         1.6333333333333333d+1)+t100*(-1.368888888888889d-1*gammaa
     1         a*t343*t61*t62+4.106666666666667d-4*gammaaa*t343*t57*t60*
     2         t61+1.4079999999999998d-3*t3*t342*t60*t61-4.224d-6*t163*t
     3         3*t342*t57*t61+9.216d-9*t101*t280*t341*t57*t61-3.072d-6*t
     4         101*t163*t341*t61-8.213333333333334d-4*gammaaa*t343*t56*t
     5         57*t60-1.408d-3*t3*t342*t56*t60+1.1059200000000002d-10*t1
     6         01*t341*t353*t56*t58+2.4640000000000004d-6*gammaaa*t163*t
     7         343*t56*t58-3.8016d-8*t280*t3*t342*t56*t58+1.689600000000
     8         0003d-5*t163*t3*t342*t56*t57-5.529600000000001d-8*t101*t2
     9         80*t341*t56*t57+6.144000000000001d-6*t101*t163*t341*t56)+
     :         1.0d+0*rhoa*t10*t352+3.0d+0*t205*t29+3*t162*t281+3*t164*t
     ;         279+3.0d+0*rhoa*t106*t224+3.0d+0*t10*t224+3.0d+0*rhoa*t12
     <         1*t205+6.0d+0*t106*t121)*wght+Amat3(iq,D3_RA_RA_RA)
            Amat3(iq,D3_RA_RA_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622
     1         634648d-1*(3.41984186832273d+0*t157*t268*t273*t76-3.41984
     2         186832273d+0*t154*t267*t268*t76+2.564881401242048d+0*t158
     3         *(t373+2*t268)-5.69973644720455d-1*t188*t272*t372+2.56488
     4         1401242048d+0*t155*(t370-2*t268)-5.69973644720455d-1*t187
     5         *t266*t369+8.549604670806825d-1*t188*t273*t276+8.54960467
     6         0806825d-1*t187*t267*t271)*t98+5.848223622634648d-1*t80*(
     7         80*t149*t261*t97+4*t149*t258*t89+t395+t394+t393+t389+t387
     8         +t386+t385+t384+t383+t382+t381+t379+t378+t377-32*t145*t14
     9         7*t149)+t368+t366+t365+t364+t358+t357+t356+1.169644724526
     :         9297d+0*t150*t283+1.1696447245269297d+0*t159*t282+5.84822
     ;         3622634648d-1*t186*t277+5.848223622634648d-1*t189*t265)+t
     <         392+1.0d+0*t278)+t100*(4.693333333333333d-4*gammaaa*gamma
     =         bb*t169*t204*t60*t61+9.216d-9*gammabb*t169*t203*t280*t3*t
     >         57*t61-1.4079999999999998d-6*gammaaa*gammabb*t163*t169*t2
     ?         04*t57*t61-3.072d-6*gammabb*t163*t169*t203*t3*t61-4.69333
     @         3333333333d-4*gammaaa*gammabb*t169*t204*t56*t60+1.1059200
     1         000000002d-10*gammabb*t169*t203*t3*t353*t56*t58-1.2672000
     2         000000003d-8*gammaaa*gammabb*t169*t204*t280*t56*t58-5.529
     3         600000000001d-8*gammabb*t169*t203*t280*t3*t56*t57+5.63199
     4         9999999999d-6*gammaaa*gammabb*t163*t169*t204*t56*t57+6.14
     5         4000000000001d-6*gammabb*t163*t169*t203*t3*t56)+2*t162*t2
     6         86+2*t164*t285+t191*t281+t192*t279)*wght+Amat3(iq,D3_RA_R
     7         A_RB)
            Amat3(iq,D3_RA_RB_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622
     1         634648d-1*(-1.5389288407452287d+1*t158*t76*t89+1.53892884
     2         07452287d+1*t155*t76*t89+3.41984186832273d+0*t188*t268*t2
     3         73*t76-3.41984186832273d+0*t187*t267*t268*t76-5.699736447
     4         20455d-1*t157*t316*t372-5.69973644720455d-1*t154*t314*t36
     5         9+8.549604670806825d-1*t157*t273*t317+8.549604670806825d-
     6         1*t154*t267*t315-5.129762802484096d+0*t158*t268+5.1297628
     7         02484096d+0*t155*t268)*t98+5.848223622634648d-1*t80*(-80*
     8         t149*t261*t97-4*t149*t258*t89+t394+t393+t391+t389+t387+t3
     9         86+t385+t384+t383+t382+t381+t379+t378+t377+32*t145*t147*t
     :         149)+t368+t366+t365+t364+t358+t357+t356+5.848223622634648
     ;         d-1*t150*t318+5.848223622634648d-1*t159*t313+1.1696447245
     <         269297d+0*t186*t283+1.1696447245269297d+0*t189*t282)+t392
     =         +1.0d+0*t319)+t100*(4.6933333333333327d-4*gammaaa*gammabb
     >         *t105*t292*t60*t61+9.216d-9*gammaaa*t105*t280*t291*t30*t5
     ?         7*t61-1.4079999999999998d-6*gammaaa*gammabb*t105*t163*t29
     @         2*t57*t61-3.072d-6*gammaaa*t105*t163*t291*t30*t61-4.69333
     1         33333333327d-4*gammaaa*gammabb*t105*t292*t56*t60+1.105920
     2         0000000002d-10*gammaaa*t105*t291*t30*t353*t56*t58-1.2672d
     3         -8*gammaaa*gammabb*t105*t280*t292*t56*t58-5.5296000000000
     4         01d-8*gammaaa*t105*t280*t291*t30*t56*t57+5.632d-6*gammaaa
     5         *gammabb*t105*t163*t292*t56*t57+6.144000000000001d-6*gamm
     6         aaa*t105*t163*t291*t30*t56)+t162*t321+t164*t320+2*t191*t2
     7         86+2*t192*t285)*wght+Amat3(iq,D3_RA_RB_RB)
            Amat3(iq,D3_RB_RB_RB) = 1.0d+0*(t63*(1.0d+0*t64*(5.848223622
     1         634648d-1*(2.564881401242048d+0*t155*(t374+t370)+2.564881
     2         401242048d+0*t158*(t373+t371)-5.69973644720455d-1*t188**3
     3         *t372-5.69973644720455d-1*t187**3*t369+2.5648814012420473
     4         d+0*t188*t273*t317+2.5648814012420473d+0*t187*t267*t315)*
     5         t98+5.848223622634648d-1*t80*(-240*t149*t261*t97-12*t149*
     6         t258*t89+t395+t390+t389+t388+t387+t386+t385+t384+t383+t38
     7         2+t381+t379+t378+t377+96*t145*t147*t149)+t368+t366+t365+t
     8         364+t358+t357+t356+1.7544670867903944d+0*t186*t318+1.7544
     9         670867903944d+0*t189*t313)-1.0d+0*rhob*t409+3.0d+0*t319-3
     :         .0d+0*t312)+1.0d+0*rhob*t55*(-9.125925925925926d+0*gammab
     ;         b*t35*t400*t8+8.082962962962963d+0*t30*t33*t399*t8-2.1617
     <         77777777778d+0*t165*t166*t398*t8+1.8204444444444445d-1*t2
     =         87*t288*t397*t8-9.90814814814815d+0*t2*t30*t33*t399+7.556
     >         740740740742d+0*t165*t166*t2*t398-1.8432000000000004d+0*t
     ?         2*t287*t288*t397+1.456355555555556d-1*gammabb**5*t2*t396/
     @         rhob**1.6333333333333333d+1)+t100*(-1.368888888888889d-1*
     1         gammabb*t400*t61*t62+4.106666666666667d-4*gammabb*t400*t5
     2         7*t60*t61+1.4079999999999998d-3*t30*t399*t60*t61-4.224d-6
     3         *t163*t30*t399*t57*t61+9.216d-9*t165*t280*t398*t57*t61-3.
     4         072d-6*t163*t165*t398*t61-8.213333333333334d-4*gammabb*t4
     5         00*t56*t57*t60-1.408d-3*t30*t399*t56*t60+2.46400000000000
     6         04d-6*gammabb*t163*t400*t56*t58-3.8016d-8*t280*t30*t399*t
     7         56*t58+1.1059200000000002d-10*t165*t353*t398*t56*t58+1.68
     8         96000000000003d-5*t163*t30*t399*t56*t57-5.529600000000001
     9         d-8*t165*t280*t398*t56*t57+6.144000000000001d-6*t163*t165
     :         *t398*t56)+3.0d+0*t293*t55+1.0d+0*rhob*t36*t409+3.0d+0*t3
     ;         12*t36+3*t191*t321+3*t192*t320+3.0d+0*rhob*t170*t312+3.0d
     <         +0*rhob*t185*t293+6.0d+0*t170*t185)*wght+Amat3(iq,D3_RB_R
     =         B_RB)
            Cmat3(iq,D3_RA_RA_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(1.95555555
     1         55555554d+0*t204*t8*t9-2.311111111111111d+0*gammaaa*t203*
     2         t6*t8+7.253333333333334d-1*t102*t202*t3*t8-6.826666666666
     3         669d-2*t101*t200*t201*t8+2.7022222222222225d+0*gammaaa*t2
     4         *t203*t6-5.461333333333335d-2*t199*t2*t339/rhoa**1.533333
     5         3333333335d+1-2.3751111111111115d+0*t102*t2*t202*t3+6.400
     6         000000000001d-1*t101*t2*t200*t201)+t100*(2.93333333333333
     7         33d-2*t204*t61*t62-8.8d-5*t204*t57*t60*t61-4.32d-4*gammaa
     8         a*t203*t60*t61-3.456000000000001d-9*t202*t280*t3*t57*t61+
     9         1.296d-6*gammaaa*t163*t203*t57*t61+1.152d-6*t163*t202*t3*
     :         t61+1.76d-4*t204*t56*t57*t60+4.32d-4*gammaaa*t203*t56*t60
     ;         -4.1472000000000003d-11*t202*t3*t353*t56*t58+1.1664000000
     <         000001d-8*gammaaa*t203*t280*t56*t58-5.28d-7*t163*t204*t56
     =         *t58+2.0736000000000004d-8*t202*t280*t3*t56*t57-5.184d-6*
     >         gammaaa*t163*t203*t56*t57-2.3040000000000002d-6*t163*t202
     ?         *t3*t56)+2*t162*t324+2.0d+0*t29*t323+2.0d+0*rhoa*t121*t32
     @         3+t195*t279+1.0d+0*rhoa*t194*t224+2.0d+0*t121*t194)*wght+
     1         Cmat3(iq,D3_RA_RA_GAA)
            Cmat3(iq,D3_RA_RA_GAB) = Cmat3(iq,D3_RA_RA_GAB)
            Cmat3(iq,D3_RA_RA_GBB) = 1.0d+0*(t100*(-1.76d-4*gammaaa*t204
     1         *t31*t60*t61-3.456000000000001d-9*t203*t280*t3*t31*t57*t6
     2         1+5.279999999999999d-7*gammaaa*t163*t204*t31*t57*t61+1.15
     3         2d-6*t163*t203*t3*t31*t61+1.76d-4*gammaaa*t204*t31*t56*t6
     4         0-4.1472000000000003d-11*t203*t3*t31*t353*t56*t58+4.75200
     5         0000000001d-9*gammaaa*t204*t280*t31*t56*t58+2.07360000000
     6         00004d-8*t203*t280*t3*t31*t56*t57-2.1120000000000003d-6*g
     7         ammaaa*t163*t204*t31*t56*t57-2.3040000000000002d-6*t163*t
     8         203*t3*t31*t56)+2*t162*t325+t198*t279)*wght+Cmat3(iq,D3_R
     9         A_RA_GBB)
            Cmat3(iq,D3_RA_RB_GAA) = 1.0d+0*(t100*(-1.28d-4*gammabb*t105
     1         *t169*t60*t61-3.456000000000001d-9*gammaaa*gammabb*t104*t
     2         169*t280*t57*t61+3.84d-7*gammabb*t105*t163*t169*t57*t61+1
     3         .152d-6*gammaaa*gammabb*t104*t163*t169*t61+1.28d-4*gammab
     4         b*t105*t169*t56*t60-4.1472000000000003d-11*gammaaa*gammab
     5         b*t104*t169*t353*t56*t58+3.456000000000001d-9*gammabb*t10
     6         5*t169*t280*t56*t58+2.0736000000000004d-8*gammaaa*gammabb
     7         *t104*t169*t280*t56*t57-1.5360000000000001d-6*gammabb*t10
     8         5*t163*t169*t56*t57-2.3040000000000002d-6*gammaaa*gammabb
     9         *t104*t163*t169*t56)+t162*t326+t191*t324+t195*t285)*wght+
     :         Cmat3(iq,D3_RA_RB_GAA)
            Cmat3(iq,D3_RA_RB_GAB) = Cmat3(iq,D3_RA_RB_GAB)
            Cmat3(iq,D3_RA_RB_GBB) = 1.0d+0*(t100*(-1.28d-4*gammaaa*t105
     1         *t169*t60*t61-3.456000000000001d-9*gammaaa*gammabb*t105*t
     2         168*t280*t57*t61+3.84d-7*gammaaa*t105*t163*t169*t57*t61+1
     3         .152d-6*gammaaa*gammabb*t105*t163*t168*t61+1.28d-4*gammaa
     4         a*t105*t169*t56*t60-4.1472000000000003d-11*gammaaa*gammab
     5         b*t105*t168*t353*t56*t58+3.456000000000001d-9*gammaaa*t10
     6         5*t169*t280*t56*t58+2.0736000000000004d-8*gammaaa*gammabb
     7         *t105*t168*t280*t56*t57-1.5360000000000001d-6*gammaaa*t10
     8         5*t163*t169*t56*t57-2.3040000000000002d-6*gammaaa*gammabb
     9         *t105*t163*t168*t56)+t162*t329+t191*t325+t198*t285)*wght+
     :         Cmat3(iq,D3_RA_RB_GBB)
            Cmat3(iq,D3_RB_RB_GAA) = 1.0d+0*(t100*(-1.76d-4*gammabb*t292
     1         *t4*t60*t61-3.456000000000001d-9*t280*t291*t30*t4*t57*t61
     2         +5.279999999999999d-7*gammabb*t163*t292*t4*t57*t61+1.152d
     3         -6*t163*t291*t30*t4*t61+1.76d-4*gammabb*t292*t4*t56*t60-4
     4         .1472000000000003d-11*t291*t30*t353*t4*t56*t58+4.75200000
     5         0000001d-9*gammabb*t280*t292*t4*t56*t58+2.073600000000000
     6         4d-8*t280*t291*t30*t4*t56*t57-2.1120000000000003d-6*gamma
     7         bb*t163*t292*t4*t56*t57-2.3040000000000002d-6*t163*t291*t
     8         30*t4*t56)+2*t191*t326+t195*t320)*wght+Cmat3(iq,D3_RB_RB_
     9         GAA)
            Cmat3(iq,D3_RB_RB_GAB) = Cmat3(iq,D3_RB_RB_GAB)
            Cmat3(iq,D3_RB_RB_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(1.95555555
     1         55555554d+0*t292*t35*t8-2.311111111111111d+0*gammabb*t291
     2         *t33*t8+7.253333333333334d-1*t166*t290*t30*t8-6.826666666
     3         666669d-2*t165*t288*t289*t8-5.461333333333335d-2*t2*t287*
     4         t396/rhob**1.5333333333333335d+1+2.7022222222222225d+0*ga
     5         mmabb*t2*t291*t33-2.3751111111111115d+0*t166*t2*t290*t30+
     6         6.400000000000001d-1*t165*t2*t288*t289)+t100*(2.933333333
     7         3333333d-2*t292*t61*t62-8.8d-5*t292*t57*t60*t61-4.32d-4*g
     8         ammabb*t291*t60*t61-3.456000000000001d-9*t280*t290*t30*t5
     9         7*t61+1.296d-6*gammabb*t163*t291*t57*t61+1.152d-6*t163*t2
     :         90*t30*t61+1.76d-4*t292*t56*t57*t60+4.32d-4*gammabb*t291*
     ;         t56*t60-4.1472000000000003d-11*t290*t30*t353*t56*t58-5.28
     <         d-7*t163*t292*t56*t58+1.1664000000000001d-8*gammabb*t280*
     =         t291*t56*t58+2.0736000000000004d-8*t280*t290*t30*t56*t57-
     >         5.184d-6*gammabb*t163*t291*t56*t57-2.3040000000000002d-6*
     ?         t163*t290*t30*t56)+2.0d+0*t328*t55+2*t191*t329+2.0d+0*rho
     @         b*t185*t328+t198*t320+1.0d+0*rhob*t197*t312+2.0d+0*t185*t
     1         197)*wght+Cmat3(iq,D3_RB_RB_GBB)
            Cmat3(iq,D3_RA_GAA_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(4.2666666
     1         66666667d-1*t104*t6*t8+2.5600000000000006d-2*t200*t3*t322
     2         *t8-2.1333333333333335d-1*gammaaa*t102*t103*t8-4.26666666
     3         66666675d-1*t104*t2*t6+2.048000000000001d-2*t101*t2*t339/
     4         rhoa**1.4333333333333334d+1-2.0480000000000004d-1*t2*t200
     5         *t3*t322+5.973333333333335d-1*gammaaa*t102*t103*t2)+t100*
     6         (9.600000000000001d-5*t104*t60*t61+1.2960000000000002d-9*
     7         gammaaa*t103*t280*t57*t61-2.8800000000000003d-7*t104*t163
     8         *t57*t61-4.3200000000000005d-7*gammaaa*t103*t163*t61-9.60
     9         0000000000001d-5*t104*t56*t60+1.5552000000000005d-11*gamm
     :         aaa*t103*t353*t56*t58-2.5920000000000004d-9*t104*t280*t56
     ;         *t58-7.776000000000002d-9*gammaaa*t103*t280*t56*t57+1.152
     <         0000000000001d-6*t104*t163*t56*t57+8.640000000000001d-7*g
     =         ammaaa*t103*t163*t56)+t162*t332+1.0d+0*t29*t331+1.0d+0*rh
     >         oa*t121*t331)*wght+Cmat3(iq,D3_RA_GAA_GAA)
            Cmat3(iq,D3_RA_GAA_GAB) = Cmat3(iq,D3_RA_GAA_GAB)
            Cmat3(iq,D3_RA_GAA_GBB) = 1.0d+0*(t100*(4.8000000000000004d-
     1         5*t105*t31*t60*t61+1.2960000000000002d-9*gammaaa*t104*t28
     2         0*t31*t57*t61-1.4400000000000002d-7*t105*t163*t31*t57*t61
     3         -4.3200000000000005d-7*gammaaa*t104*t163*t31*t61-4.800000
     4         0000000004d-5*t105*t31*t56*t60+1.5552000000000005d-11*gam
     5         maaa*t104*t31*t353*t56*t58-1.2960000000000002d-9*t105*t28
     6         0*t31*t56*t58-7.776000000000002d-9*gammaaa*t104*t280*t31*
     7         t56*t57+5.760000000000001d-7*t105*t163*t31*t56*t57+8.6400
     8         00000000001d-7*gammaaa*t104*t163*t31*t56)+t162*t410)*wght
     9         +Cmat3(iq,D3_RA_GAA_GBB)
            Cmat3(iq,D3_RA_GAB_GAB) = Cmat3(iq,D3_RA_GAB_GAB)
            Cmat3(iq,D3_RA_GAB_GBB) = Cmat3(iq,D3_RA_GAB_GBB)
            Cmat3(iq,D3_RA_GBB_GBB) = 1.0d+0*(t100*(1.2960000000000002d-
     1         9*gammaaa*t105*t280*t34*t57*t61-4.3200000000000005d-7*gam
     2         maaa*t105*t163*t34*t61+1.5552000000000005d-11*gammaaa*t10
     3         5*t34*t353*t56*t58-7.776000000000002d-9*gammaaa*t105*t280
     4         *t34*t56*t57+8.640000000000001d-7*gammaaa*t105*t163*t34*t
     5         56)+t162*t338)*wght+Cmat3(iq,D3_RA_GBB_GBB)
            Cmat3(iq,D3_RB_GAA_GAA) = 1.0d+0*(t100*(1.2960000000000002d-
     1         9*gammabb*t169*t280*t57*t61*t7-4.3200000000000005d-7*gamm
     2         abb*t163*t169*t61*t7+1.5552000000000005d-11*gammabb*t169*
     3         t353*t56*t58*t7-7.776000000000002d-9*gammabb*t169*t280*t5
     4         6*t57*t7+8.640000000000001d-7*gammabb*t163*t169*t56*t7)+t
     5         191*t332)*wght+Cmat3(iq,D3_RB_GAA_GAA)
            Cmat3(iq,D3_RB_GAA_GAB) = Cmat3(iq,D3_RB_GAA_GAB)
            Cmat3(iq,D3_RB_GAA_GBB) = 1.0d+0*(t100*(4.8000000000000004d-
     1         5*t169*t4*t60*t61+1.2960000000000002d-9*gammabb*t168*t280
     2         *t4*t57*t61-1.4400000000000002d-7*t163*t169*t4*t57*t61-4.
     3         3200000000000005d-7*gammabb*t163*t168*t4*t61-4.8000000000
     4         000004d-5*t169*t4*t56*t60+1.5552000000000005d-11*gammabb*
     5         t168*t353*t4*t56*t58-1.2960000000000002d-9*t169*t280*t4*t
     6         56*t58-7.776000000000002d-9*gammabb*t168*t280*t4*t56*t57+
     7         5.760000000000001d-7*t163*t169*t4*t56*t57+8.6400000000000
     8         01d-7*gammabb*t163*t168*t4*t56)+t191*t410)*wght+Cmat3(iq,
     9         D3_RB_GAA_GBB)
            Cmat3(iq,D3_RB_GAB_GAB) = Cmat3(iq,D3_RB_GAB_GAB)
            Cmat3(iq,D3_RB_GAB_GBB) = Cmat3(iq,D3_RB_GAB_GBB)
            Cmat3(iq,D3_RB_GBB_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(4.2666666
     1         66666667d-1*t168*t33*t8+2.5600000000000006d-2*t288*t30*t3
     2         27*t8-2.1333333333333335d-1*gammabb*t166*t167*t8+2.048000
     3         000000001d-2*t165*t2*t396/rhob**1.4333333333333334d+1-4.2
     4         666666666666675d-1*t168*t2*t33-2.0480000000000004d-1*t2*t
     5         288*t30*t327+5.973333333333335d-1*gammabb*t166*t167*t2)+t
     6         100*(9.600000000000001d-5*t168*t60*t61+1.2960000000000002
     7         d-9*gammabb*t167*t280*t57*t61-2.8800000000000003d-7*t163*
     8         t168*t57*t61-4.3200000000000005d-7*gammabb*t163*t167*t61-
     9         9.600000000000001d-5*t168*t56*t60+1.5552000000000005d-11*
     :         gammabb*t167*t353*t56*t58-2.5920000000000004d-9*t168*t280
     ;         *t56*t58-7.776000000000002d-9*gammabb*t167*t280*t56*t57+1
     <         .1520000000000001d-6*t163*t168*t56*t57+8.640000000000001d
     =         -7*gammabb*t163*t167*t56)+1.0d+0*t337*t55+t191*t338+1.0d+
     >         0*rhob*t185*t337)*wght+Cmat3(iq,D3_RB_GBB_GBB)
            Cmat3(iq,D3_GAA_GAA_GAA) = 1.0d+0*(1.0d+0*rhoa*t29*(-9.60000
     1         0000000004d-3*gammaaa*t200*t330*t8+4.8000000000000015d-2*
     2         t102*t193*t8-7.680000000000003d-3*t2*t3*t339/rhoa**1.3333
     3         333333333333d+1+5.760000000000003d-2*gammaaa*t2*t200*t330
     4         -9.600000000000003d-2*t102*t193*t2)+t100*(-4.860000000000
     5         001d-10*t193*t280*t57*t61+1.62d-7*t163*t193*t61-5.832d-12
     6         *t193*t353*t56*t58+2.916d-9*t193*t280*t56*t57-3.24d-7*t16
     7         3*t193*t56))*wght+Cmat3(iq,D3_GAA_GAA_GAA)
            Cmat3(iq,D3_GAA_GAA_GAB) = Cmat3(iq,D3_GAA_GAA_GAB)
            Cmat3(iq,D3_GAA_GAA_GBB) = 1.0d+0*t100*(t280*t31*(2.916d-9*t
     1         56*t57-4.860000000000001d-10*t57*t61)*t7+t163*t31*(1.62d-
     2         7*t61-3.24d-7*t56)*t7-5.832d-12*t31*t353*t56*t58*t7)*wght
     3         +Cmat3(iq,D3_GAA_GAA_GBB)
            Cmat3(iq,D3_GAA_GAB_GAB) = Cmat3(iq,D3_GAA_GAB_GAB)
            Cmat3(iq,D3_GAA_GAB_GBB) = Cmat3(iq,D3_GAA_GAB_GBB)
            Cmat3(iq,D3_GAA_GBB_GBB) = 1.0d+0*t100*(t163*t31*t4*(5.4d-8*
     1         t31*t61-2.16d-7*t31*t56)-5.832d-12*t34*t353*t4*t56*t58+t2
     2         80*t34*t4*(9.720000000000002d-10*t56*t57-9.00000000000000
     3         1d-3*t335)-6.0d-3*t163*t334*t34*t4)*wght+Cmat3(iq,D3_GAA_
     4         GBB_GBB)
            Cmat3(iq,D3_GAB_GAB_GAB) = Cmat3(iq,D3_GAB_GAB_GAB)
            Cmat3(iq,D3_GAB_GAB_GBB) = Cmat3(iq,D3_GAB_GAB_GBB)
            Cmat3(iq,D3_GAB_GBB_GBB) = Cmat3(iq,D3_GAB_GBB_GBB)
            Cmat3(iq,D3_GBB_GBB_GBB) = 1.0d+0*(1.0d+0*rhob*t55*(-9.60000
     1         0000000004d-3*gammabb*t288*t336*t8+4.8000000000000015d-2*
     2         t166*t196*t8-7.680000000000003d-3*t2*t30*t396/rhob**1.333
     3         3333333333333d+1+5.760000000000003d-2*gammabb*t2*t288*t33
     4         6-9.600000000000003d-2*t166*t196*t2)+t100*(-4.86000000000
     5         0001d-10*t196*t280*t57*t61+1.62d-7*t163*t196*t61-5.832d-1
     6         2*t196*t353*t56*t58+2.916d-9*t196*t280*t56*t57-3.24d-7*t1
     7         63*t196*t56))*wght+Cmat3(iq,D3_GBB_GBB_GBB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = param(6)
            t2 = gammaaa**2
            t3 = 1/rhoa**2.6666666666666666d+0
            t4 = 2.0d-1*gammaaa*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhoa**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammaaa*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhoa**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = gammaaa**3
            t30 = 1/t4**3
            t31 = 1/rhoa**9
            t32 = 1/rhoa**6.333333333333333d+0
            t33 = 1/rhoa**3.6666666666666664d+0
            t34 = -5.333333333333333d-1*gammaaa*t33*t7*t8+1.066666666666
     1         6667d-1*t2*t32*t5*t7-2.1333333333333337d-1*t1*t2*t32*t5+4
     2         .2666666666666675d-2*t1*t29*t30*t31
            t35 = 1/rhoa**1.3333333333333333d+0
            t36 = 1/t17
            t37 = 1/t15**2
            t38 = 1/rhoa**1.3333333333333336d+0
            t39 = 1/t11**3
            t40 = 1/rhoa**6.666666666666667d-1
            t41 = -1.3127055298329054d-1*t13*t39*t40-2.0096226153166658d
     1         -3*t38
            t42 = 7.876233178997433d-1*t12*t41-1.3127055298329054d-1*t14
     1         *t39*t40
            t43 = 2.11607075208357d-1*t12*t16*t40-1.269642451250142d+0*t
     1         11*t37*t42
            t44 = 1/t25
            t45 = 1/t23**2
            t46 = -1.3127055298329054d-1*t21*t39*t40-3.169132786263567d-
     1         3*t38
            t47 = 7.876233178997433d-1*t12*t46-1.3127055298329054d-1*t22
     1         *t39*t40
            t48 = 2.11607075208357d-1*t12*t24*t40-1.269642451250142d+0*t
     1         11*t45*t47
            t49 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t48-3.10907d-
     1         2*t20*t36*t43-2.747773264188438d-3*t26*t35+1.321039893133
     2         9265d-3*t18*t35)-6.21814d-2*t27*t44*t48+2.747773264188438
     3         d-3*t26*t35
            t50 = 1/rhoa**8
            t51 = -1.6000000000000003d-2*t1*t2*t30*t50
            t52 = 8.000000000000002d-2*gammaaa*t1-4.000000000000001d-2*g
     1         ammaaa*t7
            t53 = 2.0d-1*t3*t7*t8
            t54 = gammaaa**4
            t55 = 1/t4**4
            t56 = 1/rhoa**1.2666666666666665d+1
            t57 = 1/rhoa**10
            t58 = 1/rhoa**7.333333333333333d+0
            t59 = 1/rhoa**4.666666666666667d+0
            t60 = 1.9555555555555554d+0*gammaaa*t59*t7*t8-9.6d-1*t2*t5*t
     1         58*t7+1.1377777777777778d-1*t29*t30*t57*t7+1.351111111111
     2         1113d+0*t1*t2*t5*t58-6.115555555555556d-1*t1*t29*t30*t57+
     3         6.826666666666669d-2*t1*t54*t55*t56
            t61 = 1/rhoa**2.333333333333333d+0
            t62 = 1/t17**2
            t63 = t43**2
            t64 = 1/t15**3
            t65 = t42**2
            t66 = 1/rhoa**2.3333333333333334d+0
            t67 = 1/rhoa**1.6666666666666669d+0
            t68 = 1/t11**5
            t69 = 6.563527649164527d-2*t13*t38*t68+8.751370198886037d-2*
     1         t13*t39*t67+3.0144339229749983d-3*t66
            t70 = 7.876233178997433d-1*t12*t69+6.563527649164527d-2*t14*
     1         t38*t68+8.751370198886037d-2*t14*t39*t67-2.62541105966581
     2         1d-1*t39*t40*t41
            t71 = -1.269642451250142d+0*t11*t37*t70-1.4107138347223802d-
     1         1*t12*t16*t67+2.539284902500284d+0*t11*t64*t65-4.23214150
     2         416714d-1*t12*t37*t40*t42-3.52678458680595d-2*t16*t38*t39
            t72 = 1/t25**2
            t73 = t48**2
            t74 = 1/t23**3
            t75 = t47**2
            t76 = 6.563527649164527d-2*t21*t38*t68+8.751370198886037d-2*
     1         t21*t39*t67+4.753699179395351d-3*t66
            t77 = 7.876233178997433d-1*t12*t76+6.563527649164527d-2*t22*
     1         t38*t68+8.751370198886037d-2*t22*t39*t67-2.62541105966581
     2         1d-1*t39*t40*t46
            t78 = -1.269642451250142d+0*t11*t45*t77+2.539284902500284d+0
     1         *t11*t74*t75-1.4107138347223802d-1*t12*t24*t67-4.23214150
     2         416714d-1*t12*t40*t45*t47-3.52678458680595d-2*t24*t38*t39
            t79 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t78-6.21814d-
     1         2*t27*t72*t73-3.10907d-2*t20*t36*t71+3.10907d-2*t20*t62*t
     2         63+3.663697685584584d-3*t26*t61-1.7613865241785687d-3*t18
     3         *t61-5.495546528376876d-3*t35*t44*t48+2.642079786267853d-
     4         3*t35*t36*t43)-6.21814d-2*t27*t44*t78+6.21814d-2*t27*t72*
     5         t73-3.663697685584584d-3*t26*t61+5.495546528376876d-3*t35
     6         *t44*t48
            t80 = -4.000000000000001d-2*gammaaa*t5*t6*t7+8.0000000000000
     1         02d-2*gammaaa*t1*t5*t6+t53+t51
            t81 = 1/rhoa**1.1666666666666665d+1
            t82 = -2.5600000000000006d-2*t1*t29*t55*t81-5.33333333333333
     1         3d-1*t33*t7*t8+3.2d-1*gammaaa*t32*t5*t7-4.266666666666667
     2         5d-2*t2*t30*t31*t7-4.2666666666666675d-1*gammaaa*t1*t32*t
     3         5+2.1333333333333337d-1*t1*t2*t30*t31
            t83 = 1/rhoa**1.0666666666666666d+1
            t84 = 9.600000000000004d-3*t1*t2*t55*t83
            t85 = -4.0d-1*t52-3.2000000000000006d-2*gammaaa*t1
            t86 = 8.000000000000002d-2*t1
            t87 = t86-8.000000000000002d-2*t7
            t88 = 1/t4**5
            t89 = 1/rhoa**1.3666666666666666d+1
            t90 = 1/rhoa**11
            t91 = 1/rhoa**8.333333333333334d+0
            t92 = 1/rhoa**3.333333333333333d+0
            t93 = 1/rhoa**3.3333333333333337d+0
            t94 = 1/rhoa**2.666666666666667d+0
            t95 = 1/t11**7
            t96 = 1/rhoa**2.0d+0
            t97 = 1/t25**3
            t98 = t48**3
            t99 = -1.269642451250142d+0*t11*t45*(7.876233178997433d-1*t1
     1         2*(-5.469606374303773d-2*t21*t95*t96-1.4585616998143394d-
     2         1*t21*t39*t94-1.1708185015918181d-2*t93-1.312705529832905
     3         4d-1*t21*t66*t68)-5.469606374303773d-2*t22*t95*t96-1.4585
     4         616998143394d-1*t22*t39*t94-3.9381165894987163d-1*t39*t40
     5         *t76-1.3127055298329054d-1*t22*t66*t68+1.9690582947493582
     6         d-1*t38*t46*t68+2.625411059665811d-1*t39*t46*t67)+1.76339
     7         2293402975d-2*t24*t68*t96+2.3511897245373004d-1*t12*t24*t
     8         94+7.617854707500852d+0*t11*t47*t74*t77-6.34821225625071d
     9         -1*t12*t40*t45*t77+1.269642451250142d+0*t12*t40*t74*t75+4
     :         .2321415041671406d-1*t12*t45*t47*t67+7.053569173611901d-2
     ;         *t24*t39*t66-7.617854707500852d+0*t11*t47**3/t23**4+1.058
     <         0353760417849d-1*t38*t39*t45*t47
            t100 = t84-8.000000000000002d-2*t5*t6*t7+1.6000000000000003d
     1         -2*gammaaa*t30*t50*t7+8.000000000000002d-2*t1*t5*t6-6.400
     2         000000000001d-2*gammaaa*t1*t30*t50
            fnc(iq) = 1.0d+0*rhoa*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*rhoa*t49*t9*wght+1.0d+0*t28*t9*wght+
     1         1.0d+0*rhoa*t28*t34*wght+Amat(iq,D1_RA)
            Cmat(iq,D1_GAA) = 1.0d+0*rhoa*t28*(t5*t52*t6+t53+t51)*wght+C
     1         mat(iq,D1_GAA)
            Amat2(iq,D2_RA_RA) = 1.0d+0*rhoa*t79*t9*wght+2.0d+0*t49*t9*w
     1         ght+1.0d+0*rhoa*t28*t60*wght+2.0d+0*rhoa*t34*t49*wght+2.0
     2         d+0*t28*t34*wght+Amat2(iq,D2_RA_RA)
            Cmat2(iq,D2_RA_GAA) = 1.0d+0*rhoa*t28*t82*wght+1.0d+0*rhoa*t
     1         49*t80*wght+1.0d+0*t28*t80*wght+Cmat2(iq,D2_RA_GAA)
            Cmat2(iq,D2_GAA_GAA) = 1.0d+0*rhoa*t28*(t5*t6*t87+t30*t50*t8
     1         5+t84)*wght+Cmat2(iq,D2_GAA_GAA)
            Amat3(iq,D3_RA_RA_RA) = 1.0d+0*rhoa*t9*(9.999999999999991d-1
     1         *(6.21814d-2*t27*t44*t99+1.243628d-1*t27*t97*t98-3.10907d
     2         -2*t20*t36*(-1.269642451250142d+0*t11*t37*(7.876233178997
     3         433d-1*t12*(-5.469606374303773d-2*t13*t95*t96-1.458561699
     4         8143394d-1*t13*t39*t94-7.424439106586571d-3*t93-1.3127055
     5         298329054d-1*t13*t66*t68)-5.469606374303773d-2*t14*t95*t9
     6         6-1.4585616998143394d-1*t14*t39*t94-3.9381165894987163d-1
     7         *t39*t40*t69-1.3127055298329054d-1*t14*t66*t68+1.96905829
     8         47493582d-1*t38*t41*t68+2.625411059665811d-1*t39*t41*t67)
     9         +1.763392293402975d-2*t16*t68*t96+2.3511897245373004d-1*t
     :         12*t16*t94+7.617854707500852d+0*t11*t42*t64*t70-6.3482122
     ;         5625071d-1*t12*t37*t40*t70+4.2321415041671406d-1*t12*t37*
     <         t42*t67+7.053569173611901d-2*t16*t39*t66+1.26964245125014
     =         2d+0*t12*t40*t64*t65-7.617854707500852d+0*t11*t42**3/t15*
     >         *4+1.0580353760417849d-1*t37*t38*t39*t42)-8.5486279330306
     ?         94d-3*t26*t92+4.1099018897499934d-3*t18*t92-1.865442d-1*t
     @         27*t48*t72*t78-8.243319792565315d-3*t35*t44*t78+8.2433197
     1         92565315d-3*t35*t72*t73+9.327209999999999d-2*t20*t43*t62*
     2         t71+3.96311967940178d-3*t35*t36*t71-3.96311967940178d-3*t
     3         35*t62*t63+1.0991093056753751d-2*t44*t48*t61-5.2841595725
     4         35706d-3*t36*t43*t61-6.21814d-2*t20*t43**3/t17**3)-6.2181
     5         4d-2*t27*t44*t99-1.243628d-1*t27*t97*t98+8.54862793303069
     6         4d-3*t26*t92+1.865442d-1*t27*t48*t72*t78+8.24331979256531
     7         5d-3*t35*t44*t78-8.243319792565315d-3*t35*t72*t73-1.09910
     8         93056753751d-2*t44*t48*t61)*wght+1.0d+0*rhoa*t28*(8.08296
     9         2962962963d+0*t2*t5*t7*t91-9.90814814814815d+0*t1*t2*t5*t
     :         91-2.161777777777778d+0*t29*t30*t7*t90+7.556740740740742d
     ;         +0*t1*t29*t30*t90+1.8204444444444445d-1*t54*t55*t7*t89-1.
     <         8432000000000004d+0*t1*t54*t55*t89+1.456355555555556d-1*g
     =         ammaaa**5*t1*t88/rhoa**1.6333333333333333d+1-9.1259259259
     >         25926d+0*gammaaa*t7*t8/rhoa**5.666666666666667d+0)*wght+3
     ?         .0d+0*t79*t9*wght+3.0d+0*rhoa*t34*t79*wght+3.0d+0*rhoa*t4
     @         9*t60*wght+3.0d+0*t28*t60*wght+6.0d+0*t34*t49*wght+Amat3(
     1         iq,D3_RA_RA_RA)
            Cmat3(iq,D3_RA_RA_GAA) = 1.0d+0*rhoa*t28*(-5.461333333333335
     1         d-2*t1*t54*t88/rhoa**1.5333333333333335d+1+1.955555555555
     2         5554d+0*t59*t7*t8-2.311111111111111d+0*gammaaa*t5*t58*t7+
     3         7.253333333333334d-1*t2*t30*t57*t7-6.826666666666669d-2*t
     4         29*t55*t56*t7+2.7022222222222225d+0*gammaaa*t1*t5*t58-2.3
     5         751111111111115d+0*t1*t2*t30*t57+6.400000000000001d-1*t1*
     6         t29*t55*t56)*wght+2.0d+0*rhoa*t49*t82*wght+2.0d+0*t28*t82
     7         *wght+1.0d+0*rhoa*t79*t80*wght+2.0d+0*t49*t80*wght+Cmat3(
     8         iq,D3_RA_RA_GAA)
            Cmat3(iq,D3_RA_GAA_GAA) = 1.0d+0*rhoa*t28*(2.048000000000001
     1         d-2*t1*t29*t88/rhoa**1.4333333333333334d+1+2.560000000000
     2         0006d-2*t2*t55*t7*t81-2.0480000000000004d-1*t1*t2*t55*t81
     3         +4.266666666666667d-1*t32*t5*t7-2.1333333333333335d-1*gam
     4         maaa*t30*t31*t7-4.2666666666666675d-1*t1*t32*t5+5.9733333
     5         33333335d-1*gammaaa*t1*t30*t31)*wght+1.0d+0*rhoa*t100*t49
     6         *wght+1.0d+0*t100*t28*wght+Cmat3(iq,D3_RA_GAA_GAA)
            Cmat3(iq,D3_GAA_GAA_GAA) = 1.0d+0*rhoa*t28*(-7.6800000000000
     1         03d-3*t1*t2*t88/rhoa**1.3333333333333333d+1+t30*t50*(-4.0
     2         d-1*t87-4.0d-1*(t86-4.000000000000001d-2*t7)-3.2000000000
     3         000006d-2*t1)+t55*t83*(1.920000000000001d-2*gammaaa*t1-6.
     4         000000000000001d-1*t85))*wght+Cmat3(iq,D3_GAA_GAA_GAA)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = param(6)
            t2 = gammabb**2
            t3 = 1/rhob**2.6666666666666666d+0
            t4 = 2.0d-1*gammabb*t3+1.0d+0
            t5 = 1/t4**2
            t6 = 1/rhob**5.333333333333333d+0
            t7 = param(4)
            t8 = 1/t4
            t9 = 2.0d-1*gammabb*t3*t7*t8+4.000000000000001d-2*t1*t2*t5*t
     1         6+param(2)
            t10 = rhob**3.333333333333333d-1
            t11 = t10**5.0d-1
            t12 = 1/t11
            t13 = 1.530901310039024d-2*t12+1.0465751434d-1
            t14 = 7.876233178997433d-1*t12*t13+1.9269083139d-1
            t15 = 7.876233178997433d-1*t12*t14+4.3896648423d-1
            t16 = 1/t15
            t17 = 1.269642451250142d+0*t11*t16+1.0d+0
            t18 = log(t17)
            t19 = 1/t10
            t20 = 1.2746961887000874d-1*t19+1.0d+0
            t21 = 2.4141993114533214d-2*t12+1.0186556948d-1
            t22 = 7.876233178997433d-1*t12*t21+2.2308199064d-1
            t23 = 7.876233178997433d-1*t12*t22+4.7231125998d-1
            t24 = 1/t23
            t25 = 1.269642451250142d+0*t11*t24+1.0d+0
            t26 = log(t25)
            t27 = 1.325688999052018d-1*t19+1.0d+0
            t28 = 9.999999999999991d-1*(6.21814d-2*t26*t27-3.10907d-2*t1
     1         8*t20)-6.21814d-2*t26*t27
            t29 = gammabb**3
            t30 = 1/t4**3
            t31 = 1/rhob**9
            t32 = 1/rhob**6.333333333333333d+0
            t33 = 1/rhob**3.6666666666666664d+0
            t34 = -5.333333333333333d-1*gammabb*t33*t7*t8+1.066666666666
     1         6667d-1*t2*t32*t5*t7-2.1333333333333337d-1*t1*t2*t32*t5+4
     2         .2666666666666675d-2*t1*t29*t30*t31
            t35 = 1/rhob**1.3333333333333333d+0
            t36 = 1/t17
            t37 = 1/t15**2
            t38 = 1/rhob**1.3333333333333336d+0
            t39 = 1/t11**3
            t40 = 1/rhob**6.666666666666667d-1
            t41 = -1.3127055298329054d-1*t13*t39*t40-2.0096226153166658d
     1         -3*t38
            t42 = 7.876233178997433d-1*t12*t41-1.3127055298329054d-1*t14
     1         *t39*t40
            t43 = 2.11607075208357d-1*t12*t16*t40-1.269642451250142d+0*t
     1         11*t37*t42
            t44 = 1/t25
            t45 = 1/t23**2
            t46 = -1.3127055298329054d-1*t21*t39*t40-3.169132786263567d-
     1         3*t38
            t47 = 7.876233178997433d-1*t12*t46-1.3127055298329054d-1*t22
     1         *t39*t40
            t48 = 2.11607075208357d-1*t12*t24*t40-1.269642451250142d+0*t
     1         11*t45*t47
            t49 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t48-3.10907d-
     1         2*t20*t36*t43-2.747773264188438d-3*t26*t35+1.321039893133
     2         9265d-3*t18*t35)-6.21814d-2*t27*t44*t48+2.747773264188438
     3         d-3*t26*t35
            t50 = 1/rhob**8
            t51 = -1.6000000000000003d-2*t1*t2*t30*t50
            t52 = 8.000000000000002d-2*gammabb*t1-4.000000000000001d-2*g
     1         ammabb*t7
            t53 = 2.0d-1*t3*t7*t8
            t54 = gammabb**4
            t55 = 1/t4**4
            t56 = 1/rhob**1.2666666666666665d+1
            t57 = 1/rhob**10
            t58 = 1/rhob**7.333333333333333d+0
            t59 = 1/rhob**4.666666666666667d+0
            t60 = 1.9555555555555554d+0*gammabb*t59*t7*t8-9.6d-1*t2*t5*t
     1         58*t7+1.1377777777777778d-1*t29*t30*t57*t7+1.351111111111
     2         1113d+0*t1*t2*t5*t58-6.115555555555556d-1*t1*t29*t30*t57+
     3         6.826666666666669d-2*t1*t54*t55*t56
            t61 = 1/rhob**2.333333333333333d+0
            t62 = 1/t17**2
            t63 = t43**2
            t64 = 1/t15**3
            t65 = t42**2
            t66 = 1/rhob**2.3333333333333334d+0
            t67 = 1/rhob**1.6666666666666669d+0
            t68 = 1/t11**5
            t69 = 6.563527649164527d-2*t13*t38*t68+8.751370198886037d-2*
     1         t13*t39*t67+3.0144339229749983d-3*t66
            t70 = 7.876233178997433d-1*t12*t69+6.563527649164527d-2*t14*
     1         t38*t68+8.751370198886037d-2*t14*t39*t67-2.62541105966581
     2         1d-1*t39*t40*t41
            t71 = -1.269642451250142d+0*t11*t37*t70-1.4107138347223802d-
     1         1*t12*t16*t67+2.539284902500284d+0*t11*t64*t65-4.23214150
     2         416714d-1*t12*t37*t40*t42-3.52678458680595d-2*t16*t38*t39
            t72 = 1/t25**2
            t73 = t48**2
            t74 = 1/t23**3
            t75 = t47**2
            t76 = 6.563527649164527d-2*t21*t38*t68+8.751370198886037d-2*
     1         t21*t39*t67+4.753699179395351d-3*t66
            t77 = 7.876233178997433d-1*t12*t76+6.563527649164527d-2*t22*
     1         t38*t68+8.751370198886037d-2*t22*t39*t67-2.62541105966581
     2         1d-1*t39*t40*t46
            t78 = -1.269642451250142d+0*t11*t45*t77+2.539284902500284d+0
     1         *t11*t74*t75-1.4107138347223802d-1*t12*t24*t67-4.23214150
     2         416714d-1*t12*t40*t45*t47-3.52678458680595d-2*t24*t38*t39
            t79 = 9.999999999999991d-1*(6.21814d-2*t27*t44*t78-6.21814d-
     1         2*t27*t72*t73-3.10907d-2*t20*t36*t71+3.10907d-2*t20*t62*t
     2         63+3.663697685584584d-3*t26*t61-1.7613865241785687d-3*t18
     3         *t61-5.495546528376876d-3*t35*t44*t48+2.642079786267853d-
     4         3*t35*t36*t43)-6.21814d-2*t27*t44*t78+6.21814d-2*t27*t72*
     5         t73-3.663697685584584d-3*t26*t61+5.495546528376876d-3*t35
     6         *t44*t48
            t80 = -4.000000000000001d-2*gammabb*t5*t6*t7+8.0000000000000
     1         02d-2*gammabb*t1*t5*t6+t53+t51
            t81 = 1/rhob**1.1666666666666665d+1
            t82 = -2.5600000000000006d-2*t1*t29*t55*t81-5.33333333333333
     1         3d-1*t33*t7*t8+3.2d-1*gammabb*t32*t5*t7-4.266666666666667
     2         5d-2*t2*t30*t31*t7-4.2666666666666675d-1*gammabb*t1*t32*t
     3         5+2.1333333333333337d-1*t1*t2*t30*t31
            t83 = 1/rhob**1.0666666666666666d+1
            t84 = 9.600000000000004d-3*t1*t2*t55*t83
            t85 = -4.0d-1*t52-3.2000000000000006d-2*gammabb*t1
            t86 = 8.000000000000002d-2*t1
            t87 = t86-8.000000000000002d-2*t7
            t88 = 1/t4**5
            t89 = 1/rhob**1.3666666666666666d+1
            t90 = 1/rhob**11
            t91 = 1/rhob**8.333333333333334d+0
            t92 = 1/rhob**3.333333333333333d+0
            t93 = 1/rhob**3.3333333333333337d+0
            t94 = 1/rhob**2.666666666666667d+0
            t95 = 1/t11**7
            t96 = 1/rhob**2.0d+0
            t97 = 1/t25**3
            t98 = t48**3
            t99 = -1.269642451250142d+0*t11*t45*(7.876233178997433d-1*t1
     1         2*(-5.469606374303773d-2*t21*t95*t96-1.4585616998143394d-
     2         1*t21*t39*t94-1.1708185015918181d-2*t93-1.312705529832905
     3         4d-1*t21*t66*t68)-5.469606374303773d-2*t22*t95*t96-1.4585
     4         616998143394d-1*t22*t39*t94-3.9381165894987163d-1*t39*t40
     5         *t76-1.3127055298329054d-1*t22*t66*t68+1.9690582947493582
     6         d-1*t38*t46*t68+2.625411059665811d-1*t39*t46*t67)+1.76339
     7         2293402975d-2*t24*t68*t96+2.3511897245373004d-1*t12*t24*t
     8         94+7.617854707500852d+0*t11*t47*t74*t77-6.34821225625071d
     9         -1*t12*t40*t45*t77+1.269642451250142d+0*t12*t40*t74*t75+4
     :         .2321415041671406d-1*t12*t45*t47*t67+7.053569173611901d-2
     ;         *t24*t39*t66-7.617854707500852d+0*t11*t47**3/t23**4+1.058
     <         0353760417849d-1*t38*t39*t45*t47
            t100 = t84-8.000000000000002d-2*t5*t6*t7+1.6000000000000003d
     1         -2*gammabb*t30*t50*t7+8.000000000000002d-2*t1*t5*t6-6.400
     2         000000000001d-2*gammabb*t1*t30*t50
            fnc(iq) = 1.0d+0*rhob*t28*t9*wght+fnc(iq)
            Amat(iq,D1_RB) = 1.0d+0*rhob*t49*t9*wght+1.0d+0*t28*t9*wght+
     1         1.0d+0*rhob*t28*t34*wght+Amat(iq,D1_RB)
            Cmat(iq,D1_GBB) = 1.0d+0*rhob*t28*(t5*t52*t6+t53+t51)*wght+C
     1         mat(iq,D1_GBB)
            Amat2(iq,D2_RB_RB) = 1.0d+0*rhob*t79*t9*wght+2.0d+0*t49*t9*w
     1         ght+1.0d+0*rhob*t28*t60*wght+2.0d+0*rhob*t34*t49*wght+2.0
     2         d+0*t28*t34*wght+Amat2(iq,D2_RB_RB)
            Cmat2(iq,D2_RB_GBB) = 1.0d+0*rhob*t28*t82*wght+1.0d+0*rhob*t
     1         49*t80*wght+1.0d+0*t28*t80*wght+Cmat2(iq,D2_RB_GBB)
            Cmat2(iq,D2_GBB_GBB) = 1.0d+0*rhob*t28*(t5*t6*t87+t30*t50*t8
     1         5+t84)*wght+Cmat2(iq,D2_GBB_GBB)
            Amat3(iq,D3_RB_RB_RB) = 1.0d+0*rhob*t9*(9.999999999999991d-1
     1         *(6.21814d-2*t27*t44*t99+1.243628d-1*t27*t97*t98-3.10907d
     2         -2*t20*t36*(-1.269642451250142d+0*t11*t37*(7.876233178997
     3         433d-1*t12*(-5.469606374303773d-2*t13*t95*t96-1.458561699
     4         8143394d-1*t13*t39*t94-7.424439106586571d-3*t93-1.3127055
     5         298329054d-1*t13*t66*t68)-5.469606374303773d-2*t14*t95*t9
     6         6-1.4585616998143394d-1*t14*t39*t94-3.9381165894987163d-1
     7         *t39*t40*t69-1.3127055298329054d-1*t14*t66*t68+1.96905829
     8         47493582d-1*t38*t41*t68+2.625411059665811d-1*t39*t41*t67)
     9         +1.763392293402975d-2*t16*t68*t96+2.3511897245373004d-1*t
     :         12*t16*t94+7.617854707500852d+0*t11*t42*t64*t70-6.3482122
     ;         5625071d-1*t12*t37*t40*t70+4.2321415041671406d-1*t12*t37*
     <         t42*t67+7.053569173611901d-2*t16*t39*t66+1.26964245125014
     =         2d+0*t12*t40*t64*t65-7.617854707500852d+0*t11*t42**3/t15*
     >         *4+1.0580353760417849d-1*t37*t38*t39*t42)-8.5486279330306
     ?         94d-3*t26*t92+4.1099018897499934d-3*t18*t92-1.865442d-1*t
     @         27*t48*t72*t78-8.243319792565315d-3*t35*t44*t78+8.2433197
     1         92565315d-3*t35*t72*t73+9.327209999999999d-2*t20*t43*t62*
     2         t71+3.96311967940178d-3*t35*t36*t71-3.96311967940178d-3*t
     3         35*t62*t63+1.0991093056753751d-2*t44*t48*t61-5.2841595725
     4         35706d-3*t36*t43*t61-6.21814d-2*t20*t43**3/t17**3)-6.2181
     5         4d-2*t27*t44*t99-1.243628d-1*t27*t97*t98+8.54862793303069
     6         4d-3*t26*t92+1.865442d-1*t27*t48*t72*t78+8.24331979256531
     7         5d-3*t35*t44*t78-8.243319792565315d-3*t35*t72*t73-1.09910
     8         93056753751d-2*t44*t48*t61)*wght+1.0d+0*rhob*t28*(8.08296
     9         2962962963d+0*t2*t5*t7*t91-9.90814814814815d+0*t1*t2*t5*t
     :         91-2.161777777777778d+0*t29*t30*t7*t90+7.556740740740742d
     ;         +0*t1*t29*t30*t90+1.8204444444444445d-1*t54*t55*t7*t89-1.
     <         8432000000000004d+0*t1*t54*t55*t89+1.456355555555556d-1*g
     =         ammabb**5*t1*t88/rhob**1.6333333333333333d+1-9.1259259259
     >         25926d+0*gammabb*t7*t8/rhob**5.666666666666667d+0)*wght+3
     ?         .0d+0*t79*t9*wght+3.0d+0*rhob*t34*t79*wght+3.0d+0*rhob*t4
     @         9*t60*wght+3.0d+0*t28*t60*wght+6.0d+0*t34*t49*wght+Amat3(
     1         iq,D3_RB_RB_RB)
            Cmat3(iq,D3_RB_RB_GBB) = 1.0d+0*rhob*t28*(-5.461333333333335
     1         d-2*t1*t54*t88/rhob**1.5333333333333335d+1+1.955555555555
     2         5554d+0*t59*t7*t8-2.311111111111111d+0*gammabb*t5*t58*t7+
     3         7.253333333333334d-1*t2*t30*t57*t7-6.826666666666669d-2*t
     4         29*t55*t56*t7+2.7022222222222225d+0*gammabb*t1*t5*t58-2.3
     5         751111111111115d+0*t1*t2*t30*t57+6.400000000000001d-1*t1*
     6         t29*t55*t56)*wght+2.0d+0*rhob*t49*t82*wght+2.0d+0*t28*t82
     7         *wght+1.0d+0*rhob*t79*t80*wght+2.0d+0*t49*t80*wght+Cmat3(
     8         iq,D3_RB_RB_GBB)
            Cmat3(iq,D3_RB_GBB_GBB) = 1.0d+0*rhob*t28*(2.048000000000001
     1         d-2*t1*t29*t88/rhob**1.4333333333333334d+1+2.560000000000
     2         0006d-2*t2*t55*t7*t81-2.0480000000000004d-1*t1*t2*t55*t81
     3         +4.266666666666667d-1*t32*t5*t7-2.1333333333333335d-1*gam
     4         mabb*t30*t31*t7-4.2666666666666675d-1*t1*t32*t5+5.9733333
     5         33333335d-1*gammabb*t1*t30*t31)*wght+1.0d+0*rhob*t100*t49
     6         *wght+1.0d+0*t100*t28*wght+Cmat3(iq,D3_RB_GBB_GBB)
            Cmat3(iq,D3_GBB_GBB_GBB) = 1.0d+0*rhob*t28*(-7.6800000000000
     1         03d-3*t1*t2*t88/rhob**1.3333333333333333d+1+t30*t50*(-4.0
     2         d-1*t87-4.0d-1*(t86-4.000000000000001d-2*t7)-3.2000000000
     3         000006d-2*t1)+t55*t83*(1.920000000000001d-2*gammabb*t1-6.
     4         000000000000001d-1*t85))*wght+Cmat3(iq,D3_GBB_GBB_GBB)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
