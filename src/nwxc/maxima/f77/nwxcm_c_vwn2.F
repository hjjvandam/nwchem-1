C> \ingroup nwxc 
C> @{ 
C> 
C> \file nwxcm_c_vwn2.F 
C> The nwxcm_c_vwn2 functional 
C> 
C> @} 
C> 
C> \ingroup nwxc_priv 
C> @{ 
C> 
C> \brief Evaluate the nwxcm_c_vwn2 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{\sqrt{{\it t_2}}}}\\\\ 
C>   {\it t_4} &=& 1.575246635799487\,{\it t_3}\\\\ 
C>   {\it t_5} &=& \arctan \left({{6.15199081975908}\over{{\it t_4}+3.72744}}\right)\\\\ 
C>   {\it t_6} &=& .7876233178997433\,{\it t_3}\\\\ 
C>   {\it t_7} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_8} &=& .6203504908994001\,{\it t_7}\\\\ 
C>   {\it t_9} &=& {{1}\over{\left| 2.935818660072219\,{\it t_3}+{\it t_8}+12.9352\right| }}\\\\ 
C>   {\it t_{10}} &=& \log \left(1.0\,\left({\it t_6}+0.10498\right)^2\,{\it t_9}\right)\\\\ 
C>   {\it t_{11}} &=& \left| {\it t_7}\right| \\\\ 
C>   {\it t_{12}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_9}\right)\\\\ 
C>   {\it t_{13}} &=& -\rho_\beta\\\\ 
C>   {\it t_{14}} &=& {\it t_{13}}+\rho_\alpha\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{16}} &=& \left({\it t_{14}}\,{\it t_{15}}+1.0\right)^{{{4}\over{3}}}+\left(1.0-{\it t_{14}}\,{\it t_{15}}\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.692072046645942}\over{{\it t_4}+1.06835}}\right)\\\\ 
C>   {\it t_{18}} &=& {{1}\over{\left| .8414573716781907\,{\it t_3}+{\it t_8}+11.4813\right| }}\\\\ 
C>   {\it t_{19}} &=& \log \left(1.0\,\left({\it t_6}+0.228344\right)^2\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{20}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{21}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_4}+13.072}}\right)\\\\ 
C>   {\it t_{22}} &=& \arctan \left({{1.171685277708971}\over{{\it t_4}+20.1231}}\right)\\\\ 
C>   {\it t_{23}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_3}+{\it t_8}+42.7198\right| }}\\\\ 
C>   {\it t_{24}} &=& \log \left(1.0\,\left({\it t_6}+0.409286\right)^2\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{25}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_3}+{\it t_8}+101.578\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_6}+0.743294\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_3}+{\it t_8}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{31}} &=& {\it t_{30}}^{.3333333333333333}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{\sqrt{{\it t_{31}}}}}\\\\ 
C>   {\it t_{33}} &=& 1.575246635799487\,{\it t_{32}}\\\\ 
C>   {\it t_{34}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{33}}+3.72744}}\right)\\\\ 
C>   {\it t_{35}} &=& .7876233178997433\,{\it t_{32}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{31}}}}\\\\ 
C>   {\it t_{37}} &=& .6203504908994001\,{\it t_{36}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{32}}+{\it t_{37}}+12.9352\right| }}\\\\ 
C>   {\it t_{39}} &=& \log \left(1.0\,\left({\it t_{35}}+0.10498\right)^2\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{40}} &=& \left| {\it t_{36}}\right| \\\\ 
C>   {\it t_{41}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{42}} &=& \rho_s+{\it t_{13}}\\\\ 
C>   {\it t_{43}} &=& \left({{{\it t_{42}}}\over{{\it t_{30}}}}+1.0\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{44}} &=& \arctan \left({{6.692072046645942}\over{{\it t_{33}}+1.06835}}\right)\\\\ 
C>   {\it t_{45}} &=& {{1}\over{\left| .8414573716781907\,{\it t_{32}}+{\it t_{37}}+11.4813\right| }}\\\\ 
C>   {\it t_{46}} &=& \log \left(1.0\,\left({\it t_{35}}+0.228344\right)^2\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{47}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{48}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_{33}}+13.072}}\right)\\\\ 
C>   {\it t_{49}} &=& \arctan \left({{1.171685277708971}\over{{\it t_{33}}+20.1231}}\right)\\\\ 
C>   {\it t_{50}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_{32}}+{\it t_{37}}+42.7198\right| }}\\\\ 
C>   {\it t_{51}} &=& \log \left(1.0\,\left({\it t_{35}}+0.409286\right)^2\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{52}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{53}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_{32}}+{\it t_{37}}+101.578\right| }}\\\\ 
C>   {\it t_{54}} &=& \log \left(1.0\,\left({\it t_{35}}+0.743294\right)^2\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{55}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{56}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{32}}+{\it t_{37}}+18.0578\right| }}\\\\ 
C>   f &=& 1.0\,{\it t_1}\,\left(1.923661050931536\,{\it t_{16}}\,\left(-0.01554535\,{\it t_{28}}-.002667310007273315\,{\it t_{27}}+0.0310907\,{\it t_{25}}+.004431373767749538\,{\it t_{24}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{29}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_6}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{12}}-9.690227711544375 \times 10^{-4}\,{\it t_{10}}-.6188180297906176\,{\it t_{22}}+20.52197293770518\,{\it t_{21}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_4}+7.06042}}\right)-.03878329487811301\,{\it t_5}\right)+1.125\,{\it t_{16}}\,\left({{{\it t_{14}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{28}}+.002667310007273315\,{\it t_{27}}-0.0310907\,{\it t_{25}}-.004431373767749538\,{\it t_{24}}+.6188180297906176\,{\it t_{22}}-20.52197293770518\,{\it t_{21}}\right)+.01688686394038963\,{\it t_{20}}+3.6490335179177674 \times 10^{-4}\,{\it t_{19}}+.005458482358638966\,{\it t_{17}}\right)}\over{{\it t_1}^4}}-.01688686394038963\,{\it t_{20}}-3.6490335179177674 \times 10^{-4}\,{\it t_{19}}-.005458482358638966\,{\it t_{17}}\right)+0.0310907\,{\it t_{12}}+9.690227711544375 \times 10^{-4}\,{\it t_{10}}+.03878329487811301\,{\it t_5}\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,{\it t_{30}}\,\left(1.923661050931536\,{\it t_{43}}\,\left(-0.01554535\,{\it t_{55}}-.002667310007273315\,{\it t_{54}}+0.0310907\,{\it t_{52}}+.004431373767749538\,{\it t_{51}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{56}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_{35}}+0.325\right)^2\,{\it t_{56}}\right)-0.0310907\,{\it t_{41}}-9.690227711544375 \times 10^{-4}\,{\it t_{39}}-.6188180297906176\,{\it t_{49}}+20.52197293770518\,{\it t_{48}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{33}}+7.06042}}\right)-.03878329487811301\,{\it t_{34}}\right)+1.125\,{\it t_{43}}\,\left({{{\it t_{42}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{55}}+.002667310007273315\,{\it t_{54}}-0.0310907\,{\it t_{52}}-.004431373767749538\,{\it t_{51}}+.6188180297906176\,{\it t_{49}}-20.52197293770518\,{\it t_{48}}\right)+.01688686394038963\,{\it t_{47}}+3.6490335179177674 \times 10^{-4}\,{\it t_{46}}+.005458482358638966\,{\it t_{44}}\right)}\over{{\it t_{30}}^4}}-.01688686394038963\,{\it t_{47}}-3.6490335179177674 \times 10^{-4}\,{\it t_{46}}-.005458482358638966\,{\it t_{44}}\right)+0.0310907\,{\it t_{41}}+9.690227711544375 \times 10^{-4}\,{\it t_{39}}+.03878329487811301\,{\it t_{34}}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] SH Vosko, L Wilk, M Nusair, Can.J.Phys. 58, 1200 (1980)  , DOI: 
C> <a href="http://dx.doi.org/10.1139/p80-159 "> 
C> 10.1139/p80-159 </a> 
C> 
      subroutine nwxcm_c_vwn2(param,tol_rho,ipol,nq,wght, 
     +rho,fnc,Amat) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          if (rhoa.gt.tol_rho) then 
            t1 = 1/rhoa**1.6666666666666666d-1
            t2 = 1.4033852085886447d+0*t1+3.72744d+0
            t3 = 7.016926042943223d-1*t1+1.0498d-1
            t4 = t3**2
            t5 = rhoa**3.333333333333333d-1
            t6 = 1/t5
            t7 = 4.9237251092134837d-1*t6
            t8 = t7+2.615517080950829d+0*t1+1.29352d+1
            t9 = 1/t8
            t10 = t7+2.615517080950829d+0/t5**5.0d-1+1.29352d+1
            t11 = 1/t10
            t12 = 9.690227711544375d-4*log(1.0d+0*t4*t9)+3.10907d-2*log(
     1         4.9237251092134837d-1*t11*t6)+3.8783294878113006d-2*atan(
     2         6.15199081975908d+0/t2)
            t13 = 1/t2**2
            t14 = 1/rhoa**1.1666666666666667d+0
            t15 = 1/rhoa**1.3333333333333333d+0
            t16 = -1.6412417030711612d-1*t15-4.359195134918048d-1*t14
            fnc(iq) = 2.0d+0*rhoa*t12*wght+fnc(iq)
            Amat(iq,D1_RA) = 2.0d+0*rhoa*(9.690227711544375d-4*t8*(-2.33
     1         8975347647741d-1*t14*t3*t9-1.0d+0*t16*t4/t8**2)/t4+6.3144
     2         67057030003d-2*t10*t5*(-4.9237251092134837d-1*t16*t6/t10*
     3         *2-1.6412417030711612d-1*t11*t15)+5.580665928883042d-2*t1
     4         3*t14/(3.784699104639999d+1*t13+1))*wght+2.0d+0*t12*wght+
     5         Amat(iq,D1_RA)
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = rhob+rhoa
            t2 = t1**3.333333333333333d-1
            t3 = t2**5.0d-1
            t4 = 1/t3
            t5 = 1.5752466357994865d+0*t4
            t6 = t5+3.72744d+0
            t7 = atan(6.15199081975908d+0/t6)
            t8 = 7.876233178997433d-1*t4
            t9 = t8+1.0498d-1
            t10 = t9**2
            t11 = 1/t2
            t12 = 6.203504908994001d-1*t11
            t13 = 2.935818660072219d+0*t4+t12+1.29352d+1
            t14 = abs(t13)
            t15 = 1/t14
            t16 = log(1.0d+0*t10*t15)
            t17 = abs(t11)
            t18 = log(6.203504908994001d-1*t15*t17)
            t19 = rhoa-rhob
            t20 = 1/t1
            t21 = 1.0d+0-t19*t20
            t22 = t19*t20+1.0d+0
            t23 = t22**1.3333333333333333d+0+t21**1.3333333333333333d+0-
     1         2.0d+0
            t24 = t5+1.0683499999999999d+0
            t25 = atan(6.692072046645942d+0/t24)
            t26 = t8+2.28344d-1
            t27 = t26**2
            t28 = 8.414573716781907d-1*t4+t12+1.14813d+1
            t29 = abs(t28)
            t30 = 1/t29
            t31 = log(1.0d+0*t27*t30)
            t32 = log(6.203504908994001d-1*t17*t30)
            t33 = t19**4
            t34 = 1/t1**4
            t35 = t5+1.3072d+1
            t36 = atan(4.4899888641576796d-2/t35)
            t37 = t5+2.0123100000000002d+1
            t38 = atan(1.171685277708971d+0/t37)
            t39 = t8+4.09286d-1
            t40 = t39**2
            t41 = 1.0295812011585444d+1*t4+t12+4.2719799999999997d+1
            t42 = abs(t41)
            t43 = 1/t42
            t44 = log(1.0d+0*t40*t43)
            t45 = log(6.203504908994001d-1*t17*t43)
            t46 = t8+7.43294d-1
            t47 = t46**2
            t48 = 1.5849422788428325d+1*t4+t12+1.01578d+2
            t49 = abs(t48)
            t50 = 1/t49
            t51 = log(1.0d+0*t47*t50)
            t52 = log(6.203504908994001d-1*t17*t50)
            t53 = 1.709920934161365d+0*(1.554535d-2*t52+2.66731000727331
     1         5d-3*t51-3.10907d-2*t45-4.431373767749538d-3*t44+6.188180
     2         297906176d-1*t38-2.052197293770518d+1*t36)+1.688686394038
     3         963d-2*t32+3.6490335179177674d-4*t31+5.458482358638966d-3
     4         *t25
            t54 = t33*t34*t53-1.688686394038963d-2*t32-3.649033517917767
     1         4d-4*t31-5.458482358638966d-3*t25
            t55 = t5+7.06042d+0
            t56 = t8+3.25d-1
            t57 = t56**2
            t58 = 5.560951426165704d+0*t4+t12+1.8057800000000002d+1
            t59 = abs(t58)
            t60 = 1/t59
            t61 = -3.8783294878113006d-2*t7+2.2478670955426108d-3*log(1.
     1         0d+0*t57*t60)+1.554535d-2*log(6.203504908994001d-1*t17*t6
     2         0)+5.249139316978092d-2*atan(4.7309269095601136d+0/t55)-1
     3         .554535d-2*t52-2.667310007273315d-3*t51+3.10907d-2*t45+4.
     4         431373767749538d-3*t44-6.188180297906176d-1*t38+2.0521972
     5         93770518d+1*t36-3.10907d-2*t18-9.690227711544375d-4*t16
            t62 = 3.8783294878113006d-2*t7+1.923661050931536d+0*t23*t61+
     1         1.1250000000000002d+0*t23*t54+3.10907d-2*t18+9.6902277115
     2         44375d-4*t16
            t63 = 1/t1**6.666666666666667d-1
            t64 = 1/t3**3
            t65 = 1/t6**2
            t66 = 1/(3.784699104639999d+1*t65+1)
            t67 = 6.264085709464389d-2*t63*t64*t65*t66
            t68 = 1/t10
            t69 = -2.067834969664667d-1/t1**1.3333333333333333d+0
            t70 = t69-4.8930311001203647d-1*t63*t64
            t71 = 1/t13
            t72 = -2.625411059665811d-1*t15*t63*t64*t9-1.0d+0*t10*t15*t7
     1         0*t71
            t73 = 9.690227711544375d-4*t14*t68*t72
            t74 = 1/t17
            t75 = 1/t1**1.6666666666666666d+0
            t76 = -2.067834969664667d-1*t15*t74*t75-6.203504908994001d-1
     1         *t15*t17*t70*t71
            t77 = 5.011795824473985d-2*t14*t74*t76
            t78 = 1/t55**2
            t79 = 1/t35**2
            t80 = 1/(2.016000000025997d-3*t79+1)
            t81 = 1/t37**2
            t82 = 1/(1.3728463899999485d+0*t81+1)
            t83 = t69-9.26825237694284d-1*t63*t64
            t84 = 1/t58
            t85 = 1/t40
            t86 = t69-1.715968668597574d+0*t63*t64
            t87 = 1/t41
            t88 = -1.0d+0*t40*t43*t86*t87-2.625411059665811d-1*t39*t43*t
     1         63*t64
            t89 = -6.203504908994001d-1*t17*t43*t86*t87-2.06783496966466
     1         7d-1*t43*t74*t75
            t90 = 1/t47
            t91 = t69-2.641570464738054d+0*t63*t64
            t92 = 1/t48
            t93 = -1.0d+0*t47*t50*t91*t92-2.625411059665811d-1*t46*t50*t
     1         63*t64
            t94 = -6.203504908994001d-1*t17*t50*t91*t92-2.06783496966466
     1         7d-1*t50*t74*t75
            t95 = 1.923661050931536d+0*t23*(-2.5058979122369923d-2*t49*t
     1         74*t94-2.667310007273315d-3*t49*t90*t93+5.011795824473985
     2         d-2*t42*t74*t89+4.431373767749538d-3*t42*t85*t88+2.247867
     3         0955426108d-3*t59*(-1.0d+0*t57*t60*t83*t84-2.625411059665
     4         811d-1*t56*t60*t63*t64)/t57+2.5058979122369923d-2*t59*t74
     5         *(-6.203504908994001d-1*t17*t60*t83*t84-2.067834969664667
     6         d-1*t60*t74*t75)-1.9035804775132142d-1*t63*t64*t81*t82+2.
     7         4191438009473537d-1*t63*t64*t79*t80+6.519760588836059d-2*
     8         t63*t64*t78/(2.238166942360001d+1*t78+1)-5.01179582447398
     9         5d-2*t14*t74*t76-9.690227711544375d-4*t14*t68*t72-6.26408
     :         5709464389d-2*t63*t64*t65*t66)
            t96 = 1/t24**2
            t97 = 1/(4.4783828277500004d+1*t96+1)
            t98 = -9.590247809108334d-3*t63*t64*t96*t97
            t99 = 1/t27
            t100 = t69-1.4024289527969844d-1*t63*t64
            t101 = 1/t28
            t102 = -2.625411059665811d-1*t26*t30*t63*t64-1.0d+0*t100*t10
     1         1*t27*t30
            t103 = -3.6490335179177674d-4*t102*t29*t99
            t104 = -2.067834969664667d-1*t30*t74*t75-6.203504908994001d-
     1         1*t100*t101*t17*t30
            t105 = -2.722148880047894d-2*t104*t29*t74
            t106 = t33*t34*(3.6490335179177674d-4*t102*t29*t99+9.5902478
     1         09108334d-3*t63*t64*t96*t97+1.709920934161365d+0*(2.50589
     2         79122369923d-2*t49*t74*t94+2.667310007273315d-3*t49*t90*t
     3         93-5.011795824473985d-2*t42*t74*t89-4.431373767749538d-3*
     4         t42*t85*t88+1.9035804775132142d-1*t63*t64*t81*t82-2.41914
     5         38009473537d-1*t63*t64*t79*t80)+2.722148880047894d-2*t104
     6         *t29*t74)
            t107 = -4*t33*t53/t1**5
            t108 = t19**3
            t109 = 1/t1**2
            t110 = t109*t19
            t111 = -t20
            t112 = t21**3.333333333333333d-1
            t113 = -t109*t19
            t114 = t22**3.333333333333333d-1
            t115 = 1.3333333333333333d+0*t114*(t20+t113)+1.3333333333333
     1         333d+0*(t111+t110)*t112
            t116 = 1.0d+0*t62*wght
            t117 = 1.3333333333333333d+0*t112*(t20+t110)+1.3333333333333
     1         333d+0*(t113+t111)*t114
            fnc(iq) = 1.0d+0*t1*t62*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*t1*(1.1250000000000002d+0*t23*(t98+4
     1         *t108*t34*t53+t107+t106+t105+t103)+t95+t77+t73+t67+1.9236
     2         61050931536d+0*t115*t61+1.1250000000000002d+0*t115*t54)*w
     3         ght+t116+Amat(iq,D1_RA)
            Amat(iq,D1_RB) = 1.0d+0*t1*(1.1250000000000002d+0*t23*(t98-4
     1         *t108*t34*t53+t107+t106+t105+t103)+t95+t77+t73+t67+1.9236
     2         61050931536d+0*t117*t61+1.1250000000000002d+0*t117*t54)*w
     3         ght+t116+Amat(iq,D1_RB)
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
            t1 = rhob+rhoa
            t2 = t1**3.333333333333333d-1
            t3 = t2**5.0d-1
            t4 = 1/t3
            t5 = 1.5752466357994865d+0*t4
            t6 = t5+3.72744d+0
            t7 = atan(6.15199081975908d+0/t6)
            t8 = 7.876233178997433d-1*t4
            t9 = t8+1.0498d-1
            t10 = t9**2
            t11 = 1/t2
            t12 = 6.203504908994001d-1*t11
            t13 = 2.935818660072219d+0*t4+t12+1.29352d+1
            t14 = abs(t13)
            t15 = 1/t14
            t16 = log(1.0d+0*t10*t15)
            t17 = abs(t11)
            t18 = log(6.203504908994001d-1*t15*t17)
            t19 = rhoa-rhob
            t20 = 1/t1
            t21 = t19*t20+1.0d+0
            t22 = t21**1.3333333333333333d+0-2.0d+0
            t23 = t5+1.0683499999999999d+0
            t24 = atan(6.692072046645942d+0/t23)
            t25 = t8+2.28344d-1
            t26 = t25**2
            t27 = 8.414573716781907d-1*t4+t12+1.14813d+1
            t28 = abs(t27)
            t29 = 1/t28
            t30 = log(1.0d+0*t26*t29)
            t31 = log(6.203504908994001d-1*t17*t29)
            t32 = t19**4
            t33 = 1/t1**4
            t34 = t5+1.3072d+1
            t35 = atan(4.4899888641576796d-2/t34)
            t36 = t5+2.0123100000000002d+1
            t37 = atan(1.171685277708971d+0/t36)
            t38 = t8+4.09286d-1
            t39 = t38**2
            t40 = 1.0295812011585444d+1*t4+t12+4.2719799999999997d+1
            t41 = abs(t40)
            t42 = 1/t41
            t43 = log(1.0d+0*t39*t42)
            t44 = log(6.203504908994001d-1*t17*t42)
            t45 = t8+7.43294d-1
            t46 = t45**2
            t47 = 1.5849422788428325d+1*t4+t12+1.01578d+2
            t48 = abs(t47)
            t49 = 1/t48
            t50 = log(1.0d+0*t46*t49)
            t51 = log(6.203504908994001d-1*t17*t49)
            t52 = 1.709920934161365d+0*(1.554535d-2*t51+2.66731000727331
     1         5d-3*t50-3.10907d-2*t44-4.431373767749538d-3*t43+6.188180
     2         297906176d-1*t37-2.052197293770518d+1*t35)+1.688686394038
     3         963d-2*t31+3.6490335179177674d-4*t30+5.458482358638966d-3
     4         *t24
            t53 = t32*t33*t52-1.688686394038963d-2*t31-3.649033517917767
     1         4d-4*t30-5.458482358638966d-3*t24
            t54 = t5+7.06042d+0
            t55 = t8+3.25d-1
            t56 = t55**2
            t57 = 5.560951426165704d+0*t4+t12+1.8057800000000002d+1
            t58 = abs(t57)
            t59 = 1/t58
            t60 = -3.8783294878113006d-2*t7+2.2478670955426108d-3*log(1.
     1         0d+0*t56*t59)+1.554535d-2*log(6.203504908994001d-1*t17*t5
     2         9)+5.249139316978092d-2*atan(4.7309269095601136d+0/t54)-1
     3         .554535d-2*t51-2.667310007273315d-3*t50+3.10907d-2*t44+4.
     4         431373767749538d-3*t43-6.188180297906176d-1*t37+2.0521972
     5         93770518d+1*t35-3.10907d-2*t18-9.690227711544375d-4*t16
            t61 = 3.8783294878113006d-2*t7+1.923661050931536d+0*t22*t60+
     1         1.1250000000000002d+0*t22*t53+3.10907d-2*t18+9.6902277115
     2         44375d-4*t16
            t62 = 1/t1**6.666666666666667d-1
            t63 = 1/t3**3
            t64 = 1/t6**2
            t65 = 1/(3.784699104639999d+1*t64+1)
            t66 = 1/t10
            t67 = -2.067834969664667d-1/t1**1.3333333333333333d+0
            t68 = t67-4.8930311001203647d-1*t62*t63
            t69 = 1/t13
            t70 = -2.625411059665811d-1*t15*t62*t63*t9-1.0d+0*t10*t15*t6
     1         8*t69
            t71 = 1/t17
            t72 = 1/t1**1.6666666666666666d+0
            t73 = -2.067834969664667d-1*t15*t71*t72-6.203504908994001d-1
     1         *t15*t17*t68*t69
            t74 = 1/t54**2
            t75 = 1/t34**2
            t76 = 1/(2.016000000025997d-3*t75+1)
            t77 = 1/t36**2
            t78 = 1/(1.3728463899999485d+0*t77+1)
            t79 = t67-9.26825237694284d-1*t62*t63
            t80 = 1/t57
            t81 = 1/t39
            t82 = t67-1.715968668597574d+0*t62*t63
            t83 = 1/t40
            t84 = -1.0d+0*t39*t42*t82*t83-2.625411059665811d-1*t38*t42*t
     1         62*t63
            t85 = -6.203504908994001d-1*t17*t42*t82*t83-2.06783496966466
     1         7d-1*t42*t71*t72
            t86 = 1/t46
            t87 = t67-2.641570464738054d+0*t62*t63
            t88 = 1/t47
            t89 = -1.0d+0*t46*t49*t87*t88-2.625411059665811d-1*t45*t49*t
     1         62*t63
            t90 = -6.203504908994001d-1*t17*t49*t87*t88-2.06783496966466
     1         7d-1*t49*t71*t72
            t91 = 1/t23**2
            t92 = 1/(4.4783828277500004d+1*t91+1)
            t93 = 1/t26
            t94 = t67-1.4024289527969844d-1*t62*t63
            t95 = 1/t27
            t96 = -1.0d+0*t26*t29*t94*t95-2.625411059665811d-1*t25*t29*t
     1         62*t63
            t97 = -6.203504908994001d-1*t17*t29*t94*t95-2.06783496966466
     1         7d-1*t29*t71*t72
            t98 = t20-t19/t1**2
            t99 = t21**3.333333333333333d-1
            fnc(iq) = 1.0d+0*t1*t61*wght+fnc(iq)
            Amat(iq,D1_RA) = 1.0d+0*t1*(2.564881401242048d+0*t60*t98*t99
     1         +1.5000000000000002d+0*t53*t98*t99+1.1250000000000002d+0*
     2         t22*(t32*t33*(2.722148880047894d-2*t28*t71*t97+3.64903351
     3         79177674d-4*t28*t93*t96+9.590247809108334d-3*t62*t63*t91*
     4         t92+1.709920934161365d+0*(2.5058979122369923d-2*t48*t71*t
     5         90+2.667310007273315d-3*t48*t86*t89-5.011795824473985d-2*
     6         t41*t71*t85-4.431373767749538d-3*t41*t81*t84+1.9035804775
     7         132142d-1*t62*t63*t77*t78-2.4191438009473537d-1*t62*t63*t
     8         75*t76))-2.722148880047894d-2*t28*t71*t97-3.6490335179177
     9         674d-4*t28*t93*t96-9.590247809108334d-3*t62*t63*t91*t92+4
     :         *t19**3*t33*t52-4*t32*t52/t1**5)+1.923661050931536d+0*t22
     ;         *(-2.5058979122369923d-2*t48*t71*t90-2.667310007273315d-3
     <         *t48*t86*t89+5.011795824473985d-2*t41*t71*t85+4.431373767
     =         749538d-3*t41*t81*t84+2.2478670955426108d-3*t58*(-1.0d+0*
     >         t56*t59*t79*t80-2.625411059665811d-1*t55*t59*t62*t63)/t56
     ?         +2.5058979122369923d-2*t58*t71*(-6.203504908994001d-1*t17
     @         *t59*t79*t80-2.067834969664667d-1*t59*t71*t72)-1.90358047
     1         75132142d-1*t62*t63*t77*t78+2.4191438009473537d-1*t62*t63
     2         *t75*t76+6.519760588836059d-2*t62*t63*t74/(2.238166942360
     3         001d+1*t74+1)-5.011795824473985d-2*t14*t71*t73-9.69022771
     4         1544375d-4*t14*t66*t70-6.264085709464389d-2*t62*t63*t64*t
     5         65)+5.011795824473985d-2*t14*t71*t73+9.690227711544375d-4
     6         *t14*t66*t70+6.264085709464389d-2*t62*t63*t64*t65)*wght+1
     7         .0d+0*t61*wght+Amat(iq,D1_RA)
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
            t1 = 1/rhob**1.6666666666666666d-1
            t2 = 1.4033852085886447d+0*t1
            t3 = t2+3.72744d+0
            t4 = atan(6.15199081975908d+0/t3)
            t5 = 7.016926042943223d-1*t1
            t6 = t5+1.0498d-1
            t7 = t6**2
            t8 = rhob**3.333333333333333d-1
            t9 = 1/t8
            t10 = 4.9237251092134837d-1*t9
            t11 = t10+2.615517080950829d+0*t1+1.29352d+1
            t12 = 1/t11
            t13 = log(1.0d+0*t12*t7)
            t14 = 2.615517080950829d+0/t8**5.0d-1+t10+1.29352d+1
            t15 = 1/t14
            t16 = t5+2.28344d-1
            t17 = t16**2
            t18 = t10+7.496532937978392d-1*t1+1.14813d+1
            t19 = 1/t18
            t20 = t2+1.0683499999999999d+0
            t21 = t2+7.06042d+0
            t22 = t2+1.3072d+1
            t23 = t2+2.0123100000000002d+1
            t24 = t5+3.25d-1
            t25 = t24**2
            t26 = t10+4.954244497211719d+0*t1+1.8057800000000002d+1
            t27 = 1/t26
            t28 = t5+4.09286d-1
            t29 = t28**2
            t30 = t10+9.172525723335381d+0*t1+4.2719799999999997d+1
            t31 = 1/t30
            t32 = t5+7.43294d-1
            t33 = t32**2
            t34 = t10+1.412023044547508d+1*t1+1.01578d+2
            t35 = 1/t34
            t36 = -1.923661050931536d+0*(-1.554535d-2*log(4.923725109213
     1         4837d-1*t35*t9)+3.10907d-2*log(4.9237251092134837d-1*t31*
     2         t9)+1.554535d-2*log(4.9237251092134837d-1*t27*t9)-3.10907
     3         d-2*log(4.9237251092134837d-1*t12*t9)-3.8783294878113006d
     4         -2*t4-2.667310007273315d-3*log(1.0d+0*t33*t35)+4.43137376
     5         7749538d-3*log(1.0d+0*t29*t31)+2.2478670955426108d-3*log(
     6         1.0d+0*t25*t27)-6.188180297906176d-1*atan(1.1716852777089
     7         71d+0/t23)+2.052197293770518d+1*atan(4.4899888641576796d-
     8         2/t22)+5.249139316978092d-2*atan(4.7309269095601136d+0/t2
     9         1)-9.690227711544375d-4*t13)-1.1250000000000002d+0*(-1.68
     :         8686394038963d-2*log(4.9237251092134837d-1*t19*t9)-5.4584
     ;         82358638966d-3*atan(6.692072046645942d+0/t20)-3.649033517
     <         9177674d-4*log(1.0d+0*t17*t19))+3.10907d-2*log(4.92372510
     =         92134837d-1*t15*t9)+3.8783294878113006d-2*t4+9.6902277115
     >         44375d-4*t13
            t37 = 1/t3**2
            t38 = 1/(3.784699104639999d+1*t37+1)
            t39 = 1/rhob**1.1666666666666667d+0
            t40 = 1/rhob**1.3333333333333333d+0
            t41 = -1.6412417030711612d-1*t40
            t42 = t41-4.359195134918048d-1*t39
            t43 = 1/t11**2
            t44 = -1.0d+0*t42*t43*t7-2.338975347647741d-1*t12*t39*t6
            t45 = 1/t7
            t46 = 1/t20**2
            t47 = t41-1.249422156329732d-1*t39
            t48 = 1/t18**2
            t49 = 1/t21**2
            t50 = 1/t22**2
            t51 = 1/t23**2
            t52 = t41-8.257074162019531d-1*t39
            t53 = 1/t26**2
            t54 = t41-1.5287542872225635d+0*t39
            t55 = 1/t30**2
            t56 = t41-2.3533717409125127d+0*t39
            t57 = 1/t34**2
            fnc(iq) = 2.0d+0*rhob*t36*wght+fnc(iq)
            Amat(iq,D1_RB) = 2.0d+0*rhob*(-1.923661050931536d+0*(-3.1572
     1         335285150016d-2*t34*t8*(-4.9237251092134837d-1*t56*t57*t9
     2         -1.6412417030711612d-1*t35*t40)+6.314467057030003d-2*t30*
     3         t8*(-4.9237251092134837d-1*t54*t55*t9-1.6412417030711612d
     4         -1*t31*t40)+3.1572335285150016d-2*t26*t8*(-4.923725109213
     5         4837d-1*t52*t53*t9-1.6412417030711612d-1*t27*t40)-6.31446
     6         7057030003d-2*t11*t8*(-4.9237251092134837d-1*t42*t43*t9-1
     7         .6412417030711612d-1*t12*t40)-2.667310007273315d-3*t34*(-
     8         1.0d+0*t33*t56*t57-2.338975347647741d-1*t32*t35*t39)/t33+
     9         4.431373767749538d-3*t30*(-1.0d+0*t29*t54*t55-2.338975347
     :         647741d-1*t28*t31*t39)/t29+2.2478670955426108d-3*t26*(-1.
     ;         0d+0*t25*t52*t53-2.338975347647741d-1*t24*t27*t39)/t25-1.
     <         695897407293498d-1*t39*t51/(1.3728463899999485d+0*t51+1)+
     =         2.1552121112611455d-1*t39*t50/(2.016000000025997d-3*t50+1
     >         )+5.808446351175949d-2*t39*t49/(2.238166942360001d+1*t49+
     ?         1)-9.690227711544375d-4*t11*t44*t45-5.580665928883042d-2*
     @         t37*t38*t39)-1.1250000000000002d+0*(-3.429692674920095d-2
     1         *t18*t8*(-4.9237251092134837d-1*t47*t48*t9-1.641241703071
     2         1612d-1*t19*t40)-3.6490335179177674d-4*t18*(-1.0d+0*t17*t
     3         47*t48-2.338975347647741d-1*t16*t19*t39)/t17-8.5439394797
     4         82815d-3*t39*t46/(4.4783828277500004d+1*t46+1))+6.3144670
     5         57030003d-2*t14*t8*(-4.9237251092134837d-1*t42*t9/t14**2-
     6         1.6412417030711612d-1*t15*t40)+9.690227711544375d-4*t11*t
     7         44*t45+5.580665928883042d-2*t37*t38*t39)*wght+2.0d+0*t36*
     8         wght+Amat(iq,D1_RB)
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_vwn2 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{\sqrt{{\it t_2}}}}\\\\ 
C>   {\it t_4} &=& 1.575246635799487\,{\it t_3}\\\\ 
C>   {\it t_5} &=& \arctan \left({{6.15199081975908}\over{{\it t_4}+3.72744}}\right)\\\\ 
C>   {\it t_6} &=& .7876233178997433\,{\it t_3}\\\\ 
C>   {\it t_7} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_8} &=& .6203504908994001\,{\it t_7}\\\\ 
C>   {\it t_9} &=& {{1}\over{\left| 2.935818660072219\,{\it t_3}+{\it t_8}+12.9352\right| }}\\\\ 
C>   {\it t_{10}} &=& \log \left(1.0\,\left({\it t_6}+0.10498\right)^2\,{\it t_9}\right)\\\\ 
C>   {\it t_{11}} &=& \left| {\it t_7}\right| \\\\ 
C>   {\it t_{12}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_9}\right)\\\\ 
C>   {\it t_{13}} &=& -\rho_\beta\\\\ 
C>   {\it t_{14}} &=& {\it t_{13}}+\rho_\alpha\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{16}} &=& \left({\it t_{14}}\,{\it t_{15}}+1.0\right)^{{{4}\over{3}}}+\left(1.0-{\it t_{14}}\,{\it t_{15}}\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.692072046645942}\over{{\it t_4}+1.06835}}\right)\\\\ 
C>   {\it t_{18}} &=& {{1}\over{\left| .8414573716781907\,{\it t_3}+{\it t_8}+11.4813\right| }}\\\\ 
C>   {\it t_{19}} &=& \log \left(1.0\,\left({\it t_6}+0.228344\right)^2\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{20}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{21}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_4}+13.072}}\right)\\\\ 
C>   {\it t_{22}} &=& \arctan \left({{1.171685277708971}\over{{\it t_4}+20.1231}}\right)\\\\ 
C>   {\it t_{23}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_3}+{\it t_8}+42.7198\right| }}\\\\ 
C>   {\it t_{24}} &=& \log \left(1.0\,\left({\it t_6}+0.409286\right)^2\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{25}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_3}+{\it t_8}+101.578\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_6}+0.743294\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_3}+{\it t_8}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{31}} &=& {\it t_{30}}^{.3333333333333333}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{\sqrt{{\it t_{31}}}}}\\\\ 
C>   {\it t_{33}} &=& 1.575246635799487\,{\it t_{32}}\\\\ 
C>   {\it t_{34}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{33}}+3.72744}}\right)\\\\ 
C>   {\it t_{35}} &=& .7876233178997433\,{\it t_{32}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{31}}}}\\\\ 
C>   {\it t_{37}} &=& .6203504908994001\,{\it t_{36}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{32}}+{\it t_{37}}+12.9352\right| }}\\\\ 
C>   {\it t_{39}} &=& \log \left(1.0\,\left({\it t_{35}}+0.10498\right)^2\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{40}} &=& \left| {\it t_{36}}\right| \\\\ 
C>   {\it t_{41}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{42}} &=& \rho_s+{\it t_{13}}\\\\ 
C>   {\it t_{43}} &=& \left({{{\it t_{42}}}\over{{\it t_{30}}}}+1.0\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{44}} &=& \arctan \left({{6.692072046645942}\over{{\it t_{33}}+1.06835}}\right)\\\\ 
C>   {\it t_{45}} &=& {{1}\over{\left| .8414573716781907\,{\it t_{32}}+{\it t_{37}}+11.4813\right| }}\\\\ 
C>   {\it t_{46}} &=& \log \left(1.0\,\left({\it t_{35}}+0.228344\right)^2\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{47}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{48}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_{33}}+13.072}}\right)\\\\ 
C>   {\it t_{49}} &=& \arctan \left({{1.171685277708971}\over{{\it t_{33}}+20.1231}}\right)\\\\ 
C>   {\it t_{50}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_{32}}+{\it t_{37}}+42.7198\right| }}\\\\ 
C>   {\it t_{51}} &=& \log \left(1.0\,\left({\it t_{35}}+0.409286\right)^2\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{52}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{53}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_{32}}+{\it t_{37}}+101.578\right| }}\\\\ 
C>   {\it t_{54}} &=& \log \left(1.0\,\left({\it t_{35}}+0.743294\right)^2\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{55}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{56}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{32}}+{\it t_{37}}+18.0578\right| }}\\\\ 
C>   f &=& 1.0\,{\it t_1}\,\left(1.923661050931536\,{\it t_{16}}\,\left(-0.01554535\,{\it t_{28}}-.002667310007273315\,{\it t_{27}}+0.0310907\,{\it t_{25}}+.004431373767749538\,{\it t_{24}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{29}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_6}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{12}}-9.690227711544375 \times 10^{-4}\,{\it t_{10}}-.6188180297906176\,{\it t_{22}}+20.52197293770518\,{\it t_{21}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_4}+7.06042}}\right)-.03878329487811301\,{\it t_5}\right)+1.125\,{\it t_{16}}\,\left({{{\it t_{14}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{28}}+.002667310007273315\,{\it t_{27}}-0.0310907\,{\it t_{25}}-.004431373767749538\,{\it t_{24}}+.6188180297906176\,{\it t_{22}}-20.52197293770518\,{\it t_{21}}\right)+.01688686394038963\,{\it t_{20}}+3.6490335179177674 \times 10^{-4}\,{\it t_{19}}+.005458482358638966\,{\it t_{17}}\right)}\over{{\it t_1}^4}}-.01688686394038963\,{\it t_{20}}-3.6490335179177674 \times 10^{-4}\,{\it t_{19}}-.005458482358638966\,{\it t_{17}}\right)+0.0310907\,{\it t_{12}}+9.690227711544375 \times 10^{-4}\,{\it t_{10}}+.03878329487811301\,{\it t_5}\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,{\it t_{30}}\,\left(1.923661050931536\,{\it t_{43}}\,\left(-0.01554535\,{\it t_{55}}-.002667310007273315\,{\it t_{54}}+0.0310907\,{\it t_{52}}+.004431373767749538\,{\it t_{51}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{56}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_{35}}+0.325\right)^2\,{\it t_{56}}\right)-0.0310907\,{\it t_{41}}-9.690227711544375 \times 10^{-4}\,{\it t_{39}}-.6188180297906176\,{\it t_{49}}+20.52197293770518\,{\it t_{48}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{33}}+7.06042}}\right)-.03878329487811301\,{\it t_{34}}\right)+1.125\,{\it t_{43}}\,\left({{{\it t_{42}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{55}}+.002667310007273315\,{\it t_{54}}-0.0310907\,{\it t_{52}}-.004431373767749538\,{\it t_{51}}+.6188180297906176\,{\it t_{49}}-20.52197293770518\,{\it t_{48}}\right)+.01688686394038963\,{\it t_{47}}+3.6490335179177674 \times 10^{-4}\,{\it t_{46}}+.005458482358638966\,{\it t_{44}}\right)}\over{{\it t_{30}}^4}}-.01688686394038963\,{\it t_{47}}-3.6490335179177674 \times 10^{-4}\,{\it t_{46}}-.005458482358638966\,{\it t_{44}}\right)+0.0310907\,{\it t_{41}}+9.690227711544375 \times 10^{-4}\,{\it t_{39}}+.03878329487811301\,{\it t_{34}}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] SH Vosko, L Wilk, M Nusair, Can.J.Phys. 58, 1200 (1980)  , DOI: 
C> <a href="http://dx.doi.org/10.1139/p80-159 "> 
C> 10.1139/p80-159 </a> 
C> 
      subroutine nwxcm_c_vwn2_d2(param,tol_rho,ipol,nq,wght, 
     +rho,fnc,Amat,Amat2) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
c 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> 
C> \brief Evaluate the nwxcm_c_vwn2 functional [1] 
C> 
C> \f{eqnarray*}{ 
C>   {\it t_1} &=& \rho_\beta+\rho_\alpha\\\\ 
C>   {\it t_2} &=& {\it t_1}^{.3333333333333333}\\\\ 
C>   {\it t_3} &=& {{1}\over{\sqrt{{\it t_2}}}}\\\\ 
C>   {\it t_4} &=& 1.575246635799487\,{\it t_3}\\\\ 
C>   {\it t_5} &=& \arctan \left({{6.15199081975908}\over{{\it t_4}+3.72744}}\right)\\\\ 
C>   {\it t_6} &=& .7876233178997433\,{\it t_3}\\\\ 
C>   {\it t_7} &=& {{1}\over{{\it t_2}}}\\\\ 
C>   {\it t_8} &=& .6203504908994001\,{\it t_7}\\\\ 
C>   {\it t_9} &=& {{1}\over{\left| 2.935818660072219\,{\it t_3}+{\it t_8}+12.9352\right| }}\\\\ 
C>   {\it t_{10}} &=& \log \left(1.0\,\left({\it t_6}+0.10498\right)^2\,{\it t_9}\right)\\\\ 
C>   {\it t_{11}} &=& \left| {\it t_7}\right| \\\\ 
C>   {\it t_{12}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_9}\right)\\\\ 
C>   {\it t_{13}} &=& -\rho_\beta\\\\ 
C>   {\it t_{14}} &=& {\it t_{13}}+\rho_\alpha\\\\ 
C>   {\it t_{15}} &=& {{1}\over{{\it t_1}}}\\\\ 
C>   {\it t_{16}} &=& \left({\it t_{14}}\,{\it t_{15}}+1.0\right)^{{{4}\over{3}}}+\left(1.0-{\it t_{14}}\,{\it t_{15}}\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{17}} &=& \arctan \left({{6.692072046645942}\over{{\it t_4}+1.06835}}\right)\\\\ 
C>   {\it t_{18}} &=& {{1}\over{\left| .8414573716781907\,{\it t_3}+{\it t_8}+11.4813\right| }}\\\\ 
C>   {\it t_{19}} &=& \log \left(1.0\,\left({\it t_6}+0.228344\right)^2\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{20}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{18}}\right)\\\\ 
C>   {\it t_{21}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_4}+13.072}}\right)\\\\ 
C>   {\it t_{22}} &=& \arctan \left({{1.171685277708971}\over{{\it t_4}+20.1231}}\right)\\\\ 
C>   {\it t_{23}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_3}+{\it t_8}+42.7198\right| }}\\\\ 
C>   {\it t_{24}} &=& \log \left(1.0\,\left({\it t_6}+0.409286\right)^2\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{25}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{23}}\right)\\\\ 
C>   {\it t_{26}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_3}+{\it t_8}+101.578\right| }}\\\\ 
C>   {\it t_{27}} &=& \log \left(1.0\,\left({\it t_6}+0.743294\right)^2\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{28}} &=& \log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{26}}\right)\\\\ 
C>   {\it t_{29}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_3}+{\it t_8}+18.0578\right| }}\\\\ 
C>   {\it t_{30}} &=& \rho_s+\rho_\beta\\\\ 
C>   {\it t_{31}} &=& {\it t_{30}}^{.3333333333333333}\\\\ 
C>   {\it t_{32}} &=& {{1}\over{\sqrt{{\it t_{31}}}}}\\\\ 
C>   {\it t_{33}} &=& 1.575246635799487\,{\it t_{32}}\\\\ 
C>   {\it t_{34}} &=& \arctan \left({{6.15199081975908}\over{{\it t_{33}}+3.72744}}\right)\\\\ 
C>   {\it t_{35}} &=& .7876233178997433\,{\it t_{32}}\\\\ 
C>   {\it t_{36}} &=& {{1}\over{{\it t_{31}}}}\\\\ 
C>   {\it t_{37}} &=& .6203504908994001\,{\it t_{36}}\\\\ 
C>   {\it t_{38}} &=& {{1}\over{\left| 2.935818660072219\,{\it t_{32}}+{\it t_{37}}+12.9352\right| }}\\\\ 
C>   {\it t_{39}} &=& \log \left(1.0\,\left({\it t_{35}}+0.10498\right)^2\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{40}} &=& \left| {\it t_{36}}\right| \\\\ 
C>   {\it t_{41}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{38}}\right)\\\\ 
C>   {\it t_{42}} &=& \rho_s+{\it t_{13}}\\\\ 
C>   {\it t_{43}} &=& \left({{{\it t_{42}}}\over{{\it t_{30}}}}+1.0\right)^{{{4}\over{3}}}-2.0\\\\ 
C>   {\it t_{44}} &=& \arctan \left({{6.692072046645942}\over{{\it t_{33}}+1.06835}}\right)\\\\ 
C>   {\it t_{45}} &=& {{1}\over{\left| .8414573716781907\,{\it t_{32}}+{\it t_{37}}+11.4813\right| }}\\\\ 
C>   {\it t_{46}} &=& \log \left(1.0\,\left({\it t_{35}}+0.228344\right)^2\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{47}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{45}}\right)\\\\ 
C>   {\it t_{48}} &=& \arctan \left({{0.0448998886415768}\over{{\it t_{33}}+13.072}}\right)\\\\ 
C>   {\it t_{49}} &=& \arctan \left({{1.171685277708971}\over{{\it t_{33}}+20.1231}}\right)\\\\ 
C>   {\it t_{50}} &=& {{1}\over{\left| 10.29581201158544\,{\it t_{32}}+{\it t_{37}}+42.7198\right| }}\\\\ 
C>   {\it t_{51}} &=& \log \left(1.0\,\left({\it t_{35}}+0.409286\right)^2\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{52}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{50}}\right)\\\\ 
C>   {\it t_{53}} &=& {{1}\over{\left| 15.84942278842832\,{\it t_{32}}+{\it t_{37}}+101.578\right| }}\\\\ 
C>   {\it t_{54}} &=& \log \left(1.0\,\left({\it t_{35}}+0.743294\right)^2\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{55}} &=& \log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{53}}\right)\\\\ 
C>   {\it t_{56}} &=& {{1}\over{\left| 5.560951426165705\,{\it t_{32}}+{\it t_{37}}+18.0578\right| }}\\\\ 
C>   f &=& 1.0\,{\it t_1}\,\left(1.923661050931536\,{\it t_{16}}\,\left(-0.01554535\,{\it t_{28}}-.002667310007273315\,{\it t_{27}}+0.0310907\,{\it t_{25}}+.004431373767749538\,{\it t_{24}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{11}}\,{\it t_{29}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_6}+0.325\right)^2\,{\it t_{29}}\right)-0.0310907\,{\it t_{12}}-9.690227711544375 \times 10^{-4}\,{\it t_{10}}-.6188180297906176\,{\it t_{22}}+20.52197293770518\,{\it t_{21}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_4}+7.06042}}\right)-.03878329487811301\,{\it t_5}\right)+1.125\,{\it t_{16}}\,\left({{{\it t_{14}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{28}}+.002667310007273315\,{\it t_{27}}-0.0310907\,{\it t_{25}}-.004431373767749538\,{\it t_{24}}+.6188180297906176\,{\it t_{22}}-20.52197293770518\,{\it t_{21}}\right)+.01688686394038963\,{\it t_{20}}+3.6490335179177674 \times 10^{-4}\,{\it t_{19}}+.005458482358638966\,{\it t_{17}}\right)}\over{{\it t_1}^4}}-.01688686394038963\,{\it t_{20}}-3.6490335179177674 \times 10^{-4}\,{\it t_{19}}-.005458482358638966\,{\it t_{17}}\right)+0.0310907\,{\it t_{12}}+9.690227711544375 \times 10^{-4}\,{\it t_{10}}+.03878329487811301\,{\it t_5}\right)\\\\ 
C>   g &=& 0\\\\ 
C>   G &=& 1.0\,{\it t_{30}}\,\left(1.923661050931536\,{\it t_{43}}\,\left(-0.01554535\,{\it t_{55}}-.002667310007273315\,{\it t_{54}}+0.0310907\,{\it t_{52}}+.004431373767749538\,{\it t_{51}}+0.01554535\,\log \left(.6203504908994001\,{\it t_{40}}\,{\it t_{56}}\right)+.002247867095542611\,\log \left(1.0\,\left({\it t_{35}}+0.325\right)^2\,{\it t_{56}}\right)-0.0310907\,{\it t_{41}}-9.690227711544375 \times 10^{-4}\,{\it t_{39}}-.6188180297906176\,{\it t_{49}}+20.52197293770518\,{\it t_{48}}+.05249139316978092\,\arctan \left({{4.730926909560114}\over{{\it t_{33}}+7.06042}}\right)-.03878329487811301\,{\it t_{34}}\right)+1.125\,{\it t_{43}}\,\left({{{\it t_{42}}^4\,\left(1.709920934161365\,\left(0.01554535\,{\it t_{55}}+.002667310007273315\,{\it t_{54}}-0.0310907\,{\it t_{52}}-.004431373767749538\,{\it t_{51}}+.6188180297906176\,{\it t_{49}}-20.52197293770518\,{\it t_{48}}\right)+.01688686394038963\,{\it t_{47}}+3.6490335179177674 \times 10^{-4}\,{\it t_{46}}+.005458482358638966\,{\it t_{44}}\right)}\over{{\it t_{30}}^4}}-.01688686394038963\,{\it t_{47}}-3.6490335179177674 \times 10^{-4}\,{\it t_{46}}-.005458482358638966\,{\it t_{44}}\right)+0.0310907\,{\it t_{41}}+9.690227711544375 \times 10^{-4}\,{\it t_{39}}+.03878329487811301\,{\it t_{34}}\right)\\\\ 
C> \f} 
C> 
C> ### References ### 
C> 
C> [1] SH Vosko, L Wilk, M Nusair, Can.J.Phys. 58, 1200 (1980)  , DOI: 
C> <a href="http://dx.doi.org/10.1139/p80-159 "> 
C> 10.1139/p80-159 </a> 
C> 
      subroutine nwxcm_c_vwn2_d3(param,tol_rho,ipol,nq,wght, 
     +rho,fnc,Amat,Amat2,Amat3) 
c $Id: $ 
      implicit double precision (a-h,o-z), integer (i-n) 
#include "nwxc_param.fh" 
      double precision param(*)     !< [Input] Parameters of functional 
      double precision tol_rho      !< [Input] The lower limit on the density 
      integer ipol                  !< [Input] The number of spin channels 
      integer nq                    !< [Input] The number of points 
      double precision wght         !< [Input] The weight of the functional 
      double precision rho(nq,*)    !< [Input] The density 
      double precision fnc(nq)      !< [Output] The value of the functional 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat(nq,*)   !< [Output] The derivative wrt rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat2(nq,*)  !< [Output] The 2nd derivative wrt rho 
c 
c     Sampling Matrices for the XC Kernel 
c 
      double precision Amat3(nq,*)  !< [Output] The 3rd derivative wrt rho 
c 
      integer iq 
      double precision tmp 
      double precision rhoa,rhob 
      double precision gammaaa,gammaab,gammabb 
      double precision taua,taub 
      do iq = 1, nq 
        if (ipol.eq.1) then 
          rhoa    = 0.5d0*rho(iq,R_T) 
          if (rhoa.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho 
        else  ! ipol.eq.1 
          rhoa    = rho(iq,R_A) 
          rhob    = rho(iq,R_B) 
          if (rhoa.gt.tol_rho.and.rhob.gt.tol_rho) then 
          elseif (rhoa.gt.tol_rho.and.rhob.le.tol_rho) then 
          elseif (rhoa.le.tol_rho.and.rhob.gt.tol_rho) then 
          endif ! rhoa.gt.tol_rho.and.rhob.gt.tol_rho 
        endif ! ipol.eq.1 
      enddo ! iq 
      end 
C> @} 
