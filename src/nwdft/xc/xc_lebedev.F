      subroutine xc_lebedev(iacc,nang,lpri1)
      implicit none

C$Id: xc_lebedev.F,v 1.2 1995-12-19 20:20:58 og845 Exp $

#include "quad.fh"
#include "stdio.fh"
C
C     routine for Lebedev weights, supplied by Mauro Causa`
C
      integer iacc  ! [input]
      integer MAXN,i
      parameter(MAXN=61)
      logical lpri1,lpri2
      double precision gjk(3,MAXN),wleb(MAXN),fasf(6),goh(3,3,48)
      integer  njk(6,IAC_MAX),ivj(48,IAC_MAX),nvj(IAC_MAX),
     *     jkv(IAC_MAX+1),nridv(IAC_MAX),
     * itop(3,3,6),isig(3,8)
      double precision fourpi
      parameter(fourpi=4.d0*3.1415926535897932385d0)
      data itop/
     *1,0,0,0,1,0,0,0,1, 1,0,0,0,0,1,0,1,0,
     *0,1,0,1,0,0,0,0,1, 0,0,1,0,1,0,1,0,0,
     *0,1,0,0,0,1,1,0,0, 0,0,1,1,0,0,0,1,0/
      data isig/
     * 1, 1, 1,-1, 1, 1, 1,-1, 1, 1, 1,-1,
     *-1,-1,-1, 1,-1,-1,-1, 1,-1,-1,-1, 1/
c     n= 9
      data wleb( 1),(gjk(i, 1),i=1,3)/
     *     0.00952380952397,1.0,0.0,0.0/
      data wleb( 2),(gjk(i, 2),i=1,3)/
     *     0.0321428571429 ,1.0,1.0,1.0/
      data wleb( 3),(gjk(i, 3),i=1,3)/
     *     0.0285714285714 ,0.888073833977,0.459700843381,0.0/
c     n=11
      data wleb( 4),(gjk(i, 4),i=1,3)/
     *     0.0126984126985 ,1.0,0.0,0.0/
      data wleb( 5),(gjk(i, 5),i=1,3)/
     *     0.0225749559083 ,1.0,1.0,0.0/
      data wleb( 6),(gjk(i, 6),i=1,3)/
     *     0.02109375      ,1.0,1.0,1.0/
      data wleb( 7),(gjk(i, 7),i=1,3)/
     *0.0201733355379 ,0.301511344578,0.301511344578,0.904534033733/
c     n=17
      data wleb( 8),(gjk(i, 8),i=1,3)/
     *     0.003828270494940,1.00,0.00,0.00/
      data wleb( 9),(gjk(i, 9),i=1,3)/
     *     0.009793737512490,1.00,1.00,1.00/
      data wleb(10),(gjk(i,10),i=1,3)/
     *0.008211737283190,0.1851156353450,0.1851156353450,0.9651240350870/
      data wleb(11),(gjk(i,11),i=1,3)/
     *0.009595471336070,0.3956894730560,0.3956894730560,0.8287699812530/
      data wleb(12),(gjk(i,12),i=1,3)/
     *0.00994281489118,0.690421048382,0.690421048382,0.215957291846/
      data wleb(13),(gjk(i,13),i=1,3)/
     *     0.00969499636166,0.878158910604,0.478369028812,0.0/
c     n=23
      data wleb(14),(gjk(i,14),i=1,3)/
     *     0.00178234044724,1.0,0.0,0.0/
      data wleb(15),(gjk(i,15),i=1,3)/
     *     0.00571690594998,1.0,1.0,0.0/
      data wleb(16),(gjk(i,16),i=1,3)/
     *     0.00557338317884,1.0,1.0,1.0/
      data wleb(17),(gjk(i,17),i=1,3)/
     * 0.00551877146727,0.444693317871,0.444693317871,0.777493219315/
      data wleb(18),(gjk(i,18),i=1,3)/
     *0.005158237711810,0.2892465627580,0.2892465627580,0.9125090968670/
      data wleb(19),(gjk(i,19),i=1,3)/
     *0.00560870408259,0.671297344270,0.671297344270,0.314196994183/
      data wleb(20),(gjk(i,20),i=1,3)/
     *0.00410677702817,0.129933544765,0.129933544765,0.982972302707/
      data wleb(21),(gjk(i,21),i=1,3)/
     *     0.00505184606462,0.938319218138,0.345770219761,0.0/
      data wleb(22),(gjk(i,22),i=1,3)/
     *0.00553024891623,0.836036015482,0.159041710538,0.525118572443/
c     n=27
      data wleb(23),(gjk(i,23),i=1,3)/
     *     -0.00131376912733,1.0,0.0,0.0/
      data wleb(24),(gjk(i,24),i=1,3)/
     *     -0.00252272870489,1.0,1.0,0.0/
      data wleb(25),(gjk(i,25),i=1,3)/
     *     0.00418685388170,1.0,1.0,1.0/
      data wleb(26),(gjk(i,26),i=1,3)/
     *0.00531516797782,0.703937339159,0.703937339159,0.0945750764036/
      data wleb(27),(gjk(i,27),i=1,3)/
     * 0.00425613135143,0.662033866370,0.662033866370,0.351315128565/
      data wleb(28),(gjk(i,28),i=1,3)/
     * 0.00411248239441,0.464744872642,0.464744872642,0.753673939251/
      data wleb(29),(gjk(i,29),i=1,3)/
     * 0.00359558489976,0.327742065497,0.327742065497,0.886098344997/
      data wleb(30),(gjk(i,30),i=1,3)/
     * 0.00404714237709,0.101252624857,0.101252624857,0.9896948074629/
C     * 0.00404714237709,0.101252624857,0.101252624857,0.986948074629/
      data wleb(31),(gjk(i,31),i=1,3)/
     *     0.00422958270065,0.850650808352,0.525731112119,0.0/
      data wleb(32),(gjk(i,32),i=1,3)/
     * 0.00407146759383,0.819343388819,0.524493924092,0.231479015871/
      data wleb(33),(gjk(i,33),i=1,3)/
     *     0.00408091422578,0.939227930219614, 0.3233484544306744, 
     *     0.1153111968226556/
c    * 0.00408091422578,0.939227929750,0.323348454269,0.115311196765/
c     n=29
      data wleb(34),(gjk(i,34),i=1,3)/
     *     0.000854591172878,1.0,0.0,0.0/
      data wleb(35),(gjk(i,35),i=1,3)/
     *     0.00359911928502,1.0,1.0,1.0/
      data wleb(36),(gjk(i,36),i=1,3)/
     * 0.00365004580768,0.701176641609,0.701176641609,0.129238672710/
      data wleb(37),(gjk(i,37),i=1,3)/
     * 0.00360482260142,0.656632941022,0.656632941022,0.371034178385/
      data wleb(38),(gjk(i,38),i=1,3)/
     * 0.00357672966173,0.472905413258,0.472905413258,0.743452042987/
      data wleb(39),(gjk(i,39),i=1,3)/
     * 0.00344978842429,0.351564034558,0.351564034558,0.867643624544/
      data wleb(40),(gjk(i,40),i=1,3)/
     * 0.00310895312238,0.221964523631,0.221964523631,0.949454317226/
      data wleb(41),(gjk(i,41),i=1,3)/
     * 0.00235210141366,0.0961830852303,0.0961830852303,0.990705621379/
      data wleb(42),(gjk(i,42),i=1,3)/
     *     0.00360082093222,0.820326419828,0.571895589188,0.0/
      data wleb(43),(gjk(i,43),i=1,3)/
     *     0.00298234496317,0.964408914879,0.264415288706,0.0/
      data wleb(44),(gjk(i,44),i=1,3)/
     * 0.00357154055427,0.251003475177,0.800072749407,0.544867737258/
      data wleb(45),(gjk(i,45),i=1,3)/
     * 0.00339231220501,0.902442529533,0.412772408317,0.123354853258/
c     n=35
      data wleb(46),(gjk(i,46),i=1,3)/
     *  0.00052659765761428065, 1.0,0.0,0.0/                             
      data wleb(47),(gjk(i,47),i=1,3)/
     *     0.0025482199909403521, 1.0,1.0,0.0/
      data wleb(48),(gjk(i,48),i=1,3)/
     *  0.0025123173709441058, 1.0,1.0,1.0/
      data wleb(49),(gjk(i,49),i=1,3)/
     *0.0025304038224001323, 0.69093463105113458,0.69093463105113458, 
     *0.21264682275657227/
      data wleb(50),(gjk(i,50),i=1,3)/
     *0.25132671684706878e-2,0.64566647095194987,0.64566647095194987, 
     *0.40771266423415123/
      data wleb(51),(gjk(i,51),i=1,3)/
     *0.0025017251210647733,0.49143426555639500,0.49143426555639500, 
     *0.71901649861049314/
      data wleb(52),(gjk(i,52),i=1,3)/
     *  0.0024453733047996786, 0.39272598223217649, 0.39272598223217649, 
     *  0.83158439485090411/
      data wleb(53),(gjk(i,53),i=1,3)/
     *0.23026944325620758e-2,0.28612891787658218,0.28612891787658218,
     *0.91447279057911405/
      data wleb(54),(gjk(i,54),i=1,3)/
     *0.20142782609526094e-2,0.17748365242374568,0.17748365242374568, 
     *0.96798714156989403/
      data wleb(55),(gjk(i,55),i=1,3)/
     * 0.14624950815475142e-2,0.07568095866244468,0.07568095866244468, 
     *     0.99425589512552888/
      data wleb(56),(gjk(i,56),i=1,3)/
     * 0.19109513147305082e-2,0.97764280892098723,.21027253307334757,
     * 0.0/
      data wleb(57),(gjk(i,57),i=1,3)/
     * 0.24174423575419847e-2,0.88181328936054412,0.47159868819488597,
     * 0.0/
      data wleb(58),(gjk(i,58),i=1,3)/
     * 0.22366077071364263e-2,0.09921769971362576,0.33443631695748371, 
     * 0.93718098463607886/
      data wleb(59),(gjk(i,59),i=1,3)/
     *0.24169300107381179e-2,0.20548237125466495,0.45023303874296735, 
     *0.86894603165434486/
      data wleb(60),(gjk(i,60),i=1,3)/
     *0.25122368647336706e-2, 0.10680182513533723, 0.59051570309804130, 
     *0.79992785583600399/
      data wleb(61),(gjk(i,61),i=1,3)/
     *0.24966440519292456e-2, 0.31042840327515130, 0.55501523681448068, 
     *0.77174626228042463/
c     
      data fasf/6*1.0/
      data  jkv/0,3,7,13,22,33,45,61/
c     
      data  njk/1,0,1,0,1,0, 1,1,1,1,0,0, 1,0,1,3,1,0, 1,1,1,4,1,1,
     *     1,1,1,5,1,2, 1,0,1,6,2,2, 1,1,1,7,2,4/
      data  nvj/6,12,8,24,24,48,48/
      data (ivj(i,1),i=1,6)/
     *     1, 2,17,19,25,28/
      data (ivj(i,2),i=1,12)/
     *     1, 2, 3, 8, 9,10,12,15,25,27,28,30/
      data (ivj(i,3),i=1,8)/
     *     1, 2, 3, 4, 5, 6, 7, 8/
      data (ivj(i,4),i=1,24)/
     *     1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,
     *     13,14,15,16,25,26,27,28,29,30,31,32/
      data (ivj(i,5),i=1,24)/
     *     1, 2, 3, 8,17,18,19,24, 9,10,12,15,
     *     41,42,44,47,33,35,36,38,25,27,28,30/
      data (ivj(i,6),i=1,48)/
     *     1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,
     *     13,14,15,16,17,18,19,20,21,22,23,24,
     *     25,26,27,28,29,30,31,32,33,34,35,36,
     *     37,38,39,40,41,42,43,44,45,46,47,48/
      data (ivj(i,7),i=1,48)/
     *     1, 2, 3, 4, 5, 6, 7, 8, 9,10,11,12,
     *     13,14,15,16,17,18,19,20,21,22,23,24,
     *     25,26,27,28,29,30,31,32,33,34,35,36,
     *     37,38,39,40,41,42,43,44,45,46,47,48/
      data nridv/38,50,110,194,266,302,434/
c
      integer nop,n48,iv,k,ks,isi,j,ia,nang,iaz,
     ,     jk,jk1,nvjj,l
      double precision wtest,fasfj,x0,y0,z0,
     ,     gjkt1,gjkt2,gjkt3
c
      lpri2=.false.
      nop=0
      n48=1
      do 57 iv=1,6
      do 57 ks=1,8
      nop=nop+1
      do 57  i=1,3
      isi=isig(i,ks)
      do 57  j=1,3
57    goh(i,j,nop)=isi*itop(i,j,iv)
      fasf(2)=1.d0/sqrt(2.d0)
      fasf(3)=1.d0/sqrt(3.d0)

      do ia=1,iacc

      if(ia.le.0) then
        nang=1
        za_leb(1,1,ia)=1.0
        za_leb(2,1,ia)=0.0
        za_leb(3,1,ia)=0.0
        wa_leb(1,ia)=fourpi
      else
        iaz=min(ia,IAC_MAX)
        nang=0
        wtest=0.
        jk=jkv(iaz)
        jk1=0
        do 20  j=1,6
          nvjj=nvj(j)
          fasfj=fasf(j)
          do 20 k=1,njk(j,iaz)
            jk=jk+1
            jk1=jk1+1
              x0=gjk(1,jk)
              y0=gjk(2,jk)
              z0=gjk(3,jk)
              if(lpri2) write(LuOut,207)

            do  l=1,nvjj
              iv=ivj(l,j)

              gjkt1=goh(1,1,iv)*x0+goh(1,2,iv)*y0+goh(1,3,iv)*z0
              gjkt2=goh(2,1,iv)*x0+goh(2,2,iv)*y0+goh(2,3,iv)*z0
              gjkt3=goh(3,1,iv)*x0+goh(3,2,iv)*y0+goh(3,3,iv)*z0
              nang=nang+1
              za_leb(1,nang,iaz)=gjkt1*fasfj
              za_leb(2,nang,iaz)=gjkt2*fasfj
              za_leb(3,nang,iaz)=gjkt3*fasfj
              wa_leb(nang,iaz)=wleb(jk)*fourpi
              wtest=wtest+wa_leb(nang,ia)

              if(lpri2) write(LuOut,209)
     &             wa_leb(nang,iaz),(za_leb(i,nang,iaz),i=1,3)
            enddo

   20   continue
        if(lpri1) write(LuOut,410) nang,wtest/fourpi
        endif
        ntheta(ia)=nang
        nphi(ia)=-99
        enddo
        return
  208   format(t10,3f10.5)
  207   format('     reducible set of points ;')
  209   format(t10,f10.5,2x,3f10.5)
  410   format('   total no. of   reducible points:',i4,'; test:',f12.8)
            end

