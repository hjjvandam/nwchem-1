title "SiC 8 atom cubic cell"

start SiC

#**** define a simulation cell ****
PSPW
   SIMULATION_CELL
      cell_name: small
      boundry_conditions: periodic
      lattice_vectors:
         8.277d0  0.000d0  0.0d0 
         0.000d0  8.277d0  0.000d0
         0.000d0  0.000d0  8.277d0
      ngrid: 8 8 8
   END
END
PSPW
   SIMULATION_CELL
      cell_name: medium
      boundry_conditions: periodic
      lattice_vectors:
         8.277d0  0.000d0  0.0d0 
         0.000d0  8.277d0  0.000d0
         0.000d0  0.000d0  8.277d0
      ngrid: 16 16 16
   END
END

geometry units au center autosym print
  system crystal 
    lat_a 8.277d0
    lat_b 8.277d0
    lat_c 8.277d0
    alpha 90.0d0
    beta  90.0d0
    gamma 90.0d0
  end
Si    -0.50000d0  -0.50000d0  -0.50000d0
Si     0.00000d0   0.00000d0  -0.50000d0
Si     0.00000d0  -0.50000d0   0.00000d0
Si    -0.50000d0   0.00000d0   0.00000d0
C     -0.25000d0  -0.25000d0  -0.25000d0
C      0.25000d0   0.25000d0  -0.25000d0
C      0.25000d0  -0.25000d0   0.25000d0
C     -0.25000d0   0.25000d0   0.25000d0
end
#geometry units au 
#Si    -2.69003   -2.69003   -2.69003
#Si     1.44848    1.44848   -2.69003
#Si     1.44848   -2.69003    1.44848
#Si    -2.69003    1.44848    1.44848
#C     -0.62078   -0.62078   -0.62078
#C      3.51773    3.51773   -0.62078
#C      3.51773   -0.62078    3.51773
#C     -0.62078    3.51773    3.51773
#end




#******* Generate a Pseudopotential for Silicon **********************
PSPW 
   PSP_GENERATOR                       
      pseudopotential_filename: Si.psp  # Si.psp is the name of the datafile
                                        # generated

      element: Si                       # label used for the carbon atom
      charge: 14.0d0                       # nuclear charge of carbon atom
      mass_number: 28.0d0                 # mass (a.u.) of carbon atom
      solver_type: pauli                # Pauli or Schrodinger op
      pseudopotential_type: hamann      # Hamann and Troullier-Martins options 
      #exchange_type: pbe96              # dirac and pbe96 options
      #correlation_type: pbe96           # vosko and pbe96 options

      atomic_filling: 3 2   # Ncore and Nvalence states
        1 s 2.0d0             # core state  1s^2
        2 s 2.0d0             # coren state 2s^2
        2 p 6.0d0             # coren state 2p^2
        3 s 2.0d0             # valence state 3s^2
        3 p 2.0d0             # valence state 3p^2
   END
END
#******* Generate a Pseudopotential for Carbon  **********************
PSPW 
   PSP_GENERATOR                       
      pseudopotential_filename: C.psp   # C.psp is the name of the datafile
                                        # generated

      element: C                        # label used for the carbon atom
      charge: 6.0d0                      # nuclear charge of carbon atom
      mass_number: 12.0d0                 # mass (a.u.) of carbon atom
      solver_type: pauli                # Pauli or Schrodinger op
      pseudopotential_type: hamann      # Hamann and Troullier-Martins options 
      #exchange_type: pbe96              # dirac and pbe96 options
      #correlation_type: pbe96           # vosko and pbe96 options

      atomic_filling: 1 2   # Ncore and Nvalence states
        1 s 2.0d0             # core state    1s^2
        2 s 2.0d0             # valence state 2s^2
        2 p 2.0d0             # valence state 2p^2
      cutoff: 3   # number of cutoff values
         s 0.80d0   # cutoff value for Vs
         p 0.85d0   # cutoff value for Vp
         d 0.85d0   # cutoff value for Vd

   END
END


#******* Generate a Formmatted pseudopotential for silicon *****
PSPW
   PSP_FORMATTER
      cell_name: small
      psp_filename: Si.psp
      formatted_filename: Si.small.vpp
   END
END
task pspw psp_formatter
PSPW
   PSP_FORMATTER
      cell_name: medium
      psp_filename: Si.psp
      formatted_filename: Si.medium.vpp
   END
END
task pspw psp_formatter

#******* Generate a Formmatted pseudopotential for carbon *****
PSPW
   PSP_FORMATTER
      cell_name: small
      psp_filename: C.psp
      formatted_filename: C.small.vpp
   END
END
task pspw psp_formatter
PSPW
   PSP_FORMATTER
      cell_name: medium
      psp_filename: C.psp
      formatted_filename: C.medium.vpp
   END
END
task pspw psp_formatter


#******* Generate a initial wavefunction based on planewaves ****
PSPW
   WAVEFUNCTION_INITIALIZER
      restricted
      wavefunction_filename: SiC.small.movecs
      cell_name: small
      up_filling: 16
        0  0  0  0
        0  1  0 -1
        1  0  0  1
        0  0  1  1
        1  0  1 -1
        1 -1  0 -1
        0  1  1 -1
        1  0  1 +1
        1 -1  0 +1
        1  1  1 -1
        1  1 -1 -1
        1 -1  1 -1
        1 -1 -1 -1
        1 -1 -1 +1
        2  0  0 -1
        0  2  0 -1
   END 
END
task pspw wavefunction_initializer

#***** do coarse optimization with steepest descent ********
PSPW
   STEEPEST_DESCENT
      cell_name: small
      formatted_filename: Si.small.vpp
      formatted_filename: C.small.vpp
      input_wavefunction_filename:  SiC.small.movecs
      output_wavefunction_filename: SiC.small.movecs
      fake_mass: 400000.0d0
      time_step: 15.8d0
      loop: 200 50
      tolerances: 1.0d-9 1.0d-9 1.0d-4
      ewald_ncut: 8
   END 
END
task pspw steepest_descent
#***** Setup conjugate gradient code ****
PSPW
   CONJUGATE_GRADIENT
      cell_name: small
      formatted_filename: Si.small.vpp
      formatted_filename: C.small.vpp
      input_wavefunction_filename:  SiC.small.movecs
      output_wavefunction_filename: SiC.small.movecs
      fake_mass: 400000.0d0
      time_step: 15.8d0
      loop: 25 10
      tolerances: 1.0d-12 1.0d-9
      ewald_ncut: 8
   END 
END
task pspw conjugate_gradient  #task cg_pspw energy is equivalent
task pspw steepest_descent




#***** expand the wavefunction to larger grid *****
PSPW
   WAVEFUNCTION_EXPANDER
      old_wavefunction_filename: SiC.small.movecs
      new_wavefunction_filename: SiC.movecs
      new_ngrid: 16 16 16
   END 
END
task pspw wavefunction_expander

#***** do finer optimization with steepest descent for a few iterations *****
PSPW
   STEEPEST_DESCENT
      cell_name: medium
      formatted_filename: Si.medium.vpp
      formatted_filename: C.medium.vpp
      input_wavefunction_filename:  SiC.movecs
      output_wavefunction_filename: SiC.movecs
      fake_mass: 400000.0d0
      time_step: 15.8d0
      loop: 100 10
      tolerances: 1.0d-9 1.0d-9 1.0d-4
      ewald_ncut: 8
   END 
END
task pspw steepest_descent

#***** Setup conjugate gradient code ****
PSPW
   CONJUGATE_GRADIENT
      cell_name: medium
      formatted_filename: Si.medium.vpp
      formatted_filename: C.medium.vpp
      input_wavefunction_filename:  SiC.movecs
      output_wavefunction_filename: SiC.movecs
      fake_mass: 400000.0d0
      time_step: 15.8d0
      loop: 25 10
      tolerances: 1.0d-9 1.0d-9 1.0d-4
      ewald_ncut: 8
   END 
END
task cg_pspw energy   #task pspw conjugate_gradient is equivalent
task pspw steepest_descent


